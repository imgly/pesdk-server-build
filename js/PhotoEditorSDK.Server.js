(function webpackUniversalModuleDefinition(root, factory) {
	if(typeof exports === 'object' && typeof module === 'object')
		module.exports = factory(require("canvas"), require("gl"), require("request"));
	else if(typeof define === 'function' && define.amd)
		define(["canvas", "gl", "request"], factory);
	else if(typeof exports === 'object')
		exports["PhotoEditorServer"] = factory(require("canvas"), require("gl"), require("request"));
	else
		root["PhotoEditorServer"] = factory(root["canvas"], root["gl"], root["request"]);
})(typeof self !== 'undefined' ? self : this, function(__WEBPACK_EXTERNAL_MODULE_19__, __WEBPACK_EXTERNAL_MODULE_115__, __WEBPACK_EXTERNAL_MODULE_233__) {
return /******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId]) {
/******/ 			return installedModules[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, {
/******/ 				configurable: false,
/******/ 				enumerable: true,
/******/ 				get: getter
/******/ 			});
/******/ 		}
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(__webpack_require__.s = 140);
/******/ })
/************************************************************************/
/******/ ([
/* 0 */
/***/ (function(module, exports, __webpack_require__) {

module.exports = { "default": __webpack_require__(141), __esModule: true };

/***/ }),
/* 1 */
/***/ (function(module, exports, __webpack_require__) {

module.exports = { "default": __webpack_require__(151), __esModule: true };

/***/ }),
/* 2 */
/***/ (function(module, exports, __webpack_require__) {

module.exports = { "default": __webpack_require__(143), __esModule: true };

/***/ }),
/* 3 */
/***/ (function(module, exports, __webpack_require__) {

module.exports = { "default": __webpack_require__(146), __esModule: true };

/***/ }),
/* 4 */
/***/ (function(module, exports, __webpack_require__) {

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */

module.exports = __webpack_require__(154).default;

/***/ }),
/* 5 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__primitives_stack__ = __webpack_require__(242);





var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* jshint unused: false */
/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




/**
 * Base class for filters. Extendable via {@link PhotoEditorSDK.Filter#extend}
 * @class
 * @memberof PhotoEditorSDK
 */

var Filter = function (_Configurable) {
  _inherits(Filter, _Configurable);

  function Filter() {
    var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};

    _classCallCheck(this, Filter);

    var _this = _possibleConstructorReturn(this, (Filter.__proto__ || __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default()(Filter)).call(this, options, {
      intensity: {
        type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].NUMBER,
        default: 1.0,
        setter: function setter(intensity) {
          this._stack && this._stack.setIntensity(intensity);
          return intensity;
        }
      },
      dirty: {
        type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].BOOLEAN,
        default: true
      }
    }));

    _this._stack = new __WEBPACK_IMPORTED_MODULE_5__primitives_stack__["a" /* default */](_this._options.intensity);
    return _this;
  }

  /**
   * Renders the filter
   * @param  {PhotoEditorSDK} sdk
   * @param  {PhotoEditorSDK.Engine.Texture} inputTexture
   * @param  {PhotoEditorSDK.Engine.RenderTexture} outputTexture
   * @return {Promise}
   */


  _createClass(Filter, [{
    key: 'render',
    value: function render(sdk, inputTexture, outputTexture) {
      var _this2 = this;

      return this._stack.render(sdk, inputTexture, outputTexture).then(function (response) {
        _this2.setDirty(false);
        return response;
      });
    }

    /**
     * Sets the dirtiness for the given renderer
     * @param {Boolean} dirty
     * @param {PhotoEditorSDK.Engine.BaseRenderer} renderer
     */

  }, {
    key: 'setDirtyForRenderer',
    value: function setDirtyForRenderer(dirty, renderer) {
      this._stack.setDirtyForRenderer(dirty, renderer);
    }

    /**
     * Frees the memory
     */

  }, {
    key: 'disposeRenderTextures',
    value: function disposeRenderTextures() {
      this._stack.disposeRenderTextures();
    }

    /**
     * Cleans this instance up
     */

  }, {
    key: 'dispose',
    value: function dispose() {
      this._stack.dispose();
    }
  }]);

  return Filter;
}(__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Configurable"]);

/**
 * A unique string that identifies this filter
 * @type {String}
 */


Filter.identifier = null;

/**
 * If `isIdentity` is true, this filter does not do anything and can be seen as
 * the default filter.
 * @type {Boolean}
 */
Filter.isIdentity = false;

/**
 * This string is used by the UI
 * @type {String}
 */
Filter.displayName = null;

// Exposed classes
Filter.PrimitivesStack = __WEBPACK_IMPORTED_MODULE_5__primitives_stack__["a" /* default */];

/* harmony default export */ __webpack_exports__["a"] = (Filter);

/***/ }),
/* 6 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
Object.defineProperty(__webpack_exports__, "__esModule", { value: true });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__brightness__ = __webpack_require__(244);
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "Brightness", function() { return __WEBPACK_IMPORTED_MODULE_0__brightness__["a"]; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__contrast__ = __webpack_require__(246);
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "Contrast", function() { return __WEBPACK_IMPORTED_MODULE_1__contrast__["a"]; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__color_matrix__ = __webpack_require__(248);
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "ColorMatrixPrimitive", function() { return __WEBPACK_IMPORTED_MODULE_2__color_matrix__["a"]; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__desaturation__ = __webpack_require__(250);
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "Desaturation", function() { return __WEBPACK_IMPORTED_MODULE_3__desaturation__["a"]; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__gamma__ = __webpack_require__(252);
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "Gamma", function() { return __WEBPACK_IMPORTED_MODULE_4__gamma__["a"]; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__glow__ = __webpack_require__(254);
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "Glow", function() { return __WEBPACK_IMPORTED_MODULE_5__glow__["a"]; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__gobblin__ = __webpack_require__(256);
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "Gobblin", function() { return __WEBPACK_IMPORTED_MODULE_6__gobblin__["a"]; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__grayscale__ = __webpack_require__(258);
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "Grayscale", function() { return __WEBPACK_IMPORTED_MODULE_7__grayscale__["a"]; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__lookup_table__ = __webpack_require__(128);
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "LookupTable", function() { return __WEBPACK_IMPORTED_MODULE_8__lookup_table__["a"]; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9__lookup_table_image__ = __webpack_require__(261);
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "LookupTableImage", function() { return __WEBPACK_IMPORTED_MODULE_9__lookup_table_image__["a"]; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10__saturation__ = __webpack_require__(263);
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "Saturation", function() { return __WEBPACK_IMPORTED_MODULE_10__saturation__["a"]; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_11__soft_color_overlay__ = __webpack_require__(265);
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "SoftColorOverlay", function() { return __WEBPACK_IMPORTED_MODULE_11__soft_color_overlay__["a"]; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_12__tone_curve__ = __webpack_require__(267);
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "ToneCurve", function() { return __WEBPACK_IMPORTED_MODULE_12__tone_curve__["a"]; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_13__x400__ = __webpack_require__(268);
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "X400", function() { return __WEBPACK_IMPORTED_MODULE_13__x400__["a"]; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_14__3d_lookup_table_image__ = __webpack_require__(270);
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "ThreeDLookupTableImage", function() { return __WEBPACK_IMPORTED_MODULE_14__3d_lookup_table_image__["a"]; });
/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */

/**
 * Filter primitives are the core of filters. One filter consists of multiple filter primitives.
 * For an example, look at the implementation of a filter, e.g. {@link PhotoEditorSDK.Filters.A15Filter}
 * or see our documentation at {@link https://www.photoeditorsdk.com/documentation}.
 * @namespace PhotoEditorSDK.FilterPrimitives
 */
















/***/ }),
/* 7 */
/***/ (function(module, exports, __webpack_require__) {

module.exports = { "default": __webpack_require__(196), __esModule: true };

/***/ }),
/* 8 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return BATCH_SIZE; });
/* unused harmony export VERTEX_SIZE */
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "j", function() { return VERTEX_BYTE_SIZE; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__shared_log__ = __webpack_require__(17);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__lib_color__ = __webpack_require__(41);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__lib_math_matrix__ = __webpack_require__(108);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__lib_math_rectangle__ = __webpack_require__(109);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__lib_math_vector2__ = __webpack_require__(34);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__lib_event_emitter__ = __webpack_require__(42);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__lib_utils__ = __webpack_require__(24);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__lib_gl_utils__ = __webpack_require__(110);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__constants__ = __webpack_require__(28);
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "b", function() { return __WEBPACK_IMPORTED_MODULE_1__lib_color__["a"]; });
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "g", function() { return __WEBPACK_IMPORTED_MODULE_2__lib_math_matrix__["a"]; });
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "k", function() { return __WEBPACK_IMPORTED_MODULE_4__lib_math_vector2__["a"]; });
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "h", function() { return __WEBPACK_IMPORTED_MODULE_3__lib_math_rectangle__["a"]; });
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "d", function() { return __WEBPACK_IMPORTED_MODULE_5__lib_event_emitter__["a"]; });
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "f", function() { return __WEBPACK_IMPORTED_MODULE_0__shared_log__["a"]; });
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "i", function() { return __WEBPACK_IMPORTED_MODULE_6__lib_utils__["a"]; });
/* harmony reexport (module object) */ __webpack_require__.d(__webpack_exports__, "c", function() { return __WEBPACK_IMPORTED_MODULE_8__constants__; });
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "e", function() { return __WEBPACK_IMPORTED_MODULE_7__lib_gl_utils__["a"]; });
/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */











var BATCH_SIZE = 2000;
var VERTEX_SIZE = 5;
var VERTEX_BYTE_SIZE = VERTEX_SIZE * 4;



/***/ }),
/* 9 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "h", function() { return Promise; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "n", function() { return Vector2; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "k", function() { return SDKUtils; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "d", function() { return EventEmitter; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "b", function() { return Color; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return Base64; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "i", function() { return RenderType; });
/* unused harmony export OptionType */
/* unused harmony export UniformType */
/* unused harmony export EXIF */
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "j", function() { return SDK; });
/* unused harmony export now */
/* unused harmony export ColorMatrix */
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "e", function() { return ImageFormat; });
/* unused harmony export Rectangle */
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__lib_utils__ = __webpack_require__(153);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__lib_constants__ = __webpack_require__(330);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__shared_log__ = __webpack_require__(17);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__shared_constants__ = __webpack_require__(131);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__shared_loaders_image_loader__ = __webpack_require__(48);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk__ = __webpack_require__(39);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk__);
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "m", function() { return __WEBPACK_IMPORTED_MODULE_0__lib_utils__["a"]; });
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "c", function() { return __WEBPACK_IMPORTED_MODULE_1__lib_constants__["a"]; });
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "g", function() { return __WEBPACK_IMPORTED_MODULE_2__shared_log__["a"]; });
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "l", function() { return __WEBPACK_IMPORTED_MODULE_3__shared_constants__["a"]; });
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "f", function() { return __WEBPACK_IMPORTED_MODULE_4__shared_loaders_image_loader__["a"]; });
/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */








var Base64 = __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk___default.a.Base64;
var Color = __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk___default.a.Color;
var ColorMatrix = __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk___default.a.Math.ColorMatrix;
var EventEmitter = __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk___default.a.EventEmitter;
var EXIF = __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk___default.a.EXIF;
var OptionType = __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk___default.a.OptionType;
var Promise = __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk___default.a.Promise;
var SDKUtils = __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk___default.a.Utils;
var RenderType = __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk___default.a.RenderType;
var ImageFormat = __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk___default.a.ImageFormat;
var SDK = __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk___default.a;
var UniformType = __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk___default.a.UniformType;
var Vector2 = __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk___default.a.Math.Vector2;
var Rectangle = __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk___default.a.Math.Rectangle;

var now = typeof window !== 'undefined' && window.performance && window.performance.now ? window.performance.now.bind(window.performance) : __webpack_require__(80);



/***/ }),
/* 10 */
/***/ (function(module, exports) {

var core = module.exports = { version: '2.5.3' };
if (typeof __e == 'number') __e = core; // eslint-disable-line no-undef


/***/ }),
/* 11 */
/***/ (function(module, exports, __webpack_require__) {

module.exports = { "default": __webpack_require__(170), __esModule: true };

/***/ }),
/* 12 */
/***/ (function(module, exports, __webpack_require__) {

var store = __webpack_require__(69)('wks');
var uid = __webpack_require__(51);
var Symbol = __webpack_require__(14).Symbol;
var USE_SYMBOL = typeof Symbol == 'function';

var $exports = module.exports = function (name) {
  return store[name] || (store[name] =
    USE_SYMBOL && Symbol[name] || (USE_SYMBOL ? Symbol : uid)('Symbol.' + name));
};

$exports.store = store;


/***/ }),
/* 13 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__);





var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* jshint unused: false */
/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */



/**
 * Base class for filter primitives.
 * @class
 * @memberof PhotoEditorSDK.FilterPrimitives
 */

var Primitive = function (_Configurable) {
  _inherits(Primitive, _Configurable);

  function Primitive() {
    _classCallCheck(this, Primitive);

    return _possibleConstructorReturn(this, (Primitive.__proto__ || __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default()(Primitive)).apply(this, arguments));
  }

  _createClass(Primitive, [{
    key: 'update',

    /**
     * Gets called before this primitive's filter is being applied
     */
    value: function update() {}

    /**
     * Returns this primitive's filter
     * @return {PhotoEditorSDK.Engine.Filter}
     */

  }, {
    key: 'getFilter',
    value: function getFilter() {
      return this._filter;
    }

    /**
     * Cleans up this instance
     */

  }, {
    key: 'dispose',
    value: function dispose() {
      if (this._filter) {
        this._filter.dispose();
        this._filter = null;
      }
    }
  }]);

  return Primitive;
}(__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Configurable"]);

/* harmony default export */ __webpack_exports__["a"] = (Primitive);

/***/ }),
/* 14 */
/***/ (function(module, exports) {

// https://github.com/zloirock/core-js/issues/86#issuecomment-115759028
var global = module.exports = typeof window != 'undefined' && window.Math == Math
  ? window : typeof self != 'undefined' && self.Math == Math ? self
  // eslint-disable-next-line no-new-func
  : Function('return this')();
if (typeof __g == 'number') __g = global; // eslint-disable-line no-undef


/***/ }),
/* 15 */
/***/ (function(module, exports, __webpack_require__) {

var global = __webpack_require__(14);
var core = __webpack_require__(10);
var ctx = __webpack_require__(30);
var hide = __webpack_require__(25);
var PROTOTYPE = 'prototype';

var $export = function (type, name, source) {
  var IS_FORCED = type & $export.F;
  var IS_GLOBAL = type & $export.G;
  var IS_STATIC = type & $export.S;
  var IS_PROTO = type & $export.P;
  var IS_BIND = type & $export.B;
  var IS_WRAP = type & $export.W;
  var exports = IS_GLOBAL ? core : core[name] || (core[name] = {});
  var expProto = exports[PROTOTYPE];
  var target = IS_GLOBAL ? global : IS_STATIC ? global[name] : (global[name] || {})[PROTOTYPE];
  var key, own, out;
  if (IS_GLOBAL) source = name;
  for (key in source) {
    // contains in native
    own = !IS_FORCED && target && target[key] !== undefined;
    if (own && key in exports) continue;
    // export native or passed
    out = own ? target[key] : source[key];
    // prevent global pollution for namespaces
    exports[key] = IS_GLOBAL && typeof target[key] != 'function' ? source[key]
    // bind timers to global for call from export context
    : IS_BIND && own ? ctx(out, global)
    // wrap global constructors for prevent change them in library
    : IS_WRAP && target[key] == out ? (function (C) {
      var F = function (a, b, c) {
        if (this instanceof C) {
          switch (arguments.length) {
            case 0: return new C();
            case 1: return new C(a);
            case 2: return new C(a, b);
          } return new C(a, b, c);
        } return C.apply(this, arguments);
      };
      F[PROTOTYPE] = C[PROTOTYPE];
      return F;
    // make static versions for prototype methods
    })(out) : IS_PROTO && typeof out == 'function' ? ctx(Function.call, out) : out;
    // export proto methods to core.%CONSTRUCTOR%.methods.%NAME%
    if (IS_PROTO) {
      (exports.virtual || (exports.virtual = {}))[key] = out;
      // export proto methods to core.%CONSTRUCTOR%.prototype.%NAME%
      if (type & $export.R && expProto && !expProto[key]) hide(expProto, key, out);
    }
  }
};
// type bitmap
$export.F = 1;   // forced
$export.G = 2;   // global
$export.S = 4;   // static
$export.P = 8;   // proto
$export.B = 16;  // bind
$export.W = 32;  // wrap
$export.U = 64;  // safe
$export.R = 128; // real proto method for `library`
module.exports = $export;


/***/ }),
/* 16 */
/***/ (function(module, exports, __webpack_require__) {

var isObject = __webpack_require__(20);
module.exports = function (it) {
  if (!isObject(it)) throw TypeError(it + ' is not an object!');
  return it;
};


/***/ }),
/* 17 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */

var maxLogLevel = 'warn';

var LEVELS = [{ type: 'trace', background: '#EEEEEE', color: '#AAAAAA' }, { type: 'info', background: '#BDE5F8', color: '#00529B' }, { type: 'warn', background: '#FEEFB3', color: '#9F6000' }, { type: 'error', background: '#FFBABA', color: '#D8000C' }, { type: 'log', background: '#EEEEEE', color: '#1f4f6b' }];
var LEVEL_TYPES = LEVELS.map(function (l) {
  return l.type;
});

var Log = {};

Log.setLevel = function (_level) {
  maxLogLevel = _level;
};
Log.canLog = function (type) {
  if (maxLogLevel === null) return false;
  var currentLevelIndex = LEVEL_TYPES.indexOf(type);
  var maxLevelIndex = LEVEL_TYPES.indexOf(maxLogLevel);
  if (currentLevelIndex < maxLevelIndex) return false;
  return true;
};
Log.hasColorfulOutput = function () {
  return (!process || process && process.browser) && typeof navigator !== 'undefined' && navigator.userAgent.match(/Gecko|WebKit/i) && !navigator.userAgent.match(/Trident/);
};

Log.printError = function (e) {
  var lines = e.stack.split('\n');
  lines.forEach(function (line) {
    Log.error('Error', line);
  });
};

LEVELS.forEach(function (level) {
  var type = level.type,
      background = level.background,
      color = level.color;

  Log[type] = function (tag) {
    if (typeof console === 'undefined') return;
    if (!Log.canLog(type)) return;

    for (var _len = arguments.length, args = Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
      args[_key - 1] = arguments[_key];
    }

    var output = args.map(function (a) {
      return typeof a === 'string' ? a : a.toString();
    }).join(' ');
    if (!Log.hasColorfulOutput()) {
      return console.log('PhotoEditorSDK | ' + tag + ' | ' + output);
    }
    console.log('%c  %c PhotoEditorSDK %c  %c ' + tag + ' %c  ' + output + '  %c  ', 'background: #2D7BFF; line-height: 20px; padding: 4px 0', 'background: #2B2B2B; color: white; line-height: 20px; padding: 4px 0', 'background: #2D7BFF; line-height: 20px; padding: 4px 0', 'background: ' + background + '; color: ' + color + '; line-height: 20px; padding: 4px 0; font-weight: bold', 'background: #2B2B2B; color: white; line-height: 20px; padding: 4px 0', 'background: #2D7BFF; line-height: 20px; padding: 4px 0');
  };
});

/* harmony default export */ __webpack_exports__["a"] = (Log);

/***/ }),
/* 18 */
/***/ (function(module, exports, __webpack_require__) {

var anObject = __webpack_require__(16);
var IE8_DOM_DEFINE = __webpack_require__(91);
var toPrimitive = __webpack_require__(62);
var dP = Object.defineProperty;

exports.f = __webpack_require__(21) ? Object.defineProperty : function defineProperty(O, P, Attributes) {
  anObject(O);
  P = toPrimitive(P, true);
  anObject(Attributes);
  if (IE8_DOM_DEFINE) try {
    return dP(O, P, Attributes);
  } catch (e) { /* empty */ }
  if ('get' in Attributes || 'set' in Attributes) throw TypeError('Accessors not supported!');
  if ('value' in Attributes) O[P] = Attributes.value;
  return O;
};


/***/ }),
/* 19 */
/***/ (function(module, exports) {

module.exports = __WEBPACK_EXTERNAL_MODULE_19__;

/***/ }),
/* 20 */
/***/ (function(module, exports) {

module.exports = function (it) {
  return typeof it === 'object' ? it !== null : typeof it === 'function';
};


/***/ }),
/* 21 */
/***/ (function(module, exports, __webpack_require__) {

// Thank's IE8 for his funny defineProperty
module.exports = !__webpack_require__(31)(function () {
  return Object.defineProperty({}, 'a', { get: function () { return 7; } }).a != 7;
});


/***/ }),
/* 22 */
/***/ (function(module, exports, __webpack_require__) {

module.exports = { "default": __webpack_require__(156), __esModule: true };

/***/ }),
/* 23 */
/***/ (function(module, exports, __webpack_require__) {

module.exports = { "default": __webpack_require__(162), __esModule: true };

/***/ }),
/* 24 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_symbol_iterator__ = __webpack_require__(22);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_symbol_iterator___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_symbol_iterator__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_symbol__ = __webpack_require__(23);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_symbol___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_symbol__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_assign__ = __webpack_require__(79);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_assign___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_assign__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_array_from__ = __webpack_require__(188);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_array_from___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_array_from__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_promise__ = __webpack_require__(11);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_promise___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_promise__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_keys__ = __webpack_require__(56);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_keys___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_keys__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_6_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_7_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__base64__ = __webpack_require__(43);









var _extends = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_assign___default.a || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };

var _typeof = typeof __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_symbol___default.a === "function" && typeof __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_symbol_iterator___default.a === "symbol" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_symbol___default.a === "function" && obj.constructor === __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_symbol___default.a && obj !== __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_symbol___default.a.prototype ? "symbol" : typeof obj; };

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_7_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_array_from___default()(arr); } }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/* global HTMLElement, WEBPACK */
/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */



var ArrayUtils = function () {
  function ArrayUtils() {
    _classCallCheck(this, ArrayUtils);
  }

  _createClass(ArrayUtils, null, [{
    key: 'head',

    /**
     * Returns the first element in an array
     * @param {Array<A>} arr
     * @returns {A}
     */
    value: function head(arr) {
      return arr[0];
    }

    /**
     * Returns a shallow copy of the array excluding the first element
     * @param {Array<A>} arr
     * @returns {Array<A>}
     */

  }, {
    key: 'tail',
    value: function tail(arr) {
      return arr.slice(1);
    }

    /**
     * Returns the last element of an array
     * @param {Array<A>} arr
     * @returns {A}
     */

  }, {
    key: 'last',
    value: function last(arr) {
      return arr[arr.length - 1];
    }

    /**
     * Returns a shallow copy of the array excluding the last element
     * @param {Array<A>} arr
     * @returns {Array<A>}
     */

  }, {
    key: 'init',
    value: function init(arr) {
      return arr.slice(0, arr.length - 1);
    }

    /**
     * Returns a shallow copy of the array with the elements tha pass
     * the test function removed.
     * @param {Array<A>} arr
     * @param {Function} func - A test function
     */

  }, {
    key: 'remove',
    value: function remove(arr, func) {
      return arr.filter(function (v, i, arr) {
        return !func(v, i, arr);
      });
    }
  }]);

  return ArrayUtils;
}();

/**
 * Provides utility functions for internal use
 * @class
 * @memberof PhotoEditorSDK
 * @private
 */


var Utils = function () {
  function Utils() {
    _classCallCheck(this, Utils);
  }

  _createClass(Utils, null, [{
    key: 'isArray',

    /**
     * Checks if the given object is an Array
     * @param  {Object}  object
     * @return {Boolean}
     */
    value: function isArray(object) {
      return Object.prototype.toString.call(object) === '[object Array]';
    }

    /**
     * Checks if a given object is a plain object (i.e., a literal object) or not.
     * @param {any} object
     * @returns Boolean
     */

  }, {
    key: 'isPlainObject',
    value: function isPlainObject(object) {
      if ((typeof object === 'undefined' ? 'undefined' : _typeof(object)) !== 'object' || !object) {
        return false;
      }

      if (typeof __WEBPACK_IMPORTED_MODULE_6_babel_runtime_core_js_object_get_prototype_of___default.a === 'function') {
        var proto = __WEBPACK_IMPORTED_MODULE_6_babel_runtime_core_js_object_get_prototype_of___default()(object);
        return proto === Object.prototype || proto === null;
      }

      return Object.prototype.toString.call(object) === '[object Object]';
    }

    /**
     * Checks whether the user agent represents a mobile device
     * @return {Boolean}
     */

  }, {
    key: 'isMobile',
    value: function isMobile() {
      if (typeof navigator === 'undefined') return false;

      var a = navigator.userAgent || navigator.vendor || window.opera;
      /* eslint-disable */
      return (/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od|ad)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(a) || /1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(a.substr(0, 4))
      );
      /* eslint-enable */
    }

    /**
     * Checks wether the platform target is a browser
     * @return {Boolean}
     */

  }, {
    key: 'isBrowser',
    value: function isBrowser() {
      return typeof window !== 'undefined';
    }

    /**
     * Checks wether the platform target is Nodejs
     * @return {Boolean}
     */

  }, {
    key: 'isNode',
    value: function isNode() {
      return typeof window === 'undefined' && typeof global !== 'undefined';
    }

    /**
     * Returns the given object's values as an array
     * @param {Object} object
     * @returns {Array<*>}
     */

  }, {
    key: 'values',
    value: function values(object) {
      var values = [];
      for (var key in object) {
        values.push(object[key]);
      }
      return values;
    }

    /**
     * Checks if the given object is a DOM element
     * @param  {Object}  o
     * @return {Boolean}
     */
    /* istanbul ignore next */

  }, {
    key: 'isDOMElement',
    value: function isDOMElement(o) {
      return (typeof HTMLElement === 'undefined' ? 'undefined' : _typeof(HTMLElement)) === 'object' ? o instanceof HTMLElement : o && (typeof o === 'undefined' ? 'undefined' : _typeof(o)) === 'object' && o !== null && o.nodeType === 1 && typeof o.nodeName === 'string';
    }

    /**
     * Checks if th given event is a touch event
     * @param  {Event}  e
     * @return {Boolean}
     */

  }, {
    key: 'isTouchEvent',
    value: function isTouchEvent(e) {
      return e.type.indexOf('touch') !== -1;
    }

    /**
     * Resizes the given vector to fit inside the given max size while maintaining
     * the aspect ratio
     * @param  {Vector2} vector
     * @param  {Vector2} max
     * @return {Vector2}
     */

  }, {
    key: 'resizeVectorToFit',
    value: function resizeVectorToFit(vector, max) {
      var scale = Math.min(max.x / vector.x, max.y / vector.y);
      var newSize = vector.clone().multiply(scale);
      return newSize;
    }
  }, {
    key: 'resizeVectorToFill',
    value: function resizeVectorToFill(vector, container) {
      var vectorRatio = vector.x / vector.y;
      var containerRatio = container.x / container.y;
      if (vectorRatio > containerRatio) {
        return container.clone().set(container.y * vectorRatio, container.y);
      } else {
        return container.clone().set(container.x, container.x / vectorRatio);
      }
    }

    /**
     * Checks if this value is extendable / can have keys
     * @param  {*}  val
     * @return {Boolean}
     */

  }, {
    key: 'isExtendable',
    value: function isExtendable(val) {
      return typeof val !== 'undefined' && val !== null && ((typeof val === 'undefined' ? 'undefined' : _typeof(val)) === 'object' || typeof val === 'function');
    }

    /**
     * Assigns own enumerable properties of source object(s) to the destination
     * object for all destination properties that resolve to undefined. Once a
     * property is set, additional values of the same property are ignored.
     * @param  {Object} object
     * @param  {Object} ...sources
     * @return {Object}
     */

  }, {
    key: 'defaults',
    value: function defaults(object) {
      // Shallow clone
      var newObject = {};
      for (var key in object) {
        newObject[key] = object[key];
      }

      // Clone sources

      for (var _len = arguments.length, sources = Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
        sources[_key - 1] = arguments[_key];
      }

      for (var i = 0; i < sources.length; i++) {
        var source = sources[i];
        for (var _key2 in source) {
          if (typeof newObject[_key2] === 'undefined') {
            newObject[_key2] = source[_key2];
          }
        }
      }

      return newObject;
    }

    /**
     * Does a deep merge between a set of objects, from left to right. The merge is
     * deep in the sense that it goes recurseviley trough the objects own
     * properties. When it encounters an array, it only does a shallow copy of it.
     *
     * @param {Object} dest
     * @param {Object[]} sources
     * @returns {Object}
     */

  }, {
    key: 'deepMerge',
    value: function deepMerge(dest) {
      // deep merge between two objects only
      var _deepMerge = function _deepMerge(dest, source) {
        // If the source is undefined, return a copy of dest
        if (source === undefined) {
          return _deepMerge(null, dest);
        }

        // If the source is an array, return a shallow copy
        if (Array.isArray(source)) {
          return [].concat(_toConsumableArray(source));
        }

        // If the source is not a plain object, just return it
        if (!Utils.isPlainObject(source)) {
          return source;
        }

        // If dest is an not a plain object, return a shallow copy of the source
        if (!Utils.isPlainObject(dest)) {
          return _extends({}, source);
        }

        // Shallow-copy the original object
        var result = _extends({}, dest);

        // Go trough each source key
        __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_keys___default()(source).forEach(function (key) {
          var value = source[key];
          if (value === undefined) {
            return;
          }
          result[key] = _deepMerge(dest[key], value);
        });
        return result;
      };

      for (var _len2 = arguments.length, sources = Array(_len2 > 1 ? _len2 - 1 : 0), _key3 = 1; _key3 < _len2; _key3++) {
        sources[_key3 - 1] = arguments[_key3];
      }

      return sources.reduce(_deepMerge, dest);
    }

    /**
     * Assigns own enumerable properties of source object(s) to the destination
     * object for all destination properties and their properties that resolve to
     * undefined. Once a property is set, additional value sof the same property
     * are ignored.
     * @param  {Object} object
     * @param  {Object} ...sources
     * @return {Object}
     */

  }, {
    key: 'deepDefaults',
    value: function deepDefaults(object) {
      for (var _len3 = arguments.length, sources = Array(_len3 > 1 ? _len3 - 1 : 0), _key4 = 1; _key4 < _len3; _key4++) {
        sources[_key4 - 1] = arguments[_key4];
      }

      var reversedSources = [].concat(sources).reverse();
      return Utils.deepMerge.apply(Utils, _toConsumableArray(reversedSources).concat([object]));
    }

    /**
     * Creates a deep clone of the given object
     * @param  {Object}    object
     * @return {Object}
     */

  }, {
    key: 'deepClone',
    value: function deepClone(object) {
      var newObject = {};
      for (var key in object) {
        if (Utils.isExtendable(object[key])) {
          newObject[key] = Utils.deepClone(object[key]);
        } else {
          newObject[key] = object[key];
        }
      }
      return newObject;
    }

    /**
     * Get a deep property inside an object.
     *
     * @param {Object} object - the object
     * @param {String[]} path - Either a string with the prop's
     *  name, or an array of prop names and/or functions describing a path in a
     *  nested object. Any function passed in the array should function as a getter
     *  for a prop.
     *
     * @returns {(any|undefined)} - The prop's value, or undefined if the prop is
     * not found
     */

  }, {
    key: 'getDeepProperty',
    value: function getDeepProperty(object, path) {
      if (typeof path === 'string') {
        return object[path];
      }

      if (!Array.isArray(path)) {
        return undefined;
      }

      // When we have a getter function inside the array, call it as a getter,
      // ignoring any type errors thrown by it (just return undefined.)
      var callPropName = function callPropName(object, propName) {
        var value = void 0;
        try {
          value = propName(object);
        } catch (e) {
          if (!(e instanceof TypeError)) {
            throw e;
          }
        }

        return value;
      };

      return path.reduce(function (object, propName) {
        return object ? typeof propName === 'function' ? callPropName(object, propName) : object[propName] : null;
      }, object);
    }

    /**
     * Assigns own enumerable properties of source object(s) to the destination
     * object. Subsequent sources overwrite property assignments of previous
     * sources.
     * @param {Object} object
     * @param {Object} ...sources
     * @return {Object}
     */

  }, {
    key: 'extend',
    value: function extend(object) {
      // Shallow clone
      var newObject = {};
      for (var key in object) {
        newObject[key] = object[key];
      }

      // Extend sources

      for (var _len4 = arguments.length, sources = Array(_len4 > 1 ? _len4 - 1 : 0), _key5 = 1; _key5 < _len4; _key5++) {
        sources[_key5 - 1] = arguments[_key5];
      }

      for (var i = 0; i < sources.length; i++) {
        var source = sources[i];
        for (var _key6 in source) {
          newObject[_key6] = source[_key6];
        }
      }

      return newObject;
    }

    /**
     * Creates a shallow clone of the given object
     * @param {Object} object
     * @returns {Object}
     */

  }, {
    key: 'clone',
    value: function clone(object) {
      return this.extend({}, object);
    }

    /**
     * Creates a Blob URI from the given Data URI
     * @param {String} data
     */

  }, {
    key: 'createBlobURIFromDataURI',
    value: function createBlobURIFromDataURI(data) {
      var root = typeof window === 'undefined' ? global : window;
      if (!root.Blob || !root.URL || !ArrayBuffer || !Uint8Array) {
        return data;
      }

      var rawData = __WEBPACK_IMPORTED_MODULE_8__base64__["a" /* default */].decode(data.split(',')[1]);
      var mimeString = data.split(',')[0].split(':')[1].split(';')[0];

      // write the bytes of the string to an ArrayBuffer
      var arrayBuffer = new ArrayBuffer(rawData.length);
      var intArray = new Uint8Array(arrayBuffer);
      for (var i = 0; i < rawData.length; i++) {
        intArray[i] = rawData[i];
      }

      // write the ArrayBuffer to a blob, and you're done
      var blob = new root.Blob([arrayBuffer], {
        type: mimeString
      });
      return root.URL.createObjectURL(blob);
    }

    /**
     * Generates a UUID
     * @return {String}
     */

  }, {
    key: 'getUUID',
    value: function getUUID() {
      return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {
        var r = Math.random() * 16 | 0;
        var v = c === 'x' ? r : r & 0x3 | 0x8;
        return v.toString(16);
      });
    }

    /**
     * Flattens the given multidimensional array
     * @return {Array}
     */

  }, {
    key: 'flatten',
    value: function flatten(array) {
      return array.reduce(function (flat, toFlatten) {
        return flat.concat(Array.isArray(toFlatten) ? Utils.flatten(toFlatten) : toFlatten);
      }, []);
    }

    /**
     * Creates a canvas DOM element (browser) or a node-canvas canvas (node)
     * @return {Canvas}
     */

  }, {
    key: 'createCanvas',
    value: function createCanvas() {
      if (typeof WEBPACK === 'undefined') {
        var NodeCanvas = __webpack_require__(19).Canvas;
        return new NodeCanvas(300, 150);
      } else {
        return document.createElement('canvas');
      }
    }

    /**
     * Checks if the given dimensions are POT
     * @param  {PhotoEditorSDK.Math.Vector2}  dimensions
     * @return {Boolean}
     */

  }, {
    key: 'isPowerOfTwo',
    value: function isPowerOfTwo(dimensions) {
      return (dimensions.x & dimensions.x - 1) === 0 && (dimensions.y & dimensions.y - 1) === 0;
    }

    /**
     * Returns the next lowest power of two of the given number
     * @param  {Number} x
     * @return {Number}
     */

  }, {
    key: 'nextLowestPOT',
    value: function nextLowestPOT(x) {
      for (var i = 1; i < 32; i <<= 1) {
        x = x | x >> i;
      }
      return x - (x >> 1);
    }

    /**
     * Returns the next highest power of two of the given number
     * @param  {Number} x
     * @return {Number}
     */

  }, {
    key: 'nextHighestPOT',
    value: function nextHighestPOT(x) {
      x--;
      for (var i = 1; i < 32; i <<= 1) {
        x = x | x >> i;
      }
      return x + 1;
    }

    /**
     * Moves the array item at `oldIndex` to `newIndex`
     * @param  {Array} arr
     * @param  {Number} oldIndex
     * @param  {Number} newIndex
     */

  }, {
    key: 'moveArrayItem',
    value: function moveArrayItem(arr, oldIndex, newIndex) {
      if (newIndex >= arr.length) {
        var k = newIndex - arr.length;
        while (k-- + 1) {
          arr.push(undefined);
        }
      }
      arr.splice(newIndex, 0, arr.splice(oldIndex, 1)[0]);
    }

    /**
     * Makes sure the given canvas has the given dimensions. If not, it does not change the
     * canvas dimensions.
     * @param  {Canvas} canvas
     * @param  {PhotoEditorSDK.Math.Vector2} dimensions
     */

  }, {
    key: 'ensureCanvasDimensions',
    value: function ensureCanvasDimensions(canvas, dimensions) {
      if (canvas.width !== dimensions.x || canvas.height !== dimensions.y) {
        canvas.width = dimensions.x;
        canvas.height = dimensions.y;
      }
    }

    /**
     * Converts the given array of bytes to a string
     * @param  {Number[]} byteArray
     * @return {String}
     */

  }, {
    key: 'byteArrayToString',
    value: function byteArrayToString(byteArray) {
      return byteArray.map(function (byte) {
        return String.fromCharCode(byte);
      }).join('');
    }

    /**
     * Clamps the given `number` into `min` and `max`
     * @param  {Number} number
     * @param  {Number} min
     * @param  {Number} max
     * @return {Number}
     */

  }, {
    key: 'clamp',
    value: function clamp(number, min, max) {
      return Math.max(min, Math.min(number, max));
    }

    /**
     * Checks if the given string matches the given wildcard
     * @param  {String} str
     * @param  {String} rule
     * @return {Boolean}
     */

  }, {
    key: 'wildCardMatch',
    value: function wildCardMatch(str, rule) {
      return new RegExp('^' + rule.split('*').join('.*') + '$').test(str);
    }

    /**
     * Returns a new object with flipped values and keys
     * @param  {Object} obj
     * @return {Object}
     */

  }, {
    key: 'flipObject',
    value: function flipObject(obj) {
      var newObj = {};
      for (var key in obj) {
        newObj[obj[key]] = key;
      }
      return newObj;
    }

    /**
     * Returns a clone of the given options object
     * @param  {Object} options
     * @return {Object}
     */

  }, {
    key: 'cloneOptions',
    value: function cloneOptions(options) {
      var newOptions = {};
      for (var key in options) {
        var value = options[key];
        if (Array.isArray(value)) {
          value = value.slice();
        } else if (value.clone) {
          value = value.clone();
        }
        newOptions[key] = value;
      }
      return newOptions;
    }

    /**
     * Returns the given date as RFC 3339
     * @param {Date} date
     * @return {String}
     */

  }, {
    key: 'ISODateString',
    value: function ISODateString(date) {
      function pad(n) {
        return n < 10 ? '0' + n : n;
      }
      return date.getUTCFullYear() + '-' + pad(date.getUTCMonth() + 1) + '-' + pad(date.getUTCDate()) + 'T' + pad(date.getUTCHours()) + ':' + pad(date.getUTCMinutes()) + ':' + pad(date.getUTCSeconds()) + 'Z';
    }

    /**
     * Shallow equal compare two objects
     * @param {*} objA
     * @param {*} objB
     * @returns {Boolean}
     */

  }, {
    key: 'shallowEqual',
    value: function shallowEqual(objA, objB) {
      if (objA === objB) {
        return true;
      }

      if ((typeof objA === 'undefined' ? 'undefined' : _typeof(objA)) !== 'object' || objA === null || (typeof objB === 'undefined' ? 'undefined' : _typeof(objB)) !== 'object' || objB === null) {
        return false;
      }

      var keysA = __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_keys___default()(objA);
      var keysB = __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_keys___default()(objB);

      if (keysA.length !== keysB.length) {
        return false;
      }
      // Test for A's keys different from B.
      var bHasOwnProperty = hasOwnProperty.bind(objB);
      for (var i = 0; i < keysA.length; i++) {
        if (!bHasOwnProperty(keysA[i]) || objA[keysA[i]] !== objB[keysA[i]]) {
          return false;
        }
      }
      return true;
    }

    /**
     * Returns 'value' if condition is met else returns 'undefined'
     * @param {Boolean} condition
     * @param {*} value
     * @returns {*}
     */

  }, {
    key: 'enableIf',
    value: function enableIf(condition, value) {
      return condition ? value : undefined;
    }

    /**
      Throws an error if condition is not met
      @param {Boolean} condition
     */

  }, {
    key: 'invariant',
    value: function invariant(condition, message) {
      if (!condition) {
        var error = new Error(message);
        throw error;
      }
    }

    /**
     * Exectues all Promises in an array, returning a new Promise which
     * will fulfill with an array of the values returned by all promises in
     * the case all of them are resolved, or, with one or more are rejected,
     * rejects with an array containing all the error values.
     *
     * @param {Array<Promise>} promises
     * @returns {Promise<Array>}
     */

  }, {
    key: 'executePromises',
    // eslint-disable-line
    value: function executePromises(promises) {
      var count = promises.length;
      var counter = 0;

      var values = [];
      var errors = [];

      return new __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_promise___default.a(function (resolve, reject) {
        var onFinnish = function onFinnish() {
          counter++;
          if (counter >= count) {
            if (errors.length <= 0) {
              resolve(values);
            } else {
              reject(errors);
            }
          }
        };

        var onSuccess = function onSuccess(value) {
          values.push(value);
          onFinnish();
        };

        var onError = function onError(value) {
          errors.push(value);
          onFinnish();
        };

        promises.forEach(function (promise) {
          promise.then(onSuccess).catch(onError);
        });
      });
    }
  }]);

  return Utils;
}();

Utils.Array = ArrayUtils;


/* harmony default export */ __webpack_exports__["a"] = (Utils);

/***/ }),
/* 25 */
/***/ (function(module, exports, __webpack_require__) {

var dP = __webpack_require__(18);
var createDesc = __webpack_require__(35);
module.exports = __webpack_require__(21) ? function (object, key, value) {
  return dP.f(object, key, createDesc(1, value));
} : function (object, key, value) {
  object[key] = value;
  return object;
};


/***/ }),
/* 26 */
/***/ (function(module, exports, __webpack_require__) {

// to indexed object, toObject with fallback for non-array-like ES3 strings
var IObject = __webpack_require__(92);
var defined = __webpack_require__(64);
module.exports = function (it) {
  return IObject(defined(it));
};


/***/ }),
/* 27 */
/***/ (function(module, exports) {

var hasOwnProperty = {}.hasOwnProperty;
module.exports = function (it, key) {
  return hasOwnProperty.call(it, key);
};


/***/ }),
/* 28 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
Object.defineProperty(__webpack_exports__, "__esModule", { value: true });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "RenderType", function() { return RenderType; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ImageFormat", function() { return ImageFormat; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Events", function() { return Events; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "OptionType", function() { return OptionType; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "UniformType", function() { return UniformType; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "RendererType", function() { return RendererType; });
/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */

/**
* The available render types
* @enum {String} RenderType
* @property {string} IMAGE image
* @property {string} DATAURL data-url
* @property {string} BUFFER buffer
* @property {string} BLOB blob
* @property {string} MSBLOB ms-blob
* @memberof PhotoEditorSDK
*/
var RenderType = {
  IMAGE: 'image',
  DATAURL: 'data-url',
  BUFFER: 'buffer',
  BLOB: 'blob',
  MSBLOB: 'ms-blob'

  /**
   * The available image types
   * @enum {String} ImageFormat
   * @property {string} PNG  image/png
   * @property {string} JPEG image/jpg
   * @memberof PhotoEditorSDK
   */
};var ImageFormat = {
  PNG: 'image/png',
  JPEG: 'image/jpeg'

  /**
   * Events used by the UI
   * @enum {String}
   * @alias Events
   * @property {string} OPERATION_UPDATED
   * @memberof PhotoEditorSDK
   */
};var Events = {
  OPERATION_UPDATED: 'operation:update'

  /**
   * The available option types for classes inheriting {@link PhotoEditorSDK.Configurable}
   * @enum {String}
   * @alias OptionType
   * @property {string} NUMBER
   * @property {string} VECTOR2
   * @property {string} COLOR_MATRIX
   * @property {string} COLOR
   * @property {string} ARRAY
   * @property {string} OBJECT
   * @property {string} STRING
   * @property {string} BOOLEAN
   * @property {string} CONFIGURABLE
   * @property {string} IMAGE
   * @property {string} FUNCTION
   * @property {string} TEXTURE
   * @property {string} ALL
   * @memberof PhotoEditorSDK
   */
};var OptionType = {
  NUMBER: 'number',
  VECTOR2: 'vector2',
  COLOR_MATRIX: 'color-matrix',
  COLOR: 'color',
  ARRAY: 'array',
  OBJECT: 'object',
  STRING: 'string',
  BOOLEAN: 'boolean',
  CONFIGURABLE: 'configurable',
  IMAGE: 'image',
  FUNCTION: 'function',
  TEXTURE: 'texture',
  ALL: '*'

  /**
   * The available uniform types for WebGL shaders
   * @enum {String}
   * @alias UniformType
   * @property {string} SAMPLER2D
   * @property {string} INT
   * @property {string} INT1
   * @property {string} FLOAT
   * @property {string} FLOAT1
   * @property {string} FLOAT2
   * @property {string} FLOAT_VECTOR2
   * @property {string} FLOAT3
   * @property {string} FLOAT4
   * @property {string} MAT3
   * @property {string} MAT3FV
   * @property {string} MAT4
   * @memberof PhotoEditorSDK
   */
};var UniformType = {
  SAMPLER2D: 'sampler2d',
  INT: 'i',
  INT1: '1i',
  FLOAT: 'f',
  FLOAT1: '1f',
  FLOAT2: '2f',
  FLOAT_VECTOR2: '2fv',
  FLOAT3: '3f',
  FLOAT4: '4f',
  MAT3: 'mat3',
  MAT3FV: 'mat3fv',
  MAT4: 'mat4'

  /**
   * The available renderer types
   * @enum {String}
   * @alias RendererType
   * @property {string} WEBGL
   * @property {string} CANVAS
   * @memberOf PhotoEditorSDK
   */
};var RendererType = {
  WEBGL: 'webgl',
  CANVAS: 'canvas'
};

/***/ }),
/* 29 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_symbol_iterator__ = __webpack_require__(22);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_symbol_iterator___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_symbol_iterator__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_symbol__ = __webpack_require__(23);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_symbol___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_symbol__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_promise__ = __webpack_require__(11);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_promise___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_promise__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_set_immediate__ = __webpack_require__(207);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_set_immediate___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_set_immediate__);






var _typeof = typeof __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_symbol___default.a === "function" && typeof __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_symbol_iterator___default.a === "symbol" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_symbol___default.a === "function" && obj.constructor === __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_symbol___default.a && obj !== __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_symbol___default.a.prototype ? "symbol" : typeof obj; };

/* eslint-disable */

/*!
 * Native Promise Only
 * v0.8.0-a (c) Kyle Simpson
 * MIT License: http://getify.mit-license.org
 */

/* istanbul ignore next */
var promiseFactory = function DEF() {
  /*jshint validthis:true */
  "use strict";

  var builtInProp,
      cycle,
      scheduling_queue,
      ToString = Object.prototype.toString,
      timer = typeof __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_set_immediate___default.a != "undefined" ? function timer(fn) {
    return __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_set_immediate___default()(fn);
  } : setTimeout;

  // dammit, IE8.
  try {
    Object.defineProperty({}, "x", {});
    builtInProp = function builtInProp(obj, name, val, config) {
      return __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_define_property___default()(obj, name, {
        value: val,
        writable: true,
        configurable: config !== false
      });
    };
  } catch (err) {
    builtInProp = function builtInProp(obj, name, val) {
      obj[name] = val;
      return obj;
    };
  }

  // Note: using a queue instead of array for efficiency
  scheduling_queue = function Queue() {
    var first, last, item;

    function Item(fn, self) {
      this.fn = fn;
      this.self = self;
      this.next = void 0;
    }

    return {
      add: function add(fn, self) {
        item = new Item(fn, self);
        if (last) {
          last.next = item;
        } else {
          first = item;
        }
        last = item;
        item = void 0;
      },
      drain: function drain() {
        var f = first;
        first = last = cycle = void 0;

        while (f) {
          f.fn.call(f.self);
          f = f.next;
        }
      }
    };
  }();

  function schedule(fn, self) {
    scheduling_queue.add(fn, self);
    if (!cycle) {
      cycle = timer(scheduling_queue.drain);
    }
  }

  // promise duck typing
  function isThenable(o) {
    var _then,
        o_type = typeof o === "undefined" ? "undefined" : _typeof(o);

    if (o != null && (o_type == "object" || o_type == "function")) {
      _then = o.then;
    }
    return typeof _then == "function" ? _then : false;
  }

  function notify() {
    for (var i = 0; i < this.chain.length; i++) {
      notifyIsolated(this, this.state === 1 ? this.chain[i].success : this.chain[i].failure, this.chain[i]);
    }
    this.chain.length = 0;
  }

  // NOTE: This is a separate function to isolate
  // the `try..catch` so that other code can be
  // optimized better
  function notifyIsolated(self, cb, chain) {
    var ret, _then;
    try {
      if (cb === false) {
        chain.reject(self.msg);
      } else {
        if (cb === true) {
          ret = self.msg;
        } else {
          ret = cb.call(void 0, self.msg);
        }

        if (ret === chain.promise) {
          chain.reject(TypeError("Promise-chain cycle"));
        } else if (_then = isThenable(ret)) {
          _then.call(ret, chain.resolve, chain.reject);
        } else {
          chain.resolve(ret);
        }
      }
    } catch (err) {
      chain.reject(err);
    }
  }

  function resolve(msg) {
    var _then,
        self = this;

    // already triggered?
    if (self.triggered) {
      return;
    }

    self.triggered = true;

    // unwrap
    if (self.def) {
      self = self.def;
    }

    try {
      if (_then = isThenable(msg)) {
        schedule(function () {
          var def_wrapper = new MakeDefWrapper(self);
          try {
            _then.call(msg, function $resolve$() {
              resolve.apply(def_wrapper, arguments);
            }, function $reject$() {
              reject.apply(def_wrapper, arguments);
            });
          } catch (err) {
            reject.call(def_wrapper, err);
          }
        });
      } else {
        self.msg = msg;
        self.state = 1;
        if (self.chain.length > 0) {
          schedule(notify, self);
        }
      }
    } catch (err) {
      reject.call(new MakeDefWrapper(self), err);
    }
  }

  function reject(msg) {
    var self = this;

    // already triggered?
    if (self.triggered) {
      return;
    }

    self.triggered = true;

    // unwrap
    if (self.def) {
      self = self.def;
    }

    self.msg = msg;
    self.state = 2;
    if (self.chain.length > 0) {
      schedule(notify, self);
    }
  }

  function iteratePromises(Constructor, arr, resolver, rejecter) {
    for (var idx = 0; idx < arr.length; idx++) {
      (function IIFE(idx) {
        Constructor.resolve(arr[idx]).then(function $resolver$(msg) {
          resolver(idx, msg);
        }, rejecter);
      })(idx);
    }
  }

  function MakeDefWrapper(self) {
    this.def = self;
    this.triggered = false;
  }

  function MakeDef(self) {
    this.promise = self;
    this.state = 0;
    this.triggered = false;
    this.chain = [];
    this.msg = void 0;
  }

  function Promise(executor) {
    if (typeof executor != "function") {
      throw TypeError("Not a function");
    }

    if (this.__NPO__ !== 0) {
      throw TypeError("Not a promise");
    }

    // instance shadowing the inherited "brand"
    // to signal an already "initialized" promise
    this.__NPO__ = 1;

    var def = new MakeDef(this);

    this["then"] = function then(success, failure) {
      var o = {
        success: typeof success == "function" ? success : true,
        failure: typeof failure == "function" ? failure : false
      };
      // Note: `then(..)` itself can be borrowed to be used against
      // a different promise constructor for making the chained promise,
      // by substituting a different `this` binding.
      o.promise = new this.constructor(function extractChain(resolve, reject) {
        if (typeof resolve != "function" || typeof reject != "function") {
          throw TypeError("Not a function");
        }

        o.resolve = resolve;
        o.reject = reject;
      });
      def.chain.push(o);

      if (def.state !== 0) {
        schedule(notify, def);
      }

      return o.promise;
    };
    this["catch"] = function $catch$(failure) {
      return this.then(void 0, failure);
    };

    try {
      executor.call(void 0, function publicResolve(msg) {
        resolve.call(def, msg);
      }, function publicReject(msg) {
        reject.call(def, msg);
      });
    } catch (err) {
      reject.call(def, err);
    }
  }

  var PromisePrototype = builtInProp({}, "constructor", Promise,
  /*configurable=*/false);

  // Note: Android 4 cannot use `Object.defineProperty(..)` here
  Promise.prototype = PromisePrototype;

  // built-in "brand" to signal an "uninitialized" promise
  builtInProp(PromisePrototype, "__NPO__", 0,
  /*configurable=*/false);

  builtInProp(Promise, "resolve", function Promise$resolve(msg) {
    var Constructor = this;

    // spec mandated checks
    // note: best "isPromise" check that's practical for now
    if (msg && (typeof msg === "undefined" ? "undefined" : _typeof(msg)) == "object" && msg.__NPO__ === 1) {
      return msg;
    }

    return new Constructor(function executor(resolve, reject) {
      if (typeof resolve != "function" || typeof reject != "function") {
        throw TypeError("Not a function");
      }

      resolve(msg);
    });
  });

  builtInProp(Promise, "reject", function Promise$reject(msg) {
    return new this(function executor(resolve, reject) {
      if (typeof resolve != "function" || typeof reject != "function") {
        throw TypeError("Not a function");
      }

      reject(msg);
    });
  });

  builtInProp(Promise, "all", function Promise$all(arr) {
    var Constructor = this;

    // spec mandated checks
    if (ToString.call(arr) != "[object Array]") {
      return Constructor.reject(TypeError("Not an array"));
    }
    if (arr.length === 0) {
      return Constructor.resolve([]);
    }

    return new Constructor(function executor(resolve, reject) {
      if (typeof resolve != "function" || typeof reject != "function") {
        throw TypeError("Not a function");
      }

      var len = arr.length,
          msgs = Array(len),
          count = 0;

      iteratePromises(Constructor, arr, function resolver(idx, msg) {
        msgs[idx] = msg;
        if (++count === len) {
          resolve(msgs);
        }
      }, reject);
    });
  });

  builtInProp(Promise, "race", function Promise$race(arr) {
    var Constructor = this;

    // spec mandated checks
    if (ToString.call(arr) != "[object Array]") {
      return Constructor.reject(TypeError("Not an array"));
    }

    return new Constructor(function executor(resolve, reject) {
      if (typeof resolve != "function" || typeof reject != "function") {
        throw TypeError("Not a function");
      }

      iteratePromises(Constructor, arr, function resolver(idx, msg) {
        resolve(msg);
      }, reject);
    });
  });

  return Promise;
};

var root = typeof global === 'undefined' ? window : global;
var _Promise = typeof __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_promise___default.a !== 'undefined' ? __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_promise___default.a : promiseFactory();
root.Promise = root.Promise || _Promise;
/* harmony default export */ __webpack_exports__["a"] = (_Promise);

/***/ }),
/* 30 */
/***/ (function(module, exports, __webpack_require__) {

// optional / simple context binding
var aFunction = __webpack_require__(49);
module.exports = function (fn, that, length) {
  aFunction(fn);
  if (that === undefined) return fn;
  switch (length) {
    case 1: return function (a) {
      return fn.call(that, a);
    };
    case 2: return function (a, b) {
      return fn.call(that, a, b);
    };
    case 3: return function (a, b, c) {
      return fn.call(that, a, b, c);
    };
  }
  return function (/* ...args */) {
    return fn.apply(that, arguments);
  };
};


/***/ }),
/* 31 */
/***/ (function(module, exports) {

module.exports = function (exec) {
  try {
    return !!exec();
  } catch (e) {
    return true;
  }
};


/***/ }),
/* 32 */
/***/ (function(module, exports) {

module.exports = {};


/***/ }),
/* 33 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
Object.defineProperty(__webpack_exports__, "__esModule", { value: true });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__engine__ = __webpack_require__(55);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__constants__ = __webpack_require__(28);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__lib_base64__ = __webpack_require__(43);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__lib_event_emitter__ = __webpack_require__(42);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__lib_utils__ = __webpack_require__(24);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__lib_configurable__ = __webpack_require__(46);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__lib_color__ = __webpack_require__(41);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__shared_log__ = __webpack_require__(17);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__shared_vendor_promise__ = __webpack_require__(29);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9__lib_gl_utils__ = __webpack_require__(110);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10__lib_license_checker__ = __webpack_require__(219);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_11__shared_async_animation_frame__ = __webpack_require__(223);
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "requestAnimationFrame", function() { return __WEBPACK_IMPORTED_MODULE_11__shared_async_animation_frame__["b"]; });
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "cancelAnimationFrame", function() { return __WEBPACK_IMPORTED_MODULE_11__shared_async_animation_frame__["a"]; });
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "Engine", function() { return __WEBPACK_IMPORTED_MODULE_0__engine__["a"]; });
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "EventEmitter", function() { return __WEBPACK_IMPORTED_MODULE_3__lib_event_emitter__["a"]; });
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "Utils", function() { return __WEBPACK_IMPORTED_MODULE_4__lib_utils__["a"]; });
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "Configurable", function() { return __WEBPACK_IMPORTED_MODULE_5__lib_configurable__["a"]; });
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "Color", function() { return __WEBPACK_IMPORTED_MODULE_6__lib_color__["a"]; });
/* harmony reexport (module object) */ __webpack_require__.d(__webpack_exports__, "Constants", function() { return __WEBPACK_IMPORTED_MODULE_1__constants__; });
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "Log", function() { return __WEBPACK_IMPORTED_MODULE_7__shared_log__["a"]; });
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "Promise", function() { return __WEBPACK_IMPORTED_MODULE_8__shared_vendor_promise__["a"]; });
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "GLUtils", function() { return __WEBPACK_IMPORTED_MODULE_9__lib_gl_utils__["a"]; });
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "Base64", function() { return __WEBPACK_IMPORTED_MODULE_2__lib_base64__["a"]; });
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "LicenseChecker", function() { return __WEBPACK_IMPORTED_MODULE_10__lib_license_checker__["a"]; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_12__lib_math___ = __webpack_require__(119);
/* harmony namespace reexport (by provided) */ __webpack_require__.d(__webpack_exports__, "Vector2", function() { return __WEBPACK_IMPORTED_MODULE_12__lib_math___["Vector2"]; });
/* harmony namespace reexport (by provided) */ __webpack_require__.d(__webpack_exports__, "Vector3", function() { return __WEBPACK_IMPORTED_MODULE_12__lib_math___["Vector3"]; });
/* harmony namespace reexport (by provided) */ __webpack_require__.d(__webpack_exports__, "Rectangle", function() { return __WEBPACK_IMPORTED_MODULE_12__lib_math___["Rectangle"]; });
/* harmony namespace reexport (by provided) */ __webpack_require__.d(__webpack_exports__, "Matrix", function() { return __WEBPACK_IMPORTED_MODULE_12__lib_math___["Matrix"]; });
/* harmony namespace reexport (by provided) */ __webpack_require__.d(__webpack_exports__, "ColorMatrix", function() { return __WEBPACK_IMPORTED_MODULE_12__lib_math___["ColorMatrix"]; });
/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */

/* eslint-disable import/first */





















/***/ }),
/* 34 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);


var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */

/**
 * Represents a 2-dimensional vector while providing math functions to
 * modify / clone the vector. Fully chainable.
 * @class
 * @memberof PhotoEditorSDK.Math
 */
var Vector2 = function () {
  /**
   * Creates a Vector2
   * @param  {Number} x
   * @param  {Number} y
   */
  function Vector2(x, y) {
    _classCallCheck(this, Vector2);

    this.x = x;
    this.y = y;
    if (typeof this.x === 'undefined') {
      this.x = 0;
    }
    if (typeof this.y === 'undefined') {
      this.y = 0;
    }
  }

  /**
   * Sets the given values
   * @param {Number} x
   * @param {Number} y
   * @return {PhotoEditorSDK.Math.Vector2}
   */


  _createClass(Vector2, [{
    key: 'set',
    value: function set(x, y) {
      this.x = x;
      this.y = y;
      return this;
    }

    /**
     * Creates a clone of this vector
     * @return {PhotoEditorSDK.Math.Vector2}
     */

  }, {
    key: 'clone',
    value: function clone() {
      return new Vector2(this.x, this.y);
    }

    /**
     * Copies the values of the given vector
     * @param  {PhotoEditorSDK.Math.Vector2} other
     * @return {PhotoEditorSDK.Math.Vector2}
     */

  }, {
    key: 'copy',
    value: function copy(other) {
      this.x = other.x;
      this.y = other.y;
      return this;
    }

    /**
     * Clamps this vector with the given Vector2 / Number
     * @param  {(Number|PhotoEditorSDK.Math.Vector2)} minimum
     * @param  {(Number|PhotoEditorSDK.Math.Vector2)} maximum
     * @return {PhotoEditorSDK.Math.Vector2}
     */

  }, {
    key: 'clamp',
    value: function clamp(minimum, maximum) {
      var minimumSet = minimum !== null && typeof minimum !== 'undefined';
      var maximumSet = maximum !== null && typeof maximum !== 'undefined';

      /* istanbul ignore else  */
      if (!(minimum instanceof Vector2) && minimumSet) {
        minimum = new Vector2(minimum, minimum);
      }
      /* istanbul ignore else  */
      if (!(maximum instanceof Vector2) && maximumSet) {
        maximum = new Vector2(maximum, maximum);
      }

      if (minimumSet) {
        this.x = Math.max(minimum.x, this.x);
        this.y = Math.max(minimum.y, this.y);
      }

      if (maximumSet) {
        this.x = Math.min(maximum.x, this.x);
        this.y = Math.min(maximum.y, this.y);
      }
      return this;
    }

    /**
     * Divides this vector by the given Vector2 / Number
     * @param  {(Number|PhotoEditorSDK.Math.Vector2)} divisor
     * @param  {Number} [y]
     * @return {PhotoEditorSDK.Math.Vector2}
     */

  }, {
    key: 'divide',
    value: function divide(divisor, y) {
      if (divisor instanceof Vector2) {
        this.x /= divisor.x;
        this.y /= divisor.y;
      } else {
        this.x /= divisor;
        this.y /= typeof y === 'undefined' ? divisor : y;
      }
      return this;
    }

    /**
     * Subtracts the given Vector2 / Number from this vector
     * @param  {(Number|PhotoEditorSDK.Math.Vector2)} subtrahend
     * @param  {Number} [y]
     * @return {PhotoEditorSDK.Math.Vector2}
     */

  }, {
    key: 'subtract',
    value: function subtract(subtrahend, y) {
      if (subtrahend instanceof Vector2) {
        this.x -= subtrahend.x;
        this.y -= subtrahend.y;
      } else {
        this.x -= subtrahend;
        this.y -= typeof y === 'undefined' ? subtrahend : y;
      }
      return this;
    }

    /**
     * Multiplies the given Vector2 / Number with this vector
     * @param  {(Number|PhotoEditorSDK.Math.Vector2)} subtrahend
     * @param  {Number} [y]
     * @return {PhotoEditorSDK.Math.Vector2}
     */

  }, {
    key: 'multiply',
    value: function multiply(factor, y) {
      if (factor instanceof Vector2) {
        this.x *= factor.x;
        this.y *= factor.y;
      } else {
        this.x *= factor;
        this.y *= typeof y === 'undefined' ? factor : y;
      }
      return this;
    }

    /**
     * Adds the given Vector2 / Numbers to this vector
     * @param {(Number|PhotoEditorSDK.Math.Vector2)} addend
     * @param {Number} [y]
     * @return {PhotoEditorSDK.Math.Vector2}
     */

  }, {
    key: 'add',
    value: function add(addend, y) {
      if (addend instanceof Vector2) {
        this.x += addend.x;
        this.y += addend.y;
      } else {
        this.x += addend;
        this.y += typeof y === 'undefined' ? addend : y;
      }
      return this;
    }

    /**
     * Checks whether the x and y value are the same as the given ones
     * @param  {(Number|PhotoEditorSDK.Math.Vector2)} vec
     * @param  {Number} y
     * @return {Boolean}
     */

  }, {
    key: 'equals',
    value: function equals(vec, y) {
      if (vec instanceof Vector2) {
        return vec.x === this.x && vec.y === this.y;
      } else {
        return vec === this.x && y === this.y;
      }
    }

    /**
     * Flips the x and y values of this vector
     * @return {PhotoEditorSDK.Math.Vector2}
     */

  }, {
    key: 'flip',
    value: function flip() {
      var tempX = this.x;
      this.x = this.y;
      this.y = tempX;
      return this;
    }

    /**
     * Rounds the values of this vector
     * @returns {PhotoEditorSDK.Math.Vector2}
     */

  }, {
    key: 'round',
    value: function round() {
      this.x = Math.round(this.x);
      this.y = Math.round(this.y);
      return this;
    }

    /**
     * Rounds up the values of this vector
     * @returns {PhotoEditorSDK.Math.Vector2}
     */

  }, {
    key: 'ceil',
    value: function ceil() {
      this.x = Math.ceil(this.x);
      this.y = Math.ceil(this.y);
      return this;
    }

    /**
     * Rounds down the values of this vector
     * @returns {PhotoEditorSDK.Math.Vector2}
     */

  }, {
    key: 'floor',
    value: function floor() {
      this.x = this.x | 0;
      this.y = this.y | 0;
      return this;
    }

    /**
     * Makes both numbers of this vector positive
     * @returns {PhotoEditorSDK.Math.Vector2}
     */

  }, {
    key: 'abs',
    value: function abs() {
      this.x = Math.abs(this.x);
      this.y = Math.abs(this.y);
      return this;
    }

    /**
     * Returns the euclidean length of this vector
     * @return {Number}
     */

  }, {
    key: 'len',
    value: function len() {
      return Math.sqrt(this.x * this.x + this.y * this.y);
    }

    /**
     * Returns the smallest number in this vector
     * @return {Number}
     */

  }, {
    key: 'min',
    value: function min() {
      return Math.min(this.x, this.y);
    }

    /**
     * Returns the largest number in this vector
     * @return {Number}
     */

  }, {
    key: 'max',
    value: function max() {
      return Math.max(this.x, this.y);
    }

    /**
     * Returns a POJO of this Vector2
     * @return {Object}
     */

  }, {
    key: 'toObject',
    value: function toObject() {
      return { x: this.x, y: this.y };
    }

    /**
     * Returns a string representation of this vector
     * @return {String}
     */

  }, {
    key: 'toString',
    value: function toString() {
      return 'Vector2({ x: ' + this.x + ', y: ' + this.y + ' })';
    }

    /**
     * Rounds this vector's values to the given number of decimals
     * @param  {Number} decimals
     * @return {Number}
     */

  }, {
    key: 'roundDecimal',
    value: function roundDecimal(decimals) {
      this.x = parseFloat(this.x.toFixed(decimals));
      this.y = parseFloat(this.y.toFixed(decimals));
      return this;
    }

    /**
     * Creates a new Vector2 instance from the given Object
     * @param  {Object} object
     * @return {PhotoEditorSDK.Math.Vector2}
     */

  }], [{
    key: 'fromObject',
    value: function fromObject(object) {
      return new Vector2(object.x, object.y);
    }

    /**
     * Returns a null vector
     * @return {PhotoEditorSDK.Math.Vector2}
     */

  }, {
    key: 'NULL',
    get: function get() {
      return new Vector2(0, 0);
    }
  }]);

  return Vector2;
}();

/* harmony default export */ __webpack_exports__["a"] = (Vector2);

/***/ }),
/* 35 */
/***/ (function(module, exports) {

module.exports = function (bitmap, value) {
  return {
    enumerable: !(bitmap & 1),
    configurable: !(bitmap & 2),
    writable: !(bitmap & 4),
    value: value
  };
};


/***/ }),
/* 36 */
/***/ (function(module, exports) {

var toString = {}.toString;

module.exports = function (it) {
  return toString.call(it).slice(8, -1);
};


/***/ }),
/* 37 */
/***/ (function(module, exports, __webpack_require__) {

// 19.1.2.14 / 15.2.3.14 Object.keys(O)
var $keys = __webpack_require__(93);
var enumBugKeys = __webpack_require__(70);

module.exports = Object.keys || function keys(O) {
  return $keys(O, enumBugKeys);
};


/***/ }),
/* 38 */
/***/ (function(module, exports, __webpack_require__) {

// 7.1.13 ToObject(argument)
var defined = __webpack_require__(64);
module.exports = function (it) {
  return Object(defined(it));
};


/***/ }),
/* 39 */
/***/ (function(module, exports, __webpack_require__) {

/* @module */
/*!
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */

/**
 * @namespace PhotoEditorSDK.UI
 */
module.exports = __webpack_require__(4);
__webpack_require__(234);

/***/ }),
/* 40 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var $at = __webpack_require__(157)(true);

// 21.1.3.27 String.prototype[@@iterator]()
__webpack_require__(96)(String, 'String', function (iterated) {
  this._t = String(iterated); // target
  this._i = 0;                // next index
// 21.1.5.2.1 %StringIteratorPrototype%.next()
}, function () {
  var O = this._t;
  var index = this._i;
  var point;
  if (index >= O.length) return { value: undefined, done: true };
  point = $at(O, index);
  this._i += point.length;
  return { value: point, done: false };
});


/***/ }),
/* 41 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_is_iterable__ = __webpack_require__(106);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_is_iterable___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_is_iterable__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_get_iterator__ = __webpack_require__(107);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_get_iterator___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_get_iterator__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_define_property__);




var _slicedToArray = function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_get_iterator___default()(arr), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i["return"]) _i["return"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_is_iterable___default()(Object(arr))) { return sliceIterator(arr, i); } else { throw new TypeError("Invalid attempt to destructure non-iterable instance"); } }; }();

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */

/**
 * Represents a color
 * @class
 * @memberof PhotoEditorSDK
 */
var Color = function () {
  /**
   * Creates a color
   * @param  {Number} r
   * @param  {Number} g
   * @param  {Number} b
   * @param  {Number} [a = 1]
   */
  function Color(r, g, b) {
    var a = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 1.0;

    _classCallCheck(this, Color);

    this.r = r;
    this.g = g;
    this.b = b;
    this.a = a;
  }

  /**
   * Returns an rgba() representation of this color
   * @return {String}
   */


  _createClass(Color, [{
    key: 'toRGBA',
    value: function toRGBA() {
      var colors = [Math.round(this.r * 255), Math.round(this.g * 255), Math.round(this.b * 255), this.a.toFixed(2)];
      return 'rgba(' + colors.join(',') + ')';
    }

    /**
     * Sets this color's values to the given RGBA values
     * @param {Number} r
     * @param {Number} g
     * @param {Number} b
     * @param {Number} [a]
     * @return {PhotoEditorSDK.Color}
     */

  }, {
    key: 'set',
    value: function set(r, g, b) {
      var a = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : this.a;

      this.r = r;
      this.g = g;
      this.b = b;
      this.a = a;
      return this;
    }

    /**
     * Returns an array with 3 values (0...255)
     * @return {Number[]}
     */

  }, {
    key: 'toRGB',
    value: function toRGB() {
      return [Math.round(this.r * 255), Math.round(this.g * 255), Math.round(this.b * 255)];
    }

    /**
     * Returns a hex representation of this color
     * @return {String}
     */

  }, {
    key: 'toHex',
    value: function toHex() {
      var components = [this._componentToHex(Math.round(this.r * 255)), this._componentToHex(Math.round(this.g * 255)), this._componentToHex(Math.round(this.b * 255))];
      return '#' + components.join('');
    }

    /**
     * Returns an array with 4 values (0...1)
     * @return {Number[]}
     */

  }, {
    key: 'toGLColor',
    value: function toGLColor() {
      return [this.r, this.g, this.b, this.a];
    }

    /**
     * Returns an array with 4 values (0...1)
     * @return {Number[]}
     */

  }, {
    key: 'toArray',
    value: function toArray() {
      return this.toGLColor();
    }

    /**
     * Returns an array with 3 values (0...1)
     * @return {Number[]}
     */

  }, {
    key: 'toRGBGLColor',
    value: function toRGBGLColor() {
      return [this.r, this.g, this.b];
    }

    /**
     * Converts the RGB value to HSV
     * @return {Number[]}
     */

  }, {
    key: 'toHSV',
    value: function toHSV() {
      var max = Math.max(this.r, this.g, this.b);
      var min = Math.min(this.r, this.g, this.b);
      var h = void 0;
      var s = void 0;
      var v = max;
      var d = max - min;
      s = max === 0 ? 0 : d / max;

      if (max === min) {
        h = 0; // achromatic
      } else {
        switch (max) {
          case this.r:
            h = (this.g - this.b) / d;
            if (this.g < this.b) {
              h += 6;
            }
            break;
          case this.g:
            h = (this.b - this.r) / d + 2;
            break;
          case this.b:
            h = (this.r - this.g) / d + 4;
            break;
        }
        h /= 6;
      }

      return [h, s, v];
    }

    /**
     * Sets the RGB values according to the given HSV values
     * @param  {Number} h
     * @param  {Number} s
     * @param  {Number} v
     */

  }, {
    key: 'fromHSV',
    value: function fromHSV(h, s, v) {
      this.copy(Color.fromHSV(h, s, v));
      return this;
    }

    /**
     * Creates an RGBA color from the given HSV and alpha values
     * @param {Number} h
     * @param {Number} s
     * @param {Number} v
     * @param {Number} [a = 1]
     */

  }, {
    key: 'clone',


    /**
     * Returns a clone of the current color
     * @return {PhotoEditorSDK.Color}
     */
    value: function clone() {
      return new Color(this.r, this.g, this.b, this.a);
    }

    /**
     * Adds another color
     * @param {PhotoEditorSDK.Color} color
     * @return {PhotoEditorSDK.Color}
     */

  }, {
    key: 'add',
    value: function add(color) {
      this.r += color.r;
      this.g += color.g;
      this.b += color.b;
      this.a += color.a;
      return this;
    }

    /**
     * Subtract another color
     * @param {PhotoEditorSDK.Color} color
     * @return {PhotoEditorSDK.Color}
     */

  }, {
    key: 'minus',
    value: function minus(color) {
      this.r -= color.r;
      this.g -= color.g;
      this.b -= color.b;
      this.a -= color.a;
      return this;
    }

    /**
     * Multiply with a scalar
     * @param {Number} val
     * @return {PhotoEditorSDK.Color}
     */

  }, {
    key: 'multiplyScalar',
    value: function multiplyScalar(val) {
      this.r *= val;
      this.g *= val;
      this.b *= val;
      this.a *= val;
      return this;
    }

    /**
     * Divide with a scalar
     * @param {Number} val
     * @return {PhotoEditorSDK.Color}
     */

  }, {
    key: 'divideScalar',
    value: function divideScalar(val) {
      this.r /= val;
      this.g /= val;
      this.b /= val;
      this.a /= val;
      return this;
    }

    /**
     * clamp
     * @param {Number} minVal
     * @param {Number} maxVal
     * @return {PhotoEditorSDK.Color}
     */

  }, {
    key: 'clamp',
    value: function clamp(minVal, maxVal) {
      this.r = Math.min(Math.max(this.r, minVal), maxVal);
      this.g = Math.min(Math.max(this.g, minVal), maxVal);
      this.b = Math.min(Math.max(this.b, minVal), maxVal);
      this.a = Math.min(Math.max(this.a, minVal), maxVal);
      return this;
    }

    /**
     * Copies the values from the given color
     * @param  {PhotoEditorSDK.Color} color
     * @return {PhotoEditorSDK.Color}
     */

  }, {
    key: 'copy',
    value: function copy(color) {
      this.r = color.r;
      this.g = color.g;
      this.b = color.b;
      this.a = color.a;
      return this;
    }

    /**
     * Checks if this color equals the given one
     * @param  {PhotoEditorSDK.Color} color
     * @return {Boolean}
     */

  }, {
    key: 'equals',
    value: function equals(color) {
      return this.r === color.r && this.g === color.g && this.b === color.b && this.a === color.a;
    }

    /**
     * Returns the given number as hex
     * @param  {Number} component
     * @return {String}
     * @private
     */

  }, {
    key: '_componentToHex',
    value: function _componentToHex(component) {
      var hex = component.toString(16);
      return hex.length === 1 ? '0' + hex : hex;
    }

    /**
     * Returns the string representation of this color
     * @returns {String}
     */

  }, {
    key: 'toString',
    value: function toString() {
      return 'Color(' + this.r + ', ' + this.g + ', ' + this.b + ', ' + this.a + ')';
    }

    /**
     * @type {PhotoEditorSDK.Color}
     */

  }], [{
    key: 'fromHSV',
    value: function fromHSV(h, s, v) {
      var a = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 1;
      var _ref = [],
          r = _ref[0],
          g = _ref[1],
          b = _ref[2];


      var i = Math.floor(h * 6);
      var f = h * 6 - i;
      var p = v * (1 - s);
      var q = v * (1 - f * s);
      var t = v * (1 - (1 - f) * s);

      switch (i % 6) {
        case 0:
          r = v;
          g = t;
          b = p;
          break;
        case 1:
          r = q;
          g = v;
          b = p;
          break;
        case 2:
          r = p;
          g = v;
          b = t;
          break;
        case 3:
          r = p;
          g = q;
          b = v;
          break;
        case 4:
          r = t;
          g = p;
          b = v;
          break;
        case 5:
          r = v;
          g = p;
          b = q;
          break;
      }

      return new Color(r, g, b, a);
    }

    /**
     * Creates a new Color object from the given array of numbers
     * @param  {Number[]} arr
     * @return {PhotoEditorSDK.Color}
     */

  }, {
    key: 'fromArray',
    value: function fromArray(arr) {
      return new Color(arr[0], arr[1], arr[2], arr[3]);
    }

    /**
     * Creates a new color object from the given hex string
     * @param  {String} hex
     * @return {PhotoEditorSDK.Color}
     */

  }, {
    key: 'fromHex',
    value: function fromHex(hex) {
      var _hex$match = hex.match(/.{1,2}/g),
          _hex$match2 = _slicedToArray(_hex$match, 3),
          r = _hex$match2[0],
          g = _hex$match2[1],
          b = _hex$match2[2];

      return new Color(parseInt(r, 16) / 255, parseInt(g, 16) / 255, parseInt(b, 16) / 255, 1.0);
    }
  }, {
    key: 'TRANSPARENT',
    get: function get() {
      return new Color(0, 0, 0, 0);
    }

    /**
     * @type {PhotoEditorSDK.Color}
     */

  }, {
    key: 'WHITE',
    get: function get() {
      return new Color(1, 1, 1, 1);
    }

    /**
     * @type {PhotoEditorSDK.Color}
     */

  }, {
    key: 'BLACK',
    get: function get() {
      return new Color(0, 0, 0, 1);
    }
  }]);

  return Color;
}();

/* harmony default export */ __webpack_exports__["a"] = (Color);

/***/ }),
/* 42 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__shared_log__ = __webpack_require__(17);


var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/**
 * EventEmitter (ES6) from:
 * https://gist.github.com/bloodyowl/41b1de3388c626796eca
 */


var DEFAULT_MAX_LISTENERS = 12;

/**
 * Receives and emits events
 * @class
 * @memberof PhotoEditorSDK
 */

var EventEmitter = function () {
  /**
   * Creates an EventEmitter
   */
  function EventEmitter() {
    _classCallCheck(this, EventEmitter);

    this._maxListeners = DEFAULT_MAX_LISTENERS;
    this._events = {};
    this._pipeDestinations = [];
  }

  /**
   * Pipes all events to the given EventEmitter
   * @param  {EventEmitter} destination
   */


  _createClass(EventEmitter, [{
    key: 'pipeEvents',
    value: function pipeEvents(destination) {
      this._pipeDestinations.push(destination);
    }

    /**
     * Stops piping events to the given EventEmitter
     * @param  {EventEmitter} destination
     */

  }, {
    key: 'unpipeEvents',
    value: function unpipeEvents(destination) {
      var i = this._pipeDestinations.indexOf(destination);
      if (i === -1) {
        return;
      }
      this._pipeDestinations.splice(i, 1);
    }

    /**
     * Adds the given listener to the given type of events
     * @param  {String} type
     * @param  {Function} listener
     */

  }, {
    key: 'on',
    value: function on(type, listener) {
      if (typeof type === 'undefined') {
        throw new Error('Invalid event type: `' + type + '`');
      }

      if (typeof listener !== 'function') {
        throw new TypeError();
      }

      var listeners = this._events[type] || (this._events[type] = []);
      if (listeners.indexOf(listener) !== -1) {
        return this;
      }
      listeners.push(listener);

      if (this._maxListeners && listeners.length > this._maxListeners) {
        __WEBPACK_IMPORTED_MODULE_1__shared_log__["a" /* default */].warn('EventEmitter', 'Possible memory leak detected, added ' + listeners.length + ' `' + type + '` listeners (current limit is ' + this._maxListeners + ')');
        if (typeof console !== 'undefined') {
          console.trace();
        }
      }
      return this;
    }

    /**
     * Adds the given listener to the given type of events and removes it
     * once it has been triggered
     * @param  {String} type
     * @param  {Function} listener
     */

  }, {
    key: 'once',
    value: function once(type, listener) {
      if (typeof type === 'undefined') {
        throw new Error('Invalid event type: `' + type + '`');
      }

      var eventsInstance = this;
      function onceCallback() {
        eventsInstance.off(type, onceCallback);
        listener.apply(null, arguments);
      }
      return this.on(type, onceCallback);
    }

    /**
     * Removes the given listener from the given type of events
     * @param  {String} type
     * @param  {*} ...args
     */

  }, {
    key: 'off',
    value: function off(type) {
      if (typeof type === 'undefined') {
        throw new Error('Invalid event type: `' + type + '`');
      }

      if ((arguments.length <= 1 ? 0 : arguments.length - 1) === 0) {
        this._events[type] = null;
        return this;
      }

      var listener = arguments.length <= 1 ? undefined : arguments[1];
      if (typeof listener !== 'function') {
        throw new TypeError();
      }

      var listeners = this._events[type];
      if (!listeners || !listeners.length) {
        return this;
      }

      var indexOfListener = listeners.indexOf(listener);
      if (indexOfListener === -1) {
        return this;
      }

      listeners.splice(indexOfListener, 1);
      return this;
    }

    /**
     * Emits an event with the given type and arguments
     * @param  {String} type
     * @param  {*} ...args
     */

  }, {
    key: 'emit',
    value: function emit(type) {
      for (var _len = arguments.length, args = Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
        args[_key - 1] = arguments[_key];
      }

      if (typeof type === 'undefined') {
        throw new Error('Invalid event type: `' + type + '`');
      }

      this._pipeDestinations.forEach(function (dest) {
        dest.emit.apply(dest, [type].concat(args));
      });

      var listeners = this._events[type];
      if (!listeners || !listeners.length) {
        return false;
      }

      listeners.slice(0).forEach(function (fn) {
        return fn.apply(null, args);
      });

      return true;
    }

    /**
     * Sets the maximum amonut of listeners before a warning is printed
     * @param {Number} newMaxListeners
     */

  }, {
    key: 'setMaxListeners',
    value: function setMaxListeners(newMaxListeners) {
      if (parseInt(newMaxListeners, 10) !== newMaxListeners) {
        throw new TypeError();
      }

      this._maxListeners = newMaxListeners;
    }
  }]);

  return EventEmitter;
}();

/* harmony default export */ __webpack_exports__["a"] = (EventEmitter);

/***/ }),
/* 43 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/*
 * Extracted from MinifyJpeg (Copyright (c) 2014 Hiroaki Matoba, MIT License):
 * https://github.com/hMatoba/MinifyJpeg
 * @license
 */

var KEY_STR = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=';

/**
 * Provides Base64 encode and decode methods
 * @type {Object}
 * @ignore
 */
/* istanbul ignore next */
var Base64 = {
  /**
   * Encodes the given input into a Base64 string
   * @param  {String} input
   * @return {String}
   */
  encode: function encode(input) {
    var output = '';
    var chr1 = void 0,
        chr2 = void 0,
        chr3 = void 0;
    var enc1 = void 0,
        enc2 = void 0,
        enc3 = void 0,
        enc4 = void 0;
    var i = 0;

    do {
      chr1 = input[i++];
      chr2 = input[i++];
      chr3 = input[i++];

      enc1 = chr1 >> 2;
      enc2 = (chr1 & 3) << 4 | chr2 >> 4;
      enc3 = (chr2 & 15) << 2 | chr3 >> 6;
      enc4 = chr3 & 63;

      if (isNaN(chr2)) {
        enc3 = enc4 = 64;
      } else if (isNaN(chr3)) {
        enc4 = 64;
      }

      output = output + KEY_STR.charAt(enc1) + KEY_STR.charAt(enc2) + KEY_STR.charAt(enc3) + KEY_STR.charAt(enc4);
      chr1 = chr2 = chr3 = '';
      enc1 = enc2 = enc3 = enc4 = '';
    } while (i < input.length);

    return output;
  },


  /**
   * Decodes the given Base64 string
   * @param  {String} input
   * @return {String}
   */
  decode: function decode(input) {
    var chr1 = void 0,
        chr2 = void 0,
        chr3 = void 0;
    var enc1 = void 0,
        enc2 = void 0,
        enc3 = void 0,
        enc4 = void 0;
    var i = 0;
    var buf = [];

    // remove all characters that are not A-Z, a-z, 0-9, +, /, or =
    var base64test = /[^A-Za-z0-9+/=]/g;
    if (base64test.exec(input)) {
      throw new Error('There were invalid base64 characters in the input text.\n' + 'Valid base64 characters are A-Z, a-z, 0-9, \'+\', \'/\',and \'=\'\n' + 'Expect errors in decoding.');
    }
    input = input.replace(/[^A-Za-z0-9+/=]/g, '');

    do {
      enc1 = KEY_STR.indexOf(input.charAt(i++));
      enc2 = KEY_STR.indexOf(input.charAt(i++));
      enc3 = KEY_STR.indexOf(input.charAt(i++));
      enc4 = KEY_STR.indexOf(input.charAt(i++));

      chr1 = enc1 << 2 | enc2 >> 4;
      chr2 = (enc2 & 15) << 4 | enc3 >> 2;
      chr3 = (enc3 & 3) << 6 | enc4;

      buf.push(chr1);

      if (enc3 !== 64) {
        buf.push(chr2);
      }
      if (enc4 !== 64) {
        buf.push(chr3);
      }

      chr1 = chr2 = chr3 = '';
      enc1 = enc2 = enc3 = enc4 = '';
    } while (i < input.length);

    return buf;
  }
};

/* harmony default export */ __webpack_exports__["a"] = (Base64);

/***/ }),
/* 44 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__globals__ = __webpack_require__(8);





var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */



/**
 * A BaseTexture holds and handles the raw source of a texture
 * @class
 * @extends EventEmitter
 * @memberof PhotoEditorSDK.Engine
 */

var BaseTexture = function (_EventEmitter) {
  _inherits(BaseTexture, _EventEmitter);

  /**
   * Creates a BaseTexture
   * @param  {*} source
   */
  function BaseTexture(source) {
    _classCallCheck(this, BaseTexture);

    var _this = _possibleConstructorReturn(this, (BaseTexture.__proto__ || __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default()(BaseTexture)).call(this));

    _this.id = BaseTexture.id++;
    _this._onSourceLoaded = _this._onSourceLoaded.bind(_this);

    _this._renderers = [];
    _this._glTextures = {};
    _this._source = source;
    _this._dirty = true;

    _this._glUnit = 0;
    _this._mipMapping = false;
    _this._magFilter = BaseTexture.DefaultMagFilter;
    _this._minFilter = BaseTexture.DefaultMinFilter;
    _this._repeatX = BaseTexture.ClampToEdge;
    _this._repeatY = BaseTexture.ClampToEdge;

    _this._pixelRatio = 1;
    _this._loaded = false;
    _this._frame = new __WEBPACK_IMPORTED_MODULE_4__globals__["h" /* Rectangle */](0, 0, 100, 100);

    if (source) {
      _this._loadSource();
    }
    return _this;
  }

  /**
   * Resizes this BaseTexture to the given dimensions
   * @param  {PhotoEditorSDK.Math.Vector2} dimensions
   */


  _createClass(BaseTexture, [{
    key: 'resizeTo',
    value: function resizeTo(dimensions) {
      if (this._frame.width === dimensions.x && this._frame.height === dimensions.y) {
        return;
      }

      this._frame.width = dimensions.x;
      this._frame.height = dimensions.y;
      this._dirty = true;
    }

    /**
     * Loads the source
     * @private
     */

  }, {
    key: '_loadSource',
    value: function _loadSource() {
      var source = this._source;

      var sourceLoaded = source.complete;
      var sourceIsCanvas = source.constructor.name === 'Canvas' || source.tagName && source.tagName.toUpperCase() === 'CANVAS';
      if (sourceLoaded || sourceIsCanvas) {
        return this._onSourceLoaded();
      }

      source.addEventListener('load', this._onSourceLoaded);
    }

    /**
     * Gets called when the source of this BaseTexture has been loaded
     * @private
     */

  }, {
    key: '_onSourceLoaded',
    value: function _onSourceLoaded() {
      this._loaded = true;
      this.emit('loaded');
      this.update();
    }

    /**
     * If mip-mapping is available, update GL filters accordingly
     * @private
     */
    /* istanbul ignore next */

  }, {
    key: '_updateGLFilters',
    value: function _updateGLFilters() {
      var sourceDimensions = new __WEBPACK_IMPORTED_MODULE_4__globals__["k" /* Vector2 */](this._source.width, this._source.height);
      if (__WEBPACK_IMPORTED_MODULE_4__globals__["i" /* Utils */].isPowerOfTwo(sourceDimensions)) {
        __WEBPACK_IMPORTED_MODULE_4__globals__["f" /* Log */].info(this.constructor.name, 'Mip-mapping enabled');
        this._minFilter = BaseTexture.TrilinearFilter;
        this._mipMapping = true;
      } else {
        this._minFilter = BaseTexture.LinearFilter;
        this._mipMapping = false;
      }
    }

    /**
     * Updates the cached dimensions of this BaseTexture's source
     */

  }, {
    key: 'update',
    value: function update() {
      if (this._frame.width !== this._source.width || this._frame.height !== this._source.height) {
        this._frame = new __WEBPACK_IMPORTED_MODULE_4__globals__["h" /* Rectangle */](0, 0, this._source.width, this._source.height);
        this._dirty = true;
      }

      this._updateGLFilters();
      this.emit('update');
    }

    /**
     * Returns the filter for the given direction from the given WebGL context
     * @param  {WebGLRenderingContext} gl
     * @param  {String} minOrMag
     * @return {Number}
     */
    /* istanbul ignore next */

  }, {
    key: 'getGLFilter',
    value: function getGLFilter(gl, minOrMag) {
      switch (minOrMag) {
        case 'min':
          return this.constructor.getGLFilter(gl, this._minFilter);
        case 'mag':
          return this.constructor.getGLFilter(gl, this._magFilter);
      }
    }

    /**
     * Returns the filter for the given enum value from the given WebGL context
     * @param  {WebGLRenderingContext} gl
     * @param  {Number} filterEnum
     * @return {Number}
     */
    /* istanbul ignore next */

  }, {
    key: 'isLoaded',


    /**
     * Checks if this BaseTexture has been loaded
     * @return {Boolean}
     */
    value: function isLoaded() {
      return this._loaded;
    }

    /**
     * Sets the loaded state
     * @param {Boolean} loaded
     */

  }, {
    key: 'setLoaded',
    value: function setLoaded(loaded) {
      this._loaded = loaded;
    }

    /**
     * Returns the source
     * @return {*} s
     */

  }, {
    key: 'getSource',
    value: function getSource() {
      return this._source;
    }

    /**
     * Sets the source
     * @param {*} source
     */

  }, {
    key: 'setSource',
    value: function setSource(source) {
      this._source = source;
    }

    /**
     * Returns the WebGL texture for the given renderer ID
     * @param  {PhotoEditorSDK.Engine.Renderer} renderer
     * @return {WebGLTexture}
     */
    /* istanbul ignore next */

  }, {
    key: 'getGLTextureForRenderer',
    value: function getGLTextureForRenderer(renderer) {
      return this._glTextures[renderer.id];
    }

    /**
     * Sets the WebGLTexture for the given renderer ID
     * @param {WebGLTexture} texture
     * @param {PhotoEditorSDK.Engine.WebGLRenderer} renderer
     */
    /* istanbul ignore next */

  }, {
    key: 'setGLTextureForRenderer',
    value: function setGLTextureForRenderer(texture, renderer) {
      this._renderers[renderer.id] = renderer;
      this._glTextures[renderer.id] = texture;
    }

    /**
     * Returns the frame
     * @return {PhotoEditorSDK.Math.Rectangle}
     */

  }, {
    key: 'getFrame',
    value: function getFrame() {
      return this._frame;
    }

    /**
     * Sets the frame
     * @param {PhotoEditorSDK.Math.Rectangle} frame
     */

  }, {
    key: 'setFrame',
    value: function setFrame(frame) {
      this._frame = frame;
    }

    /**
     * Returns the dimensions
     * @return {PhotoEditorSDK.Math.Vector2}
     */

  }, {
    key: 'getDimensions',
    value: function getDimensions() {
      return new __WEBPACK_IMPORTED_MODULE_4__globals__["k" /* Vector2 */](this._frame.width, this._frame.height);
    }

    /**
     * Returns the pixel ratio
     * @return {Number}
     */

  }, {
    key: 'getPixelRatio',
    value: function getPixelRatio() {
      return this._pixelRatio;
    }

    /**
     * Sets the pixel ratio
     * @param {Number} pixelRatio
     */

  }, {
    key: 'setPixelRatio',
    value: function setPixelRatio(pixelRatio) {
      this._pixelRatio = pixelRatio;
    }

    /**
     * Returns the WebGL texture unit
     * @return {Number}
     */
    /* istanbul ignore next */

  }, {
    key: 'getGLUnit',
    value: function getGLUnit() {
      return this._glUnit;
    }

    /**
     * Sets the WebGL texture unit
     * @param {Number} glUnit
     */
    /* istanbul ignore next */

  }, {
    key: 'setGLUnit',
    value: function setGLUnit(glUnit) {
      this._glUnit = glUnit;
    }

    /**
     * Sets the min filter to the given one
     * @param {Number} minFilter
     */
    /* istanbul ignore next */

  }, {
    key: 'setMinFilter',
    value: function setMinFilter(minFilter) {
      this._minFilter = minFilter;
    }

    /**
     * Returns this texture's min filter
     * @return {Number}
     */
    /* istanbul ignore next */

  }, {
    key: 'getMinFilter',
    value: function getMinFilter() {
      return this._minFilter;
    }

    /**
     * Sets the mag filter to the given one
     * @param {Number} magFilter
     */
    /* istanbul ignore next */

  }, {
    key: 'setMagFilter',
    value: function setMagFilter(magFilter) {
      this._magFilter = magFilter;
    }

    /**
     * Returns this texture's mag filter
     * @return {Number}
     */
    /* istanbul ignore next */

  }, {
    key: 'getMagFilter',
    value: function getMagFilter() {
      return this._magFilter;
    }

    /**
     * Sets the way the texture is repeated on the X axis
     * @param {Number} repeat
     */

  }, {
    key: 'setRepeatX',
    value: function setRepeatX(repeat) {
      this._repeatX = repeat;
    }

    /**
     * Returns the way the texture is repeated on the X axis
     * @return {Number}
     */

  }, {
    key: 'getRepeatX',
    value: function getRepeatX() {
      return this._repeatX;
    }

    /**
     * Sets the way the texture is repeated on the Y axis
     * @param {Number} repeat
     */

  }, {
    key: 'setRepeatY',
    value: function setRepeatY(repeat) {
      this._repeatY = repeat;
    }

    /**
     * Returns the way the texture is repeated on the Y axis
     * @return {Number}
     */

  }, {
    key: 'getRepeatY',
    value: function getRepeatY() {
      return this._repeatY;
    }

    /**
     * Returns the correct ENUM value for the given repeat direction
     * @param  {WebGLRenderingContext} gl
     * @param  {String} direction
     * @return {Number}
     */

  }, {
    key: 'getGLRepeat',
    value: function getGLRepeat(gl, direction) {
      var value = direction === 'x' ? this.getRepeatX() : this.getRepeatY();
      switch (value) {
        case BaseTexture.ClampToEdge:
          return gl.CLAMP_TO_EDGE;
        case BaseTexture.Repeat:
          return gl.REPEAT;
        case BaseTexture.MirroredRepeat:
          return gl.MIRRORED_REPEAT;
      }
    }

    /**
     * Checks if this base texture needs to be updated
     * @return {Boolean}
     */
    /* istanbul ignore next */

  }, {
    key: 'isDirty',
    value: function isDirty() {
      return this._dirty;
    }

    /**
     * Sets the dirtiness of this base texture
     * @param {Boolean} dirty
     */
    /* istanbul ignore next */

  }, {
    key: 'setDirty',
    value: function setDirty(dirty) {
      this._dirty = dirty;
    }

    /**
     * Disposes the WebGL textures for all renderers
     */
    /* istanbul ignore next */

  }, {
    key: 'disposeGLTextures',
    value: function disposeGLTextures() {
      for (var rendererId in this._renderers) {
        this.disposeGLTexturesForRenderer(this._renderers[rendererId]);
      }
    }

    /**
     * Disposes the WebGL textures for the given renderer
     * @param {PhotoEditorSDK.Engine.WebGLRenderer} renderer
     */
    /* istanbul ignore next */

  }, {
    key: 'disposeGLTexturesForRenderer',
    value: function disposeGLTexturesForRenderer(renderer) {
      if (!this._glTextures[renderer.id]) return;

      var gl = renderer.getContext();
      gl.deleteTexture(this._glTextures[renderer.id]);
      delete this._glTextures[renderer.id];

      if (!this._renderers[renderer.id]) {
        delete this._renderers[renderer.id];
      }
    }

    /**
     * Checks if mip-mapping is enabled for this texture
     * @return {Boolean}
     */

  }, {
    key: 'isMipMappingEnabled',
    value: function isMipMappingEnabled() {
      return this._mipMapping;
    }

    /**
     * Sets the state for mip mapping
     * @param {Boolean} enabled
     */

  }, {
    key: 'setMipMappingEnabled',
    value: function setMipMappingEnabled(enabled) {
      this._mipMapping = enabled;
    }

    /**
     * Cleans up this object
     * @param  {PhotoEditorSDK.Engine.WebGLRenderer} renderer
     */

  }, {
    key: 'dispose',
    value: function dispose() {
      var renderer = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;

      this.disposeGLTextures();
    }
  }], [{
    key: 'getGLFilter',
    value: function getGLFilter(gl, filterEnum) {
      switch (filterEnum) {
        case BaseTexture.LinearFilter:
          return gl.LINEAR;
        case BaseTexture.NearestFilter:
          return gl.NEAREST;
        case BaseTexture.BilinearFilter:
          return gl.LINEAR_MIPMAP_NEAREST;
        case BaseTexture.TrilinearFilter:
          return gl.LINEAR_MIPMAP_LINEAR;
      }
    }
  }]);

  return BaseTexture;
}(__WEBPACK_IMPORTED_MODULE_4__globals__["d" /* EventEmitter */]);

BaseTexture.NearestFilter = 0;
BaseTexture.LinearFilter = 1;
BaseTexture.BilinearFilter = 2;
BaseTexture.TrilinearFilter = 3;

BaseTexture.DefaultMagFilter = BaseTexture.NearestFilter;
BaseTexture.DefaultMinFilter = BaseTexture.LinearFilter;

BaseTexture.ClampToEdge = 0;
BaseTexture.Repeat = 1;
BaseTexture.MirroredRepeat = 2;

BaseTexture.id = 0;

/* harmony default export */ __webpack_exports__["a"] = (BaseTexture);

/***/ }),
/* 45 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor__ = __webpack_require__(7);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__globals__ = __webpack_require__(8);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__lib_configurable__ = __webpack_require__(46);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__shaders_shader__ = __webpack_require__(83);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__shaders_texture_shader__ = __webpack_require__(82);






var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor___default()(object, property); if (desc === undefined) { var parent = __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if ("value" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */





var OptionType = __WEBPACK_IMPORTED_MODULE_5__globals__["c" /* Constants */].OptionType,
    UniformType = __WEBPACK_IMPORTED_MODULE_5__globals__["c" /* Constants */].UniformType,
    RendererType = __WEBPACK_IMPORTED_MODULE_5__globals__["c" /* Constants */].RendererType;

/**
 * A filter can be attached to a DisplayObject and affects the way it is displayed.
 * @class
 * @extends PhotoEditorSDK.Configurable
 * @memberof PhotoEditorSDK.Engine
 */

var Filter = function (_Configurable) {
  _inherits(Filter, _Configurable);

  function Filter() {
    _classCallCheck(this, Filter);

    return _possibleConstructorReturn(this, (Filter.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(Filter)).apply(this, arguments));
  }

  _createClass(Filter, [{
    key: '_initOptions',

    /**
     * Goes through the available options, sets _options defaults
     * @param {Object} userOptions
     * @override
     * @protected
     */
    value: function _initOptions() {
      var userOptions = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};

      this._shaders = [];
      this._availableUniforms = __WEBPACK_IMPORTED_MODULE_8__shaders_texture_shader__["a" /* default */].defaultUniforms;
      this._attributes = __WEBPACK_IMPORTED_MODULE_8__shaders_texture_shader__["a" /* default */].defaultAttributes;
      this._vertexSource = __WEBPACK_IMPORTED_MODULE_8__shaders_texture_shader__["a" /* default */].defaultVertexSource;
      this._fragmentSource = __WEBPACK_IMPORTED_MODULE_8__shaders_texture_shader__["a" /* default */].defaultFragmentSource;

      this._initUniforms();
      _get(Filter.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(Filter.prototype), '_initOptions', this).call(this, userOptions);
    }

    /**
     * Initializes the uniforms
     * @private
     */

  }, {
    key: '_initUniforms',
    value: function _initUniforms() {
      this._uniforms = {};
      for (var name in this._availableUniforms) {
        var uniform = this._availableUniforms[name];
        this._uniforms[name] = {
          type: uniform.type,
          value: uniform.default || null
        };
      }

      // Options are also turned into uniforms
      for (var optionName in this.availableOptions) {
        var optionConfig = this.availableOptions[optionName];

        if (!optionConfig.uniformType) {
          __WEBPACK_IMPORTED_MODULE_5__globals__["f" /* Log */].trace(this.constructor.name, 'Option `' + optionName + '` is missing a `uniformType`!');
        } else {
          this._uniforms['u_' + optionName] = {
            type: optionConfig.uniformType,
            value: optionConfig.default || null
          };
        }
      }
    }

    /**
     * Sets the value for the given option, validates it
     * @param {String} optionName
     * @param {*} value
     * @param {Boolean} update = true
     * @override
     */

  }, {
    key: 'setOption',
    value: function setOption(optionName, value) {
      var update = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;

      _get(Filter.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(Filter.prototype), 'setOption', this).call(this, optionName, value, update);

      var uniformValue = value;
      var optionConfig = this.availableOptions[optionName];

      if (!optionConfig.uniformType) {
        return;
      }

      var uniformName = 'u_' + optionName;

      switch (optionConfig.type) {
        case OptionType.COLOR:
          if (optionConfig.uniformType === UniformType.FLOAT4) {
            uniformValue = value.toGLColor();
          } else if (optionConfig.uniformType === UniformType.FLOAT3) {
            uniformValue = value.toRGBGLColor();
          }
          break;
        case OptionType.VECTOR2:
          uniformValue = [value.x, value.y];
          break;
        case OptionType.COLOR_MATRIX:
          // a color matrix splits into 4x4 matrix and tranlation vector
          uniformValue = [value.a, value.b, value.c, value.d, value.f, value.g, value.h, value.i, value.k, value.l, value.m, value.n, value.p, value.q, value.r, value.s];
          var vectorValue = [value.e, value.j, value.o, value.t];
          this._uniforms[uniformName + '_vec'] = {
            value: vectorValue,
            type: UniformType.FLOAT4
          };
      }

      this.setUniform(uniformName, uniformValue);
    }

    /**
     * Sets the given uniform to the given value
     * @param {String} name
     * @param {*} value
     * @param {Boolean} sync = false
     */

  }, {
    key: 'setUniform',
    value: function setUniform(name, value) {
      var sync = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;

      this._uniforms[name].value = value;
    }

    /**
     * Sets the given uniforms to their values
     * @param {Object}  uniforms
     * @param {Boolean} sync = false
     */
    /* istanbul ignore next */

  }, {
    key: 'setUniforms',
    value: function setUniforms(uniforms) {
      var sync = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;

      for (var name in uniforms) {
        this._uniforms[name].value = uniforms[name];
        if (sync) {
          this.syncUniform(name);
        }
      }
    }

    /**
     * Synchronizes the uniform with the given name
     * @param  {String} name
     */
    /* istanbul ignore next */

  }, {
    key: 'syncUniform',
    value: function syncUniform(name) {
      this._shaders.forEach(function (shader) {
        shader.syncUniform(name);
      });
    }

    /**
     * Synchronizes all uniforms with WebGL
     */
    /* istanbul ignore next */

  }, {
    key: 'syncUniforms',
    value: function syncUniforms() {
      this._shaders.forEach(function (shader) {
        shader.syncUniforms();
      });
    }

    /**
     * Returns the shader for the given renderer
     * @param  {PhotoEditorSDK.Engine.WebGLRenderer} renderer
     * @return {PhotoEditorSDK.Engine.Shader}
     */
    /* istanbul ignore next */

  }, {
    key: 'getShaderForRenderer',
    value: function getShaderForRenderer(renderer) {
      var gl = renderer.getContext();
      var shader = this._shaders[gl.id];

      if (!shader) {
        shader = new __WEBPACK_IMPORTED_MODULE_7__shaders_shader__["a" /* default */](renderer, this._vertexSource, this._fragmentSource, this._uniforms, this._attributes);

        this._shaders[gl.id] = shader;
      }

      return shader;
    }

    /**
     * Applies this filter to the given inputTarget and renders it to
     * the given outputTarget
     * @param  {PhotoEditorSDK.Engine.BaseRenderer} renderer
     * @param  {PhotoEditorSDK.Engine.RenderTarget} inputTarget
     * @param  {PhotoEditorSDK.Engine.RenderTarget} outputTarget
     * @param  {Boolean} clear = false
     */

  }, {
    key: 'apply',
    value: function apply(renderer, inputTarget, outputTarget) {
      var clear = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;

      /* istanbul ignore if */
      if (renderer.isOfType(RendererType.WEBGL)) {
        this._applyWebGL(renderer, inputTarget, outputTarget, clear);
      } else if (renderer.isOfType(RendererType.CANVAS)) {
        this._applyCanvas(renderer, inputTarget, outputTarget, clear);
      }
    }

    /**
     * Applies this filter to the given inputTarget and renders it to
     * the given outputTarget using the WebGLRenderer
     * @param  {PhotoEditorSDK.Engine.WebGLRenderer} renderer
     * @param  {PhotoEditorSDK.Engine.WebGLRenderTarget} inputTarget
     * @param  {PhotoEditorSDK.Engine.WebGLRenderTarget} outputTarget
     * @param  {Boolean} clear = false
     * @private
     */
    /* istanbul ignore next */

  }, {
    key: '_applyWebGL',
    value: function _applyWebGL(renderer, inputTarget, outputTarget) {
      var clear = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;

      var gl = renderer.getContext();
      var shader = this.getShaderForRenderer(renderer);

      renderer.setRenderTarget(outputTarget);
      if (clear) {
        outputTarget.clear();
      }

      renderer.setShader(shader);

      var projectionMatrix = renderer.getCurrentRenderTarget().getProjectionMatrix().toArray();
      shader.setUniform('u_projMatrix', projectionMatrix);
      shader.syncUniforms();

      // Render!
      gl.activeTexture(gl.TEXTURE0);
      gl.bindTexture(gl.TEXTURE_2D, inputTarget.getTexture());
      gl.drawElements(gl.TRIANGLES, 6, gl.UNSIGNED_SHORT, 0);
    }

    /**
     * Applies this filter to the given inputTarget and renders it to
     * the given outputTarget using the CanvasRenderer
     * @param  {PhotoEditorSDK.Engine.CanvasRenderer} renderer
     * @param  {PhotoEditorSDK.Engine.RenderTarget} inputTarget
     * @param  {PhotoEditorSDK.Engine.RenderTarget} outputTarget
     * @param  {Boolean} clear = false
     * @private
     */

  }, {
    key: '_applyCanvas',
    value: function _applyCanvas(renderer, inputTarget, outputTarget) {
      var clear = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;

      var canvas = inputTarget.getCanvas();
      var outputContext = outputTarget.getContext();

      __WEBPACK_IMPORTED_MODULE_5__globals__["f" /* Log */].warn(this.constructor.name, '`_applyCanvas` is not implemented. Just copying image data from `inputTarget` to `outputTarget`.');

      outputContext.clearRect(0, 0, canvas.width, canvas.height);
      outputContext.drawImage(canvas, 0, 0);
    }

    /**
     * Disposes this Filter
     */

  }, {
    key: 'dispose',
    value: function dispose() {
      this._shaders.forEach(function (shader) {
        return shader.dispose();
      });
      this._shaders = [];
    }
  }]);

  return Filter;
}(__WEBPACK_IMPORTED_MODULE_6__lib_configurable__["a" /* default */]);

/* harmony default export */ __webpack_exports__["a"] = (Filter);

/***/ }),
/* 46 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_symbol_iterator__ = __webpack_require__(22);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_symbol_iterator___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_symbol_iterator__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_symbol__ = __webpack_require__(23);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_symbol___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_symbol__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_keys__ = __webpack_require__(56);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_keys___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_keys__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_6_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__shared_vendor_promise__ = __webpack_require__(29);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__shared_log_js__ = __webpack_require__(17);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9__event_emitter__ = __webpack_require__(42);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10__math_vector2__ = __webpack_require__(34);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_11__color__ = __webpack_require__(41);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_12__utils__ = __webpack_require__(24);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_13__math_color_matrix__ = __webpack_require__(118);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_14__constants__ = __webpack_require__(28);








var _typeof = typeof __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_symbol___default.a === "function" && typeof __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_symbol_iterator___default.a === "symbol" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_symbol___default.a === "function" && obj.constructor === __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_symbol___default.a && obj !== __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_symbol___default.a.prototype ? "symbol" : typeof obj; };

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _defineProperty(obj, key, value) { if (key in obj) { __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_define_property___default()(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* global HTMLImageElement, WEBPACK */
/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */

/* eslint-disable valid-typeof */










var Image = void 0;
Image = __webpack_require__(19).Image;

/**
 * Adds `set{OptionName}` and `get{OptionName}` methods to an object. Method names
 * are specified via the `availableOptions` object.
 * @class
 * @extends EventEmitter
 * @memberof PhotoEditorSDK
 */

var Configurable = function (_EventEmitter) {
  _inherits(Configurable, _EventEmitter);

  function Configurable() {
    var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};
    var additionalAvailableOptions = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};

    _classCallCheck(this, Configurable);

    var _this = _possibleConstructorReturn(this, (Configurable.__proto__ || __WEBPACK_IMPORTED_MODULE_6_babel_runtime_core_js_object_get_prototype_of___default()(Configurable)).call(this));

    _this.availableOptions = _this.availableOptions || {};
    _this.availableOptions = __WEBPACK_IMPORTED_MODULE_12__utils__["a" /* default */].extend(_this.availableOptions, additionalAvailableOptions);

    _this._onConfigurableUpdate = _this._onConfigurableUpdate.bind(_this);

    _this._initOptions(options);
    return _this;
  }

  /**
   * Builds an error message from the given string
   * @param  {String} message
   * @return {Error}
   * @private
   */


  _createClass(Configurable, [{
    key: '_buildConfigError',
    value: function _buildConfigError(message) {
      var errorMessage = '';
      if (this.constructor.name) {
        errorMessage = this.constructor.name + ': ';
      }
      errorMessage += message;
      return new Error(errorMessage);
    }

    /**
     * Gets called when options have been changed
     * @protected
     */

  }, {
    key: '_onOptionsChange',
    value: function _onOptionsChange() {}

    /**
     * Checks whether all required options are specified
     * @return {Promise}
     */

  }, {
    key: 'validateSettings',
    value: function validateSettings() {
      var _this2 = this;

      return new __WEBPACK_IMPORTED_MODULE_7__shared_vendor_promise__["a" /* default */](function (resolve, reject) {
        // Check for required options
        for (var optionName in _this2.availableOptions) {
          var optionConfig = _this2.availableOptions[optionName];
          if (optionConfig.required && typeof _this2._options[optionName] === 'undefined') {
            return reject(_this2._buildConfigError('Option `' + optionName + '` is required.'));
          }
        }

        resolve();
      });
    }

    /**
     * Goes through the available options, sets _options defaults
     * @param {Object} userOptions
     * @protected
     */

  }, {
    key: '_initOptions',
    value: function _initOptions() {
      var userOptions = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};

      this._options = {};

      // Set defaults, create getters and setters
      var optionName, option, capitalized;
      var self = this;
      for (optionName in this.availableOptions) {
        capitalized = optionName.charAt(0).toUpperCase() + optionName.slice(1);
        option = this.availableOptions[optionName];

        if ([__WEBPACK_IMPORTED_MODULE_14__constants__["OptionType"].STRING, __WEBPACK_IMPORTED_MODULE_14__constants__["OptionType"].NUMBER, __WEBPACK_IMPORTED_MODULE_14__constants__["OptionType"].BOOLEAN, __WEBPACK_IMPORTED_MODULE_14__constants__["OptionType"].OBJECT, __WEBPACK_IMPORTED_MODULE_14__constants__["OptionType"].VECTOR2, __WEBPACK_IMPORTED_MODULE_14__constants__["OptionType"].COLOR, __WEBPACK_IMPORTED_MODULE_14__constants__["OptionType"].CONFIGURABLE, __WEBPACK_IMPORTED_MODULE_14__constants__["OptionType"].COLOR_MATRIX, __WEBPACK_IMPORTED_MODULE_14__constants__["OptionType"].ARRAY, __WEBPACK_IMPORTED_MODULE_14__constants__["OptionType"].IMAGE, __WEBPACK_IMPORTED_MODULE_14__constants__["OptionType"].FUNCTION, __WEBPACK_IMPORTED_MODULE_14__constants__["OptionType"].ALL].indexOf(option.type) === -1) {
          throw this._buildConfigError('Unknown option type: `' + option.type + '`');
        }

        // Create setter and getter
        var fn = function fn(optionName, option) {
          self['set' + capitalized] = function (value, update, initial) {
            self.setOption(optionName, value, update, initial);
          };

          // Default getter
          self['get' + capitalized] = function () {
            return self.getOption(optionName);
          };
        };
        fn(optionName, option);

        // Handle configurable initialization
        if (option.type === __WEBPACK_IMPORTED_MODULE_14__constants__["OptionType"].CONFIGURABLE) {
          this._options[optionName] = new Configurable(undefined, option.structure || {});
          this._options[optionName].on('update', this._onConfigurableUpdate);
        }

        // Set default if available
        if (!(optionName in userOptions) || typeof userOptions[optionName] === 'undefined') {
          if (typeof option.default !== 'undefined') {
            var defaultValue = option.default;
            if (typeof option.default === 'function') {
              defaultValue = option.default();
            }
            this['set' + capitalized](defaultValue, false, true);
          } else if (option.type !== __WEBPACK_IMPORTED_MODULE_14__constants__["OptionType"].CONFIGURABLE) {
            this._options[optionName] = undefined;
          }
        }
      }

      // Overwrite options with the ones given by user
      for (optionName in userOptions) {
        // Check if option is available
        if (typeof this.availableOptions[optionName] === 'undefined') {
          throw new Error('Invalid option: ' + optionName);
        }

        if (typeof userOptions[optionName] !== 'undefined') {
          // Call setter
          capitalized = optionName.charAt(0).toUpperCase() + optionName.slice(1);
          this['set' + capitalized](userOptions[optionName], false, true);
        }
      }
    }

    /**
     * Sets the given options
     * @param {Object} options
     */

  }, {
    key: 'set',
    value: function set(options) {
      var emitUpdate = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;

      for (var optionName in options) {
        this.setOption(optionName, options[optionName], false);
      }
      this._onOptionsChange();

      if (emitUpdate) {
        this.emit('update', this, options);
      }
    }

    /**
     * Returns the value for the given option
     * @param {String} optionName
     * @return {*}
     */

  }, {
    key: 'getOption',
    value: function getOption(optionName) {
      return this._options[optionName];
    }

    /**
     * Checks if this configurable has an option with the given name
     * @param  {String}  optionName
     * @return {Boolean}
     */

  }, {
    key: 'hasOption',
    value: function hasOption(optionName) {
      return !!this.availableOptions[optionName];
    }

    /**
     * Returns the default value for the given option
     * @param  {String} optionName
     * @return {*}
     */

  }, {
    key: 'getOptionDefault',
    value: function getOptionDefault(optionName) {
      var option = this.availableOptions[optionName];
      if (!option) {
        throw new Error('Invalid option: ' + optionName);
      }
      return option.default;
    }

    /**
     * Resets the options of the configurable to the default
     * ones.
     */

  }, {
    key: 'resetOptions',
    value: function resetOptions() {
      this.set(this.getDefaultOptions());
    }

    /**
     * Returns a hash with the default options
     * @return {Object}
     */

  }, {
    key: 'getDefaultOptions',
    value: function getDefaultOptions() {
      var options = {};
      for (var optionName in this.availableOptions) {
        var defaultValue = this.availableOptions[optionName].default;
        if (typeof defaultValue === 'undefined') continue;

        options[optionName] = defaultValue;
      }
      return options;
    }

    /**
     * Check if the current options equal the given ones
     * @param  {Object} options
     * @return {Boolean}
     */

  }, {
    key: 'optionsEqual',
    value: function optionsEqual(options) {
      for (var optionName in options) {
        var value = options[optionName];
        if (!this._optionEquals(optionName, value)) {
          return false;
        }
      }
      return true;
    }

    /**
     * Checks if the given option has the given value
     * @param  {String} optionName
     * @param  {*} value
     * @return {Boolean}
     * @private
     */

  }, {
    key: '_optionEquals',
    value: function _optionEquals(optionName, value) {
      var option = this.availableOptions[optionName];
      if (typeof option === 'undefined') {
        throw new Error('Invalid option: ' + optionName);
      }

      var optionType = this.availableOptions[optionName].type;
      var currentValue = this._options[optionName];
      if (currentValue === value) return true;

      if (typeof value === 'undefined' || typeof currentValue === 'undefined') return false;

      switch (optionType) {
        case __WEBPACK_IMPORTED_MODULE_14__constants__["OptionType"].OBJECT:
          if (typeof currentValue.optionsEqual === 'function') {
            return currentValue.optionsEqual(value._options);
          } else {
            return currentValue === value;
          }
        case __WEBPACK_IMPORTED_MODULE_14__constants__["OptionType"].STRING:
        case __WEBPACK_IMPORTED_MODULE_14__constants__["OptionType"].NUMBER:
        case __WEBPACK_IMPORTED_MODULE_14__constants__["OptionType"].BOOLEAN:
        case __WEBPACK_IMPORTED_MODULE_14__constants__["OptionType"].FUNCTION:
        case '*':
          return currentValue === value;
        case __WEBPACK_IMPORTED_MODULE_14__constants__["OptionType"].VECTOR2:
          return currentValue.equals(value);
        case __WEBPACK_IMPORTED_MODULE_14__constants__["OptionType"].COLOR:
        case __WEBPACK_IMPORTED_MODULE_14__constants__["OptionType"].COLOR_MATRIX:
          return value.equals(currentValue);
        case __WEBPACK_IMPORTED_MODULE_14__constants__["OptionType"].CONFIGURABLE:
          return currentValue.optionsEqual(value);
        case __WEBPACK_IMPORTED_MODULE_14__constants__["OptionType"].ARRAY:
          return this._arrayOptionEquals(optionName, value);
        case __WEBPACK_IMPORTED_MODULE_14__constants__["OptionType"].IMAGE:
          return currentValue.src === value.src;
      }
    }

    /**
     * Checks if the given option of type `array` matches the given value
     * @param  {String} optionName
     * @param  {Array} arr
     * @return {Boolean}
     * @private
     */

  }, {
    key: '_arrayOptionEquals',
    value: function _arrayOptionEquals(optionName, arr) {
      var thisArr = this._options[optionName];

      if (arr.length !== thisArr.length) {
        return false;
      }

      var equal = true;
      for (var i = 0; i < thisArr.length; i++) {
        var thisValue = thisArr[i];
        var value = arr[i];
        if (thisValue instanceof Configurable) {
          if (typeof value === 'undefined' || !thisValue.optionsEqual(value)) {
            equal = false;
            break;
          }
        } else if (value !== thisValue) {
          equal = false;
          break;
        }
      }
      return equal;
    }

    /**
     * Returns a serialized version of this configurable
     * @param {Boolean} toObject = false
     * @return {Object}
     */

  }, {
    key: 'serializeOptions',
    value: function serializeOptions() {
      var _this3 = this;

      var keys = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_keys___default()(this._options);
      var toObject = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;

      var options = {};
      keys.forEach(function (key) {
        if (typeof _this3.availableOptions[key] === 'undefined') {
          return __WEBPACK_IMPORTED_MODULE_8__shared_log_js__["a" /* default */].warn('Trying to serialize a key that does not exist: ' + key);
        }
        if (_this3.availableOptions[key].serializable === false) return;
        options[key] = _this3.serializeOption(key, toObject);
      });
      return options;
    }

    /**
     * Returns a serialized version of the given option
     * @param {String} optionName
     * @param {Boolean} toObject = false
     * @return {*}
     */

  }, {
    key: 'serializeOption',
    value: function serializeOption(optionName) {
      var toObject = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;

      var option = this.availableOptions[optionName];
      var optionType = option.type;
      var value = this._options[optionName];
      if (!value) return value;
      if (option.serializable === false) {
        throw new Error('Option `' + optionName + '` is not serializable.');
      }

      switch (optionType) {
        case __WEBPACK_IMPORTED_MODULE_14__constants__["OptionType"].STRING:
        case __WEBPACK_IMPORTED_MODULE_14__constants__["OptionType"].NUMBER:
        case __WEBPACK_IMPORTED_MODULE_14__constants__["OptionType"].BOOLEAN:
        case __WEBPACK_IMPORTED_MODULE_14__constants__["OptionType"].OBJECT:
        case __WEBPACK_IMPORTED_MODULE_14__constants__["OptionType"].FUNCTION:
        case __WEBPACK_IMPORTED_MODULE_14__constants__["OptionType"].ALL:
          return value;
        case __WEBPACK_IMPORTED_MODULE_14__constants__["OptionType"].VECTOR2:
          return toObject ? value.toObject() : value.clone();
        case __WEBPACK_IMPORTED_MODULE_14__constants__["OptionType"].COLOR:
        case __WEBPACK_IMPORTED_MODULE_14__constants__["OptionType"].COLOR_MATRIX:
          return toObject ? value.toArray() : value.clone();
        case __WEBPACK_IMPORTED_MODULE_14__constants__["OptionType"].CONFIGURABLE:
          return value.serializeOptions(undefined, toObject);
        case __WEBPACK_IMPORTED_MODULE_14__constants__["OptionType"].ARRAY:
          return value.slice(0);
        case __WEBPACK_IMPORTED_MODULE_14__constants__["OptionType"].IMAGE:
          return toObject ? value.src : value;
      }
    }

    /**
     * Sets the value for the given option, validates it
     * @param {String} optionName
     * @param {*} value
     * @param {Boolean} [update = true] - Should an `update` event be emitted?
     * @param {Boolean} [initial = false] - Is this the first time this option is set?
     */

  }, {
    key: 'setOption',
    value: function setOption(optionName, value) {
      var update = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;
      var initial = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;

      var optionConfig = this.availableOptions[optionName];
      if (!optionConfig) {
        throw new Error('Invalid option: ' + optionName);
      }

      if (typeof optionConfig.setter !== 'undefined') {
        value = optionConfig.setter.call(this, value, initial);
      }

      if (typeof optionConfig.validation !== 'undefined') {
        optionConfig.validation(value);
      }

      if (value === null || typeof value === 'undefined') {
        if (optionConfig.required) {
          throw this._buildConfigError('Option `' + optionName + '` is required.');
        }
        this._options[optionName] = value;
      } else {
        switch (optionConfig.type) {
          // String options
          case __WEBPACK_IMPORTED_MODULE_14__constants__["OptionType"].STRING:
            if ((typeof value === 'undefined' ? 'undefined' : _typeof(value)) !== __WEBPACK_IMPORTED_MODULE_14__constants__["OptionType"].STRING) {
              throw this._buildConfigError('Option `' + optionName + '` has to be a string.');
            }

            // String value restrictions
            var available = optionConfig.available;
            if (typeof available !== 'undefined' && available.indexOf(value) === -1) {
              throw this._buildConfigError('Invalid value for `' + optionName + '` (valid values are: ' + optionConfig.available.join(', ') + ')');
            }

            this._options[optionName] = value;
            break;

          // Number options
          case __WEBPACK_IMPORTED_MODULE_14__constants__["OptionType"].NUMBER:
            if ((typeof value === 'undefined' ? 'undefined' : _typeof(value)) !== __WEBPACK_IMPORTED_MODULE_14__constants__["OptionType"].NUMBER) {
              throw this._buildConfigError('Option `' + optionName + '` has to be a number.');
            }

            this._options[optionName] = value;
            break;

          // Boolean options
          case __WEBPACK_IMPORTED_MODULE_14__constants__["OptionType"].BOOLEAN:
            if ((typeof value === 'undefined' ? 'undefined' : _typeof(value)) !== __WEBPACK_IMPORTED_MODULE_14__constants__["OptionType"].BOOLEAN) {
              throw this._buildConfigError('Option `' + optionName + '` has to be a boolean.');
            }

            this._options[optionName] = value;

            break;

          // Vector2 options
          case __WEBPACK_IMPORTED_MODULE_14__constants__["OptionType"].VECTOR2:
            if (!(value instanceof __WEBPACK_IMPORTED_MODULE_10__math_vector2__["a" /* default */]) && !((typeof value === 'undefined' ? 'undefined' : _typeof(value)) === 'object' && 'x' in value && 'y' in value)) {
              throw this._buildConfigError('Option `' + optionName + '` has to be an instance of Vector2 or an Object holding x and y values.');
            }

            if (value instanceof __WEBPACK_IMPORTED_MODULE_10__math_vector2__["a" /* default */]) {
              this._options[optionName] = value.clone();
            } else {
              this._options[optionName] = __WEBPACK_IMPORTED_MODULE_10__math_vector2__["a" /* default */].fromObject(value);
            }

            break;

          // Color options
          case __WEBPACK_IMPORTED_MODULE_14__constants__["OptionType"].COLOR:
            if (!(value instanceof __WEBPACK_IMPORTED_MODULE_11__color__["a" /* default */])) {
              throw this._buildConfigError('Option `' + optionName + '` has to be an instance of Color.');
            }

            this._options[optionName] = value;
            break;

          // ColorMatrix options
          case __WEBPACK_IMPORTED_MODULE_14__constants__["OptionType"].COLOR_MATRIX:
            if (!(value instanceof __WEBPACK_IMPORTED_MODULE_13__math_color_matrix__["a" /* default */])) {
              throw this._buildConfigError('Option `' + optionName + '` has to be an instance of ColorMatrix.');
            }

            this._options[optionName] = value.clone();

            break;

          // Function options
          case __WEBPACK_IMPORTED_MODULE_14__constants__["OptionType"].FUNCTION:
            if (typeof value !== 'function') {
              throw this._buildConfigError('Option `' + optionName + '` has to be a function.');
            }

            this._options[optionName] = value;

            break;

          // Object options
          case __WEBPACK_IMPORTED_MODULE_14__constants__["OptionType"].OBJECT:
          case '*':
            this._options[optionName] = value;
            break;

          case __WEBPACK_IMPORTED_MODULE_14__constants__["OptionType"].IMAGE:
            if (typeof value === 'string') {
              var image = new Image();
              image.src = value;
              this._options[optionName] = image;
            } else if (value instanceof Image || typeof HTMLImageElement !== 'undefined' && value instanceof HTMLImageElement) {
              this._options[optionName] = value;
            } else {
              throw this._buildConfigError('Option `' + optionName + '` has to be an Image or String.');
            }
            break;

          // Configurable options
          case __WEBPACK_IMPORTED_MODULE_14__constants__["OptionType"].CONFIGURABLE:
            this._options[optionName].set(value);
            break;

          // Array options
          case __WEBPACK_IMPORTED_MODULE_14__constants__["OptionType"].ARRAY:
            if (!(value instanceof Array)) {
              throw this._buildConfigError('Option `' + optionName + '` has to be an Array.');
            }
            this._options[optionName] = value.slice(0);
            break;

          // Unknown option type
          default:
            throw this._buildConfigError('Unknown option type: `' + optionConfig.type + '`');
        }
      }

      if (update) {
        this._onOptionsChange();
        this.emit('update', this, _defineProperty({}, optionName, value));
      }
    }

    /**
     * Gets called when a `configurable` option has been updated
     * @param  {*} ...args
     * @private
     */

  }, {
    key: '_onConfigurableUpdate',
    value: function _onConfigurableUpdate() {
      for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
        args[_key] = arguments[_key];
      }

      this.emit.apply(this, ['update'].concat(args));
    }

    /**
     * Check if the configurable has any options that differ from the default options
     * @return {Boolean}
     */

  }, {
    key: 'hasChanges',
    value: function hasChanges() {
      var defaultOptions = this.getDefaultOptions();
      return !this.optionsEqual(defaultOptions);
    }
  }]);

  return Configurable;
}(__WEBPACK_IMPORTED_MODULE_9__event_emitter__["a" /* default */]);

/* harmony default export */ __webpack_exports__["a"] = (Configurable);

/***/ }),
/* 47 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__vendor_promise__ = __webpack_require__(29);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_url__ = __webpack_require__(221);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_url___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_url__);


var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/* global XMLHttpRequest */
/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




var TIMEOUT = 5000;

var root = typeof window !== 'undefined' ? window : global;

var JSONLoader = function () {
  function JSONLoader(url) {
    _classCallCheck(this, JSONLoader);

    this._url = url;
    this._parsedUrl = __WEBPACK_IMPORTED_MODULE_2_url___default.a.parse(this._url, true);
  }

  /**
   * Checks if this request is a JSONP request
   * @return {Boolean}
   */


  _createClass(JSONLoader, [{
    key: '_isJSONPRequest',
    value: function _isJSONPRequest() {
      var query = this._parsedUrl.query;

      for (var key in query) {
        var value = query[key];
        if (value === '?') {
          return true;
        }
      }
      return false;
    }

    /**
     * Loads the JSON(P) from the given URL
     * @return {Promise}
     */

  }, {
    key: 'load',
    value: function load() {
      if (this._isJSONPRequest()) {
        return this._loadJSONP();
      } else {
        return this._loadJSON();
      }
    }

    /**
     * Loads the URL as JSON
     * @return {Promise}
     */

  }, {
    key: '_loadJSON',
    value: function _loadJSON() {
      var _this = this;

      return new __WEBPACK_IMPORTED_MODULE_1__vendor_promise__["a" /* default */](function (resolve, reject) {
        var xhr = void 0;
        if (root.XDomainRequest) {
          xhr = new root.XDomainRequest();

          xhr.onload = function () {
            var json = JSON.parse(xhr.responseText);
            resolve(json);
          };
          xhr.onerror = function (e) {
            reject(e);
          };
          xhr.open('GET', _this._url, true);
          xhr.send();
        } else if (root.XMLHttpRequest) {
          xhr = new XMLHttpRequest();

          xhr.onreadystatechange = function (oEvent) {
            if (xhr.readyState === 4) {
              if (xhr.status === 200) {
                var json = JSON.parse(xhr.responseText);
                resolve(json);
              } else {
                reject(new Error('HTTP Status ' + xhr.status));
              }
            }
          };
          xhr.open('GET', _this._url, true);
          xhr.send();
        }
      });
    }

    /**
     * Loads the URL as JSONP
     * @return {Promise}
     */

  }, {
    key: '_loadJSONP',
    value: function _loadJSONP() {
      var _this2 = this;

      var failed = false;
      var succeeded = false;

      var fnName = 'pesdk' + Math.round(Math.random() * 99999999999999);
      return new __WEBPACK_IMPORTED_MODULE_1__vendor_promise__["a" /* default */](function (resolve, reject) {
        var node = _this2._createJSONPNode(fnName);
        root[fnName] = function (result) {
          _this2._removeJSONPNode(node);
          if (!failed) {
            succeeded = true;
            resolve(result);
          }
        };

        root.setTimeout(function () {
          if (!succeeded) {
            _this2._removeJSONPNode(node);
            failed = true;
            reject(new Error('Timeout of 5 seconds exceeded.'));
          }
        }, TIMEOUT);
      });
    }

    /**
     * Creates a JSONP <script> node inside the <head> element
     * @param  {String} fnName
     * @return {DOMElement}
     * @private
     */

  }, {
    key: '_createJSONPNode',
    value: function _createJSONPNode(fnName) {
      var JSONPUrl = this._buildJSONPUrl(fnName);
      var headNode = document.querySelector('head');
      var scriptNode = document.createElement('script');
      scriptNode.src = JSONPUrl;
      headNode.appendChild(scriptNode);
      return scriptNode;
    }

    /**
     * Removes the JSONP <script> node from the <head> element
     * @param  {DOMElement} node
     * @private
     */

  }, {
    key: '_removeJSONPNode',
    value: function _removeJSONPNode(node) {
      node.parentNode.removeChild(node);
    }

    /**
     * Builds a JSONP url for the given function name
     * @param  {String} fnName
     * @return {String}
     */

  }, {
    key: '_buildJSONPUrl',
    value: function _buildJSONPUrl(fnName) {
      // Find JSONP parameter
      var query = this._parsedUrl.query;

      var parameter = null;
      for (var param in query) {
        if (query[param] === '?') {
          parameter = param;
          break;
        }
      }

      delete this._parsedUrl.search;
      query[parameter] = fnName;

      return __WEBPACK_IMPORTED_MODULE_2_url___default.a.format(this._parsedUrl);
    }
  }]);

  return JSONLoader;
}();

/* harmony default export */ __webpack_exports__["a"] = (JSONLoader);

/***/ }),
/* 48 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_is_iterable__ = __webpack_require__(106);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_is_iterable___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_is_iterable__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_get_iterator__ = __webpack_require__(107);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_get_iterator___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_get_iterator__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_promise__ = __webpack_require__(11);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_promise___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_promise__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_canvas__ = __webpack_require__(19);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_canvas___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_canvas__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_fs__ = __webpack_require__(232);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_fs___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_fs__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_request__ = __webpack_require__(233);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_request___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_request__);




var _slicedToArray = function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_get_iterator___default()(arr), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i["return"]) _i["return"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_is_iterable___default()(Object(arr))) { return sliceIterator(arr, i); } else { throw new TypeError("Invalid attempt to destructure non-iterable instance"); } }; }();

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */

/* eslint-disable brace-style */





var readFileAsync = function readFileAsync(filePath) {
  return new __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_promise___default.a(function (resolve, reject) {
    try {
      __WEBPACK_IMPORTED_MODULE_4_fs___default.a.readFile(filePath, function (err, buffer) {
        if (err) {
          reject(err);
        } else {
          resolve([filePath, buffer]);
        }
      });
    } catch (err) {
      reject(err);
    }
  });
};

var loadRemoteFile = function loadRemoteFile(url) {
  return new __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_promise___default.a(function (resolve, reject) {
    __WEBPACK_IMPORTED_MODULE_5_request___default.a.get(url, { encoding: null }, function (err, response, body) {
      if (err) return reject(err);

      if (response.statusCode !== 200) {
        return reject(new Error('Server responded with status code ' + response.statusCode));
      }
      resolve([url, response.body]);
    });
  });
};

/* harmony default export */ __webpack_exports__["a"] = ({
  load: function load(url) {
    var _this = this;

    var loadPromise = function loadPromise() {
      if (url.substr(0, 5) === 'data:' || typeof WEBPACK !== 'undefined') {
        return __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_promise___default.a.resolve([url, url]);
      } else {
        if (!url.match(/^(https?|ftp|file):\/\//)) {
          return readFileAsync(url);
        } else {
          return loadRemoteFile(url);
        }
      }
    };

    return loadPromise().then(function (_ref) {
      var _ref2 = _slicedToArray(_ref, 2),
          originalSrc = _ref2[0],
          src = _ref2[1];

      return _this._createAndLoadImage(originalSrc, src);
    });
  },
  _createAndLoadImage: function _createAndLoadImage(originalSrc, src) {
    if (typeof WEBPACK !== 'undefined') {
      return new __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_promise___default.a(function (resolve, reject) {
        var image = new window.Image();
        image.addEventListener('load', function () {
          resolve(image);
        });
        image.addEventListener('error', function () {
          reject(new Error('Failed to load image at ' + src));
        });
        image.crossOrigin = 'Anonymous';
        image.src = src;
      });
    }

    var image = new __WEBPACK_IMPORTED_MODULE_3_canvas___default.a.Image();
    image.src = src;
    image.filePath = originalSrc;
    return __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_promise___default.a.resolve(image);
  },
  loadXHR: function loadXHR(url, mime) {
    return new __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_promise___default.a(function (resolve, reject) {
      var xhr = void 0;
      if (window.XDomainRequest) {
        xhr = new window.XDomainRequest();
        if (mime) xhr.overrideMimeType(mime);

        xhr.onload = function () {
          resolve(xhr);
        };
        xhr.onerror = function (e) {
          reject(e);
        };
      } else if (window.XMLHttpRequest) {
        xhr = new window.XMLHttpRequest();
        if (mime) xhr.overrideMimeType(mime);

        xhr.onreadystatechange = function (oEvent) {
          if (xhr.readyState === 4) {
            if (xhr.status === 200) {
              resolve(xhr);
            } else {
              reject(new Error('HTTP Status ' + xhr.status));
            }
          }
        };
      }

      xhr.open('GET', url, true);
      xhr.send();
    });
  }
});

/***/ }),
/* 49 */
/***/ (function(module, exports) {

module.exports = function (it) {
  if (typeof it != 'function') throw TypeError(it + ' is not a function!');
  return it;
};


/***/ }),
/* 50 */
/***/ (function(module, exports) {

exports.f = {}.propertyIsEnumerable;


/***/ }),
/* 51 */
/***/ (function(module, exports) {

var id = 0;
var px = Math.random();
module.exports = function (key) {
  return 'Symbol('.concat(key === undefined ? '' : key, ')_', (++id + px).toString(36));
};


/***/ }),
/* 52 */
/***/ (function(module, exports) {

module.exports = true;


/***/ }),
/* 53 */
/***/ (function(module, exports, __webpack_require__) {

var def = __webpack_require__(18).f;
var has = __webpack_require__(27);
var TAG = __webpack_require__(12)('toStringTag');

module.exports = function (it, tag, stat) {
  if (it && !has(it = stat ? it : it.prototype, TAG)) def(it, TAG, { configurable: true, value: tag });
};


/***/ }),
/* 54 */
/***/ (function(module, exports, __webpack_require__) {

__webpack_require__(159);
var global = __webpack_require__(14);
var hide = __webpack_require__(25);
var Iterators = __webpack_require__(32);
var TO_STRING_TAG = __webpack_require__(12)('toStringTag');

var DOMIterables = ('CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,' +
  'DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,' +
  'MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,' +
  'SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,' +
  'TextTrackList,TouchList').split(',');

for (var i = 0; i < DOMIterables.length; i++) {
  var NAME = DOMIterables[i];
  var Collection = global[NAME];
  var proto = Collection && Collection.prototype;
  if (proto && !proto[TO_STRING_TAG]) hide(proto, TO_STRING_TAG, NAME);
  Iterators[NAME] = Iterators.Array;
}


/***/ }),
/* 55 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__renderers_canvas_canvas_renderer__ = __webpack_require__(180);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__renderers_webgl_webgl_renderer__ = __webpack_require__(195);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__managers_canvas_filter_manager__ = __webpack_require__(81);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__managers_webgl_filter_manager__ = __webpack_require__(85);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__display_display_object__ = __webpack_require__(84);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__display_container__ = __webpack_require__(116);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__textures_base_texture__ = __webpack_require__(44);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__textures_texture__ = __webpack_require__(117);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__textures_render_texture__ = __webpack_require__(203);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9__utils_webgl_render_target__ = __webpack_require__(58);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10__utils_canvas_render_target__ = __webpack_require__(57);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_11__sprites_sprite__ = __webpack_require__(204);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_12__shaders___ = __webpack_require__(206);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_13__shaders_shader__ = __webpack_require__(83);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_14__filters_filter__ = __webpack_require__(45);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_15__filters__ = __webpack_require__(210);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_16__utils_pixel_array_image__ = __webpack_require__(114);
/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */



















/**
 * The heart of PhotoEditorSDK. Handles all the rendering in a scene-graph fashion
 * @namespace PhotoEditorSDK.Engine
 */
var Engine = {
  WebGLRenderer: __WEBPACK_IMPORTED_MODULE_1__renderers_webgl_webgl_renderer__["a" /* default */],
  CanvasRenderer: __WEBPACK_IMPORTED_MODULE_0__renderers_canvas_canvas_renderer__["a" /* default */],
  WebGLFilterManager: __WEBPACK_IMPORTED_MODULE_3__managers_webgl_filter_manager__["a" /* default */],
  CanvasFilterManager: __WEBPACK_IMPORTED_MODULE_2__managers_canvas_filter_manager__["a" /* default */],
  DisplayObject: __WEBPACK_IMPORTED_MODULE_4__display_display_object__["a" /* default */],
  Container: __WEBPACK_IMPORTED_MODULE_5__display_container__["a" /* default */],
  BaseTexture: __WEBPACK_IMPORTED_MODULE_6__textures_base_texture__["a" /* default */],
  Texture: __WEBPACK_IMPORTED_MODULE_7__textures_texture__["a" /* default */],
  RenderTexture: __WEBPACK_IMPORTED_MODULE_8__textures_render_texture__["a" /* default */],
  WebGLRenderTarget: __WEBPACK_IMPORTED_MODULE_9__utils_webgl_render_target__["a" /* default */],
  CanvasRenderTarget: __WEBPACK_IMPORTED_MODULE_10__utils_canvas_render_target__["a" /* default */],
  Sprite: __WEBPACK_IMPORTED_MODULE_11__sprites_sprite__["a" /* default */],
  Shaders: __WEBPACK_IMPORTED_MODULE_12__shaders___["a" /* default */],
  Shader: __WEBPACK_IMPORTED_MODULE_13__shaders_shader__["a" /* default */],
  Filter: __WEBPACK_IMPORTED_MODULE_14__filters_filter__["a" /* default */],
  Filters: __WEBPACK_IMPORTED_MODULE_15__filters__,
  PixelArrayImage: __WEBPACK_IMPORTED_MODULE_16__utils_pixel_array_image__["a" /* default */],

  /**
   * If WebGL is supported, this returns a WebGLRenderer and falls back to CanvasRenderer
   * @param  {Number} width
   * @param  {Number} height
   * @param  {Object} [options = {} ]
   * @return {(PhotoEditorSDK.Engine.WebGLRenderer|PhotoEditorSDK.Engine.CanvasRenderer)}
   */
  autoDetectRenderer: function autoDetectRenderer(width, height) {
    var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};

    if (__WEBPACK_IMPORTED_MODULE_1__renderers_webgl_webgl_renderer__["a" /* default */].isSupported()) {
      return new __WEBPACK_IMPORTED_MODULE_1__renderers_webgl_webgl_renderer__["a" /* default */](width, height, options);
    } else {
      return new __WEBPACK_IMPORTED_MODULE_0__renderers_canvas_canvas_renderer__["a" /* default */](width, height, options);
    }
  }
};

/* harmony default export */ __webpack_exports__["a"] = (Engine);

/***/ }),
/* 56 */
/***/ (function(module, exports, __webpack_require__) {

module.exports = { "default": __webpack_require__(192), __esModule: true };

/***/ }),
/* 57 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__globals__ = __webpack_require__(8);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__textures_base_texture__ = __webpack_require__(44);


var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




/**
 * A canvas render target that you can render to.
 * Canvas equivalent of {@link PhotoEditorSDK.Engine.WebGLRenderTarget}
 * @class
 * @memberof PhotoEditorSDK.Engine
 */

var CanvasRenderTarget = function () {
  /**
   * Creates a CanvasRenderTarget
   * @param  {Number} width
   * @param  {Number} height
   * @param  {Number} pixelRatio
   * @param  {HTMLCanvasElement} canvas
   * @param  {CanvasRenderingContext2D} context
   */
  function CanvasRenderTarget(width, height, pixelRatio, canvas, context) {
    _classCallCheck(this, CanvasRenderTarget);

    this._width = width;
    this._height = height;
    this._pixelRatio = pixelRatio;

    this._baseTexture = new __WEBPACK_IMPORTED_MODULE_2__textures_base_texture__["a" /* default */]();
    this._canvas = canvas || this._createCanvas();
    this._context = context || this._canvas.getContext('2d');
    this._baseTexture.setSource(this._canvas);

    this._canvas.width = this._width * this._pixelRatio;
    this._canvas.height = this._height * this._pixelRatio;
    this._filterStack = [{
      renderTarget: this,
      filter: []
    }];
  }

  /**
   * Creates a canvas
   * @return {Canvas}
   * @private
   */


  _createClass(CanvasRenderTarget, [{
    key: '_createCanvas',
    value: function _createCanvas() {
      return __WEBPACK_IMPORTED_MODULE_1__globals__["i" /* Utils */].createCanvas();
    }

    /**
     * Clears this CanvasRenderTarget
     */

  }, {
    key: 'clear',
    value: function clear() {
      var ctx = this._context;
      ctx.setTransform(1, 0, 0, 1, 0, 0);
      ctx.clearRect(0, 0, this._width * this._pixelRatio, this._height * this._pixelRatio);
    }

    /**
     * Resizes this canvas buffer to the given dimensions
     * @param  {PhotoEditorSDK.Math.Vector2} dimensions
     */

  }, {
    key: 'resizeTo',
    value: function resizeTo(dimensions) {
      this._baseTexture.resizeTo(dimensions);

      if (this._width !== dimensions.x) {
        this._width = dimensions.x;
        this._canvas.width = this._width * this._pixelRatio;
      }

      if (this._height !== dimensions.y) {
        this._height = dimensions.y;
        this._canvas.height = this._height * this._pixelRatio;
      }
    }

    /**
     * Returns the canvas
     * @return {HTMLCanvasElement}
     */

  }, {
    key: 'getCanvas',
    value: function getCanvas() {
      return this._canvas;
    }

    /**
     * Returns the rendering context
     * @return {CanvasRenderingContext2D} [description]
     */

  }, {
    key: 'getContext',
    value: function getContext() {
      return this._context;
    }

    /**
     * Returns the filter stack
     * @return {Object[]}
     */

  }, {
    key: 'getFilterStack',
    value: function getFilterStack() {
      return this._filterStack;
    }

    /**
     * Returns the width
     * @return {Number}
     */

  }, {
    key: 'getWidth',
    value: function getWidth() {
      return this._width;
    }

    /**
     * Returns the height
     * @return {Number}
     */

  }, {
    key: 'getHeight',
    value: function getHeight() {
      return this._height;
    }

    /**
     * Returns the pixel ratio
     * @return {Number}
     */

  }, {
    key: 'getPixelRatio',
    value: function getPixelRatio() {
      return this._pixelRatio;
    }

    /**
     * Sets the pixel ratio
     * @param {Number} pixelRatio
     */

  }, {
    key: 'setPixelRatio',
    value: function setPixelRatio(pixelRatio) {
      this._pixelRatio = pixelRatio;
    }

    /**
     * Returns the dimensions
     * @return {PhotoEditorSDK.Math.Vector2}
     */

  }, {
    key: 'getDimensions',
    value: function getDimensions() {
      return new __WEBPACK_IMPORTED_MODULE_1__globals__["k" /* Vector2 */](this._width, this._height);
    }

    /**
     * Returns the base texture
     * @return {PhotoEditorSDK.Engine.BaseTexture}
     */

  }, {
    key: 'getBaseTexture',
    value: function getBaseTexture() {
      return this._baseTexture;
    }

    /**
     * Cleans up this canvas buffer
     */

  }, {
    key: 'dispose',
    value: function dispose() {
      this._canvas = null;
      this._context = null;
    }
  }]);

  return CanvasRenderTarget;
}();

/* harmony default export */ __webpack_exports__["a"] = (CanvasRenderTarget);

/***/ }),
/* 58 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__globals__ = __webpack_require__(8);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__textures_base_texture__ = __webpack_require__(44);


var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




/**
 * An object that you can render to. WebGL equivalent of {@link PhotoEditorSDK.Engine.CanvasRenderTarget}
 * @class
 * @memberof PhotoEditorSDK.Engine
 */
/* istanbul ignore next */

var WebGLRenderTarget = function () {
  /**
   * Creates a WebGLRenderTarget
   * @param  {PhotoEditorSDK.Engine.BaseRenderer}  renderer
   * @param  {Number}  width
   * @param  {Number}  height
   * @param  {Number}  pixelRatio
   * @param  {Boolean} [isRoot = false]
   */
  function WebGLRenderTarget(renderer, width, height, pixelRatio) {
    var isRoot = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : false;

    _classCallCheck(this, WebGLRenderTarget);

    this._renderer = renderer;
    this._gl = renderer.getContext();
    this._width = width;
    this._height = height;
    this._frame = null;
    this._pixelRatio = pixelRatio;
    this._projectionMatrix = new __WEBPACK_IMPORTED_MODULE_1__globals__["g" /* Matrix */]();
    this._mipMapping = false;

    this._baseTexture = new __WEBPACK_IMPORTED_MODULE_2__textures_base_texture__["a" /* default */]();
    var frame = this._baseTexture.getFrame();
    frame.width = width;
    frame.height = height;
    this._baseTexture.setPixelRatio(pixelRatio);
    this._baseTexture.setLoaded(true);

    // `null` means render to canvas directly
    this._framebuffer = null;
    this._isRoot = isRoot;
    this._filterStack = [{
      renderTarget: this,
      filter: []
    }];

    if (!isRoot) {
      this._initFrameBuffer();
    }
  }

  /**
   * Resizes this WebGLRenderTarget to the given dimensions
   * @param  {PhotoEditorSDK.Math.Vector2} dimensions
   */


  _createClass(WebGLRenderTarget, [{
    key: 'resizeTo',
    value: function resizeTo(dimensions) {
      this._width = dimensions.x | 0; // rounded
      this._height = dimensions.y | 0; // rounded

      this._baseTexture.resizeTo(dimensions);

      if (!this._isRoot) {
        this._resizeTexture();
      }

      this._baseTexture.setMinFilter(this._getMinFilter());
      this._baseTexture.setMagFilter(this._getMagFilter());

      this._calculateProjectionMatrix();
    }

    /**
     * Returns the downsampling filter
     * @return {Number}
     * @private
     */

  }, {
    key: '_getMinFilter',
    value: function _getMinFilter() {
      var minFilter = __WEBPACK_IMPORTED_MODULE_2__textures_base_texture__["a" /* default */].DefaultMinFilter;
      if (this._mipMapping) {
        minFilter = __WEBPACK_IMPORTED_MODULE_2__textures_base_texture__["a" /* default */].TrilinearFilter;
      }
      return minFilter;
    }

    /**
     * Returns the upsampling filter
     * @return {Number}
     * @private
     */

  }, {
    key: '_getMagFilter',
    value: function _getMagFilter() {
      return __WEBPACK_IMPORTED_MODULE_2__textures_base_texture__["a" /* default */].DefaultMagFilter;
    }

    /**
     * Resizes the FBO's texture to the current dimensions
     * @private
     */

  }, {
    key: '_resizeTexture',
    value: function _resizeTexture() {
      var gl = this._gl;
      gl.bindTexture(gl.TEXTURE_2D, this._texture);

      var realWidth = this._width * this._pixelRatio;
      var realHeight = this._height * this._pixelRatio;
      gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, realWidth, realHeight, 0, gl.RGBA, gl.UNSIGNED_BYTE, null);

      var dimensions = new __WEBPACK_IMPORTED_MODULE_1__globals__["k" /* Vector2 */](this._width, this._height);
      if (__WEBPACK_IMPORTED_MODULE_1__globals__["i" /* Utils */].isPowerOfTwo(dimensions)) {
        __WEBPACK_IMPORTED_MODULE_1__globals__["f" /* Log */].info('WebGLRenderTarget', 'Mip-mapping enabled');
        this._mipMapping = true;
      } else {
        this._mipMapping = false;
      }

      this._baseTexture.setMipMappingEnabled(this._mipMapping);
    }

    /**
     * Binds the framebuffer and resizes the viewport
     */

  }, {
    key: 'activate',
    value: function activate() {
      var gl = this._gl;
      gl.bindFramebuffer(gl.FRAMEBUFFER, this._framebuffer);

      this._calculateProjectionMatrix();

      gl.viewport(0, 0, this._width * this._pixelRatio, this._height * this._pixelRatio);
      gl.disable(gl.STENCIL_TEST);
    }

    /**
     * Clears the framebuffer
     */

  }, {
    key: 'clear',
    value: function clear() {
      var color = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : __WEBPACK_IMPORTED_MODULE_1__globals__["b" /* Color */].TRANSPARENT;

      var gl = this._gl;
      gl.bindFramebuffer(gl.FRAMEBUFFER, this._framebuffer);

      __WEBPACK_IMPORTED_MODULE_1__globals__["e" /* GLUtils */].checkFramebufferStatus('WebGLRenderTarget#clear', gl);

      gl.clearColor.apply(gl, color.toGLColor());
      gl.clear(gl.COLOR_BUFFER_BIT);
    }

    /**
     * Calculates the projection matrix for this render target
     * @private
     */

  }, {
    key: '_calculateProjectionMatrix',
    value: function _calculateProjectionMatrix() {
      var projectionMatrix = this._projectionMatrix;
      projectionMatrix.reset();

      var frame = this._frame || new __WEBPACK_IMPORTED_MODULE_1__globals__["h" /* Rectangle */](0, 0, this._width, this._height);

      var x = frame.x,
          y = frame.y;

      if (!this._isRoot) {
        projectionMatrix.a = 1 / this._width * 2;
        projectionMatrix.d = 1 / this._height * 2;

        projectionMatrix.tx = -1 - x * projectionMatrix.a;
        projectionMatrix.ty = -1 - y * projectionMatrix.d;
      } else {
        projectionMatrix.a = 1 / this._width * 2;
        projectionMatrix.d = -1 / this._height * 2;

        projectionMatrix.tx = -1 - x * projectionMatrix.a;
        projectionMatrix.ty = 1 - y * projectionMatrix.d;
      }
    }

    /**
     * Initializes the WebGL FBO and Texture for this WebGLRenderTarget
     * @private
     */

  }, {
    key: '_initFrameBuffer',
    value: function _initFrameBuffer() {
      var gl = this._gl;

      // Init the FBO
      this._framebuffer = gl.createFramebuffer();

      // Create the texture
      this._texture = gl.createTexture();
      gl.bindTexture(gl.TEXTURE_2D, this._texture);

      // Bind texture to FBO
      gl.bindFramebuffer(gl.FRAMEBUFFER, this._framebuffer);
      gl.framebufferTexture2D(gl.FRAMEBUFFER, gl.COLOR_ATTACHMENT0, gl.TEXTURE_2D, this._texture, 0);

      this._baseTexture.setGLTextureForRenderer(this._texture, this._renderer);
      this.resizeTo(new __WEBPACK_IMPORTED_MODULE_1__globals__["k" /* Vector2 */](this._width, this._height));

      __WEBPACK_IMPORTED_MODULE_1__globals__["e" /* GLUtils */].checkFramebufferStatus('WebGLRenderTarget#_initFramebuffer', gl);
    }

    /**
     * Returns the projection matrix
     * @return {PhotoEditorSDK.Math.Matrix}
     */

  }, {
    key: 'getProjectionMatrix',
    value: function getProjectionMatrix() {
      return this._projectionMatrix;
    }

    /**
     * Returns the texture
     * @return {PhotoEditorSDK.Engine.Texture}
     */

  }, {
    key: 'getTexture',
    value: function getTexture() {
      return this._texture;
    }

    /**
     * Returns the frame
     * @return {PhotoEditorSDK.Math.Rectangle}
     */

  }, {
    key: 'getFrame',
    value: function getFrame() {
      return this._frame;
    }

    /**
     * Sets the frame
     * @param {PhotoEditorSDK.Math.Rectangle} frame
     */

  }, {
    key: 'setFrame',
    value: function setFrame(frame) {
      this._frame = frame;
    }

    /**
     * Returns the filter stack
     * @return {Object[]}
     */

  }, {
    key: 'getFilterStack',
    value: function getFilterStack() {
      return this._filterStack;
    }

    /**
     * Returns the current pixel ratio
     * @return {Number}
     */

  }, {
    key: 'getPixelRatio',
    value: function getPixelRatio() {
      return this._pixelRatio;
    }

    /**
     * Sets the pixel ratio
     * @param {Number} pixelRatio
     */

  }, {
    key: 'setPixelRatio',
    value: function setPixelRatio(pixelRatio) {
      this._pixelRatio = pixelRatio;

      if (!this._isRoot) {
        this._resizeTexture();
      }
    }

    /**
     * Returns the base texture
     * @return {PhotoEditorSDK.Engine.BaseTexture}
     */

  }, {
    key: 'getBaseTexture',
    value: function getBaseTexture() {
      return this._baseTexture;
    }

    /**
     * Disposes this WebGLRenderTarget
     */

  }, {
    key: 'dispose',
    value: function dispose() {
      var gl = this._gl;
      this._baseTexture.disposeGLTexturesForRenderer(this._renderer);
      gl.deleteTexture(this._texture);
      gl.deleteFramebuffer(this._framebuffer);
    }
  }]);

  return WebGLRenderTarget;
}();

/* harmony default export */ __webpack_exports__["a"] = (WebGLRenderTarget);

/***/ }),
/* 59 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
/* eslint-disable */

/*!
StackBlur - a fast almost Gaussian Blur For Canvas

Version:  0.5
Author:   Mario Klingemann
Contact:  mario@quasimondo.com
Website:  http://www.quasimondo.com/StackBlurForCanvas
Twitter:  @quasimondo

In case you find this class useful - especially in commercial projects -
I am not totally unhappy for a small donation to my PayPal account
mario@quasimondo.de

Or support me on flattr:
https://flattr.com/thing/72791/StackBlur-a-fast-almost-Gaussian-Blur-Effect-for-CanvasJavascript

Copyright (c) 2010 Mario Klingemann

Permission is hereby granted, free of charge, to any person
obtaining a copy of this software and associated documentation
files (the "Software"), to deal in the Software without
restriction, including without limitation the rights to use,
copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the
Software is furnished to do so, subject to the following
conditions:

The above copyright notice and this permission notice shall be
included in all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
OTHER DEALINGS IN THE SOFTWARE.
@license
*/

var mul_table = [512, 512, 456, 512, 328, 456, 335, 512, 405, 328, 271, 456, 388, 335, 292, 512, 454, 405, 364, 328, 298, 271, 496, 456, 420, 388, 360, 335, 312, 292, 273, 512, 482, 454, 428, 405, 383, 364, 345, 328, 312, 298, 284, 271, 259, 496, 475, 456, 437, 420, 404, 388, 374, 360, 347, 335, 323, 312, 302, 292, 282, 273, 265, 512, 497, 482, 468, 454, 441, 428, 417, 405, 394, 383, 373, 364, 354, 345, 337, 328, 320, 312, 305, 298, 291, 284, 278, 271, 265, 259, 507, 496, 485, 475, 465, 456, 446, 437, 428, 420, 412, 404, 396, 388, 381, 374, 367, 360, 354, 347, 341, 335, 329, 323, 318, 312, 307, 302, 297, 292, 287, 282, 278, 273, 269, 265, 261, 512, 505, 497, 489, 482, 475, 468, 461, 454, 447, 441, 435, 428, 422, 417, 411, 405, 399, 394, 389, 383, 378, 373, 368, 364, 359, 354, 350, 345, 341, 337, 332, 328, 324, 320, 316, 312, 309, 305, 301, 298, 294, 291, 287, 284, 281, 278, 274, 271, 268, 265, 262, 259, 257, 507, 501, 496, 491, 485, 480, 475, 470, 465, 460, 456, 451, 446, 442, 437, 433, 428, 424, 420, 416, 412, 408, 404, 400, 396, 392, 388, 385, 381, 377, 374, 370, 367, 363, 360, 357, 354, 350, 347, 344, 341, 338, 335, 332, 329, 326, 323, 320, 318, 315, 312, 310, 307, 304, 302, 299, 297, 294, 292, 289, 287, 285, 282, 280, 278, 275, 273, 271, 269, 267, 265, 263, 261, 259];

var shg_table = [9, 11, 12, 13, 13, 14, 14, 15, 15, 15, 15, 16, 16, 16, 16, 17, 17, 17, 17, 17, 17, 17, 18, 18, 18, 18, 18, 18, 18, 18, 18, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24];

function stackBlurCanvasRGBA(imageData, top_x, top_y, width, height, radius) {
  if (isNaN(radius) || radius < 1) {
    return;
  }
  radius |= 0;

  var pixels = imageData.data;

  var x, y, i, p, yp, yi, yw, r_sum, g_sum, b_sum, a_sum, r_out_sum, g_out_sum, b_out_sum, a_out_sum, r_in_sum, g_in_sum, b_in_sum, a_in_sum, pr, pg, pb, pa, rbs;

  var div = radius + radius + 1;
  var widthMinus1 = width - 1;
  var heightMinus1 = height - 1;
  var radiusPlus1 = radius + 1;
  var sumFactor = radiusPlus1 * (radiusPlus1 + 1) / 2;

  var stackStart = new BlurStack();
  var stackEnd;
  var stack = stackStart;
  for (i = 1; i < div; i++) {
    stack = stack.next = new BlurStack();
    if (i == radiusPlus1) stackEnd = stack;
  }
  stack.next = stackStart;
  var stackIn = null;
  var stackOut = null;

  yw = yi = 0;

  var mul_sum = mul_table[radius];
  var shg_sum = shg_table[radius];

  for (y = 0; y < height; y++) {
    r_in_sum = g_in_sum = b_in_sum = a_in_sum = r_sum = g_sum = b_sum = a_sum = 0;

    r_out_sum = radiusPlus1 * (pr = pixels[yi]);
    g_out_sum = radiusPlus1 * (pg = pixels[yi + 1]);
    b_out_sum = radiusPlus1 * (pb = pixels[yi + 2]);
    a_out_sum = radiusPlus1 * (pa = pixels[yi + 3]);

    r_sum += sumFactor * pr;
    g_sum += sumFactor * pg;
    b_sum += sumFactor * pb;
    a_sum += sumFactor * pa;

    stack = stackStart;

    for (i = 0; i < radiusPlus1; i++) {
      stack.r = pr;
      stack.g = pg;
      stack.b = pb;
      stack.a = pa;
      stack = stack.next;
    }

    for (i = 1; i < radiusPlus1; i++) {
      p = yi + ((widthMinus1 < i ? widthMinus1 : i) << 2);
      r_sum += (stack.r = pr = pixels[p]) * (rbs = radiusPlus1 - i);
      g_sum += (stack.g = pg = pixels[p + 1]) * rbs;
      b_sum += (stack.b = pb = pixels[p + 2]) * rbs;
      a_sum += (stack.a = pa = pixels[p + 3]) * rbs;

      r_in_sum += pr;
      g_in_sum += pg;
      b_in_sum += pb;
      a_in_sum += pa;

      stack = stack.next;
    }

    stackIn = stackStart;
    stackOut = stackEnd;
    for (x = 0; x < width; x++) {
      pixels[yi + 3] = pa = a_sum * mul_sum >> shg_sum;
      if (pa !== 0) {
        pa = 255 / pa;
        pixels[yi] = (r_sum * mul_sum >> shg_sum) * pa;
        pixels[yi + 1] = (g_sum * mul_sum >> shg_sum) * pa;
        pixels[yi + 2] = (b_sum * mul_sum >> shg_sum) * pa;
      } else {
        pixels[yi] = pixels[yi + 1] = pixels[yi + 2] = 0;
      }

      r_sum -= r_out_sum;
      g_sum -= g_out_sum;
      b_sum -= b_out_sum;
      a_sum -= a_out_sum;

      r_out_sum -= stackIn.r;
      g_out_sum -= stackIn.g;
      b_out_sum -= stackIn.b;
      a_out_sum -= stackIn.a;

      p = yw + ((p = x + radius + 1) < widthMinus1 ? p : widthMinus1) << 2;

      r_in_sum += stackIn.r = pixels[p];
      g_in_sum += stackIn.g = pixels[p + 1];
      b_in_sum += stackIn.b = pixels[p + 2];
      a_in_sum += stackIn.a = pixels[p + 3];

      r_sum += r_in_sum;
      g_sum += g_in_sum;
      b_sum += b_in_sum;
      a_sum += a_in_sum;

      stackIn = stackIn.next;

      r_out_sum += pr = stackOut.r;
      g_out_sum += pg = stackOut.g;
      b_out_sum += pb = stackOut.b;
      a_out_sum += pa = stackOut.a;

      r_in_sum -= pr;
      g_in_sum -= pg;
      b_in_sum -= pb;
      a_in_sum -= pa;

      stackOut = stackOut.next;

      yi += 4;
    }
    yw += width;
  }

  for (x = 0; x < width; x++) {
    g_in_sum = b_in_sum = a_in_sum = r_in_sum = g_sum = b_sum = a_sum = r_sum = 0;

    yi = x << 2;
    r_out_sum = radiusPlus1 * (pr = pixels[yi]);
    g_out_sum = radiusPlus1 * (pg = pixels[yi + 1]);
    b_out_sum = radiusPlus1 * (pb = pixels[yi + 2]);
    a_out_sum = radiusPlus1 * (pa = pixels[yi + 3]);

    r_sum += sumFactor * pr;
    g_sum += sumFactor * pg;
    b_sum += sumFactor * pb;
    a_sum += sumFactor * pa;

    stack = stackStart;

    for (i = 0; i < radiusPlus1; i++) {
      stack.r = pr;
      stack.g = pg;
      stack.b = pb;
      stack.a = pa;
      stack = stack.next;
    }

    yp = width;

    for (i = 1; i <= radius; i++) {
      yi = yp + x << 2;

      r_sum += (stack.r = pr = pixels[yi]) * (rbs = radiusPlus1 - i);
      g_sum += (stack.g = pg = pixels[yi + 1]) * rbs;
      b_sum += (stack.b = pb = pixels[yi + 2]) * rbs;
      a_sum += (stack.a = pa = pixels[yi + 3]) * rbs;

      r_in_sum += pr;
      g_in_sum += pg;
      b_in_sum += pb;
      a_in_sum += pa;

      stack = stack.next;

      if (i < heightMinus1) {
        yp += width;
      }
    }

    yi = x;
    stackIn = stackStart;
    stackOut = stackEnd;
    for (y = 0; y < height; y++) {
      p = yi << 2;
      pixels[p + 3] = pa = a_sum * mul_sum >> shg_sum;
      if (pa > 0) {
        pa = 255 / pa;
        pixels[p] = (r_sum * mul_sum >> shg_sum) * pa;
        pixels[p + 1] = (g_sum * mul_sum >> shg_sum) * pa;
        pixels[p + 2] = (b_sum * mul_sum >> shg_sum) * pa;
      } else {
        pixels[p] = pixels[p + 1] = pixels[p + 2] = 0;
      }

      r_sum -= r_out_sum;
      g_sum -= g_out_sum;
      b_sum -= b_out_sum;
      a_sum -= a_out_sum;

      r_out_sum -= stackIn.r;
      g_out_sum -= stackIn.g;
      b_out_sum -= stackIn.b;
      a_out_sum -= stackIn.a;

      p = x + ((p = y + radiusPlus1) < heightMinus1 ? p : heightMinus1) * width << 2;

      r_sum += r_in_sum += stackIn.r = pixels[p];
      g_sum += g_in_sum += stackIn.g = pixels[p + 1];
      b_sum += b_in_sum += stackIn.b = pixels[p + 2];
      a_sum += a_in_sum += stackIn.a = pixels[p + 3];

      stackIn = stackIn.next;

      r_out_sum += pr = stackOut.r;
      g_out_sum += pg = stackOut.g;
      b_out_sum += pb = stackOut.b;
      a_out_sum += pa = stackOut.a;

      r_in_sum -= pr;
      g_in_sum -= pg;
      b_in_sum -= pb;
      a_in_sum -= pa;

      stackOut = stackOut.next;

      yi += width;
    }
  }
}

function BlurStack() {
  this.r = 0;
  this.g = 0;
  this.b = 0;
  this.a = 0;
  this.next = null;
}

module.exports = {
  stackBlurCanvasRGBA: stackBlurCanvasRGBA
};

/***/ }),
/* 60 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor__ = __webpack_require__(7);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__);






var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor___default()(object, property); if (desc === undefined) { var parent = __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if ("value" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */


var Vector2 = __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Math"].Vector2;

var Sprite = function (_Configurable) {
  _inherits(Sprite, _Configurable);

  function Sprite(operation, options) {
    _classCallCheck(this, Sprite);

    var _this = _possibleConstructorReturn(this, (Sprite.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(Sprite)).call(this, options));

    _this._operation = operation;
    _this._dirtiness = {};
    _this.id = __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Utils"].getUUID();

    _this._renderTextures = {};
    _this._identitySprite = new __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Engine"].Sprite();
    _this._sprite = new __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Engine"].Sprite();

    // Performing hit testing on sprites without a texture doesn't work,
    // so we need to create one that is empty, but does not look empty.
    // Dirty workaround!
    _this._dummyImage = {
      addEventListener: function addEventListener() {},
      removeEventListener: function removeEventListener() {}
    };
    _this._hitTestSprite = new __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Engine"].Sprite();
    _this._renderers = [];
    return _this;
  }

  /**
   * Applies the given scale to this sprite
   * @param  {PhotoEditorSDK.Math.Vector2} scale
   */


  _createClass(Sprite, [{
    key: 'applyScale',
    value: function applyScale(scale) {}

    /**
     * Applies a rotation with the given degrees
     * @param  {Number} degrees
     */

  }, {
    key: 'applyRotation',
    value: function applyRotation(degrees) {
      var inputDimensions = this._operation.getInputDimensions();

      // Update sprite rotation
      var spriteDegrees = this.getRotation() * 180 / Math.PI;
      spriteDegrees += degrees;
      this.setRotation(spriteDegrees * Math.PI / 180);

      var actualDegrees = (degrees + 360) % 360;
      var radians = actualDegrees * Math.PI / 180;

      var cos = Math.cos(radians);
      var sin = Math.sin(radians);

      var relativePosition = this._options.position.clone().subtract(0.5).multiply(inputDimensions);

      var newRelativePosition = new Vector2(relativePosition.x * cos - relativePosition.y * sin, relativePosition.x * sin + relativePosition.y * cos).divide(inputDimensions.clone().flip());

      this.setPosition(new Vector2(0.5, 0.5).add(newRelativePosition));
    }

    /**
     * Applies a flip in the given direction
     * @param  {String} direction
     */

  }, {
    key: 'applyFlip',
    value: function applyFlip(direction) {
      var position = this.getPosition().clone();
      switch (direction) {
        case 'horizontal':
          position.x = 1 - this._options.position.x;
          break;
        case 'vertical':
          position.y = 1 - this._options.position.y;
          break;
      }

      this.setPosition(position);
    }

    /**
     * Applies a transform with the given options
     * @param  {PhotoEditorSDK.Operations.TransformOperation.TransformChange} transformChange
     */

  }, {
    key: 'applyTransform',
    value: function applyTransform(transformChange) {
      var newOptions = {};
      newOptions.rotation = transformChange.applyToRotation(this.getRotation());
      newOptions.position = transformChange.applyToRelativePoint(this.getPosition());
      if (this._options.dimensions) {
        newOptions.dimensions = transformChange.applyToDimensions(this.getDimensions());
      }
      this.set(newOptions, false);
    }

    // -------------------------------------------------------------------------- EVENTS

    /**
     * Returns the DisplayObject of this Sprite
     * @return {PhotoEditorSDK.Engine.Sprite}
     */

  }, {
    key: 'getDisplayObject',
    value: function getDisplayObject() {
      return this._sprite;
    }
  }, {
    key: 'getHitTestDisplayObject',
    value: function getHitTestDisplayObject() {
      return this._sprite;
    }

    /**
     * Returns the texture for the sprite that should be rendered
     * @return {PhotoEditorSDK.Engine.Texture}
     * @private
     * @abstract
     */

  }, {
    key: '_getTexture',
    value: function _getTexture() {
      throw new Error('Sprite#_getTexture is abstract and not implemented in child class.');
    }

    /**
     * Prepares for rendering this sprite to a render texture
     * @param {PhotoEditorSDK} sdk
     * @private
     */

  }, {
    key: '_prepareRenderTexture',
    value: function _prepareRenderTexture(sdk) {
      if (!this._renderTexture) {
        var texture = this._getTexture();
        this._renderTextureContainer = new __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Engine"].Container();
        this._renderTextureSprite = new __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Engine"].Sprite(texture);
        this._renderTextureContainer.addChild(this._renderTextureSprite);
        this._renderTexture = this._getRenderTexture(sdk.getRenderer(), texture.getDimensions());
      } else {
        this._renderTexture.clear();
      }
    }

    /**
     * Checks if this sprite should be rendered to a render texture
     * @param  {PhotoEditorSDK} sdk
     * @return {Boolean}
     * @private
     */

  }, {
    key: '_rendersToRenderTexture',
    value: function _rendersToRenderTexture(sdk) {
      return sdk.getOptions().smoothDownscaling && sdk.getRenderer().isOfType(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["RendererType"].WEBGL);
    }

    /**
     * Checks if the given option has the given value
     * @param  {String} optionName
     * @param  {*} value
     * @return {Boolean}
     * @private
     */

  }, {
    key: '_optionEquals',
    value: function _optionEquals(optionName, value) {
      if (optionName === 'type') {
        return true;
      }

      return _get(Sprite.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(Sprite.prototype), '_optionEquals', this).call(this, optionName, value);
    }

    /**
     * Updates this sprite
     * @param  {PhotoEditorSDK} sdk
     * @param  {PhotoEditorSDK.Math.Vector2} inputDimensions
     */

  }, {
    key: 'update',
    value: function update(sdk, inputDimensions) {
      if (this._rendersToRenderTexture(sdk)) {
        this._prepareRenderTexture(sdk);
        this._renderToRenderTexture(sdk);
      }

      this._updateSprite(inputDimensions);
    }

    /**
     * Updates the sprite's properties according to the options
     * @param {PhotoEditorSDK.Math.Vector2} inputDimensions
     * @private
     */

  }, {
    key: '_updateSprite',
    value: function _updateSprite(inputDimensions) {
      var _this2 = this;

      var sprites = [this._sprite, this._hitTestSprite];
      sprites.forEach(function (sprite) {
        if (!sprite.getTexture()) return;

        sprite.setAnchor(_this2._options.anchor);
        sprite.setPosition(_this2._options.position.clone().multiply(inputDimensions));
        if (typeof _this2._options.alpha !== 'undefined') {
          sprite.setAlpha(_this2._options.alpha);
        }

        var dimensions = _this2._options.dimensions;

        if (dimensions) {
          dimensions = dimensions.clone().multiply(_this2._operation.getSDK().getTextureScale());
          sprite.setWidth(dimensions.x);
          sprite.setHeight(dimensions.y);
        }
        sprite.updateTransform();

        var frame = sprite.getTexture().getFrame();
        var spriteDimensions = new Vector2(frame.width, frame.height);

        sprite.setPivot(_this2._options.pivot.clone().multiply(spriteDimensions));
        sprite.setRotation(_this2._options.rotation);
        sprite.updateTransform();
      });
    }

    /**
     * Renders this sprite to the render texture. If power-of-two textures are enforced,
     * it automatically resizes the texture and updates its UV coordinates accordingly.
     * @param  {PhotoEditorSDK} sdk
     * @private
     */

  }, {
    key: '_renderToRenderTexture',
    value: function _renderToRenderTexture(sdk) {
      var textureDimensions = this._getTexture().getDimensions();
      var renderTexture = this._getRenderTexture(sdk.getRenderer(), textureDimensions);

      var finalDimensions = textureDimensions.clone();
      if (this._options.smoothDownscaling) {
        finalDimensions.x = __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Utils"].nextHighestPOT(finalDimensions.x);
        finalDimensions.y = __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Utils"].nextHighestPOT(finalDimensions.y);
      }

      this._renderTexture.resizeTo(finalDimensions);
      this._renderTexture.render(this._renderTextureContainer);

      if (this._options.smoothDownscaling) {
        var relativeDifference = finalDimensions.clone().subtract(textureDimensions.x, textureDimensions.y).divide(finalDimensions);

        var uvs = renderTexture.getUVs().getUVs();
        uvs[0].x = uvs[3].x = 0;
        uvs[1].x = uvs[2].x = 1 - relativeDifference.x;
        uvs[0].y = uvs[1].y = 0;
        uvs[2].y = uvs[3].y = 1 - relativeDifference.y;
      }

      this._sprite.setTexture(renderTexture);
    }

    /**
     * Checks if this operation is dirty for the given renderer
     * @param  {PhotoEditorSDK.Engine.BaseRenderer}  renderer
     * @return {Boolean}
     */

  }, {
    key: 'isDirtyForRenderer',
    value: function isDirtyForRenderer(renderer) {
      if (!(renderer.id in this._dirtiness)) {
        this._dirtiness[renderer.id] = true;
      }
      return this._dirtiness[renderer.id];
    }

    /**
     * Sets the dirtiness for the given renderer
     * @param {Boolean} dirty
     * @param {PhotoEditorSDK.Engine.BaseRenderer} renderer
     */

  }, {
    key: 'setDirtyForRenderer',
    value: function setDirtyForRenderer(dirty, renderer) {
      this._renderers[renderer.id] = renderer;
      this._dirtiness[renderer.id] = dirty;
    }

    /**
     * Sets the dirtiness for all renderers
     * @param {Boolean} dirty
     */

  }, {
    key: 'setDirty',
    value: function setDirty(dirty) {
      for (var rendererId in this._dirtiness) {
        this.setDirtyForRenderer(dirty, this._renderers[rendererId]);
      }
    }

    /**
     * Creates and/or returns a RenderTexture
     * @param {PhotoEditorSDK.Engine.BaseRenderer} renderer
     * @param {PhotoEditorSDK.Math.Vector2} dimensions = new Vector(100, 100)
     * @return {PhotoEditorSDK.Engine.RenderTexture}
     * @private
     */

  }, {
    key: '_getRenderTexture',
    value: function _getRenderTexture(renderer) {
      var dimensions = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : new Vector2(100, 100);

      if (!this._renderTextures[renderer.id]) {
        this._renderTextures[renderer.id] = new __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Engine"].RenderTexture(renderer, dimensions.x, dimensions.y, 1);
      }
      return this._renderTextures[renderer.id];
    }

    /**
     * Cleans up this Sprite
     */

  }, {
    key: 'dispose',
    value: function dispose() {
      for (var rendererId in this._renderTextures) {
        this._renderTextures[rendererId].dispose();
      }
    }
  }]);

  return Sprite;
}(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Configurable"]);

/* harmony default export */ __webpack_exports__["a"] = (Sprite);

/***/ }),
/* 61 */
/***/ (function(module, exports, __webpack_require__) {

var isObject = __webpack_require__(20);
var document = __webpack_require__(14).document;
// typeof document.createElement is 'object' in old IE
var is = isObject(document) && isObject(document.createElement);
module.exports = function (it) {
  return is ? document.createElement(it) : {};
};


/***/ }),
/* 62 */
/***/ (function(module, exports, __webpack_require__) {

// 7.1.1 ToPrimitive(input [, PreferredType])
var isObject = __webpack_require__(20);
// instead of the ES6 spec version, we didn't implement @@toPrimitive case
// and the second argument - flag - preferred type is a string
module.exports = function (it, S) {
  if (!isObject(it)) return it;
  var fn, val;
  if (S && typeof (fn = it.toString) == 'function' && !isObject(val = fn.call(it))) return val;
  if (typeof (fn = it.valueOf) == 'function' && !isObject(val = fn.call(it))) return val;
  if (!S && typeof (fn = it.toString) == 'function' && !isObject(val = fn.call(it))) return val;
  throw TypeError("Can't convert object to primitive value");
};


/***/ }),
/* 63 */
/***/ (function(module, exports, __webpack_require__) {

var pIE = __webpack_require__(50);
var createDesc = __webpack_require__(35);
var toIObject = __webpack_require__(26);
var toPrimitive = __webpack_require__(62);
var has = __webpack_require__(27);
var IE8_DOM_DEFINE = __webpack_require__(91);
var gOPD = Object.getOwnPropertyDescriptor;

exports.f = __webpack_require__(21) ? gOPD : function getOwnPropertyDescriptor(O, P) {
  O = toIObject(O);
  P = toPrimitive(P, true);
  if (IE8_DOM_DEFINE) try {
    return gOPD(O, P);
  } catch (e) { /* empty */ }
  if (has(O, P)) return createDesc(!pIE.f.call(O, P), O[P]);
};


/***/ }),
/* 64 */
/***/ (function(module, exports) {

// 7.2.1 RequireObjectCoercible(argument)
module.exports = function (it) {
  if (it == undefined) throw TypeError("Can't call method on  " + it);
  return it;
};


/***/ }),
/* 65 */
/***/ (function(module, exports, __webpack_require__) {

// 19.1.2.2 / 15.2.3.5 Object.create(O [, Properties])
var anObject = __webpack_require__(16);
var dPs = __webpack_require__(148);
var enumBugKeys = __webpack_require__(70);
var IE_PROTO = __webpack_require__(68)('IE_PROTO');
var Empty = function () { /* empty */ };
var PROTOTYPE = 'prototype';

// Create object with fake `null` prototype: use iframe Object with cleared prototype
var createDict = function () {
  // Thrash, waste and sodomy: IE GC bug
  var iframe = __webpack_require__(61)('iframe');
  var i = enumBugKeys.length;
  var lt = '<';
  var gt = '>';
  var iframeDocument;
  iframe.style.display = 'none';
  __webpack_require__(94).appendChild(iframe);
  iframe.src = 'javascript:'; // eslint-disable-line no-script-url
  // createDict = iframe.contentWindow.Object;
  // html.removeChild(iframe);
  iframeDocument = iframe.contentWindow.document;
  iframeDocument.open();
  iframeDocument.write(lt + 'script' + gt + 'document.F=Object' + lt + '/script' + gt);
  iframeDocument.close();
  createDict = iframeDocument.F;
  while (i--) delete createDict[PROTOTYPE][enumBugKeys[i]];
  return createDict();
};

module.exports = Object.create || function create(O, Properties) {
  var result;
  if (O !== null) {
    Empty[PROTOTYPE] = anObject(O);
    result = new Empty();
    Empty[PROTOTYPE] = null;
    // add "__proto__" for Object.getPrototypeOf polyfill
    result[IE_PROTO] = O;
  } else result = createDict();
  return Properties === undefined ? result : dPs(result, Properties);
};


/***/ }),
/* 66 */
/***/ (function(module, exports, __webpack_require__) {

// 7.1.15 ToLength
var toInteger = __webpack_require__(67);
var min = Math.min;
module.exports = function (it) {
  return it > 0 ? min(toInteger(it), 0x1fffffffffffff) : 0; // pow(2, 53) - 1 == 9007199254740991
};


/***/ }),
/* 67 */
/***/ (function(module, exports) {

// 7.1.4 ToInteger
var ceil = Math.ceil;
var floor = Math.floor;
module.exports = function (it) {
  return isNaN(it = +it) ? 0 : (it > 0 ? floor : ceil)(it);
};


/***/ }),
/* 68 */
/***/ (function(module, exports, __webpack_require__) {

var shared = __webpack_require__(69)('keys');
var uid = __webpack_require__(51);
module.exports = function (key) {
  return shared[key] || (shared[key] = uid(key));
};


/***/ }),
/* 69 */
/***/ (function(module, exports, __webpack_require__) {

var global = __webpack_require__(14);
var SHARED = '__core-js_shared__';
var store = global[SHARED] || (global[SHARED] = {});
module.exports = function (key) {
  return store[key] || (store[key] = {});
};


/***/ }),
/* 70 */
/***/ (function(module, exports) {

// IE 8- don't enum bug keys
module.exports = (
  'constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf'
).split(',');


/***/ }),
/* 71 */
/***/ (function(module, exports, __webpack_require__) {

// most Object methods by ES6 should accept primitives
var $export = __webpack_require__(15);
var core = __webpack_require__(10);
var fails = __webpack_require__(31);
module.exports = function (KEY, exec) {
  var fn = (core.Object || {})[KEY] || Object[KEY];
  var exp = {};
  exp[KEY] = exec(fn);
  $export($export.S + $export.F * fails(function () { fn(1); }), 'Object', exp);
};


/***/ }),
/* 72 */
/***/ (function(module, exports, __webpack_require__) {

exports.f = __webpack_require__(12);


/***/ }),
/* 73 */
/***/ (function(module, exports, __webpack_require__) {

var global = __webpack_require__(14);
var core = __webpack_require__(10);
var LIBRARY = __webpack_require__(52);
var wksExt = __webpack_require__(72);
var defineProperty = __webpack_require__(18).f;
module.exports = function (name) {
  var $Symbol = core.Symbol || (core.Symbol = LIBRARY ? {} : global.Symbol || {});
  if (name.charAt(0) != '_' && !(name in $Symbol)) defineProperty($Symbol, name, { value: wksExt.f(name) });
};


/***/ }),
/* 74 */
/***/ (function(module, exports) {

exports.f = Object.getOwnPropertySymbols;


/***/ }),
/* 75 */
/***/ (function(module, exports, __webpack_require__) {

// getting tag from 19.1.3.6 Object.prototype.toString()
var cof = __webpack_require__(36);
var TAG = __webpack_require__(12)('toStringTag');
// ES3 wrong here
var ARG = cof(function () { return arguments; }()) == 'Arguments';

// fallback for IE11 Script Access Denied error
var tryGet = function (it, key) {
  try {
    return it[key];
  } catch (e) { /* empty */ }
};

module.exports = function (it) {
  var O, T, B;
  return it === undefined ? 'Undefined' : it === null ? 'Null'
    // @@toStringTag case
    : typeof (T = tryGet(O = Object(it), TAG)) == 'string' ? T
    // builtinTag case
    : ARG ? cof(O)
    // ES3 arguments fallback
    : (B = cof(O)) == 'Object' && typeof O.callee == 'function' ? 'Arguments' : B;
};


/***/ }),
/* 76 */
/***/ (function(module, exports, __webpack_require__) {

var classof = __webpack_require__(75);
var ITERATOR = __webpack_require__(12)('iterator');
var Iterators = __webpack_require__(32);
module.exports = __webpack_require__(10).getIteratorMethod = function (it) {
  if (it != undefined) return it[ITERATOR]
    || it['@@iterator']
    || Iterators[classof(it)];
};


/***/ }),
/* 77 */
/***/ (function(module, exports, __webpack_require__) {

var ctx = __webpack_require__(30);
var invoke = __webpack_require__(174);
var html = __webpack_require__(94);
var cel = __webpack_require__(61);
var global = __webpack_require__(14);
var process = global.process;
var setTask = global.setImmediate;
var clearTask = global.clearImmediate;
var MessageChannel = global.MessageChannel;
var Dispatch = global.Dispatch;
var counter = 0;
var queue = {};
var ONREADYSTATECHANGE = 'onreadystatechange';
var defer, channel, port;
var run = function () {
  var id = +this;
  // eslint-disable-next-line no-prototype-builtins
  if (queue.hasOwnProperty(id)) {
    var fn = queue[id];
    delete queue[id];
    fn();
  }
};
var listener = function (event) {
  run.call(event.data);
};
// Node.js 0.9+ & IE10+ has setImmediate, otherwise:
if (!setTask || !clearTask) {
  setTask = function setImmediate(fn) {
    var args = [];
    var i = 1;
    while (arguments.length > i) args.push(arguments[i++]);
    queue[++counter] = function () {
      // eslint-disable-next-line no-new-func
      invoke(typeof fn == 'function' ? fn : Function(fn), args);
    };
    defer(counter);
    return counter;
  };
  clearTask = function clearImmediate(id) {
    delete queue[id];
  };
  // Node.js 0.8-
  if (__webpack_require__(36)(process) == 'process') {
    defer = function (id) {
      process.nextTick(ctx(run, id, 1));
    };
  // Sphere (JS game engine) Dispatch API
  } else if (Dispatch && Dispatch.now) {
    defer = function (id) {
      Dispatch.now(ctx(run, id, 1));
    };
  // Browsers with MessageChannel, includes WebWorkers
  } else if (MessageChannel) {
    channel = new MessageChannel();
    port = channel.port2;
    channel.port1.onmessage = listener;
    defer = ctx(port.postMessage, port, 1);
  // Browsers with postMessage, skip WebWorkers
  // IE8 has postMessage, but it's sync & typeof its postMessage is 'object'
  } else if (global.addEventListener && typeof postMessage == 'function' && !global.importScripts) {
    defer = function (id) {
      global.postMessage(id + '', '*');
    };
    global.addEventListener('message', listener, false);
  // IE8-
  } else if (ONREADYSTATECHANGE in cel('script')) {
    defer = function (id) {
      html.appendChild(cel('script'))[ONREADYSTATECHANGE] = function () {
        html.removeChild(this);
        run.call(id);
      };
    };
  // Rest old browsers
  } else {
    defer = function (id) {
      setTimeout(ctx(run, id, 1), 0);
    };
  }
}
module.exports = {
  set: setTask,
  clear: clearTask
};


/***/ }),
/* 78 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";

// 25.4.1.5 NewPromiseCapability(C)
var aFunction = __webpack_require__(49);

function PromiseCapability(C) {
  var resolve, reject;
  this.promise = new C(function ($$resolve, $$reject) {
    if (resolve !== undefined || reject !== undefined) throw TypeError('Bad Promise constructor');
    resolve = $$resolve;
    reject = $$reject;
  });
  this.resolve = aFunction(resolve);
  this.reject = aFunction(reject);
}

module.exports.f = function (C) {
  return new PromiseCapability(C);
};


/***/ }),
/* 79 */
/***/ (function(module, exports, __webpack_require__) {

module.exports = { "default": __webpack_require__(185), __esModule: true };

/***/ }),
/* 80 */
/***/ (function(module, exports) {

// Generated by CoffeeScript 1.7.1
(function() {
  var getNanoSeconds, hrtime, loadTime;

  if ((typeof performance !== "undefined" && performance !== null) && performance.now) {
    module.exports = function() {
      return performance.now();
    };
  } else if ((typeof process !== "undefined" && process !== null) && process.hrtime) {
    module.exports = function() {
      return (getNanoSeconds() - loadTime) / 1e6;
    };
    hrtime = process.hrtime;
    getNanoSeconds = function() {
      var hr;
      hr = hrtime();
      return hr[0] * 1e9 + hr[1];
    };
    loadTime = getNanoSeconds();
  } else if (Date.now) {
    module.exports = function() {
      return Date.now() - loadTime;
    };
    loadTime = Date.now();
  } else {
    module.exports = function() {
      return new Date().getTime() - loadTime;
    };
    loadTime = new Date().getTime();
  }

}).call(this);


/***/ }),
/* 81 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__globals__ = __webpack_require__(8);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__utils_canvas_render_target__ = __webpack_require__(57);


var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




/**
 * Manages the filters for a {@link PhotoEditorSDK.Engine.CanvasRenderer}
 * @class
 * @memberof PhotoEditorSDK.Engine
 */

var CanvasFilterManager = function () {
  function CanvasFilterManager(renderer) {
    _classCallCheck(this, CanvasFilterManager);

    this._renderer = renderer;
    this._filterStack = [{
      renderTarget: renderer.getCurrentRenderTarget(),
      filters: []
    }];

    this._currentFrame = null;
    this._textures = [];
    this._textureFrame = new __WEBPACK_IMPORTED_MODULE_1__globals__["h" /* Rectangle */](0, 0, renderer.getWidth(), renderer.getHeight());
  }

  /**
   * Resizes this FilterManager and its textures to the given dimensions
   * @param  {PhotoEditorSDK.Math.Vector2} dimensions
   */


  _createClass(CanvasFilterManager, [{
    key: 'resizeTo',
    value: function resizeTo(dimensions) {
      this._textureFrame.width = dimensions.x;
      this._textureFrame.height = dimensions.y;

      this._textures.forEach(function (texture) {
        return texture.resizeTo(dimensions);
      });
    }

    /**
     * Pushes the given filters to the
     * @param  {PhotoEditorSDK.Engine.DisplayObject} displayObject
     * @param  {Array.<Filter>} filters
     */

  }, {
    key: 'pushFilters',
    value: function pushFilters(displayObject, filters) {
      var bounds = displayObject.getBounds();
      this._currentFrame = bounds;

      var renderTarget = this._getOrCreateRenderTarget();
      this._renderer.setRenderTarget(renderTarget);
      this._filterStack.push({ renderTarget: renderTarget, filters: filters });
      renderTarget.clear();
    }

    /**
     * Removes, applies and returns the last filters from the stack
     * @return {Object}
     */

  }, {
    key: 'popFilters',
    value: function popFilters() {
      var _filterStack$pop = this._filterStack.pop(),
          filters = _filterStack$pop.filters,
          renderTarget = _filterStack$pop.renderTarget;

      var lastFilter = this._filterStack[this._filterStack.length - 1];

      var inputRenderTarget = renderTarget;
      var outputRenderTarget = lastFilter.renderTarget;

      if (filters.length === 1) {
        filters[0].apply(this._renderer, inputRenderTarget, outputRenderTarget);
        this._textures.push(inputRenderTarget);
      } else {
        this._applyFilters(filters, inputRenderTarget, outputRenderTarget);
      }
      return filters;
    }

    /**
     * Applies the given filters to the given inputRenderTarget and outputs
     * the filtered content to the outputRenderTarget
     * @param  {PhotoEditorSDK.Engine.Filter[]} filters
     * @param  {PhotoEditorSDK.Engine.CanvasRenderTarget} inputRenderTarget
     * @param  {PhotoEditorSDK.Engine.CanvasRenderTarget} outputRenderTarget
     * @private
     */

  }, {
    key: '_applyFilters',
    value: function _applyFilters(filters, inputRenderTarget, outputRenderTarget) {
      var _this = this;

      var flipRenderTarget = inputRenderTarget;
      var flopRenderTarget = this._getOrCreateRenderTarget(true);

      var lastFilter = filters[filters.length - 1];
      filters.forEach(function (filter, i) {
        var isLastFilter = filter === lastFilter;

        if (!isLastFilter) {
          // Render from flip to flop with filter
          filter.apply(_this._renderer, flipRenderTarget, flopRenderTarget);

          // Flip the render buffers
          var temp = flipRenderTarget;
          flipRenderTarget = flopRenderTarget;
          flopRenderTarget = temp;
        } else {
          // Render to output
          filter.apply(_this._renderer, flipRenderTarget, outputRenderTarget);
        }
      });

      // Push the textures back into the texture pool to use them again later
      this._textures.push(flipRenderTarget);
      this._textures.push(flopRenderTarget);
    }

    /**
     * Returns a render buffer from the pool or creates a new one
     * @param  {Boolean} clear
     * @return {PhotoEditorSDK.Engine.RenderTexture}
     * @private
     */

  }, {
    key: '_getOrCreateRenderTarget',
    value: function _getOrCreateRenderTarget(clear) {
      var renderTarget = this._textures.pop();
      if (!renderTarget) {
        renderTarget = new __WEBPACK_IMPORTED_MODULE_2__utils_canvas_render_target__["a" /* default */](this._textureFrame.width, this._textureFrame.height, 1);
      }

      if (clear) {
        renderTarget.clear();
      }

      return renderTarget;
    }

    /**
     * Sets the filter stack to the given stack
     * @param {Object[]} filterStack
     */

  }, {
    key: 'setFilterStack',
    value: function setFilterStack(filterStack) {
      this._filterStack = filterStack;
    }

    /**
     * Disposes this CanvasFilterManager
     */

  }, {
    key: 'dispose',
    value: function dispose() {}
  }]);

  return CanvasFilterManager;
}();

/* harmony default export */ __webpack_exports__["a"] = (CanvasFilterManager);

/***/ }),
/* 82 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__globals__ = __webpack_require__(8);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__shader__ = __webpack_require__(83);




function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




var UniformType = __WEBPACK_IMPORTED_MODULE_3__globals__["c" /* Constants */].UniformType;

/**
 * The default texture shader
 * @class
 * @extends PhotoEditorSDK.Engine.Shader
 * @memberof PhotoEditorSDK.Engine
 */
/* istanbul ignore next */

var TextureShader = function (_Shader) {
  _inherits(TextureShader, _Shader);

  /**
   * Creates a TextureShader
   * @param  {PhotoEditorSDK.Engine.BaseRenderer} renderer
   * @param  {String} vertexSource
   * @param  {String} fragmentSource
   */
  function TextureShader(renderer, vertexSource, fragmentSource) {
    _classCallCheck(this, TextureShader);

    vertexSource = vertexSource || TextureShader.defaultVertexSource;
    fragmentSource = fragmentSource || TextureShader.defaultFragmentSource;

    return _possibleConstructorReturn(this, (TextureShader.__proto__ || __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default()(TextureShader)).call(this, renderer, vertexSource, fragmentSource, TextureShader.defaultUniforms, TextureShader.defaultAttributes));
  }

  return TextureShader;
}(__WEBPACK_IMPORTED_MODULE_4__shader__["a" /* default */]);

/**
 * The default vertex shader source code
 * @type {String}
 */


TextureShader.defaultVertexSource = __webpack_require__(199);

/**
 * The default fragment shader source code
 * @type {String}
 */
TextureShader.defaultFragmentSource = __webpack_require__(200);

var matrix = new __WEBPACK_IMPORTED_MODULE_3__globals__["g" /* Matrix */]();

/**
 * The default uniforms
 * @type {Object}
 */
TextureShader.defaultUniforms = {
  u_image: {
    type: UniformType.SAMPLER2D,
    value: 0
  },
  u_projMatrix: {
    type: UniformType.MAT3,
    value: matrix.toArray()
  }

  /**
   * The default WebGL attributes
   * @type {String[]}
   */
};TextureShader.defaultAttributes = ['a_position', 'a_texCoord', 'a_color'];

/* harmony default export */ __webpack_exports__["a"] = (TextureShader);

/***/ }),
/* 83 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_keys__ = __webpack_require__(56);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_keys___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_keys__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__globals__ = __webpack_require__(8);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__constants__ = __webpack_require__(28);



var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */



var Log = __WEBPACK_IMPORTED_MODULE_2__globals__["f" /* Log */],
    Utils = __WEBPACK_IMPORTED_MODULE_2__globals__["i" /* Utils */];

/**
 * Represents a WebGL shader with a vertex shader, a fragment shader, uniforms and attributes
 * @class
 * @memberof PhotoEditorSDK.Engine
 */
/* istanbul ignore next */

var Shader = function () {
  /**
   * Creates a Shader
   * @param  {PhotoEditorSDK.Engine.BaseRenderer} renderer
   * @param  {String} vertexSource
   * @param  {String} fragmentSource
   * @param  {Object} uniforms
   * @param  {String[]} attributes
   */
  function Shader(renderer, vertexSource, fragmentSource, uniforms, attributes) {
    _classCallCheck(this, Shader);

    this._renderer = renderer;
    this._vertexSource = vertexSource;
    this._fragmentSource = fragmentSource;
    this._uniforms = uniforms || {};
    this._uniformLocations = {};
    this._attributes = attributes || [];
    this._attributeLocations = {};

    this._onContextChange = this._onContextChange.bind(this);
    this._renderer.on('context', this._onContextChange);

    this._init();
  }

  /**
   * Compiles this shader and caches the uniform locations
   * @private
   */


  _createClass(Shader, [{
    key: '_init',
    value: function _init() {
      this._compile();

      var gl = this._renderer.getContext();
      gl.useProgram(this._program);

      this._cacheUniformLocations();
      this._cacheAttributeLocations();
    }

    /**
     * Gets called when the attached Renderer changes its context
     * @private
     */

  }, {
    key: '_onContextChange',
    value: function _onContextChange() {
      this._init();
    }

    /**
     * Binds the given buffers for this shader
     * @param {WebGLBuffer} vertexBuffer
     * @param {WebGLBuffer} indexBuffer
     */

  }, {
    key: 'setupBuffers',
    value: function setupBuffers(vertexBuffer, indexBuffer) {
      var gl = this._renderer.getContext();
      gl.bindBuffer(gl.ARRAY_BUFFER, vertexBuffer);
      gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, indexBuffer);

      gl.vertexAttribPointer(this._attributeLocations.a_position, 2, gl.FLOAT, false, __WEBPACK_IMPORTED_MODULE_2__globals__["j" /* VERTEX_BYTE_SIZE */], 0);
      gl.vertexAttribPointer(this._attributeLocations.a_texCoord, 2, gl.FLOAT, false, __WEBPACK_IMPORTED_MODULE_2__globals__["j" /* VERTEX_BYTE_SIZE */], 2 * 4);
      gl.vertexAttribPointer(this._attributeLocations.a_color, 4, gl.UNSIGNED_BYTE, true, __WEBPACK_IMPORTED_MODULE_2__globals__["j" /* VERTEX_BYTE_SIZE */], 4 * 4);
    }

    /**
     * Synchronizes all uniforms with WebGL
     */

  }, {
    key: 'syncUniforms',
    value: function syncUniforms() {
      var _this = this;

      __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_keys___default()(this._uniforms).forEach(function (key) {
        _this.syncUniform(key);
      });
    }

    /**
     * Synchronizes the uniform with the given name
     * @param  {String} name
     */

  }, {
    key: 'syncUniform',
    value: function syncUniform(name) {
      var gl = this._renderer.getContext();
      var uniform = this._uniforms[name];
      var location = this._uniformLocations[name];
      switch (uniform.type) {
        case __WEBPACK_IMPORTED_MODULE_3__constants__["UniformType"].SAMPLER2D:
          gl.uniform1i(location, uniform.value);
          break;
        case __WEBPACK_IMPORTED_MODULE_3__constants__["UniformType"].INT:
        case __WEBPACK_IMPORTED_MODULE_3__constants__["UniformType"].INT1:
          gl.uniform1i(location, uniform.value);
          break;
        case __WEBPACK_IMPORTED_MODULE_3__constants__["UniformType"].FLOAT:
        case __WEBPACK_IMPORTED_MODULE_3__constants__["UniformType"].FLOAT1:
          gl.uniform1f(location, uniform.value);
          break;
        case __WEBPACK_IMPORTED_MODULE_3__constants__["UniformType"].FLOAT2:
          gl.uniform2f(location, uniform.value[0], uniform.value[1]);
          break;
        case __WEBPACK_IMPORTED_MODULE_3__constants__["UniformType"].FLOAT3:
          gl.uniform3f(location, uniform.value[0], uniform.value[1], uniform.value[2]);
          break;
        case __WEBPACK_IMPORTED_MODULE_3__constants__["UniformType"].FLOAT4:
          gl.uniform4f(location, uniform.value[0], uniform.value[1], uniform.value[2], uniform.value[3]);
          break;
        case __WEBPACK_IMPORTED_MODULE_3__constants__["UniformType"].FLOAT_VECTOR2:
          gl.uniform2fv(location, uniform.value);
          break;
        case __WEBPACK_IMPORTED_MODULE_3__constants__["UniformType"].MAT3:
        case __WEBPACK_IMPORTED_MODULE_3__constants__["UniformType"].MAT3FV:
          gl.uniformMatrix3fv(location, false, uniform.value);
          break;
        case __WEBPACK_IMPORTED_MODULE_3__constants__["UniformType"].MAT4:
          gl.uniformMatrix4fv(location, false, uniform.value);
          break;
        default:
          Log.warn(this.constructor.name, 'Unknown uniform type: ' + uniform.type);
      }
    }

    /**
     * Caches the locations for all attributes
     * @private
     */

  }, {
    key: '_cacheAttributeLocations',
    value: function _cacheAttributeLocations() {
      var _this2 = this;

      var gl = this._renderer.getContext();
      this._attributes.forEach(function (name) {
        _this2._attributeLocations[name] = gl.getAttribLocation(_this2._program, name);
      });
    }

    /**
     * Caches the locations for all uniforms
     * @private
     */

  }, {
    key: '_cacheUniformLocations',
    value: function _cacheUniformLocations() {
      var _this3 = this;

      var gl = this._renderer.getContext();
      var keys = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_keys___default()(this._uniforms);
      keys.forEach(function (key) {
        _this3._uniformLocations[key] = gl.getUniformLocation(_this3._program, key);
      });
    }

    /**
     * Adds the preferred precision for the current device to the given shader source
     * @param  {String} source
     * @return {String}
     */

  }, {
    key: '_addPrecisionToSource',
    value: function _addPrecisionToSource(source) {
      var maxFloatPrecision = this._renderer.getMaxFloatPrecision();

      var precision = 'mediump';
      if (Utils.isMobile() && maxFloatPrecision === 'highp') {
        precision = 'highp';
      }

      return 'precision ' + precision + ' float;\n' + source;
    }

    /**
     * Compiles the vertex and fragment sources of this shader
     * @private
     */

  }, {
    key: '_compile',
    value: function _compile() {
      var gl = this._renderer.getContext();

      var vertexShader = this._compileShader(gl.VERTEX_SHADER, this._vertexSource);
      this._vertexShader = vertexShader;

      var fragmentSource = this._addPrecisionToSource(this._fragmentSource);
      var fragmentShader = this._compileShader(gl.FRAGMENT_SHADER, fragmentSource);
      this._fragmentShader = fragmentShader;

      // Create the WebGL program and attach the shaders
      var program = gl.createProgram();
      gl.attachShader(program, vertexShader);
      gl.attachShader(program, fragmentShader);

      // Link the program
      gl.linkProgram(program);

      // Check linking status
      // Check linking status
      var linked = gl.getProgramParameter(program, gl.LINK_STATUS);
      if (!linked) {
        var errorMessage = gl.getProgramInfoLog(program);
        if (gl.isContextLost()) errorMessage = 'WebGL context lost';
        gl.deleteProgram(program);
        Log.error(this.constructor.name, 'WebGL program linking error: ' + errorMessage);
      }

      this._program = program;
    }

    /**
     * Creates and compiles a shader with the given type and source
     * @param  {Number} shaderType
     * @param  {String} shaderSource
     * @return {WebGLShader}
     * @private
     */

  }, {
    key: '_compileShader',
    value: function _compileShader(shaderType, shaderSource) {
      var gl = this._renderer.getContext();

      // Create the shader and compile it
      var shader = gl.createShader(shaderType);
      gl.shaderSource(shader, shaderSource);
      gl.compileShader(shader);

      // Check compilation status
      var compiled = gl.getShaderParameter(shader, gl.COMPILE_STATUS);
      if (!compiled) {
        var errorMessage = gl.getShaderInfoLog(shader);
        if (gl.isContextLost()) errorMessage = 'WebGL context lost';
        gl.deleteShader(shader);
        Log.error(this.constructor.name, 'WebGL shader compilation error: ' + errorMessage);
      }

      return shader;
    }

    /**
     * Sets the given uniform to the given value
     * @param {String} name
     * @param {*} value
     * @param {Boolean} sync = false
     */

  }, {
    key: 'setUniform',
    value: function setUniform(name, value) {
      var sync = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;

      this._uniforms[name].value = value;
      if (sync) {
        this.syncUniform(name);
      }
    }

    /**
     * Sets the given uniforms to their values
     * @param {Object}  uniforms
     * @param {Boolean} sync = false
     */

  }, {
    key: 'setUniforms',
    value: function setUniforms(uniforms) {
      var sync = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;

      for (var name in uniforms) {
        this._uniforms[name].value = uniforms[name];
        if (sync) {
          this.syncUniform(name);
        }
      }
    }

    /**
     * Returns the uniforms
     * @return {Object}
     */

  }, {
    key: 'getUniforms',
    value: function getUniforms() {
      return this._uniforms;
    }

    /**
     * Returns the attributes
     * @return {String[]}
     */

  }, {
    key: 'getAttributes',
    value: function getAttributes() {
      return this._attributes;
    }

    /**
     * Returns the attribute locations
     * @return {Object}
     */

  }, {
    key: 'getAttributeLocations',
    value: function getAttributeLocations() {
      return this._attributeLocations;
    }

    /**
     * Returns this shader's WebGL program
     * @return {WebGLProgram}
     */

  }, {
    key: 'getProgram',
    value: function getProgram() {
      return this._program;
    }

    /**
     * Cleans up this shader
     */

  }, {
    key: 'dispose',
    value: function dispose() {
      var gl = this._renderer.getContext();
      gl.deleteProgram(this._program);

      gl.deleteShader(this._vertexShader);
      gl.deleteShader(this._fragmentShader);

      this._uniforms = null;
      this._uniformLocations = null;
      this._attributes = null;
      this._attributeLocations = null;

      this._renderer.off('context', this._onContextChange);
    }
  }]);

  return Shader;
}();

/* harmony default export */ __webpack_exports__["a"] = (Shader);

/***/ }),
/* 84 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__globals__ = __webpack_require__(8);


var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */



/**
 * The base class for all objects that can be displayed
 * on the screen
 * @class
 * @memberof PhotoEditorSDK.Engine
 */

var DisplayObject = function () {
  /**
   * Creates a DisplayObject
   */
  function DisplayObject() {
    _classCallCheck(this, DisplayObject);

    this._position = new __WEBPACK_IMPORTED_MODULE_1__globals__["k" /* Vector2 */](0, 0);
    this._scale = new __WEBPACK_IMPORTED_MODULE_1__globals__["k" /* Vector2 */](1, 1);
    this._pivot = new __WEBPACK_IMPORTED_MODULE_1__globals__["k" /* Vector2 */](0, 0);
    this._rotation = 0;
    this._lastRotation = null;
    this._alpha = 1;
    this._visible = true;
    this._worldTransform = new __WEBPACK_IMPORTED_MODULE_1__globals__["g" /* Matrix */]();
    this._parent = null;
    this._shaders = [];
    this._boundsNeedUpdate = true;
    this._bounds = new __WEBPACK_IMPORTED_MODULE_1__globals__["h" /* Rectangle */](0, 0, 1, 1);
    this._localBoundsNeedUpdate = true;
    this._localBounds = new __WEBPACK_IMPORTED_MODULE_1__globals__["h" /* Rectangle */](0, 0, 1, 1);
    this._tint = 0xffffff;
    this._filterRectangle = new __WEBPACK_IMPORTED_MODULE_1__globals__["h" /* Rectangle */](0, 0, 0, 0);
  }

  /**
   * Renders this DisplayObject using the given WebGLRenderer
   * @param  {PhotoEditorSDK.Engine.WebGLRenderer} renderer
   * @abstract
   */


  _createClass(DisplayObject, [{
    key: 'renderWebGL',
    value: function renderWebGL(renderer) {
      __WEBPACK_IMPORTED_MODULE_1__globals__["f" /* Log */].warn(this.constructor.name, '`renderWebGL` is abstract and not implemented in inherited class');
    }

    /**
     * Renders this DisplayObject using the given CanvasRenderer
     * @param  {PhotoEditorSDK.Engine.CanvasRenderer} renderer
     * @abstract
     */

  }, {
    key: 'renderCanvas',
    value: function renderCanvas(renderer) {
      __WEBPACK_IMPORTED_MODULE_1__globals__["f" /* Log */].warn(this.constructor.name, '`renderCanvas` is abstract and not implemented in inherited class');
    }

    /**
     * Updates the world transform for this DisplayObject
     */

  }, {
    key: 'updateTransform',
    value: function updateTransform() {
      var parentTransform = this._parent ? this._parent.getWorldTransform() : __WEBPACK_IMPORTED_MODULE_1__globals__["g" /* Matrix */].IDENTITY;
      var worldTransform = this._worldTransform;

      // Only build rotation matrix if rotation has changed since last update
      var rotationChanged = this._rotation !== this._lastRotation;
      if (rotationChanged) {
        this._sinRotation = Math.sin(this._rotation);
        this._cosRotation = Math.cos(this._rotation);
        this._lastRotation = this._rotation;
      }

      worldTransform.a = this._cosRotation * this._scale.x;
      worldTransform.b = this._sinRotation * this._scale.x;
      worldTransform.c = -this._sinRotation * this._scale.y;
      worldTransform.d = this._cosRotation * this._scale.y;
      worldTransform.tx = this._position.x;
      worldTransform.ty = this._position.y;

      if (this._pivot.x || this._pivot.y) {
        worldTransform.tx -= this._pivot.x * worldTransform.a + this._pivot.y * worldTransform.c;
        worldTransform.ty -= this._pivot.x * worldTransform.b + this._pivot.y * worldTransform.d;
      }

      // Floor
      worldTransform.tx |= 0;
      worldTransform.ty |= 0;

      worldTransform.multiply(parentTransform);

      this._boundsNeedUpdate = true;
      this._localBoundsNeedUpdate = true;
    }

    // -------------------------------------------------------------------------- SHADERS

    /**
     * Pushes the given shader to the list of shaders
     * @param {PhotoEditorSDK.Engine.Shader} shader
     */

  }, {
    key: 'addShader',
    value: function addShader(shader) {
      this._shaders.push(shader);
    }

    /**
     * Removes the given shader from the list of shaders
     * @param  {PhotoEditorSDK.Engine.Shader} shader
     * @return {Boolean}
     */

  }, {
    key: 'removeShader',
    value: function removeShader(shader) {
      var index = this._shaders.indexOf(shader);
      if (index !== -1) {
        this._shaders.splice(index, 1);
        return true;
      }
      return false;
    }

    /**
     * Removes the shader at the given index from the list of shaders
     * @param  {Number} index
     * @return {Boolean}
     */

  }, {
    key: 'removeShaderAt',
    value: function removeShaderAt(index) {
      if (!this._shaders[index]) {
        return false;
      }
      this._shaders.splice(index, 1);
      return true;
    }

    /**
     * Returns the bounds for this DisplayObject
     * @return {PhotoEditorSDK.Math.Rectangle}
     */

  }, {
    key: 'getBounds',
    value: function getBounds() {
      return this._bounds.clone();
    }

    // -------------------------------------------------------------------------- GETTERS / SETTERS

    /**
     * Returns the current position
     * @return {PhotoEditorSDK.Math.Vector2}
     */

  }, {
    key: 'getPosition',
    value: function getPosition() {
      return this._position;
    }

    /**
     * Sets the position to the given one
     * @param {PhotoEditorSDK.Math.Vector2|Number} x
     * @param {Number} [y]
     */

  }, {
    key: 'setPosition',
    value: function setPosition(position, y) {
      if (position instanceof __WEBPACK_IMPORTED_MODULE_1__globals__["k" /* Vector2 */]) {
        this._position.copy(position);
      } else {
        this._position.set(position, y);
      }
      this._boundsNeedUpdate = true;
      this._localBoundsNeedUpdate = true;
    }

    /**
     * Returns the current scale
     * @return {PhotoEditorSDK.Math.Vector2}
     */

  }, {
    key: 'getScale',
    value: function getScale() {
      return this._scale;
    }

    /**
     * Sets the scale to the given one
     * @param {PhotoEditorSDK.Math.Vector2|Number} x
     * @param {Number} [y]
     */

  }, {
    key: 'setScale',
    value: function setScale(scale, y) {
      if (scale instanceof __WEBPACK_IMPORTED_MODULE_1__globals__["k" /* Vector2 */]) {
        this._scale.copy(scale);
      } else {
        this._scale.set(scale, y);
      }
      this._boundsNeedUpdate = true;
      this._localBoundsNeedUpdate = true;
    }

    /**
     * Returns the current pivot (The point that this Displayobject rotates around)
     * @return {PhotoEditorSDK.Math.Vector2}
     */

  }, {
    key: 'getPivot',
    value: function getPivot() {
      return this._pivot;
    }

    /**
     * Sets the pivot (The point that this DisplayObject rotates around)
     * @param {PhotoEditorSDK.Math.Vector2|Number} pivot
     * @param {Number} [y]
     */

  }, {
    key: 'setPivot',
    value: function setPivot(pivot, y) {
      if (pivot instanceof __WEBPACK_IMPORTED_MODULE_1__globals__["k" /* Vector2 */]) {
        this._pivot.copy(pivot);
      } else {
        this._pivot.set(pivot, y);
      }
      this._boundsNeedUpdate = true;
      this._localBoundsNeedUpdate = true;
    }

    /**
     * Returns the current rotation in radians
     * @return {Number}
     */

  }, {
    key: 'getRotation',
    value: function getRotation() {
      return this._rotation;
    }

    /**
     * Sets this object's rotation (in radians)
     * @param {Number} rotation
     */

  }, {
    key: 'setRotation',
    value: function setRotation(rotation) {
      this._rotation = rotation;
      this._boundsNeedUpdate = true;
      this._localBoundsNeedUpdate = true;
    }

    /**
     * Returns the current alpha (0...1)
     * @return {Number}
     */

  }, {
    key: 'getAlpha',
    value: function getAlpha() {
      return this._alpha;
    }

    /**
     * Sets the alpha (0...1)
     * @param {Number} alpha
     */

  }, {
    key: 'setAlpha',
    value: function setAlpha(alpha) {
      this._alpha = alpha;
    }

    /**
     * Returns the computed alpha of this DisplayObject
     * @return {Number}
     */

  }, {
    key: 'getWorldAlpha',
    value: function getWorldAlpha() {
      if (this._parent) {
        return this._parent.getAlpha() * this._alpha;
      } else {
        return this._alpha;
      }
    }

    /**
     * Returns the current world transformation matrix
     * @return {PhotoEditorSDK.Math.Matrix}
     */

  }, {
    key: 'getWorldTransform',
    value: function getWorldTransform() {
      return this._worldTransform;
    }

    /**
     * Returns the parent object
     * @return {PhotoEditorSDK.Engine.DisplayObject}
     */

  }, {
    key: 'getParent',
    value: function getParent() {
      return this._parent;
    }

    /**
     * Sets this object's parent object
     * @param {PhotoEditorSDK.Engine.DisplayObject} parent
     */

  }, {
    key: 'setParent',
    value: function setParent(parent) {
      this._parent = parent;
    }

    /**
     * Returns the filter rectangle
     * @return {PhotoEditorSDK.Math.Rectangle} rectangle
     */

  }, {
    key: 'getFilterRectangle',
    value: function getFilterRectangle() {
      return this._filterRectangle;
    }

    /**
     * Sets the filter rectangle
     * @param {PhotoEditorSDK.Math.Rectangle} rectangle
     */

  }, {
    key: 'setFilterRectangle',
    value: function setFilterRectangle(rectangle) {
      this._filterRectangle.copy(rectangle);
    }

    /**
     * Returns the current tint color
     * @return {Number}
     */

  }, {
    key: 'getTint',
    value: function getTint() {
      return this._tint;
    }

    /**
     * Sets the tint color
     * @param {Number} tint
     */

  }, {
    key: 'setTint',
    value: function setTint(tint) {
      this._tint = tint;
    }

    /**
     * Checks whether this object is currently visible
     * @return {Boolean} [description]
     */

  }, {
    key: 'isVisible',
    value: function isVisible() {
      return this._visible;
    }

    /**
     * Sets this object's visibility
     * @param {Boolean} visible
     */

  }, {
    key: 'setVisible',
    value: function setVisible(visible) {
      this._visible = visible;
    }
  }]);

  return DisplayObject;
}();

/* harmony default export */ __webpack_exports__["a"] = (DisplayObject);

/***/ }),
/* 85 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__globals__ = __webpack_require__(8);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__utils_webgl_render_target__ = __webpack_require__(58);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__utils_quad__ = __webpack_require__(201);


var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */





var RendererType = __WEBPACK_IMPORTED_MODULE_1__globals__["c" /* Constants */].RendererType;

/**
 * Manages the filters for a {@link PhotoEditorSDK.Engine.WebGLRenderer}
 * @class
 * @memberof PhotoEditorSDK.Engine
 */
/* istanbul ignore next */

var WebGLFilterManager = function () {
  function WebGLFilterManager(renderer) {
    _classCallCheck(this, WebGLFilterManager);

    this._renderer = renderer;
    this._filterStack = [{
      filters: []
    }];

    this._currentFrame = null;
    this._renderTargets = [];
    this._textureFrame = new __WEBPACK_IMPORTED_MODULE_1__globals__["h" /* Rectangle */](0, 0, renderer.getWidth(), renderer.getHeight());

    this._onContextChange = this._onContextChange.bind(this);
    this._renderer.on('context', this._onContextChange);

    // Initial context
    this._onContextChange();
  }

  /**
   * Resizes this FilterManager and its textures to the given dimensions
   * @param  {PhotoEditorSDK.Math.Vector2} dimensions
   */


  _createClass(WebGLFilterManager, [{
    key: 'resizeTo',
    value: function resizeTo(dimensions) {
      this._textureFrame.width = dimensions.x;
      this._textureFrame.height = dimensions.y;

      this._renderTargets.forEach(function (texture) {
        return texture.resizeTo(dimensions);
      });
    }

    /**
     * Returns the filter stack
     * @return {Object[]}
     */

  }, {
    key: 'getFilterStack',
    value: function getFilterStack() {
      return this._filterStack;
    }

    /**
     * Sets the filter stack to the given stack
     * @param {Object[]} filterStack
     */

  }, {
    key: 'setFilterStack',
    value: function setFilterStack(filterStack) {
      this._filterStack = filterStack;
    }

    /**
     * Returns a render target from the pool or creates a new one
     * @param  {Boolean} clear
     * @return {PhotoEditorSDK.Engine.WebGLRenderTarget}
     * @private
     */

  }, {
    key: '_getOrCreateRenderTarget',
    value: function _getOrCreateRenderTarget(clear) {
      var renderTarget = this._renderTargets.pop();
      if (!renderTarget) {
        renderTarget = new __WEBPACK_IMPORTED_MODULE_2__utils_webgl_render_target__["a" /* default */](this._renderer, this._textureFrame.width, this._textureFrame.height, 1);
      }
      renderTarget.setFrame(this._currentFrame);

      if (clear) {
        renderTarget.clear();
      }

      return renderTarget;
    }

    /**
     * Pushes the given filters to the
     * @param  {PhotoEditorSDK.Engine.DisplayObject} displayObject
     * @param  {PhotoEditorSDK.Engine.Filter[]} filters
     */

  }, {
    key: 'pushFilters',
    value: function pushFilters(displayObject, filters) {
      var bounds = displayObject.getBounds();
      this._currentFrame = bounds;

      var filterRectangle = displayObject.getFilterRectangle();
      if (filterRectangle.width > 0 && filterRectangle.height > 0) {
        this._currentFrame = filterRectangle;
      }

      var renderTarget = this._getOrCreateRenderTarget();
      this._renderer.setRenderTarget(renderTarget);
      renderTarget.clear();

      this._filterStack.push({ renderTarget: renderTarget, filters: filters });
    }

    /**
     * Removes, applies and returns the last filters from the stack
     * @return {Object}
     */

  }, {
    key: 'popFilters',
    value: function popFilters() {
      var _filterStack$pop = this._filterStack.pop(),
          filters = _filterStack$pop.filters,
          renderTarget = _filterStack$pop.renderTarget;

      var lastFilter = this._filterStack[this._filterStack.length - 1];

      var inputRenderTarget = renderTarget;
      var outputRenderTarget = lastFilter.renderTarget;

      // Update the Quad's buffers
      this._quad.map(this._textureFrame, inputRenderTarget.getFrame());

      var shader = filters[0].getShaderForRenderer(this._renderer);
      var vertexBuffer = this._quad.getVertexBuffer();
      var indexBuffer = this._quad.getIndexBuffer();

      var gl = this._renderer.getContext();
      gl.bindBuffer(gl.ARRAY_BUFFER, vertexBuffer);
      gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, indexBuffer);

      var attributeLocations = shader.getAttributeLocations();
      gl.vertexAttribPointer(attributeLocations.a_position, 2, gl.FLOAT, false, 0, 0);
      gl.vertexAttribPointer(attributeLocations.a_texCoord, 2, gl.FLOAT, false, 0, 2 * 4 * 4);
      gl.vertexAttribPointer(attributeLocations.a_color, 4, gl.FLOAT, false, 0, 4 * 4 * 4);

      this._renderer.updateTexture(inputRenderTarget.getBaseTexture(), false);

      if (filters.length === 1) {
        filters[0].apply(this._renderer, inputRenderTarget, outputRenderTarget);
        this._renderTargets.push(inputRenderTarget);
      } else {
        this._applyFilters(filters, inputRenderTarget, outputRenderTarget);
      }

      return filters;
    }

    /**
     * Applies the given filters to the given inputRenderTarget and outputs
     * the filtered content to the outputRenderTarget
     * @param  {PhotoEditorSDK.Engine.Filter[]} filters
     * @param  {PhotoEditorSDK.Engine.WebGLRenderTarget} inputRenderTarget
     * @param  {PhotoEditorSDK.Engine.WebGLRenderTarget} outputRenderTarget
     */

  }, {
    key: '_applyFilters',
    value: function _applyFilters(filters, inputRenderTarget, outputRenderTarget) {
      var _this = this;

      var flipRenderTarget = inputRenderTarget;
      var flopRenderTarget = this._getOrCreateRenderTarget(true);

      this._renderer.updateTexture(flopRenderTarget.getBaseTexture(), false);

      var lastFilter = filters[filters.length - 1];
      filters.forEach(function (filter, i) {
        var isLastFilter = filter === lastFilter;

        if (!isLastFilter) {
          // Render from flip to flop with filter
          filter.apply(_this._renderer, flipRenderTarget, flopRenderTarget);

          // Flip the render targets
          var temp = flipRenderTarget;
          flipRenderTarget = flopRenderTarget;
          flopRenderTarget = temp;
        } else {
          // Render to output
          filter.apply(_this._renderer, flipRenderTarget, outputRenderTarget);
        }
      });

      // Push the textures back into the texture pool to use them again later
      this._renderTargets.push(flipRenderTarget);
      this._renderTargets.push(flopRenderTarget);
    }

    /**
     * Gets called when the WebGL context has been changed
     * @private
     */

  }, {
    key: '_onContextChange',
    value: function _onContextChange() {
      this._renderTargets.length = 0;
      /* istanbul ignore next */
      if (this._renderer.isOfType(RendererType.WEBGL)) {
        if (this._quad) {
          this._quad.dispose();
        }
        this._quad = new __WEBPACK_IMPORTED_MODULE_3__utils_quad__["a" /* default */](this._renderer);
      }
    }

    /**
     * Disposes this WebGLFilterManager
     */

  }, {
    key: 'dispose',
    value: function dispose() {
      this._renderer.off('context', this._onContextChange);
      if (this._quad) {
        this._quad.dispose();
      }
      this._renderTargets.forEach(function (target) {
        target.dispose();
      });
    }
  }]);

  return WebGLFilterManager;
}();

/* harmony default export */ __webpack_exports__["a"] = (WebGLFilterManager);

/***/ }),
/* 86 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__base64__ = __webpack_require__(43);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__array_stream__ = __webpack_require__(87);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__utils__ = __webpack_require__(24);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__jpeg_constants__ = __webpack_require__(88);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__jpeg_jfif_data__ = __webpack_require__(227);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__jpeg_exif_data__ = __webpack_require__(228);


var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/*
 * Based on https://github.com/exif-js/exif-js by Jacob Seidelin
 * Licensed under MIT
 * @license
 */

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */








var invariant = __WEBPACK_IMPORTED_MODULE_3__utils__["a" /* default */].invariant;
var MARKERS = __WEBPACK_IMPORTED_MODULE_4__jpeg_constants__["a" /* default */].MARKERS;


var DATA_JPEG_PREFIX = 'data:image/jpeg;base64,';
var JPEG_REGEX = new RegExp('^' + DATA_JPEG_PREFIX, 'i');

/**
 * Reads EXIF tags from the given byte array and restores them
 * @class
 * @memberof PhotoEditorSDK
 * @ignore
 */

var EXIF = function () {
  /**
   * Creates an EXIF object
   * @param  {Array} buf
   */
  function EXIF(buf) {
    _classCallCheck(this, EXIF);

    this._buf = buf;
    this._stream = new __WEBPACK_IMPORTED_MODULE_2__array_stream__["a" /* default */](this._buf);
    this._stream.setHead(0);

    this._segments = this._sliceIntoSegments(this._buf);

    this._exifData = new __WEBPACK_IMPORTED_MODULE_6__jpeg_exif_data__["a" /* default */](this._getMarkerBuffer(MARKERS.EXIF));
    this._jfifData = new __WEBPACK_IMPORTED_MODULE_5__jpeg_jfif_data__["a" /* default */](this._getMarkerBuffer(MARKERS.JFIF));
  }

  /**
   * Convert raw data buffer to base64 encoded data url
   * @param {Uint8Array}
   * @returns {String}
   */


  _createClass(EXIF, [{
    key: 'restoreSegments',


    /**
     * Restores the header segments into the given data url
     * @return {string} data
     */
    value: function restoreSegments(base64String) {
      var data = EXIF.fromDataURL(base64String);
      data = this.restoreExifTagsToImageData(data);
      data = this.restoreJfifSegmentToImageData(data);
      return EXIF.toDataURL(data);
    }

    /**
     * Restores the exif tags into the given data url
     * @return {Uint8Array} data
     */

  }, {
    key: 'restoreExifTagsToImageData',
    value: function restoreExifTagsToImageData(data) {
      if (!this._exifData.isValid()) {
        return data;
      }
      var segments = this._sliceIntoSegments(data);
      var segmentStart = segments[1][0];
      var dataBefore = data.slice(0, segmentStart);
      var dataAfter = data.slice(segmentStart);
      var newData = dataBefore.concat(this._exifData.getBuffer()); // copy exifdata
      newData = newData.concat(dataAfter);
      return newData;
    }

    /**
     * Restores the JFIF Header data into the given data url
     * @return {Uint8Array} base64String
     */

  }, {
    key: 'restoreJfifSegmentToImageData',
    value: function restoreJfifSegmentToImageData(data) {
      if (!this._jfifData.isValid()) {
        return data;
      }
      // First, make the given string a data array
      var segments = this._sliceIntoSegments(data);

      var segment = this._findSegment(MARKERS.JFIF, segments);
      invariant(segment, 'JFIF Data Error: Segment not found');

      // we have one and just need to update it
      var offset = segment[0];
      var end = segment[1];
      var dataBefore = data.slice(0, offset);
      var dataBuf = data.slice(offset, end);
      var dataAfter = data.slice(end);

      var jfifData = new __WEBPACK_IMPORTED_MODULE_5__jpeg_jfif_data__["a" /* default */](dataBuf);
      jfifData.setDensityX(this._jfifData.getDensityX());
      jfifData.setDensityY(this._jfifData.getDensityY());
      jfifData.setUnitDensity(this._jfifData.getUnitDensity());

      // update DataBuf
      var newData = dataBefore.concat(dataBuf);
      newData = newData.concat(dataAfter);
      return newData;
    }

    /**
     * Restores the exif tags into the given data url
     * @return {String} base64String
     */

  }, {
    key: 'restoreExifTags',
    value: function restoreExifTags(base64String) {
      // First, make the given string a data array
      var data = EXIF.fromDataURL(base64String);
      var newData = this.restoreExifTagsToImageData(data);
      return EXIF.toDataURL(newData);
    }

    /**
     * Restores the JFIF Header data into the given data url
     * @return {String} base64String
     */

  }, {
    key: 'restoreJfifSegment',
    value: function restoreJfifSegment(base64String) {
      if (!this._jfifData.isValid()) {
        return base64String;
      }
      var data = EXIF.fromDataURL(base64String);
      var newData = this.restoreJfifSegmentToImageData(data);
      return EXIF.toDataURL(newData);
    }

    /**
     * Overwrites the orientation with the given 16 bit integer
     * @param {Number} orientation
     */

  }, {
    key: 'setOrientation',
    value: function setOrientation(orientation) {
      return this._exifData.setOrientation(orientation);
    }

    /**
     * Checks whether the given base64 data url is a jpeg image
     * @param  {String}  base64String
     * @return {Boolean}
     */

  }, {
    key: '_findSegment',


    /**
     *
     * @param {String} identifier
     * @param {Object[]} segments
     */
    value: function _findSegment(identifier) {
      var segments = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : this._segments;

      for (var i = 0; i < segments.length; i++) {
        var offset = segments[i][0];
        var end = segments[i][1];
        this._stream.setHead(offset);
        var marker = this._stream.peekInt16();
        if (marker === identifier) {
          return [offset, end];
        }
      }
      return false;
    }

    /**
     * Returns a new buffer containing the Exif segment
     * @return {Array}
     * @private
     */

  }, {
    key: '_getMarkerBuffer',
    value: function _getMarkerBuffer(identifier) {
      var segments = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : this._segments;

      var segment = this._findSegment(identifier, segments);
      if (segment) {
        var offset = segment[0];
        var end = segment[1];
        return this._buf.slice(offset, end);
      }
      return false;
    }

    /**
     * Slices the array into segments
     * @param  {Array.<Number>} buf
     * @return {Array}
     * @private
     */

  }, {
    key: '_sliceIntoSegments',
    value: function _sliceIntoSegments(buf) {
      var stream = new __WEBPACK_IMPORTED_MODULE_2__array_stream__["a" /* default */](buf);
      var segments = [];
      while (stream.getHead() < buf.length) {
        var marker = stream.readInt16();
        if (marker === MARKERS.SOI) {
          continue;
        } // SOI
        if (marker === MARKERS.SOS) {
          break;
        } // SOS Marker

        if (marker >= 0xff00 && marker <= 0xffff) {
          // Marker (FF-XX-HL-LL)
          var length = stream.readInt16();
          var end = stream.getHead() + length - 2;
          segments.push([stream.getHead() - 4, end]);
          stream.setHead(end);
        } else {
          throw new Error('Invalid marker: 0x' + marker.toString(16));
        }
      }

      this._stream.setHead(0);

      return segments;
    }

    /**
     * Returns the tags
     * @return {Object}
     */

  }, {
    key: 'getTags',
    value: function getTags() {
      return this._exifData.getTags();
    }

    /**
     * Returns the tag data (key, value, byte position etc.)
     * @return {Object[]}
     */

  }, {
    key: 'getTagData',
    value: function getTagData() {
      return this._exifData.getTagData();
    }

    /**
     * Disposes this EXIF object
     */

  }, {
    key: 'dispose',
    value: function dispose() {
      this._buf = [];
      this._segments = [];
    }
  }], [{
    key: 'toDataURL',
    value: function toDataURL(data) {
      return DATA_JPEG_PREFIX + __WEBPACK_IMPORTED_MODULE_1__base64__["a" /* default */].encode(data);
    }

    /**
     * Convert base64 encoded data url to raw binary data
     * @param {String} dataURL
     * @returns {Uint8Array}
     */

  }, {
    key: 'fromDataURL',
    value: function fromDataURL(dataURL) {
      var raw = dataURL.replace(DATA_JPEG_PREFIX, '');
      var data = __WEBPACK_IMPORTED_MODULE_1__base64__["a" /* default */].decode(raw);
      return data;
    }
  }, {
    key: 'isJPEG',
    value: function isJPEG(base64String) {
      return JPEG_REGEX.test(base64String);
    }

    /**
     * Checks whether the given buffer is a JPEG image
     * @param  {Buffer} data
     * @return {Boolean}
     */

  }, {
    key: 'bufferIsJPEG',
    value: function bufferIsJPEG(data) {
      return data.slice(6, 10).toString() === 'JFIF';
    }

    /**
     * Creates a new instance of Exif from the given base64-encoded
     * string
     * @param  {String} base64String
     * @return {PhotoEditorSDK.Exif}
     */

  }, {
    key: 'fromBase64String',
    value: function fromBase64String(base64String) {
      var raw = base64String.replace(DATA_JPEG_PREFIX, '');
      var data = __WEBPACK_IMPORTED_MODULE_1__base64__["a" /* default */].decode(raw);
      return new EXIF(data);
    }
  }]);

  return EXIF;
}();

/* harmony default export */ __webpack_exports__["a"] = (EXIF);

/***/ }),
/* 87 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);


var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */

/**
 * An ArrayStream provides methods for working with a byte array
 * @class
 * @memberof PhotoEditorSDK
 * @ignore
 */
/* istanbul ignore next */
var ArrayStream = function () {
  /**
   * Creates an ArrayStream
   * @param  {Array} buf
   */
  function ArrayStream(buf) {
    _classCallCheck(this, ArrayStream);

    this._head = 0;
    this._buf = buf;
  }

  /**
   * Returns the value of the following 8 bit integer
   * @return {Number}
   */


  _createClass(ArrayStream, [{
    key: 'peekInt8',
    value: function peekInt8() {
      return this._buf[this._head];
    }

    /**
     * Returns the value of the following 16 bit integer
     * @param  {Boolean} [littleEndian = false]
     * @return {Number}
     */

  }, {
    key: 'peekInt16',
    value: function peekInt16() {
      var littleEndian = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;

      var a = this._buf[this._head];
      var b = this._buf[this._head + 1];
      if (!littleEndian) {
        return (a << 8) + b;
      } else {
        return (b << 8) + a;
      }
    }

    /**
     * Returns the value of the following 24 bit integer
     * @param  {Boolean} [littleEndian = false]
     * @return {Number}
     */

  }, {
    key: 'peekInt24',
    value: function peekInt24() {
      var littleEndian = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;

      var a = this._buf[this._head];
      var b = this._buf[this._head + 1];
      var c = this._buf[this._head + 2];
      if (!littleEndian) {
        return (a << 16) + (b << 8) + c;
      } else {
        return (c << 16) + (b << 8) + a;
      }
    }

    /**
     * Returns the value of the following 32 bit integer
     * @param  {Boolean} [littleEndian = false]
     * @return {Number}
     */

  }, {
    key: 'peekInt32',
    value: function peekInt32() {
      var littleEndian = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;

      var a = this._buf[this._head];
      var b = this._buf[this._head + 1];
      var c = this._buf[this._head + 2];
      var d = this._buf[this._head + 3];
      if (!littleEndian) {
        return (a << 32) + (b << 16) + (c << 8) + d;
      } else {
        return (d << 32) + (c << 16) + (b << 8) + a;
      }
    }

    /**
     * Writes the given 16 bit integer at the current head position
     * @param  {Number} num
     */

  }, {
    key: 'writeInt8',
    value: function writeInt8(num) {
      this._buf[this._head] = num & 0xff;
    }
    /**
     * Writes the given 16 bit integer at the current head position
     * @param  {Number} num
     */

  }, {
    key: 'writeInt16',
    value: function writeInt16(num) {
      this._buf[this._head] = num >> 8; // upper
      this._buf[this._head + 1] = num & 0xff; // lower
    }

    /**
     * Returns the value of the following 8 bit integer and moves the head by 1 byte
     * @return {Number}
     */

  }, {
    key: 'readInt8',
    value: function readInt8() {
      var num = this.peekInt8();
      this._head += 1;
      return num;
    }

    /**
     * Returns the value of the following 16 bit integer and moves the head by 2 bytes
     * @param  {Boolean} [littleEndian = false]
     * @return {Number}
     */

  }, {
    key: 'readInt16',
    value: function readInt16() {
      var littleEndian = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;

      var num = this.peekInt16(littleEndian);
      this._head += 2;
      return num;
    }

    /**
     * Returns the value of the following 24 bit integer and moves the head by 3 bytes
     * @param  {Boolean} [littleEndian = false]
     * @return {Number}
     */

  }, {
    key: 'readInt24',
    value: function readInt24() {
      var littleEndian = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;

      var num = this.peekInt24(littleEndian);
      this._head += 3;
      return num;
    }

    /**
     * Returns the value of the following 32 bit integer and moves the head by 4 bytes
     * @param  {Boolean} [littleEndian = false]
     * @return {Number}
     */

  }, {
    key: 'readInt32',
    value: function readInt32() {
      var littleEndian = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;

      var num = this.peekInt32(littleEndian);
      this._head += 4;
      return num;
    }

    /**
     * Reads a string with the given length
     * @param  {Number} length
     * @return {String}
     */

  }, {
    key: 'readString',
    value: function readString(length) {
      var str = '';
      for (var i = 0; i < length; i++) {
        var character = this.readInt8();
        str += String.fromCharCode(character);
      }
      return str;
    }

    /**
     * Returns the current head position
     * @return {Number}
     */

  }, {
    key: 'getHead',
    value: function getHead() {
      return this._head;
    }

    /**
     * Sets the head position
     * @param {Number} head
     */

  }, {
    key: 'setHead',
    value: function setHead(head) {
      this._head = head;
    }
  }]);

  return ArrayStream;
}();

/* harmony default export */ __webpack_exports__["a"] = (ArrayStream);

/***/ }),
/* 88 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */

/**
 * http://vip.sugovica.hu/Sardi/kepnezo/JPEG%20File%20Layout%20and%20Format.htm
 */

var MARKERS = {
  SOI: 0xffd8,
  SOS: 0xffda,
  APP0: 0xffe0,
  APP1: 0xffe1,
  JFIF: 0xffe0,
  EXIF: 0xffe1
};

var EXIF_TAGS = {
  0x0100: 'ImageWidth',
  0x0101: 'ImageHeight',
  0x8769: 'ExifIFDPointer',
  0x8825: 'GPSInfoIFDPointer',
  0xA005: 'InteroperabilityIFDPointer',
  0x0102: 'BitsPerSample',
  0x0103: 'Compression',
  0x0106: 'PhotometricInterpretation',
  0x0112: 'Orientation',
  0x0115: 'SamplesPerPixel',
  0x011C: 'PlanarConfiguration',
  0x0212: 'YCbCrSubSampling',
  0x0213: 'YCbCrPositioning',
  0x011A: 'XResolution',
  0x011B: 'YResolution',
  0x0128: 'ResolutionUnit',
  0x0111: 'StripOffsets',
  0x0116: 'RowsPerStrip',
  0x0117: 'StripByteCounts',
  0x0201: 'JPEGInterchangeFormat',
  0x0202: 'JPEGInterchangeFormatLength',
  0x012D: 'TransferFunction',
  0x013E: 'WhitePoint',
  0x013F: 'PrimaryChromaticities',
  0x0211: 'YCbCrCoefficients',
  0x0214: 'ReferenceBlackWhite',
  0x0132: 'DateTime',
  0x010E: 'ImageDescription',
  0x010F: 'Make',
  0x0110: 'Model',
  0x0131: 'Software',
  0x013B: 'Artist',
  0x8298: 'Copyright'
};

/* harmony default export */ __webpack_exports__["a"] = ({
  MARKERS: MARKERS,
  EXIF_TAGS: EXIF_TAGS
});

/***/ }),
/* 89 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_globals__ = __webpack_require__(9);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_shared_constants__ = __webpack_require__(131);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_shared_loaders_json_loader__ = __webpack_require__(47);


var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */





var StickerManager = function () {
  function StickerManager(ui, options) {
    _classCallCheck(this, StickerManager);

    this._ui = ui;
    this._options = options;
    this._categoriesById = {};
    this._categories = [];
    this._stickersById = {};

    this._addCategories(__WEBPACK_IMPORTED_MODULE_2_shared_constants__["a" /* default */].DEFAULTS.STICKER_CATEGORIES);

    var _options = this._options,
        categories = _options.categories,
        replaceCategories = _options.replaceCategories;

    if (this._options.categories) {
      this._addCategories(categories, replaceCategories);
    } else {
      this._updateCategoriesMap();
      this._updateAllCategory();
    }
  }

  /**
   * Loads stickers from the given external URL
   * @param  {String} url
   * @return {Promise}
   */


  _createClass(StickerManager, [{
    key: 'loadExternal',
    value: function loadExternal(url) {
      var _this = this;

      var loader = new __WEBPACK_IMPORTED_MODULE_3_shared_loaders_json_loader__["a" /* default */](url);
      return loader.load().then(function (result) {
        _this._addCategories(result.categories, _this._options.replaceCategories);
      });
    }

    /**
     * Initializes the categories
     * @param {Object[]} categories
     * @param {Boolean} replace = false
     * @private
     */

  }, {
    key: '_addCategories',
    value: function _addCategories(categories) {
      var replace = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;

      if (replace) {
        this._categories = categories.slice(0);
      } else {
        this._categories = __WEBPACK_IMPORTED_MODULE_1_globals__["m" /* Utils */].mergeCategories(this._categories, categories, 'stickers');
      }

      this._updateCategoriesMap();
      this._updateAllCategory();
    }

    /**
     * Updates the categories map
     * @private
     */

  }, {
    key: '_updateCategoriesMap',
    value: function _updateCategoriesMap() {
      var _this2 = this;

      this._categoriesById = {};
      this._categories.forEach(function (c) {
        _this2._categoriesById[c.identifier] = c;
      });

      // Build sticker id => sticker hash
      this._categories.forEach(function (c) {
        c.stickers.forEach(function (s) {
          _this2._stickersById[s.identifier] = s;
        });
      });

      // Filter stickers
      if (typeof this._options.availableStickers !== 'undefined' && this._options.availableStickers !== null) {
        this._categories.forEach(function (category) {
          category.stickers = category.stickers.filter(function (sticker) {
            return _this2._options.availableStickers.indexOf(sticker.identifier) !== -1;
          });
        });

        this._categories = this._categories.filter(function (category) {
          return category.stickers.length > 0;
        });
      }

      this._updateAllCategory();
    }

    /**
     * Updates the `all` category which contains all stickers
     * @private
     */

  }, {
    key: '_updateAllCategory',
    value: function _updateAllCategory() {
      this._allCategory = {
        identifier: 'all',
        defaultName: 'All',
        stickers: this._categories.map(function (c) {
          return c.stickers;
        }).reduce(function (a, b) {
          return a.concat(b);
        }, [])
      };
      this._categoriesById.all = this._allCategory;
    }

    /**
     * Returns the stickers for the category with the given name
     * @param  {String} categoryName
     * @return {Object[]}
     */

  }, {
    key: 'getStickersForCategory',
    value: function getStickersForCategory(categoryName) {
      if (!this._categoriesById[categoryName]) {
        throw new Error('Unknown sticker category \'' + categoryName + '\'');
      }
      return this._categoriesById[categoryName].stickers;
    }

    /**
     * Returns the sticker with the given identifier
     * @param  {String} identifier
     */

  }, {
    key: 'getStickerByIdentifier',
    value: function getStickerByIdentifier(identifier) {
      return this._stickersById[identifier];
    }

    /**
     * Returns the categories
     * @param {Boolean} includeAllCategory = false
     * @return {Object[]}
     */

  }, {
    key: 'getCategories',
    value: function getCategories() {
      var includeAllCategory = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;

      if (includeAllCategory) {
        return [this._allCategory].concat(this._categories);
      }

      return this._categories;
    }

    /**
     * Returns the category object for the given id
     * @param  {String} id
     * @return {Object}
     */

  }, {
    key: 'getCategory',
    value: function getCategory(id) {
      return this._categoriesById[id];
    }

    /**
     * Returns the URL for the given sticker. If the user is using Internet Explorer, we
     * fall back to the svg variant (if present)
     * @param  {Object} sticker
     * @param  {String} size
     * @return {String}
     */

  }], [{
    key: 'getURLForSticker',
    value: function getURLForSticker(sticker) {
      var size = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'base';
      var images = sticker.images;

      var media = size === 'base' ? images.mediaBase || images.mediaThumb : images.mediaThumb;
      var uris = media.uris || [media.uri];
      if (typeof __WEBPACK_IMPORTED_MODULE_1_globals__["m" /* Utils */].Browser !== 'undefined' && !__WEBPACK_IMPORTED_MODULE_1_globals__["m" /* Utils */].Browser.getIEVersion()) {
        var svgs = uris.filter(function (f) {
          return (/\.svg$/i.test(f)
          );
        });
        return svgs.length ? svgs[0] : uris[0];
      } else {
        var notSvgs = uris.filter(function (f) {
          return !/\.svg$/i.test(f);
        });
        return notSvgs.length ? notSvgs[0] : uris[0];
      }
    }
  }]);

  return StickerManager;
}();

/* harmony default export */ __webpack_exports__["a"] = (StickerManager);

/***/ }),
/* 90 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_symbol_iterator__ = __webpack_require__(22);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_symbol_iterator___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_symbol_iterator__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_symbol__ = __webpack_require__(23);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_symbol___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_symbol__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_promise__ = __webpack_require__(11);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_promise___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_promise__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_globals__ = __webpack_require__(9);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__loaders_file_fonts_loader__ = __webpack_require__(341);





var _typeof = typeof __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_symbol___default.a === "function" && typeof __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_symbol_iterator___default.a === "symbol" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_symbol___default.a === "function" && obj.constructor === __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_symbol___default.a && obj !== __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_symbol___default.a.prototype ? "symbol" : typeof obj; };

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */



var FontLoader = function () {
  function FontLoader(ui, fonts) {
    _classCallCheck(this, FontLoader);

    this._ui = ui;
    this._fonts = fonts;
    this._loadedFonts = [];
  }

  /**
   * Sets the fonts
   * @param {Font[]} fonts
   */


  _createClass(FontLoader, [{
    key: 'setFonts',
    value: function setFonts(fonts) {
      this._fonts = fonts;
    }

    /**
     * Checks if the font loader needs to load something
     * @return {Boolean}
     */

  }, {
    key: 'needsToLoad',
    value: function needsToLoad() {
      var _this = this;

      var _loop = function _loop(i) {
        var provider = void 0;
        _this._fonts[i].getVariations().forEach(function (variation) {
          provider = provider || variation.getProvider();
        });
        if (!provider) return 'continue';
        return {
          v: true
        };
      };

      for (var i = 0; i < this._fonts.length; i++) {
        var _ret = _loop(i);

        switch (_ret) {
          case 'continue':
            continue;

          default:
            if ((typeof _ret === 'undefined' ? 'undefined' : _typeof(_ret)) === "object") return _ret.v;
        }
      }
    }

    /**
     * Checks if the given font has already been loaded
     * @param  {Font} font
     */

  }, {
    key: 'fontLoaded',
    value: function fontLoaded(font) {
      var identifier = font.getFontFamily();
      return this._loadedFonts.indexOf(identifier) !== -1;
    }

    /**
     * Sets the given font to loaded
     * @param {Font} font
     */

  }, {
    key: 'setFontLoaded',
    value: function setFontLoaded(font) {
      if (!this.fontLoaded(font)) {
        var identifier = font.getFontFamily();
        this._loadedFonts.push(identifier);
      }
    }

    /**
     * Loads the given fonts
     * @param  {Object[]} fonts
     */

  }, {
    key: 'load',
    value: function load() {
      var _this2 = this;

      var fonts = this._fonts;
      var loaders = {
        file: new __WEBPACK_IMPORTED_MODULE_5__loaders_file_fonts_loader__["a" /* default */](this._ui)
      };

      var disposeLoaders = function disposeLoaders() {
        for (var identifier in loaders) {
          var loader = loaders[identifier];
          loader.dispose();
        }
      };

      fonts.filter(function (font) {
        return !_this2.fontLoaded(font);
      }).forEach(function (font) {
        font.getVariations().forEach(function (variation) {
          var provider = variation.getProvider();
          if (!provider) return;

          var loader = loaders[provider];
          if (!loader) return __WEBPACK_IMPORTED_MODULE_4_globals__["g" /* Log */].warn('No font loader for provider `' + provider + '` found.');
          loader.add(variation);
        });
      });

      var promises = [];
      for (var name in loaders) {
        promises.push(loaders[name].load());
      }
      return __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_promise___default.a.all(promises).then(function () {
        disposeLoaders();
        fonts.forEach(function (font) {
          _this2.setFontLoaded(font);
        });
      }).catch(function (e) {
        disposeLoaders();
        throw e;
      });
    }
  }]);

  return FontLoader;
}();

/* harmony default export */ __webpack_exports__["a"] = (FontLoader);

/***/ }),
/* 91 */
/***/ (function(module, exports, __webpack_require__) {

module.exports = !__webpack_require__(21) && !__webpack_require__(31)(function () {
  return Object.defineProperty(__webpack_require__(61)('div'), 'a', { get: function () { return 7; } }).a != 7;
});


/***/ }),
/* 92 */
/***/ (function(module, exports, __webpack_require__) {

// fallback for non-array-like ES3 and non-enumerable old V8 strings
var cof = __webpack_require__(36);
// eslint-disable-next-line no-prototype-builtins
module.exports = Object('z').propertyIsEnumerable(0) ? Object : function (it) {
  return cof(it) == 'String' ? it.split('') : Object(it);
};


/***/ }),
/* 93 */
/***/ (function(module, exports, __webpack_require__) {

var has = __webpack_require__(27);
var toIObject = __webpack_require__(26);
var arrayIndexOf = __webpack_require__(149)(false);
var IE_PROTO = __webpack_require__(68)('IE_PROTO');

module.exports = function (object, names) {
  var O = toIObject(object);
  var i = 0;
  var result = [];
  var key;
  for (key in O) if (key != IE_PROTO) has(O, key) && result.push(key);
  // Don't enum bug & hidden keys
  while (names.length > i) if (has(O, key = names[i++])) {
    ~arrayIndexOf(result, key) || result.push(key);
  }
  return result;
};


/***/ }),
/* 94 */
/***/ (function(module, exports, __webpack_require__) {

var document = __webpack_require__(14).document;
module.exports = document && document.documentElement;


/***/ }),
/* 95 */
/***/ (function(module, exports, __webpack_require__) {

// 19.1.2.9 / 15.2.3.2 Object.getPrototypeOf(O)
var has = __webpack_require__(27);
var toObject = __webpack_require__(38);
var IE_PROTO = __webpack_require__(68)('IE_PROTO');
var ObjectProto = Object.prototype;

module.exports = Object.getPrototypeOf || function (O) {
  O = toObject(O);
  if (has(O, IE_PROTO)) return O[IE_PROTO];
  if (typeof O.constructor == 'function' && O instanceof O.constructor) {
    return O.constructor.prototype;
  } return O instanceof Object ? ObjectProto : null;
};


/***/ }),
/* 96 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var LIBRARY = __webpack_require__(52);
var $export = __webpack_require__(15);
var redefine = __webpack_require__(97);
var hide = __webpack_require__(25);
var has = __webpack_require__(27);
var Iterators = __webpack_require__(32);
var $iterCreate = __webpack_require__(158);
var setToStringTag = __webpack_require__(53);
var getPrototypeOf = __webpack_require__(95);
var ITERATOR = __webpack_require__(12)('iterator');
var BUGGY = !([].keys && 'next' in [].keys()); // Safari has buggy iterators w/o `next`
var FF_ITERATOR = '@@iterator';
var KEYS = 'keys';
var VALUES = 'values';

var returnThis = function () { return this; };

module.exports = function (Base, NAME, Constructor, next, DEFAULT, IS_SET, FORCED) {
  $iterCreate(Constructor, NAME, next);
  var getMethod = function (kind) {
    if (!BUGGY && kind in proto) return proto[kind];
    switch (kind) {
      case KEYS: return function keys() { return new Constructor(this, kind); };
      case VALUES: return function values() { return new Constructor(this, kind); };
    } return function entries() { return new Constructor(this, kind); };
  };
  var TAG = NAME + ' Iterator';
  var DEF_VALUES = DEFAULT == VALUES;
  var VALUES_BUG = false;
  var proto = Base.prototype;
  var $native = proto[ITERATOR] || proto[FF_ITERATOR] || DEFAULT && proto[DEFAULT];
  var $default = (!BUGGY && $native) || getMethod(DEFAULT);
  var $entries = DEFAULT ? !DEF_VALUES ? $default : getMethod('entries') : undefined;
  var $anyNative = NAME == 'Array' ? proto.entries || $native : $native;
  var methods, key, IteratorPrototype;
  // Fix native
  if ($anyNative) {
    IteratorPrototype = getPrototypeOf($anyNative.call(new Base()));
    if (IteratorPrototype !== Object.prototype && IteratorPrototype.next) {
      // Set @@toStringTag to native iterators
      setToStringTag(IteratorPrototype, TAG, true);
      // fix for some old engines
      if (!LIBRARY && !has(IteratorPrototype, ITERATOR)) hide(IteratorPrototype, ITERATOR, returnThis);
    }
  }
  // fix Array#{values, @@iterator}.name in V8 / FF
  if (DEF_VALUES && $native && $native.name !== VALUES) {
    VALUES_BUG = true;
    $default = function values() { return $native.call(this); };
  }
  // Define iterator
  if ((!LIBRARY || FORCED) && (BUGGY || VALUES_BUG || !proto[ITERATOR])) {
    hide(proto, ITERATOR, $default);
  }
  // Plug for library
  Iterators[NAME] = $default;
  Iterators[TAG] = returnThis;
  if (DEFAULT) {
    methods = {
      values: DEF_VALUES ? $default : getMethod(VALUES),
      keys: IS_SET ? $default : getMethod(KEYS),
      entries: $entries
    };
    if (FORCED) for (key in methods) {
      if (!(key in proto)) redefine(proto, key, methods[key]);
    } else $export($export.P + $export.F * (BUGGY || VALUES_BUG), NAME, methods);
  }
  return methods;
};


/***/ }),
/* 97 */
/***/ (function(module, exports, __webpack_require__) {

module.exports = __webpack_require__(25);


/***/ }),
/* 98 */
/***/ (function(module, exports, __webpack_require__) {

// 19.1.2.7 / 15.2.3.4 Object.getOwnPropertyNames(O)
var $keys = __webpack_require__(93);
var hiddenKeys = __webpack_require__(70).concat('length', 'prototype');

exports.f = Object.getOwnPropertyNames || function getOwnPropertyNames(O) {
  return $keys(O, hiddenKeys);
};


/***/ }),
/* 99 */
/***/ (function(module, exports) {



/***/ }),
/* 100 */
/***/ (function(module, exports, __webpack_require__) {

// call something on iterator step with safe closing on error
var anObject = __webpack_require__(16);
module.exports = function (iterator, fn, value, entries) {
  try {
    return entries ? fn(anObject(value)[0], value[1]) : fn(value);
  // 7.4.6 IteratorClose(iterator, completion)
  } catch (e) {
    var ret = iterator['return'];
    if (ret !== undefined) anObject(ret.call(iterator));
    throw e;
  }
};


/***/ }),
/* 101 */
/***/ (function(module, exports, __webpack_require__) {

// check on default Array iterator
var Iterators = __webpack_require__(32);
var ITERATOR = __webpack_require__(12)('iterator');
var ArrayProto = Array.prototype;

module.exports = function (it) {
  return it !== undefined && (Iterators.Array === it || ArrayProto[ITERATOR] === it);
};


/***/ }),
/* 102 */
/***/ (function(module, exports, __webpack_require__) {

// 7.3.20 SpeciesConstructor(O, defaultConstructor)
var anObject = __webpack_require__(16);
var aFunction = __webpack_require__(49);
var SPECIES = __webpack_require__(12)('species');
module.exports = function (O, D) {
  var C = anObject(O).constructor;
  var S;
  return C === undefined || (S = anObject(C)[SPECIES]) == undefined ? D : aFunction(S);
};


/***/ }),
/* 103 */
/***/ (function(module, exports) {

module.exports = function (exec) {
  try {
    return { e: false, v: exec() };
  } catch (e) {
    return { e: true, v: e };
  }
};


/***/ }),
/* 104 */
/***/ (function(module, exports, __webpack_require__) {

var anObject = __webpack_require__(16);
var isObject = __webpack_require__(20);
var newPromiseCapability = __webpack_require__(78);

module.exports = function (C, x) {
  anObject(C);
  if (isObject(x) && x.constructor === C) return x;
  var promiseCapability = newPromiseCapability.f(C);
  var resolve = promiseCapability.resolve;
  resolve(x);
  return promiseCapability.promise;
};


/***/ }),
/* 105 */
/***/ (function(module, exports, __webpack_require__) {

var ITERATOR = __webpack_require__(12)('iterator');
var SAFE_CLOSING = false;

try {
  var riter = [7][ITERATOR]();
  riter['return'] = function () { SAFE_CLOSING = true; };
  // eslint-disable-next-line no-throw-literal
  Array.from(riter, function () { throw 2; });
} catch (e) { /* empty */ }

module.exports = function (exec, skipClosing) {
  if (!skipClosing && !SAFE_CLOSING) return false;
  var safe = false;
  try {
    var arr = [7];
    var iter = arr[ITERATOR]();
    iter.next = function () { return { done: safe = true }; };
    arr[ITERATOR] = function () { return iter; };
    exec(arr);
  } catch (e) { /* empty */ }
  return safe;
};


/***/ }),
/* 106 */
/***/ (function(module, exports, __webpack_require__) {

module.exports = { "default": __webpack_require__(181), __esModule: true };

/***/ }),
/* 107 */
/***/ (function(module, exports, __webpack_require__) {

module.exports = { "default": __webpack_require__(183), __esModule: true };

/***/ }),
/* 108 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__vector2__ = __webpack_require__(34);


var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */



/**
 * Represents a 3-dimensional matrix
 * @class
 * @memberof PhotoEditorSDK.Math
 */

var Matrix = function () {
  /**
   * Creates a Matrix
   */
  function Matrix() {
    _classCallCheck(this, Matrix);

    this.reset();
  }

  /**
   * Multiplies this matrix with the given one
   * @param  {PhotoEditorSDK.Math.Matrix} matrix
   * @return {PhotoEditorSDK.Math.Matrix}
   */


  _createClass(Matrix, [{
    key: 'multiply',
    value: function multiply(matrix) {
      var a = void 0,
          b = void 0,
          c = void 0,
          d = void 0,
          tx = void 0,
          ty = void 0;
      a = this.a * matrix.a + this.b * matrix.c;
      b = this.a * matrix.b + this.b * matrix.d;
      c = this.c * matrix.a + this.d * matrix.c;
      d = this.c * matrix.b + this.d * matrix.d;
      tx = this.tx * matrix.a + this.ty * matrix.c + matrix.tx;
      ty = this.tx * matrix.b + this.ty * matrix.d + matrix.ty;

      this.a = a;
      this.b = b;
      this.c = c;
      this.d = d;
      this.tx = tx;
      this.ty = ty;
      return this;
    }

    /**
     * Applies this matrix to the given vector
     * @param  {PhotoEditorSDK.Math.Vector2} position
     * @return {PhotoEditorSDK.Math.Vector2}
     */

  }, {
    key: 'applyToVector',
    value: function applyToVector(position) {
      var _position = position,
          x = _position.x,
          y = _position.y;

      position = position.clone();
      position.x = this.a * x + this.c * y + this.tx;
      position.y = this.b * x + this.d * y + this.tx;
      return position;
    }

    /**
     * Applies the inverse of this matrix to the given vector
     * @param  {PhotoEditorSDK.Math.Vector2} position
     * @return {PhotoEditorSDK.Math.Vector2}
     */

  }, {
    key: 'applyInverseToVector',
    value: function applyInverseToVector(position) {
      var determinant = 1 / (this.a * this.d + this.c * -this.b);

      var _position2 = position,
          x = _position2.x,
          y = _position2.y;

      position = position.clone();
      position.x = this.d * determinant * x + -this.c * determinant * y + (this.ty * this.c - this.tx * this.d) * determinant;
      position.y = this.a * determinant * y + -this.b * determinant * x + (-this.ty * this.a + this.tx * this.b) * determinant;

      return position;
    }

    /**
     * Turns the given rectangle into vector coordinates by applying this Matrix
     * @param  {PhotoEditorSDK.Math.Rectangle} rectangle
     * @param  {PhotoEditorSDK.Math.Vector2} anchor
     * @return {PhotoEditorSDK.Math.Vector2[]}
     */

  }, {
    key: 'rectangleToCoordinates',
    value: function rectangleToCoordinates(rectangle) {
      var anchor = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : new __WEBPACK_IMPORTED_MODULE_1__vector2__["a" /* default */](0, 0);

      // Anchor offsets (w0 = right, w1 = left, h0 = up, h1 = down)
      var w0 = rectangle.width * (1 - anchor.x);
      var w1 = rectangle.width * -anchor.x;
      var h0 = rectangle.height * (1 - anchor.y);
      var h1 = rectangle.height * -anchor.y;

      var positions = [];

      // Bottom Left
      positions.push(new __WEBPACK_IMPORTED_MODULE_1__vector2__["a" /* default */](this.a * w1 + this.c * h1 + this.tx, this.d * h1 + this.b * w1 + this.ty));

      // Bottom Right
      positions.push(new __WEBPACK_IMPORTED_MODULE_1__vector2__["a" /* default */](this.a * w0 + this.c * h1 + this.tx, this.d * h1 + this.b * w0 + this.ty));

      // Top Right
      positions.push(new __WEBPACK_IMPORTED_MODULE_1__vector2__["a" /* default */](this.a * w0 + this.c * h0 + this.tx, this.d * h0 + this.b * w0 + this.ty));

      // Top Left
      positions.push(new __WEBPACK_IMPORTED_MODULE_1__vector2__["a" /* default */](this.a * w1 + this.c * h0 + this.tx, this.d * h0 + this.b * w1 + this.ty));

      return positions;
    }

    /**
     * Resets this matrix to the identity matrix
     */

  }, {
    key: 'reset',
    value: function reset() {
      this.a = 1;
      this.b = 0;
      this.c = 0;
      this.d = 1;
      this.tx = 0;
      this.ty = 0;
    }

    /**
     * Returns an array representation of this matrix
     * @return {Float32Array}
     */

  }, {
    key: 'toArray',
    value: function toArray() {
      var arr = [this.a, this.b, 0, this.c, this.d, 0, this.tx, this.ty, 1];
      /* istanbul ignore next */
      if (typeof Float32Array === 'undefined') {
        return arr;
      }
      return new Float32Array(arr);
    }

    /**
     * Returns a string representation of this matrix
     * @return {String}
     */

  }, {
    key: 'toString',
    value: function toString() {
      return 'Matrix({ a: ' + this.a + ', b: ' + this.b + ', c: ' + this.c + ', d: ' + this.d + ', tx: ' + this.tx + ', ty: ' + this.ty + ' })';
    }

    /**
     * The identity matrix
     * @static
     * @type {PhotoEditorSDK.Math.Matrix}
     */

  }], [{
    key: 'IDENTITY',
    get: function get() {
      return new Matrix();
    }
  }]);

  return Matrix;
}();

/* harmony default export */ __webpack_exports__["a"] = (Matrix);

/***/ }),
/* 109 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__vector2__ = __webpack_require__(34);


var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */



/**
 * Represents a Rectangle
 * @class
 * @memberof PhotoEditorSDK.Math
 */

var Rectangle = function () {
  /**
   * Creartes a Rectangle
   * @param {Number} [x = 0]
   * @param {Number} [y = 0]
   * @param {Number} [width  = 0]
   * @param {Number} [height = 0]
   */
  function Rectangle() {
    var x = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;
    var y = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;
    var width = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;
    var height = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 0;

    _classCallCheck(this, Rectangle);

    this.x = x;
    this.y = y;
    this.width = width;
    this.height = height;
  }

  /**
   * Sets the given values
   * @param {Number} x
   * @param {Number} y
   * @return {PhotoEditorSDK.Math.Rectangle}
   */


  _createClass(Rectangle, [{
    key: 'set',
    value: function set(x, y, width, height) {
      this.x = x;
      this.y = y;
      this.width = width;
      this.height = height;
      return this;
    }

    /**
     * Creates a clone of this rectangle
     * @return {PhotoEditorSDK.Math.Rectangle}
     */

  }, {
    key: 'clone',
    value: function clone() {
      return new Rectangle(this.x, this.y, this.width, this.height);
    }

    /**
     * Copies the values of the given rectangle
     * @param  {PhotoEditorSDK.Math.Rectangle} other
     * @return {PhotoEditorSDK.Math.Rectangle}
     */

  }, {
    key: 'copy',
    value: function copy(other) {
      this.x = other.x;
      this.y = other.y;
      this.width = other.width;
      this.height = other.height;
      return this;
    }

    /**
     * Checks whether this rectangle's values are the same as the given ones
     * @param  {(Number|PhotoEditorSDK.Math.Rectangle)} rect
     * @param  {Number} y
     * @param  {Number} width
     * @param  {Number} height
     * @return {Boolean}
     */

  }, {
    key: 'equals',
    value: function equals(rect, y, width, height) {
      if (rect instanceof Rectangle) {
        return rect.x === this.x && rect.y === this.y && rect.width === this.width && rect.height === this.height;
      } else {
        var x = rect;
        return x === this.x && y === this.y && width === this.width && height === this.height;
      }
    }

    /**
     * Rounds this rectangle's values
     * @return {PhotoEditorSDK.Math.Rectangle}
     */

  }, {
    key: 'round',
    value: function round() {
      this.x = Math.round(this.x);
      this.y = Math.round(this.y);
      this.width = Math.round(this.width);
      this.height = Math.round(this.height);
      return this;
    }
  }, {
    key: 'getPosition',
    value: function getPosition() {
      return new __WEBPACK_IMPORTED_MODULE_1__vector2__["a" /* default */](this.x, this.y);
    }
  }, {
    key: 'getSize',
    value: function getSize() {
      return new __WEBPACK_IMPORTED_MODULE_1__vector2__["a" /* default */](this.width, this.height);
    }

    /**
     * Returns a string representation of this rectangle
     * @return {String}
     */

  }, {
    key: 'toString',
    value: function toString() {
      return 'Rectangle({ x: ' + this.x + ', y: ' + this.y + ', width: ' + this.width + ', height: ' + this.height + ' })';
    }
  }]);

  return Rectangle;
}();

/* harmony default export */ __webpack_exports__["a"] = (Rectangle);

/***/ }),
/* 110 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__shared_log__ = __webpack_require__(17);


function _defineProperty(obj, key, value) { if (key in obj) { __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */



/* istanbul ignore next */
/* harmony default export */ __webpack_exports__["a"] = ({
  /**
   * Checks if the currently bound framebuffer is complete
   * @param  {String} tag
   * @param  {WebGLRenderingContext} gl
   * @ignore
   */
  checkFramebufferStatus: function checkFramebufferStatus(tag, gl) {
    var _possibleStatuses;

    var fboStatus = gl.checkFramebufferStatus(gl.FRAMEBUFFER);

    var possibleStatuses = (_possibleStatuses = {}, _defineProperty(_possibleStatuses, gl.FRAMEBUFFER_INCOMPLETE_ATTACHMENT, 'Incomplete attachment'), _defineProperty(_possibleStatuses, gl.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT, 'Missing attachment'), _defineProperty(_possibleStatuses, gl.FRAMEBUFFER_INCOMPLETE_DIMENSIONS, 'Incomplete dimensions'), _defineProperty(_possibleStatuses, gl.FRAMEBUFFER_UNSUPPORTED, 'Framebuffer unsupported'), _possibleStatuses);

    if (fboStatus !== gl.FRAMEBUFFER_COMPLETE) {
      __WEBPACK_IMPORTED_MODULE_1__shared_log__["a" /* default */].warn(tag, 'Framebuffer incomplete: ' + possibleStatuses[fboStatus]);
    }
  }
});

/***/ }),
/* 111 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__globals__ = __webpack_require__(8);


var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */


var now = typeof window !== 'undefined' && window.performance && window.performance.now ? window.performance.now.bind(window.performance) : __webpack_require__(80);

/**
 * Hooks into a rendering context (WebGLRenderingContext or CanvasRenderingContext2D),
 * mocks its methods and measures the time consumed by the method calls. When `endFrame`
 * is called, it prints a performance report
 * @class
 * @memberof PhotoEditorSDK.Engine
 * @ignore
 */

var ContextPerformanceHook = function () {
  function ContextPerformanceHook(context) {
    var _this = this;

    _classCallCheck(this, ContextPerformanceHook);

    this._context = context;
    this._tracking = false;

    var self = this;

    var _loop = function _loop(key) {
      var value = context[key];
      if (typeof value === 'function') {
        _this[key] = function () {
          for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
            args[_key] = arguments[_key];
          }

          var fn = context[key];
          if (!self._tracking) {
            return fn.apply(context, args);
          }

          var start = now();
          var result = fn.apply(context, args);
          var time = now() - start;

          var call = {
            functionName: key,
            arguments: args,
            duration: time
          };
          self._trackedCalls.push(call);

          return result;
        };
      } else {
        _this._makePropertyWrapper(key);
      }
    };

    for (var key in context) {
      _loop(key);
    }
  }

  /**
   * Creates the getter and setter for the given property
   * @param  {String} property
   * @private
   */


  _createClass(ContextPerformanceHook, [{
    key: '_makePropertyWrapper',
    value: function _makePropertyWrapper(property) {
      var insecureProperties = ['_context', '_trackedCalls', '_tracking'];
      if (insecureProperties.indexOf(property) !== -1) return;

      var context = this._context;

      this.__defineGetter__(property, function () {
        return context[property];
      });

      this.__defineSetter__(property, function (value) {
        context[property] = value;
      });
    }

    /**
     * Starts tracking a frame
     */

  }, {
    key: 'startFrame',
    value: function startFrame() {
      this._tracking = true;
      this._trackedCalls = [];
    }

    /**
     * Stops tracking a frame and prints a performance report
     */

  }, {
    key: 'endFrame',
    value: function endFrame() {
      var tag = 'Rendering';
      __WEBPACK_IMPORTED_MODULE_1__globals__["f" /* Log */].log(tag, 'Frame rendering results:');
      __WEBPACK_IMPORTED_MODULE_1__globals__["f" /* Log */].log(tag, 'Context calls: ' + this._trackedCalls.length);

      var groupedCalls = {};
      this._trackedCalls.forEach(function (_ref) {
        var functionName = _ref.functionName,
            duration = _ref.duration;

        groupedCalls[functionName] = groupedCalls[functionName] || {
          totalDuration: 0,
          calls: 0
        };

        groupedCalls[functionName].totalDuration += duration;
        groupedCalls[functionName].calls++;
      });

      var callsArray = [];
      for (var key in groupedCalls) {
        var data = groupedCalls[key];
        data.averageDuration = data.totalDuration / data.calls;

        callsArray.push({ functionName: key, data: data });
      }

      callsArray.sort(function (a, b) {
        return b.data.totalDuration - a.data.totalDuration;
      });
      callsArray = callsArray.slice(0, 3);

      callsArray.forEach(function (item) {
        __WEBPACK_IMPORTED_MODULE_1__globals__["f" /* Log */].log(tag, item.functionName + ': ' + item.data.calls + ' calls, ' + item.data.totalDuration.toFixed(2) + 'ms');
      });
    }
  }]);

  return ContextPerformanceHook;
}();

/* harmony default export */ __webpack_exports__["a"] = (ContextPerformanceHook);

/***/ }),
/* 112 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__globals__ = __webpack_require__(8);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__utils_utils__ = __webpack_require__(194);





var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




/**
 * The base class for all renderers
 * @class
 * @memberof PhotoEditorSDK.Engine
 */

var BaseRenderer = function (_EventEmitter) {
  _inherits(BaseRenderer, _EventEmitter);

  /**
   * Create a BaseRenderer instance
   * @param  {Number} width
   * @param  {Number} height
   * @param  {Object} options = {}
   * @param  {Number} [options.pixelRatio = 1]
   * @param  {PhotoEditorSDK.Color} [options.clearColor = PhotoEditorSDK.Color.TRANSPARENT]
   * @param  {Boolean} [options.debug = false]
   */
  function BaseRenderer(width, height) {
    var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};

    _classCallCheck(this, BaseRenderer);

    var _this = _possibleConstructorReturn(this, (BaseRenderer.__proto__ || __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default()(BaseRenderer)).call(this));

    _this._options = __WEBPACK_IMPORTED_MODULE_5__utils_utils__["a" /* default */].defaults(options, {
      pixelRatio: 1,
      transparent: false,
      clearColor: __WEBPACK_IMPORTED_MODULE_4__globals__["b" /* Color */].BLACK,
      debug: false
    });

    _this.setMaxListeners(0);
    _this._width = width || 800;
    _this._height = height || 600;
    _this._dimensions = new __WEBPACK_IMPORTED_MODULE_4__globals__["k" /* Vector2 */](_this._width, _this._height);
    _this._maxTextureSize = null;
    _this._pixelRatio = _this._options.pixelRatio;
    _this._clearColor = _this._options.transparent ? __WEBPACK_IMPORTED_MODULE_4__globals__["b" /* Color */].TRANSPARENT : _this._options.clearColor || __WEBPACK_IMPORTED_MODULE_4__globals__["b" /* Color */].BLACK;
    return _this;
  }

  /**
   * Sets the canvas to the given one
   * @param {HTMLCanvasElement} canvas
   */


  _createClass(BaseRenderer, [{
    key: 'setCanvas',
    value: function setCanvas(canvas) {
      var previousCanvas = this._canvas;
      this._canvas = canvas;

      if (previousCanvas !== canvas) {
        this._createContext();
        this._onBeforeContext();
        this._setupContext();
      }

      this.resizeTo(new __WEBPACK_IMPORTED_MODULE_4__globals__["k" /* Vector2 */](this._width, this._height));
    }

    /**
     * Returns the current canvas
     * @return {HTMLCanvasElement}
     */

  }, {
    key: 'getCanvas',
    value: function getCanvas() {
      return this._canvas;
    }

    /**
     * Gets called before the context has been set up
     * @protected
     */

  }, {
    key: '_onBeforeContext',
    value: function _onBeforeContext() {}

    /**
     * Resizes the context and view to the given size
     * @param  {PhotoEditorSDK.Math.Vector2} dimensions
     * @param  {Boolean} resizeCanvas = true
     */

  }, {
    key: 'resizeTo',
    value: function resizeTo(dimensions) {
      var resizeCanvas = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;

      this._width = dimensions.x * this._pixelRatio;
      this._height = dimensions.y * this._pixelRatio;

      if (resizeCanvas) {
        this._canvas.width = this._width;
        this._canvas.height = this._height;

        if (this._canvas.style) {
          this._canvas.style.width = this._width / this._pixelRatio + 'px';
          this._canvas.style.height = this._height / this._pixelRatio + 'px';
        }
      }

      this._dimensions = dimensions.clone();
    }

    /**
     * Gets the rendering context for this renderer
     * @returns {Object}
     * @protected
     * @abstract
     */
    /* istanbul ignore next */

  }, {
    key: '_createContext',
    value: function _createContext() {
      __WEBPACK_IMPORTED_MODULE_4__globals__["f" /* Log */].warn(this.constructor.name, '`_createContext` is abstract and not implemented in inherited class');
    }

    /**
     * Sets up the rendering context for this renderer
     * @protected
     * @abstract
     */
    /* istanbul ignore next */

  }, {
    key: '_setupContext',
    value: function _setupContext() {
      __WEBPACK_IMPORTED_MODULE_4__globals__["f" /* Log */].warn(this.constructor.name, '`_setupContext` is abstract and not implemented in inherited class');
    }

    /**
     * Renders the given displayObject
     * @param  {PhotoEditorSDK.Engine.DisplayObject} displayObject
     * @abstract
     */
    /* istanbul ignore next */

  }, {
    key: 'render',
    value: function render(displayObject) {
      __WEBPACK_IMPORTED_MODULE_4__globals__["f" /* Log */].warn(this.constructor.name, '`render` is abstract and not implemented in inherited class');
    }

    /**
     * Returns the maximum dimensions
     * @return {Number}
     */
    /* istanbul ignore next */

  }, {
    key: 'getMaxDimensions',
    value: function getMaxDimensions() {
      return null;
    }

    /**
     * Returns the current rendering context
     * @return {RenderingContext}
     */

  }, {
    key: 'getContext',
    value: function getContext() {
      return this._context;
    }

    /**
     * Returns the current width
     * @return {Number}
     */

  }, {
    key: 'getWidth',
    value: function getWidth() {
      return this._dimensions.x;
    }

    /**
     * Returns the current height
     * @return {Number}
     */

  }, {
    key: 'getHeight',
    value: function getHeight() {
      return this._dimensions.y;
    }

    /**
     * Returns the current dimensions
     * @return {PhotoEditorSDK.Math.Vector2}
     */

  }, {
    key: 'getDimensions',
    value: function getDimensions() {
      return this._dimensions;
    }

    /**
     * Returns the current pixel ratio
     * @return {Number}
     */

  }, {
    key: 'getPixelRatio',
    value: function getPixelRatio() {
      return this._pixelRatio;
    }

    /**
     * Sets the pixel ratio
     * @return {Number}
     */

  }, {
    key: 'setPixelRatio',
    value: function setPixelRatio(pixelRatio) {
      this._pixelRatio = pixelRatio;
      if (this._defaultRenderTarget) {
        this._defaultRenderTarget.setPixelRatio(pixelRatio);
      }
    }

    /**
     * Returns the maximum texture size
     * @return {Number}
     */

  }, {
    key: 'getMaxTextureSize',
    value: function getMaxTextureSize() {
      return this._maxTextureSize;
    }

    /**
     * Returns the current filter manager
     * @return {PhotoEditorSDK.Engine.FilterManager}
     */

  }, {
    key: 'getFilterManager',
    value: function getFilterManager() {
      return this._filterManager;
    }

    /**
     * Sets the filter manager
     * @param {PhotoEditorSDK.Engine.FilterManager} filterManager
     */

  }, {
    key: 'setFilterManager',
    value: function setFilterManager(filterManager) {
      this._filterManager = filterManager;
    }

    /**
     * Checks if this renderer is supported on the current device and browser
     * @return {Boolean}
     */

  }, {
    key: 'isOfType',


    /**
     * Checks if this renderer's type is equal to the given one
     * @param  {String}  type
     * @return {Boolean}
     */
    value: function isOfType(type) {
      return this._type === type;
    }

    /**
     * Disposes this Renderer
     * @abstract
     */
    /* istanbul ignore next */

  }, {
    key: 'dispose',
    value: function dispose() {
      __WEBPACK_IMPORTED_MODULE_4__globals__["f" /* Log */].warn(this.constructor.name, '`dispose` is abstract and not implemented in inherited class');
    }
  }], [{
    key: 'isSupported',
    value: function isSupported() {
      return true;
    }
  }]);

  return BaseRenderer;
}(__WEBPACK_IMPORTED_MODULE_4__globals__["d" /* EventEmitter */]);

/* harmony default export */ __webpack_exports__["a"] = (BaseRenderer);

/***/ }),
/* 113 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);


var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */

/**
 * The base class for all ObjectRenderer classes
 * @class
 * @memberof PhotoEditorSDK.Engine
 */
/* istanbul ignore next */
var ObjectRenderer = function () {
  /**
   * Creates an ObjectRenderer
   * @param  {PhotoEditorSDK.Engine.BaseRenderer} renderer
   */
  function ObjectRenderer(renderer) {
    _classCallCheck(this, ObjectRenderer);

    this._renderer = renderer;

    this._onContextChange = this._onContextChange.bind(this);
    this._renderer.on('context', this._onContextChange);
  }

  /**
   * Gets called when the rendering context changes
   * @private
   */


  _createClass(ObjectRenderer, [{
    key: '_onContextChange',
    value: function _onContextChange() {}

    /**
     * Gets called when this object renderer is activated
     */

  }, {
    key: 'start',
    value: function start() {}

    /**
     * Gets called when this object renderer is deactivated
     */

  }, {
    key: 'stop',
    value: function stop() {
      this.flush();
    }

    /**
     * Renders whatever has been queued
     */

  }, {
    key: 'flush',
    value: function flush() {}

    /**
     * Disposes this ObjectRenderer
     */

  }, {
    key: 'dispose',
    value: function dispose() {
      this._renderer.off('context', this._onContextChange);
      this._renderer = null;
    }
  }]);

  return ObjectRenderer;
}();

/* harmony default export */ __webpack_exports__["a"] = (ObjectRenderer);

/***/ }),
/* 114 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_canvas__ = __webpack_require__(19);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_canvas___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_canvas__);


var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */



/**
 * This class represents an image in pixel array form.
 * @ignore
 */

var PixelArrayImage = function () {
  /**
   * @param  {Number} width
   * @param  {Number} height
   * @param  {UInt8Array} data
   * @constructor
   */
  function PixelArrayImage(width, height, data) {
    _classCallCheck(this, PixelArrayImage);

    this.width = width;
    this.height = height;
    this.data = data;
  }

  /**
   * Creates a PixelArrayImage from the given `node-canvas` Image object by rendering the image
   * to a canvas and reading the pixel data
   * @param  {Canvas.Image} image
   * @return {PixelArrayImage}
   */


  _createClass(PixelArrayImage, null, [{
    key: 'fromNodeCanvasImage',
    value: function fromNodeCanvasImage(image) {
      var canvas = new __WEBPACK_IMPORTED_MODULE_1_canvas__["Canvas"](image.width, image.height);
      var context = canvas.getContext('2d');

      context.drawImage(image, 0, 0);
      var imageData = context.getImageData(0, 0, image.width, image.height);
      return new PixelArrayImage(image.width, image.height, imageData.data);
    }
  }]);

  return PixelArrayImage;
}();

/* harmony default export */ __webpack_exports__["a"] = (PixelArrayImage);

/***/ }),
/* 115 */
/***/ (function(module, exports) {

module.exports = __WEBPACK_EXTERNAL_MODULE_115__;

/***/ }),
/* 116 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor__ = __webpack_require__(7);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__globals__ = __webpack_require__(8);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__display_object__ = __webpack_require__(84);






var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor___default()(object, property); if (desc === undefined) { var parent = __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if ("value" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




/**
 * A container for DisplayObject instances
 * @class
 * @extends PhotoEditorSDK.Engine.DisplayObject
 * @memberof PhotoEditorSDK.Engine
 */

var Container = function (_DisplayObject) {
  _inherits(Container, _DisplayObject);

  /**
   * Creates a Container
   * @override
   */
  function Container() {
    var _ref;

    _classCallCheck(this, Container);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this = _possibleConstructorReturn(this, (_ref = Container.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(Container)).call.apply(_ref, [this].concat(args)));

    _this._children = [];
    _this._filters = [];
    return _this;
  }

  /**
   * Adds the given filter to the filter stack
   * @param {PhotoEditorSDK.Engine.Filter} filter
   */


  _createClass(Container, [{
    key: 'addFilter',
    value: function addFilter(filter) {
      this._filters.push(filter);
    }

    /**
     * Removes the given filter from the filter stack
     * @param  {PhotoEditorSDK.Engine.Filter} filter
     * @return {Boolean} - Whether the filter has been removed
     */

  }, {
    key: 'removeFilter',
    value: function removeFilter(filter) {
      var index = this._filters.indexOf(filter);
      if (index !== -1) {
        this._filters.splice(index, 1);
        return true;
      }
      return false;
    }

    /**
     * Sets the filters
     * @param {Array.<PhotoEditorSDK.Engine.Filter>} filters
     */

  }, {
    key: 'setFilters',
    value: function setFilters(filters) {
      this._filters = filters;
    }

    /**
     * Adds the given DisplayObject to the list of children
     * @param {PhotoEditorSDK.Engine.DisplayObject} child
     */

  }, {
    key: 'addChild',
    value: function addChild(child) {
      // Remove from previous parent
      var originalParent = child.getParent();
      if (originalParent !== null) {
        originalParent.removeChild(child);
      }
      child.setParent(this);

      this._children.push(child);
    }

    /**
     * Prepends the given DisplayObject to the list of children
     * @param  {PhotoEditorSDK.Engine.DisplayObject} child
     */

  }, {
    key: 'prependChild',
    value: function prependChild(child) {
      // Remove from previous parent
      var originalParent = child.getParent();
      if (originalParent !== null) {
        originalParent.removeChild(child);
      }
      child.setParent(this);

      this._children.unshift(child);
    }

    /**
     * Checks whether this container has the given child
     * @param  {PhotoEditorSDK.Engine.DisplayObject}  child
     * @return {Boolean}
     */

  }, {
    key: 'hasChild',
    value: function hasChild(child) {
      var index = this._children.indexOf(child);
      return index !== -1;
    }

    /**
     * Removes the given object from the list of children
     * @param  {PhotoEditorSDK.Engine.DisplayObject} child
     */

  }, {
    key: 'removeChild',
    value: function removeChild(child) {
      var index = this._children.indexOf(child);
      if (index !== -1) {
        this._children.splice(index, 1);
        child.setParent(null);
      } else {
        __WEBPACK_IMPORTED_MODULE_5__globals__["f" /* Log */].info(this.constructor.name, 'Tried to remove a child that does not exist');
      }
    }

    /**
     * Removes all children
     */

  }, {
    key: 'clearChildren',
    value: function clearChildren() {
      this._children = [];
    }

    /**
     * Renders this DisplayObject using the given WebGLRenderer
     * @param  {PhotoEditorSDK.Engine.WebGLRenderer} renderer
     * @override
     */

  }, {
    key: 'renderWebGL',
    value: function renderWebGL(renderer) {
      if (!this._visible) {
        return;
      }

      var filterManager = renderer.getFilterManager();
      if (this._filters && this._filters.length) {
        filterManager.pushFilters(this, this._filters);
      }

      renderer.getCurrentObjectRenderer().start();

      this._renderWebGL(renderer);

      this._children.forEach(function (child) {
        child.renderWebGL(renderer);
      });

      renderer.getCurrentObjectRenderer().flush();

      if (this._filters && this._filters.length) {
        filterManager.popFilters();
      }
      renderer.getCurrentObjectRenderer().start();
    }

    /**
     * Renders the contents of this container
     * @param {PhotoEditorSDK.Engine.WebGLRenderer} renderer
     * @protected
     */

  }, {
    key: '_renderWebGL',
    value: function _renderWebGL(renderer) {}

    /**
     * Renders this DisplayObject using the given CanvasRenderer
     * @param  {PhotoEditorSDK.Engine.CanvasRenderer} renderer
     * @override
     */

  }, {
    key: 'renderCanvas',
    value: function renderCanvas(renderer) {
      if (!this._visible) {
        return;
      }

      var filterManager = renderer.getFilterManager();
      if (this._filters && this._filters.length) {
        filterManager.pushFilters(this, this._filters);
      }

      this._renderCanvas(renderer);
      this._children.forEach(function (child) {
        child.renderCanvas(renderer);
      });

      if (this._filters && this._filters.length) {
        filterManager.popFilters();
      }
    }

    /**
     * Renders the contents of this container
     * @param {PhotoEditorSDK.Engine.CanvasRenderer} renderer
     * @protected
     */

  }, {
    key: '_renderCanvas',
    value: function _renderCanvas(renderer) {}

    /**
     * Updates the world transform for this DisplayObject
     */

  }, {
    key: 'updateTransform',
    value: function updateTransform() {
      _get(Container.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(Container.prototype), 'updateTransform', this).call(this);
      this._children.forEach(function (child) {
        child.updateTransform();
      });
    }

    /**
     * Returns the non-global bounds of this DisplayObject
     * @return {PhotoEditorSDK.Math.Rectangle}
     */

  }, {
    key: 'getLocalBounds',
    value: function getLocalBounds() {
      if (this._localBoundsNeedUpdate) {
        // @TODO Calculate bounds by looking at children
        this._localBoundsNeedUpdate = false;
      }
      return this._localBounds.clone();
    }

    /**
     * Returns the bounds for this DisplayObject
     * @return {PhotoEditorSDK.Math.Rectangle}
     */

  }, {
    key: 'getBounds',
    value: function getBounds() {
      if (this._boundsNeedUpdate) {
        // @TODO Calculate bounds by looking at children
        this._boundsNeedUpdate = false;
      }
      return this._bounds.clone();
    }

    /**
     * Returns this Container's children
     * @return {PhotoEditorSDK.Engine.DisplayObject[]}
     */

  }, {
    key: 'getChildren',
    value: function getChildren() {
      return this._children;
    }

    /**
     * Returns this Container's filters
     * @return {PhotoEditorSDK.Engine.Filter[]}
     */

  }, {
    key: 'getFilters',
    value: function getFilters() {
      return this._filters;
    }

    /**
     * Disposes this Container
     */

  }, {
    key: 'dispose',
    value: function dispose() {}
  }]);

  return Container;
}(__WEBPACK_IMPORTED_MODULE_6__display_object__["a" /* default */]);

/* harmony default export */ __webpack_exports__["a"] = (Container);

/***/ }),
/* 117 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__globals__ = __webpack_require__(8);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__base_texture__ = __webpack_require__(44);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__utils_texture_uvs__ = __webpack_require__(202);





var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */





/**
 * A texture that can be applied to a {@link PhotoEditorSDK.Engine.Sprite}
 * @class
 * @extends EventEmitter
 * @memberof PhotoEditorSDK.Engine
 */

var Texture = function (_EventEmitter) {
  _inherits(Texture, _EventEmitter);

  function Texture(baseTexture, frame) {
    _classCallCheck(this, Texture);

    var _this = _possibleConstructorReturn(this, (Texture.__proto__ || __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default()(Texture)).call(this));

    if (!(baseTexture instanceof __WEBPACK_IMPORTED_MODULE_5__base_texture__["a" /* default */])) {
      throw new Error('`baseTexture` should be an instance of BaseTexture');
    }

    _this._uvs = new __WEBPACK_IMPORTED_MODULE_6__utils_texture_uvs__["a" /* default */]();
    _this._frame = frame ? frame.clone() : null;
    _this._frameLocked = !!frame;

    // Bind event handlers
    _this._onBaseTextureLoaded = _this._onBaseTextureLoaded.bind(_this);
    _this._onBaseTextureUpdated = _this._onBaseTextureUpdated.bind(_this);

    // A texture NEEDS to have a frame
    if (!_this._frame) {
      _this._frame = new __WEBPACK_IMPORTED_MODULE_4__globals__["h" /* Rectangle */](0, 0, 1, 1);
    }
    _this.setBaseTexture(baseTexture);
    return _this;
  }

  /**
   * Creates a texture from the given image
   * @param  {Image} image
   */


  _createClass(Texture, [{
    key: '_onBaseTextureLoaded',


    /**
     * Gets called when the base texture has been loaded
     * @private
     */
    value: function _onBaseTextureLoaded() {
      if (!this._frameLocked) {
        var frame = this._baseTexture.getFrame().clone();
        this.setFrame(frame);
      }

      this._baseTexture.on('update', this._onBaseTextureUpdated);
    }

    /**
     * Gets called when the base texture has been updated
     * @private
     */

  }, {
    key: '_onBaseTextureUpdated',
    value: function _onBaseTextureUpdated() {
      var _baseTexture$getFrame = this._baseTexture.getFrame(),
          width = _baseTexture$getFrame.width,
          height = _baseTexture$getFrame.height;

      this._frame.width = width;
      this._frame.height = height;
      this.emit('update');
    }

    /**
     * Updates the UV coordinates of this texture
     * @private
     */

  }, {
    key: '_updateUVs',
    value: function _updateUVs() {
      this._uvs.update(this._frame, this._baseTexture.getFrame());
    }

    /**
     * Returns the base texture
     * @return {PhotoEditorSDK.Engine.BaseTexture}
     */

  }, {
    key: 'getBaseTexture',
    value: function getBaseTexture() {
      return this._baseTexture;
    }

    /**
     * Sets the base texture
     * @param {PhotoEditorSDK.Engine.BaseTexture} baseTexture
     */

  }, {
    key: 'setBaseTexture',
    value: function setBaseTexture(baseTexture) {
      this._baseTexture = baseTexture;

      if (!this._baseTexture.isLoaded()) {
        this._baseTexture.once('loaded', this._onBaseTextureLoaded);
      } else {
        var _baseTexture$getFrame2 = baseTexture.getFrame(),
            width = _baseTexture$getFrame2.width,
            height = _baseTexture$getFrame2.height;

        if (!this._frameLocked) {
          this._frame = new __WEBPACK_IMPORTED_MODULE_4__globals__["h" /* Rectangle */](0, 0, width, height);
        }
        this._onBaseTextureLoaded();
      }
    }

    /**
     * Returns the frame
     * @return {PhotoEditorSDK.Math.Rectangle}
     */

  }, {
    key: 'getFrame',
    value: function getFrame() {
      return this._frame;
    }

    /**
     * Sets the frame
     * @param {PhotoEditorSDK.Math.Rectangle} frame
     */

  }, {
    key: 'setFrame',
    value: function setFrame(frame) {
      this._frame = frame;
      this._updateUVs();
    }

    /**
     * Returns the width
     * @return {Number}
     */

  }, {
    key: 'getWidth',
    value: function getWidth() {
      return this._frame.width;
    }

    /**
     * Returns the height
     * @return {Number}
     */

  }, {
    key: 'getHeight',
    value: function getHeight() {
      return this._frame.height;
    }

    /**
     * Returns the texture UVs
     * @return {PhotoEditorSDK.Engine.TextureUVs}
     */

  }, {
    key: 'getUVs',
    value: function getUVs() {
      return this._uvs;
    }

    /**
     * Returns the dimensions of this texture
     * @return {PhotoEditorSDK.Math.Vector2}
     */

  }, {
    key: 'getDimensions',
    value: function getDimensions() {
      return new __WEBPACK_IMPORTED_MODULE_4__globals__["k" /* Vector2 */](this._frame.width, this._frame.height);
    }

    /**
     * Disposes this texture
     * @param  {Boolean} baseTexture
     */

  }, {
    key: 'dispose',
    value: function dispose() {
      var baseTexture = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : true;

      baseTexture && this._baseTexture.dispose();
    }
  }], [{
    key: 'fromImage',
    value: function fromImage(image) {
      var baseTexture = new __WEBPACK_IMPORTED_MODULE_5__base_texture__["a" /* default */](image);
      return new Texture(baseTexture);
    }

    /**
     * Creates a texture from the given canvas
     * @param  {HTMLCanvasElement} canvas
     */

  }, {
    key: 'fromCanvas',
    value: function fromCanvas(canvas) {
      var baseTexture = new __WEBPACK_IMPORTED_MODULE_5__base_texture__["a" /* default */](canvas);
      return new Texture(baseTexture);
    }
  }]);

  return Texture;
}(__WEBPACK_IMPORTED_MODULE_4__globals__["d" /* EventEmitter */]);

/* harmony default export */ __webpack_exports__["a"] = (Texture);

/***/ }),
/* 118 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__color__ = __webpack_require__(41);


var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */



/*
 * [ a, b, c, d, e,
 *   f, g, h, i, j,
 *   k, l, m, n, o,
 *   p, q, r, s, t ]
 *
 */

/**
 * Represents a 4 by 5 matrix that is used to preform color manipulations.
 * The members are names a, b, c,..,t. The vector formed by e, j, o, t
 * represents the offset.
 * @class
 * @memberof PhotoEditorSDK.Math
 */

var ColorMatrix = function () {
  /**
   * Creates a color matrix, and defaults the values to the identity.
   * @return {PhotoEditorSDK.Math.ColorMatrix}
   */
  function ColorMatrix() {
    var a = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 1;
    var b = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;
    var c = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;
    var d = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 0;
    var e = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : 0;
    var f = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : 0;
    var g = arguments.length > 6 && arguments[6] !== undefined ? arguments[6] : 1;
    var h = arguments.length > 7 && arguments[7] !== undefined ? arguments[7] : 0;
    var i = arguments.length > 8 && arguments[8] !== undefined ? arguments[8] : 0;
    var j = arguments.length > 9 && arguments[9] !== undefined ? arguments[9] : 0;
    var k = arguments.length > 10 && arguments[10] !== undefined ? arguments[10] : 0;
    var l = arguments.length > 11 && arguments[11] !== undefined ? arguments[11] : 0;
    var m = arguments.length > 12 && arguments[12] !== undefined ? arguments[12] : 1;
    var n = arguments.length > 13 && arguments[13] !== undefined ? arguments[13] : 0;
    var o = arguments.length > 14 && arguments[14] !== undefined ? arguments[14] : 0;
    var p = arguments.length > 15 && arguments[15] !== undefined ? arguments[15] : 0;
    var q = arguments.length > 16 && arguments[16] !== undefined ? arguments[16] : 0;
    var r = arguments.length > 17 && arguments[17] !== undefined ? arguments[17] : 0;
    var s = arguments.length > 18 && arguments[18] !== undefined ? arguments[18] : 1;
    var t = arguments.length > 19 && arguments[19] !== undefined ? arguments[19] : 0;

    _classCallCheck(this, ColorMatrix);

    this.set(a, b, c, d, e, f, g, h, i, j, k, l, m, n, o, p, q, r, s, t);
  }

  /**
   * Sets the values of the color matrix.
   * @param  {number} a
   * @param  {number} b
   * @param  {number} c
   * @param  {number} d
   * @param  {number} e
   * @param  {number} f
   * @param  {number} g
   * @param  {number} h
   * @param  {number} i
   * @param  {number} j
   * @param  {number} k
   * @param  {number} l
   * @param  {number} m
   * @param  {number} n
   * @param  {number} o
   * @param  {number} p
   * @param  {number} q
   * @param  {number} r
   * @param  {number} s
   * @param  {number} t
   * @return {PhotoEditorSDK.Math.ColorMatrix}
   */


  _createClass(ColorMatrix, [{
    key: 'set',
    value: function set(a, b, c, d, e, f, g, h, i, j, k, l, m, n, o, p, q, r, s, t) {
      this.a = a;
      this.b = b;
      this.c = c;
      this.d = d;
      this.e = e;
      this.f = f;
      this.g = g;
      this.h = h;
      this.i = i;
      this.j = j;
      this.k = k;
      this.l = l;
      this.m = m;
      this.n = n;
      this.o = o;
      this.p = p;
      this.q = q;
      this.r = r;
      this.s = s;
      this.t = t;
    }

    /**
     * Returns an identity color matrix.
     * @return {ColorMatrix}
     */

  }, {
    key: 'reset',
    value: function reset() {
      this.a = 1;
      this.b = 0;
      this.c = 0;
      this.d = 0;
      this.e = 0;

      this.f = 0;
      this.g = 1;
      this.h = 0;
      this.i = 0;
      this.j = 0;

      this.k = 0;
      this.l = 0;
      this.m = 1;
      this.n = 0;
      this.o = 0;

      this.p = 0;
      this.q = 0;
      this.r = 0;
      this.s = 1;
      this.t = 0;
    }

    /**
     * Applies the color matrix to the given color, and returns the resulting color.
     * @param  {Color} color
     * @return {Color}
     */

  }, {
    key: 'apply',
    value: function apply(color) {
      var r = this.a * color.r + this.b * color.g + this.c * color.b + this.d * color.a + this.e;
      var g = this.f * color.r + this.g * color.g + this.h * color.b + this.i * color.a + this.j;
      var b = this.k * color.r + this.l * color.g + this.m * color.b + this.n * color.a + this.o;
      var a = this.p * color.r + this.q * color.g + this.r * color.b + this.s * color.a + this.t;
      return new __WEBPACK_IMPORTED_MODULE_1__color__["a" /* default */](r, g, b, a);
    }

    /**
    * Multiplies the given matrix with this matrix.
    * @param  {PhotoEditorSDK.Math.ColorMatrix} matrix
    * @return {PhotoEditorSDK.Math.ColorMatrix}
    */

  }, {
    key: 'multiply',
    value: function multiply(matrix) {
      var a = void 0,
          b = void 0,
          c = void 0,
          d = void 0,
          e = void 0,
          f = void 0,
          g = void 0,
          h = void 0,
          i = void 0,
          j = void 0,
          k = void 0,
          l = void 0,
          m = void 0,
          n = void 0,
          o = void 0,
          p = void 0,
          q = void 0,
          r = void 0,
          s = void 0,
          t = void 0;
      // store both factors, so we can swap them easily
      var A = matrix;
      var B = this;

      // transformation
      a = A.a * B.a + A.b * B.f + A.c * B.k + A.d * B.p;
      b = A.a * B.b + A.b * B.g + A.c * B.l + A.d * B.q;
      c = A.a * B.c + A.b * B.h + A.c * B.m + A.d * B.r;
      d = A.a * B.d + A.b * B.i + A.c * B.n + A.d * B.s;

      f = A.f * B.a + A.g * B.f + A.h * B.k + A.i * B.p;
      g = A.f * B.b + A.g * B.g + A.h * B.l + A.i * B.q;
      h = A.f * B.c + A.g * B.h + A.h * B.m + A.i * B.r;
      i = A.f * B.d + A.g * B.i + A.h * B.n + A.i * B.s;

      k = A.k * B.a + A.l * B.f + A.m * B.k + A.n * B.p;
      l = A.k * B.b + A.l * B.g + A.m * B.l + A.n * B.q;
      m = A.k * B.c + A.l * B.h + A.m * B.m + A.n * B.r;
      n = A.k * B.d + A.l * B.i + A.m * B.n + A.n * B.s;

      p = A.p * B.a + A.q * B.f + A.r * B.k + A.s * B.p;
      q = A.p * B.b + A.q * B.g + A.r * B.l + A.s * B.q;
      r = A.p * B.c + A.q * B.h + A.r * B.m + A.s * B.r;
      s = A.p * B.d + A.q * B.i + A.r * B.n + A.s * B.s;

      // translation
      e = A.a * B.e + A.b * B.j + A.c * B.o + A.d * B.t + A.e;
      j = A.f * B.e + A.g * B.j + A.h * B.o + A.i * B.t + A.j;
      o = A.k * B.e + A.l * B.j + A.m * B.o + A.n * B.t + A.o;
      t = A.p * B.e + A.q * B.j + A.r * B.o + A.s * B.t + A.t;

      this.a = a;
      this.b = b;
      this.c = c;
      this.d = d;
      this.e = e;
      this.f = f;
      this.g = g;
      this.h = h;
      this.i = i;
      this.j = j;
      this.k = k;
      this.l = l;
      this.m = m;
      this.n = n;
      this.o = o;
      this.p = p;
      this.q = q;
      this.r = r;
      this.s = s;
      this.t = t;

      return this;
    }

    /**
     * Retuns a clone of the current matrix/
     * @return {PhotoEditorSDK.Math.ColorMatrix}
     */

  }, {
    key: 'clone',
    value: function clone() {
      var matrix = new ColorMatrix();
      matrix.set(this.a, this.b, this.c, this.d, this.e, this.f, this.g, this.h, this.i, this.j, this.k, this.l, this.m, this.n, this.o, this.p, this.q, this.r, this.s, this.t);
      return matrix;
    }

    /**
     * Checks if the values of the given matrix match this matrix's values.
     * @param  {PhotoEditorSDK.Math.ColorMatrix} matrix
     * @return {Boolean}
     */

  }, {
    key: 'equals',
    value: function equals(matrix) {
      return this.a === matrix.a && this.b === matrix.b && this.c === matrix.c && this.d === matrix.d && this.e === matrix.e && this.f === matrix.f && this.g === matrix.g && this.h === matrix.h && this.i === matrix.i && this.j === matrix.j && this.k === matrix.k && this.l === matrix.l && this.m === matrix.m && this.n === matrix.n && this.o === matrix.o && this.p === matrix.p && this.q === matrix.q && this.r === matrix.r && this.s === matrix.s && this.t === matrix.t;
    }

    /**
     * Returns the offset values of this matrix
     * @return {Number[]}
     */

  }, {
    key: 'getOffsets',
    value: function getOffsets() {
      return [this.e, this.j, this.o, this.t];
    }

    /**
     * Returns a string representation of this color matrix
     * @return {String}
     */

  }, {
    key: 'toString',
    value: function toString() {
      return 'ColorMatrix( ' + this.a + ', ' + this.b + ', ' + this.c + ', ' + this.d + ', ' + this.e + ',\n      ' + this.f + ', ' + this.g + ', ' + this.h + ', ' + this.i + ', ' + this.j + ',\n      ' + this.k + ', ' + this.l + ', ' + this.m + ', ' + this.n + ', ' + this.o + ',\n      ' + this.p + ', ' + this.q + ', ' + this.r + ', ' + this.s + ', ' + this.t + ' )';
    }

    /**
     * Returns an array of numbers
     * @return {Number[]}
     */

  }, {
    key: 'toArray',
    value: function toArray() {
      var _this = this;

      return 'abcdefghijklmnopqrst'.split('').map(function (v) {
        return _this[v];
      });
    }

    /**
     * The identity matrix
     * @static
     * @type {PhotoEditorSDK.Math.ColorMatrix}
     */

  }], [{
    key: 'createBrightnessMatrix',


    /**
     * Returns a color matrix that can be used to change the brightness.
     * @param {Number} brightness
     * @return {PhotoEditorSDK.Math.ColorMatrix}
     */
    value: function createBrightnessMatrix(brightness) {
      var matrix = new ColorMatrix();
      matrix.e = brightness;
      matrix.j = brightness;
      matrix.o = brightness;
      return matrix;
    }

    /**
     * Returns a color matrix that can be used to change the contrast.
     * @param {Number} contrast
     * @return {PhotoEditorSDK.Math.ColorMatrix}
     */

  }, {
    key: 'createContrastMatrix',
    value: function createContrastMatrix(contrast) {
      var matrix = new ColorMatrix();
      var t = (1.0 - contrast) / 2.0;
      matrix.a = matrix.g = matrix.m = contrast;
      matrix.e = matrix.j = matrix.o = t;
      return matrix;
    }

    /**
     * Returns a color matrix that can be used to change the saturation.
     * @param {Number} saturation
     * @return {PhotoEditorSDK.Math.ColorMatrix}
     */

  }, {
    key: 'createSaturationMatrix',
    value: function createSaturationMatrix() {
      var saturation = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 1.0;

      var matrix = new ColorMatrix();
      var invSat = 1 - saturation;
      var r = 0.213 * invSat;
      var g = 0.715 * invSat;
      var b = 0.072 * invSat;

      // first row
      matrix.a = r + saturation;
      matrix.b = g;
      matrix.c = b;
      // second row
      matrix.f = r;
      matrix.g = g + saturation;
      matrix.h = b;
      // third row
      matrix.k = r;
      matrix.l = g;
      matrix.m = b + saturation;
      return matrix;
    }

    /**
     * Returns a color matrix that can be used to change the exposure.
     * @param {Number} saturation
     * @return {PhotoEditorSDK.Math.ColorMatrix}
     */

  }, {
    key: 'createExposureMatrix',
    value: function createExposureMatrix() {
      var exposure = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;

      var scale = Math.pow(2, exposure);
      return new ColorMatrix(scale, 0, 0, 0, 0, 0, scale, 0, 0, 0, 0, 0, scale, 0, 0, 0, 0, 0, 1, 0);
    }

    /**
     * Returns a color matrix that can be used to apply linear changes.
     * @static
     * @param {Number} slope
     * @param {Number} intercept
     * @return {PhotoEditorSDK.Math.ColorMatrix}
     */

  }, {
    key: 'createLinearMatrix',
    value: function createLinearMatrix() {
      var slope = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 1.0;
      var intercept = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0.0;

      var matrix = new ColorMatrix();
      matrix.a = matrix.g = matrix.m = slope;
      matrix.e = matrix.j = matrix.o = intercept;
      return matrix;
    }
  }, {
    key: 'IDENTITY',
    get: function get() {
      return new ColorMatrix();
    }
  }]);

  return ColorMatrix;
}();

/* harmony default export */ __webpack_exports__["a"] = (ColorMatrix);

/***/ }),
/* 119 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
Object.defineProperty(__webpack_exports__, "__esModule", { value: true });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__vector2__ = __webpack_require__(34);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__vector3__ = __webpack_require__(224);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__rectangle__ = __webpack_require__(109);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__matrix__ = __webpack_require__(108);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__color_matrix__ = __webpack_require__(118);
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "Vector2", function() { return __WEBPACK_IMPORTED_MODULE_0__vector2__["a"]; });
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "Vector3", function() { return __WEBPACK_IMPORTED_MODULE_1__vector3__["a"]; });
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "Rectangle", function() { return __WEBPACK_IMPORTED_MODULE_2__rectangle__["a"]; });
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "Matrix", function() { return __WEBPACK_IMPORTED_MODULE_3__matrix__["a"]; });
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "ColorMatrix", function() { return __WEBPACK_IMPORTED_MODULE_4__color_matrix__["a"]; });
/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */







/**
 * Some classes that help us do the math
 * @namespace PhotoEditorSDK.Math
 */


/***/ }),
/* 120 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
Object.defineProperty(__webpack_exports__, "__esModule", { value: true });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__exif_orientation_operation__ = __webpack_require__(225);
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "ExifOrientationOperation", function() { return __WEBPACK_IMPORTED_MODULE_0__exif_orientation_operation__["a"]; });
/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */

/**
 * @namespace PhotoEditorSDK.Operations
 * @memberof  PhotoEditorSDK
 */


/***/ }),
/* 121 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__constants__ = __webpack_require__(28);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__shared_vendor_promise__ = __webpack_require__(29);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__shared_log__ = __webpack_require__(17);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__engine___ = __webpack_require__(55);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__lib_configurable__ = __webpack_require__(46);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9__lib_performance_test__ = __webpack_require__(122);





var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* jshint unused:false */
/* jshint -W083 */
/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */








/**
 * Base class for Operations
 * @class
 * @alias Operation
 * @extends PhotoEditorSDK.Configurable
 * @memberof PhotoEditorSDK
 */

var Operation = function (_Configurable) {
  _inherits(Operation, _Configurable);

  /**
   * Creates an Operation
   * @param  {PhotoEditorSDK} sdk
   * @param  {Object} [options]
   */
  function Operation(sdk) {
    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};

    _classCallCheck(this, Operation);

    var _this = _possibleConstructorReturn(this, (Operation.__proto__ || __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default()(Operation)).call(this, options, {
      enabled: { type: __WEBPACK_IMPORTED_MODULE_4__constants__["OptionType"].BOOLEAN, default: true, serializable: false }
    }));

    _this._sdk = sdk;
    _this._cacheEnabled = false;
    _this._dirtiness = {};

    _this._sprite = new __WEBPACK_IMPORTED_MODULE_7__engine___["a" /* default */].Sprite();
    _this._container = new __WEBPACK_IMPORTED_MODULE_7__engine___["a" /* default */].Container();
    _this._container.addChild(_this._sprite);
    return _this;
  }

  // -------------------------------------------------------------------------- EVENTS

  /**
   * Gets called when options have been changed. Sets this operation to dirty.
   * @private
   */


  _createClass(Operation, [{
    key: '_onOptionsChange',
    value: function _onOptionsChange() {
      this.setDirty(true);
    }

    // -------------------------------------------------------------------------- RENDERING

    /**
     * Applies this operation
     * @param  {PhotoEditorSDK.Engine.RenderTexture} inputTexture
     * @return {Promise}
     * @abstract
     */

  }, {
    key: 'render',
    value: function render(inputTexture) {
      var _this2 = this;

      if (!this.getEnabled()) {
        __WEBPACK_IMPORTED_MODULE_6__shared_log__["a" /* default */].info(this.constructor.name, 'Disabled - skipping');
        return __WEBPACK_IMPORTED_MODULE_5__shared_vendor_promise__["a" /* default */].resolve(inputTexture);
      }

      if (!this._renderTexture) {
        var frame = this._sdk.getSprite().getTexture().getFrame();
        this._renderTexture = new __WEBPACK_IMPORTED_MODULE_7__engine___["a" /* default */].RenderTexture(this._sdk.getRenderer(), frame.width, frame.height);
      }

      var renderer = this._sdk.getRenderer();
      var promise = void 0;
      var perf = void 0;
      if (__WEBPACK_IMPORTED_MODULE_6__shared_log__["a" /* default */].canLog('info')) {
        perf = new __WEBPACK_IMPORTED_MODULE_9__lib_performance_test__["a" /* default */](this.constructor.name, 'Rendering');
      }

      // Handle caching
      if (this.isDirtyForRenderer(renderer)) {
        // Make sure that this Operation's internal sprite has the input texture and that
        // the RenderTexture we're rendering to has the same dimensions
        this._sprite.setTexture(inputTexture);

        var newDimensions = this.getNewDimensions(inputTexture.getDimensions()).floor();
        this._renderTexture.resizeTo(newDimensions);
        this._renderTexture.clear();

        // Let the operation do its work
        promise = this._render(inputTexture).then(function () {
          // Operation has been rendered - not dirty anymore
          _this2.setDirtyForRenderer(false, renderer);
          return _this2._renderTexture;
        });
      } else {
        __WEBPACK_IMPORTED_MODULE_6__shared_log__["a" /* default */].info(this.constructor.name, 'Rendering from cache');
        promise = __WEBPACK_IMPORTED_MODULE_5__shared_vendor_promise__["a" /* default */].resolve(this._renderTexture);
      }

      return promise.then(function (outputTexture) {
        if (perf) perf.stop();
        return outputTexture;
      });
    }

    /**
     * Renders this operation
     * @param  {PhotoEditorSDK.Engine.Texture} inputTexture
     * @return {Promise}
     * @private
     */

  }, {
    key: '_render',
    value: function _render(inputTexture) {
      var renderFn = void 0;
      if (this._sdk.getRenderer().isOfType(__WEBPACK_IMPORTED_MODULE_4__constants__["RendererType"].WEBGL)) {
        /* istanbul ignore next */
        renderFn = this._renderWebGL.bind(this);
      } else {
        renderFn = this._renderCanvas.bind(this);
      }

      return renderFn(inputTexture);
    }

    /**
     * Applies this operation using WebGL
     * @param  {PhotoEditorSDK.Engine.Texture} inputTexture
     * @protected
     * @abstract
     */

  }, {
    key: '_renderWebGL',
    value: function _renderWebGL(inputTexture) {
      throw new Error('Operation#_renderWebGL is abstract and not implemented in inherited class.');
    }

    /**
     * Applies this operation using Canvas2D
     * @param  {PhotoEditorSDK.Engine.Texture} inputTexture
     * @protected
     * @abstract
     */

  }, {
    key: '_renderCanvas',
    value: function _renderCanvas(inputTexture) {
      throw new Error('Operation#_renderCanvas is abstract and not implemented in inherited class.');
    }

    /**
     * Returns the dimensions that an image with the given `dimensions`
     * would have after this operation has been applied
     * @param  {PhotoEditorSDK.Math.Vector2} dimensions
     * @return {PhotoEditorSDK.Math.Vector2}
     */

  }, {
    key: 'getNewDimensions',
    value: function getNewDimensions(dimensions) {
      return dimensions.clone();
    }

    /**
     * Resets this operation
     */

  }, {
    key: 'reset',
    value: function reset() {
      this._dirty = true;
      this._glslPrograms = {};
    }

    // -------------------------------------------------------------------------- DIRTINESS

    /**
     * Checks if this operation is dirty for the given renderer
     * @param  {PhotoEditorSDK.Engine.BaseRenderer}  renderer
     * @return {Boolean}
     */

  }, {
    key: 'isDirtyForRenderer',
    value: function isDirtyForRenderer(renderer) {
      var dirty = this._dirtiness[renderer.id];
      return typeof dirty === 'undefined' ? true : dirty;
    }

    /**
     * Sets the dirtiness for the given renderer
     * @param {Boolean} dirty
     * @param {PhotoEditorSDK.Engine.BaseRenderer} renderer
     * @param {Boolean} dimensionsChanged = false
     */

  }, {
    key: 'setDirtyForRenderer',
    value: function setDirtyForRenderer(dirty, renderer) {
      var dimensionsChanged = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;

      this._dirtiness[renderer.id] = dirty;
    }

    /**
     * Sets the dirtiness for all renderers
     * @param {Boolean} dirty
     * @param {Boolean} dimensionsChanged = false
     */

  }, {
    key: 'setDirty',
    value: function setDirty(dirty) {
      var dimensionsChanged = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;

      for (var rendererId in this._dirtiness) {
        this.setDirtyForRenderer(dirty, { id: rendererId }, dimensionsChanged);
      }
    }

    /**
     * Returns the instance of {@link PhotoEditorSDK} that this operation belongs to
     * @return {PhotoEditorSDK}
     */

  }, {
    key: 'getSDK',
    value: function getSDK() {
      return this._sdk;
    }

    /**
     * Returns the input dimensions for this operation
     * @param {Boolean} incorporateZoom = true
     * @return {PhotoEditorSDK.Math.Vector2}
     */

  }, {
    key: 'getInputDimensions',
    value: function getInputDimensions() {
      var _this3 = this;

      var incorporateZoom = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : true;

      var dimensions = this._sdk.getInputDimensions();
      if (incorporateZoom) {
        dimensions.multiply(this._sdk.getZoom()).floor();
      }
      var opFound = void 0;
      this._sdk.getOperationsStack().forEach(function (op) {
        if (opFound) return;
        if (op === _this3) {
          opFound = true;
          return;
        }
        dimensions = op.getNewDimensions(dimensions);
      });
      return dimensions.floor();
    }

    /**
     * Creates a clone of this operation
     * @return {PhotoEditorSDK.Operation}
     */

  }, {
    key: 'clone',
    value: function clone() {
      var Operation = this.constructor;
      return new Operation(this._sdk, this.serializeOptions());
    }

    /**
     * Disposes the RenderTexture
     */

  }, {
    key: 'disposeRenderTextures',
    value: function disposeRenderTextures() {
      if (this._renderTexture) {
        this._renderTexture.dispose();
      }
      this._renderTexture = null;
    }

    /**
     * Disposes this operation
     */

  }, {
    key: 'dispose',
    value: function dispose() {
      this.disposeRenderTextures();
      this._sprite.dispose();
    }
  }]);

  return Operation;
}(__WEBPACK_IMPORTED_MODULE_8__lib_configurable__["a" /* default */]);

/**
 * A unique string that identifies this operation. Can be used to select
 * operations.
 * @type {String}
 */


Operation.identifier = null;

/* harmony default export */ __webpack_exports__["a"] = (Operation);

/***/ }),
/* 122 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__globals__ = __webpack_require__(33);


var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */


/* istanbul ignore next */
var now = typeof window !== 'undefined' && window.performance && window.performance.now ? window.performance.now.bind(window.performance) : __webpack_require__(80);

/**
 * A simple class that tracks the time between start and end and renders it as FPS
 * @class
 * @memberof PhotoEditorSDK
 * @ignore
 */
/* istanbul ignore next */

var PerformanceTest = function () {
  /**
   * Creates a PerformanceTest
   * @param  {String} tag
   * @param  {String} name
   */
  function PerformanceTest(tag, name) {
    _classCallCheck(this, PerformanceTest);

    this._tag = tag;
    this._name = name;
    this._start = now();
  }

  /**
   * Stops the performance test and prints the result
   */


  _createClass(PerformanceTest, [{
    key: 'stop',
    value: function stop() {
      var end = now();
      var ms = end - this._start;
      var fps = Math.round(1000 / ms);
      __WEBPACK_IMPORTED_MODULE_1__globals__["Log"].info(this._tag, this._name + ' took ' + ms.toFixed(2) + 'ms (' + fps + ' FPS)');
    }
  }]);

  return PerformanceTest;
}();

/* harmony default export */ __webpack_exports__["a"] = (PerformanceTest);

/***/ }),
/* 123 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__globals__ = __webpack_require__(33);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__shared_vendor_promise__ = __webpack_require__(29);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__event_emitter__ = __webpack_require__(42);





var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */





/**
 * Holds an array of {@link PhotoEditorSDK.Operation} instances and handles their dirtiness
 * @class
 * @memberof PhotoEditorSDK
 */

var OperationsStack = function (_EventEmitter) {
  _inherits(OperationsStack, _EventEmitter);

  /**
   * Creates an OperationsStack
   * @param  {PhotoEditorSDK.Operation[]} [operations = []]
   */
  function OperationsStack() {
    var operations = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];

    _classCallCheck(this, OperationsStack);

    var _this = _possibleConstructorReturn(this, (OperationsStack.__proto__ || __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default()(OperationsStack)).call(this));

    _this._onOperationUpdate = _this._onOperationUpdate.bind(_this);

    _this._cacheEnabled = true;
    _this._stack = operations;
    _this._stack.forEach(function (operation) {
      operation.on('update', _this._onOperationUpdate);
    });
    return _this;
  }

  /**
   * Clears this operations stack
   */


  _createClass(OperationsStack, [{
    key: 'clear',
    value: function clear() {
      var _this2 = this;

      this.forEach(function (operation) {
        return _this2.remove(operation);
      });
      this._stack = [];
    }

    /**
     * Checks if the operation has changes/modifications
     * @return {Boolean}
     */

  }, {
    key: 'hasChanges',
    value: function hasChanges() {
      return this._stack.filter(function (op) {
        return !!op;
      }).some(function (op) {
        return op.hasChanges();
      });
    }

    /**
     * Gets called when an operation is about to be updated
     * @param  {PhotoEditorSDK.Operation} operation
     * @param  {Object} options
     * @private
     */

  }, {
    key: '_onOperationUpdate',
    value: function _onOperationUpdate(operation, options) {
      this.emit(__WEBPACK_IMPORTED_MODULE_4__globals__["Constants"].Events.OPERATION_UPDATED, operation, options);
    }

    /**
     * Enables the cache on all operations
     */

  }, {
    key: 'enableCache',
    value: function enableCache() {
      this._cacheEnabled = true;
    }

    /**
     * Disables the cache on all operations
     */

  }, {
    key: 'disableCache',
    value: function disableCache() {
      this._cacheEnabled = false;
    }

    /**
     * Passes Array#forEach
     * @param  {Function} iterator
     * @return {Array}
     */

  }, {
    key: 'forEach',
    value: function forEach(iterator) {
      return this._stack.filter(function (op) {
        return !!op;
      }).forEach(iterator);
    }

    /**
     * Renders all operations
     * @param  {PhotoEditorSDK} sdk
     * @param  {PhotoEditorSDK.Engine.Texture} inputTexture
     * @return {Promise}
     */

  }, {
    key: 'render',
    value: function render(sdk, inputTexture) {
      var _this3 = this;

      var currentTexture = inputTexture;
      var operations = this._stack.filter(function (op) {
        return !!op;
      }).filter(function (op) {
        return op.getEnabled();
      });

      // Find first operation from end of array that is not dirty
      operations.reverse();
      var firstUndirtyOperation = operations.filter(function (o) {
        return !o.isDirtyForRenderer(sdk.getRenderer());
      })[0];
      var firstUndirtyIndex = operations.indexOf(firstUndirtyOperation);

      operations.reverse();

      // Skip operations that would be overwritten by succeeding operations
      var startIndex = 0;
      if (firstUndirtyIndex !== -1) {
        startIndex = operations.length - firstUndirtyIndex - 1;
      }

      for (var index = 0; index < startIndex; index++) {
        __WEBPACK_IMPORTED_MODULE_4__globals__["Log"].info(this.constructor.name, 'Skipping ' + operations[index].constructor.name);
      }

      var promise = __WEBPACK_IMPORTED_MODULE_5__shared_vendor_promise__["a" /* default */].resolve(currentTexture);

      var _loop = function _loop(_index) {
        var operation = operations[_index];
        var lastTexture = void 0,
            lastTextureOperation = void 0;
        promise = promise.then(function (inputTexture) {
          return operation.render(inputTexture).then(function (outputTexture) {
            // If cache is disabled, flush textures of previous operation
            if (lastTexture && outputTexture !== lastTexture && !_this3._cacheEnabled) {
              lastTextureOperation.disposeRenderTextures();
            }
            lastTexture = outputTexture;
            lastTextureOperation = operation;
            return outputTexture;
          });
        });
      };

      for (var _index = startIndex; _index < operations.length; _index++) {
        _loop(_index);
      }

      return promise;
    }

    /**
     * Validates the settings of all operations
     * @return {Promise}
     */

  }, {
    key: 'validateSettings',
    value: function validateSettings() {
      return __WEBPACK_IMPORTED_MODULE_5__shared_vendor_promise__["a" /* default */].all(this._stack.filter(function (op) {
        return !!op;
      }).map(function (op) {
        return op.validateSettings();
      }));
    }

    /**
     * Sets all operations to dirty
     * @param {Boolean} dimensionsChanged = falses
     */

  }, {
    key: 'setAllToDirty',
    value: function setAllToDirty() {
      var dimensionsChanged = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;

      this.forEach(function (op) {
        return op.setDirty(true, dimensionsChanged);
      });
    }

    /**
     * Finds the first dirty operation and sets all following operations to dirty
     * @param {PhotoEditorSDK.Engine.BaseRenderer} renderer
     */

  }, {
    key: 'updateDirtinessForRenderer',
    value: function updateDirtinessForRenderer(renderer) {
      var dirtyFound = false;
      for (var i = 0; i < this._stack.length; i++) {
        var _operation = this._stack[i];
        if (!_operation) continue;
        if (_operation.isDirtyForRenderer(renderer)) {
          dirtyFound = true;
        }

        if (dirtyFound) {
          _operation.setDirtyForRenderer(true, renderer);
        }
      }
    }

    /**
     * Adds the given operation to this stack
     * @param {PhotoEditorSDK.Operation} operation
     */

  }, {
    key: 'push',
    value: function push(operation) {
      this._stack.push(operation);
      operation.on('update', this._onOperationUpdate);
    }

    /**
     * Adds the given operation before all existing operations
     * @param  {PhotoEditorSDK.Operation} operation
     */

  }, {
    key: 'unshift',
    value: function unshift(operation) {
      this._stack.unshift(operation);
      operation.on('update', this._onOperationUpdate);
    }

    /**
     * Returns a cloned instance of this stack
     * @return {PhotoEditorSDK.OperationsStack}
     */

  }, {
    key: 'clone',
    value: function clone() {
      return new OperationsStack(this._stack.slice(0));
    }

    /**
     * Returns the operation at the given index
     * @param  {Number} index
     * @return {PhotoEditorSDK.Operation}
     */

  }, {
    key: 'get',
    value: function get(index) {
      return this._stack[index];
    }

    /**
     * Sets the operation at the given index to the given one
     * @param  {Number} index
     * @param  {PhotoEditorSDK.Operation} operation
     */

  }, {
    key: 'set',
    value: function set(index, operation) {
      if (this._stack[index]) {
        this._stack[index].off('update', this._onOperationUpdate);
        this._stack[index].dispose();
      }
      this._stack[index] = operation;
      operation.on('update', this._onOperationUpdate);
    }

    /**
     * Removes the given operation
     * @param  {PhotoEditorSDK.Operation} operation
     */

  }, {
    key: 'remove',
    value: function remove(operation) {
      var index = this._stack.indexOf(operation);
      if (index === -1) {
        return;
      }
      if (this._stack[index]) {
        this._stack[index].off('update', this._onOperationUpdate);
        this._stack[index].dispose();
      }
      this._stack.splice(index, 1);
    }

    /**
     * Removes the operation at the given index
     * @param  {Number} index
     */

  }, {
    key: 'removeAt',
    value: function removeAt(index) {
      if (this._stack[index]) {
        this._stack[index].off('update', this._onOperationUpdate);
        this._stack[index].dispose();
      }
      delete this._stack[index];
    }

    /**
     * Returns the stack
     * @return {PhotoEditorSDK.Operation[]}
     */

  }, {
    key: 'getStack',
    value: function getStack() {
      return this._stack;
    }
  }, {
    key: 'dispose',
    value: function dispose() {
      this.forEach(function (operation) {
        operation.dispose();
      });
    }
  }]);

  return OperationsStack;
}(__WEBPACK_IMPORTED_MODULE_6__event_emitter__["a" /* default */]);

/* harmony default export */ __webpack_exports__["a"] = (OperationsStack);

/***/ }),
/* 124 */
/***/ (function(module, exports) {

module.exports = {"name":"photoeditorsdk","version":"4.6.0","description":"The most comprehensive photo editor SDK for HTML5","repository":"http://github.com/imgly/pesdk-html5","author":"PhotoEditorSDK (9elements GmbH) <contact@photoeditorsdk.com>","license":"SEE LICENSE IN LICENSE.md","bin":{},"scripts":{"start":"npm run watch","release":"cross-env PESDK_CLEAN=true PESDK_ASSETS=true PESDK_RELEASE=true webpack --progress --colors && cross-env npm run prerender-desktop-css && rimraf build/examples/qa-* && rimraf build/examples/ci-* && rimraf build/**/dev.*","release:production":"cross-env ENV=production npm run release && rm -rf build/examples/shared","release:test":"cross-env ENV=test PESDK_CLEAN=true PESDK_ASSETS=true webpack && npm run prerender-desktop-css","release:development":"cross-env ENV=development PESDK_CLEAN=true PESDK_ASSETS=true npm run release","lint":"eslint --ext .jsx,.js src/js","lint:test":"eslint --ext .jsx,.js test","lint:sdk":"eslint --ext .jsx,.js src/js/sdk","lint:ui":"eslint --ext .jsx,.js src/js/ui","lint:ui:react-ui":"eslint --ext .jsx,.js src/js/ui/react-ui","lint:ui:desktop-ui":"eslint --ext .jsx,.js src/js/ui/desktop-ui","build":"cross-env PESDK_CLEAN=true PESDK_ASSETS=true webpack","rebuild":"cross-env PESDK_ASSETS=true webpack --progress --color","clean":"rimraf build/* doc/* dist/*","watch":"cross-env PESDK_CLEAN=true PESDK_ASSETS=true PESDK_SERVE=true webpack --watch --progress --colors","watch:test":"cross-env PESDK_CLEAN=true PESDK_ASSETS=true ENV=test webpack --watch --progress --colors","watch:production":"cross-env PESDK_CLEAN=true PESDK_ASSETS=true PESDK_SERVE=true webpack --watch --progress --colors","test":"npm run test:sdk && npm run test:ui && npm run test:ui:react-ui && npm run test:desktop-ui && npm run server","test:ui":"cross-env ENV=test node_modules/.bin/mocha --require test/sdk/support/modules --require test/sdk/support/helpers test/ui","test:sdk":"cross-env ENV=test node_modules/.bin/mocha --require test/sdk/support/modules --require test/sdk/support/helpers test/sdk","test:ui:react-ui":"cross-env ENV=test node --stack-size=65500 node_modules/.bin/mocha --require test/react-ui/support/helpers test/shared/run-server.js \"test/react-ui/*.test.js\" \"test/react-ui/**/*.test.js\"","test:ui:desktop-ui":"cross-env ENV=test node --stack-size=65500  node_modules/.bin/mocha --require test/desktop-ui/support/helpers test/shared/run-server.js \"test/desktop-ui/*.test.js\" \"test/desktop-ui/**/*.test.js\"","test:server":"cross-env ENV=test node --stack-size=65500 node_modules/.bin/mocha --require test/sdk/support/modules --require test/server/support/helpers test/shared/run-server.js \"test/server/*.test.js\" \"test/server/**/*.test.js\"","test:comparison":"cross-env ENV=test node --stack-size=65500 node_modules/.bin/mocha --require test/sdk/support/modules --require test/comparison/support/helpers \"test/comparison/*.test.js\" \"test/comparison/**/*.test.js\"","test:webgl":"cross-env RENDERER=webgl ENV=test node_modules/.bin/mocha --require test/sdk/support/modules --require test/sdk/support/helpers test/sdk","jsdoc":"rimraf doc/photoeditorsdk && jsdoc -c config/jsdoc/jsdoc.json -r","jsdoc:server":"rimraf doc/photoeditorsdk-server && jsdoc -c config/jsdoc/jsdoc.server.json -r","render-filter-previews":"node scripts/run render-filter-previews","prerender-desktop-css":"node scripts/run render-desktop-ui-css","dist:sdk":"rimraf dist/photoeditorsdk && cp -r build/photoeditorsdk/ dist/photoeditorsdk && find dist/photoeditorsdk -d 2 -name '*.min.*'  | sed 'p;s/.min././' | xargs -n2 cp && npm run jsdoc","dist:server":"rimraf dist/photoeditorsdk-server && cp -r build/photoeditorsdk-server/ dist/photoeditorsdk-server && find dist/photoeditorsdk-server -d 2 -name '*.min.*'  | sed 's/.min././' | xargs -n1 rm && npm run jsdoc:server","precommit":"true","prepush":"npm run lint"},"devDependencies":{"adonis":"git://github.com/imgly/adonis.git#v1.0.1","ajv":"^5.5.1","babel-core":"^6.26.0","babel-eslint":"^8.2.1","babel-loader":"^7.1.2","babel-minify-webpack-plugin":"^0.2.0","babel-plugin-external-helpers":"^6.22.0","babel-plugin-transform-adonis-hash":"^0.4.0","babel-plugin-transform-class-properties":"^6.19.0","babel-plugin-transform-es2015-classes":"^6.6.4","babel-plugin-transform-object-rest-spread":"^6.26.0","babel-plugin-transform-proto-to-assign":"^6.26.0","babel-plugin-transform-runtime":"^6.6.0","babel-preset-env":"^1.6.1","babel-preset-es2015":"^6.6.0","babel-preset-minify":"^0.2.0","babel-preset-react":"^6.5.0","babel-preset-stage-3":"^6.24.1","babel-register":"^6.26.0","babel-runtime":"^6.26.0","chai":"^3.4.0","chai-as-promised":"^5.1.0","chromedriver":"^2.37.0","classnames":"^2.1.3","clean-webpack-plugin":"^0.1.16","compass-mixins":"^0.12.8","copy-webpack-plugin":"^4.3.0","cross-env":"^5.1.1","css-loader":"^0.28.7","del":"^2.0.0","djv":"^1.2.0","eslint":"^4.16.0","eslint-config-standard":"^11.0.0","eslint-plugin-import":"^2.10.0","eslint-plugin-mocha":"^5.0.0","eslint-plugin-node":"^6.0.1","eslint-plugin-promise":"^3.7.0","eslint-plugin-standard":"^3.0.1","express":"^4.16.2","extract-text-webpack-plugin":"^3.0.2","husky":"^0.14.3","inquirer":"^0.11.4","inquirer-path":"^1.0.0-beta5","isomorphic-fetch":"^2.2.1","jaguarjs-jsdoc":"git://github.com/imgly/jaguarjs-jsdoc.git#master","jsdoc":"^3.5.5","json-loader":"^0.5.7","lodash":"^4.17.4","minimist":"^1.2.0","mkdirp":"^0.5.1","mocha":"^3.5.3","nightwatch":"git://github.com/imgly/nightwatch.git#feature/file-upload-and-multiple-selectors","node-sass":"^4.7.2","node-static":"^0.7.10","optimize-css-assets-webpack-plugin":"^3.2.0","performance-now":"^0.2.0","pixelmatch":"^4.0.2","pngjs":"^3.3.2","preprocess-loader":"^0.2.2","pretty-error":"^2.0.0","prompt":"^1.0.0","prop-types":"^15.6.0","raw-loader":"^0.5.1","react":"^16.2.0","react-dom":"^16.2.0","rembrandt":"^0.1.3","rimraf":"^2.6.2","sass-loader":"^6.0.6","selenium-server-standalone-jar":"3.4.0","should":"^4.3.0","sinon":"^1.17.3","sinon-chai":"^2.14.0","standard":"^9.0.2","standard-loader":"^6.0.1","stats.js":"^0.16.0","style-loader":"^0.13.1","term-img2":"^2.0.1","transform-loader":"^0.2.2","uglifyjs-webpack-plugin":"^0.4.6","vinyl-source-stream":"0.1.1","webpack":"^3.10.0","webpack-notifier":"^1.2.1"},"standard":{"globals":["describe","context","before","beforeEach","after","afterEach","it","expect"],"parser":"babel-eslint"},"dependencies":{"canvas":"git://github.com/imgly/node-canvas.git#v2.0.0-alpha.9","gl":"^4.0.4","request":"^2.83.0"}}

/***/ }),
/* 125 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__);





var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */


var ColorMatrix = __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Math"].ColorMatrix;

var EPSILON = 0.0000001;

var AdjustmentsFilter = function (_Engine$Filter) {
  _inherits(AdjustmentsFilter, _Engine$Filter);

  function AdjustmentsFilter() {
    _classCallCheck(this, AdjustmentsFilter);

    var _this = _possibleConstructorReturn(this, (AdjustmentsFilter.__proto__ || __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default()(AdjustmentsFilter)).call(this));

    _this._fragmentSource = __webpack_require__(236);
    return _this;
  }

  /**
   * Applies this filter to the given inputTarget and renders it to
   * the given outputTarget using the CanvasRenderer
   * @param  {CanvasRenderer} renderer
   * @param  {RenderTarget} inputTarget
   * @param  {RenderTarget} outputTarget
   * @param  {Boolean} clear = false
   * @private
   */


  _createClass(AdjustmentsFilter, [{
    key: '_applyCanvas',
    value: function _applyCanvas(renderer, inputTarget, outputTarget) {
      var clear = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;

      var canvas = inputTarget.getCanvas();
      var inputContext = inputTarget.getContext();
      var outputContext = outputTarget.getContext();

      var imageData = inputContext.getImageData(0, 0, canvas.width, canvas.height);

      var _options = this._options,
          colorMatrix = _options.colorMatrix,
          gamma = _options.gamma,
          shadows = _options.shadows,
          highlights = _options.highlights;

      var applyGamma = gamma !== 1;
      var applyShadowsAndHighlights = shadows !== 0 || highlights !== 0;

      var color = new __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Color"](0, 0, 0, 0);

      for (var i = 0; i < canvas.width * canvas.height; i++) {
        var index = i * 4;

        color.r = imageData.data[index] / 255;
        color.g = imageData.data[index + 1] / 255;
        color.b = imageData.data[index + 2] / 255;

        // Gamma
        if (applyGamma) {
          color.r = Math.pow(color.r, 1.0 / Math.max(gamma, EPSILON));
          color.g = Math.pow(color.g, 1.0 / Math.max(gamma, EPSILON));
          color.b = Math.pow(color.b, 1.0 / Math.max(gamma, EPSILON));
        }

        // Apply shadows and highlights
        if (applyShadowsAndHighlights) {
          var luminance = color.r * 0.2125 + color.g * 0.7154 + color.b * 0.0721;

          var shadow = shadows >= 0 ? __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Utils"].clamp(Math.pow(luminance, 1 / (shadows + 1)) + Math.pow(luminance, 2 / (shadows + 1)) * -0.76 - luminance, 0, Math.max(shadows, 1)) : -__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Utils"].clamp(Math.pow(luminance, 1 / (-shadows + 1)) + Math.pow(luminance, 2 / (-shadows + 1)) * -0.76 - luminance, 0, Math.max(-shadows, 1));

          var highlight = highlights < 0 ? __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Utils"].clamp(1 - Math.pow(1 - luminance, 1 / (1 - highlights)) - Math.pow(1 - luminance, 2 / (1 - highlights)) * -0.8 - luminance, -1, 0) : -__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Utils"].clamp(1 - Math.pow(1 - luminance, 1 / (1 + highlights)) - Math.pow(1 - luminance, 2 / (1 + highlights)) * -0.8 - luminance, -1, 0);

          var shadowContrast = shadow * luminance * luminance;
          var shadowBrightness = shadow - shadowContrast;

          var offset = luminance + shadowContrast + highlight;
          color.r = __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Utils"].clamp(offset * ((color.r + shadowBrightness) / Math.max(luminance, EPSILON)), 0, 1);
          color.g = __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Utils"].clamp(offset * ((color.g + shadowBrightness) / Math.max(luminance, EPSILON)), 0, 1);
          color.b = __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Utils"].clamp(offset * ((color.b + shadowBrightness) / Math.max(luminance, EPSILON)), 0, 1);
        }

        // Brightness, saturation, contrast, exposire
        color = colorMatrix.apply(color);

        // Apply colors
        imageData.data[index] = color.r * 255;
        imageData.data[index + 1] = color.g * 255;
        imageData.data[index + 2] = color.b * 255;
      }

      outputContext.putImageData(imageData, 0, 0);
    }
  }]);

  return AdjustmentsFilter;
}(__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Engine"].Filter);

AdjustmentsFilter.prototype.availableOptions = {
  gamma: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].NUMBER, default: 1, uniformType: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["UniformType"].FLOAT },
  shadows: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].NUMBER, default: 0, uniformType: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["UniformType"].FLOAT },
  highlights: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].NUMBER, default: 1, uniformType: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["UniformType"].FLOAT },
  colorMatrix: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].COLOR_MATRIX, default: new ColorMatrix(), uniformType: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["UniformType"].MAT4 },
  colorOffset: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].ARRAY, default: [], uniformType: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["UniformType"].FLOAT4 }
};

/* harmony default export */ __webpack_exports__["a"] = (AdjustmentsFilter);

/***/ }),
/* 126 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor__ = __webpack_require__(7);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__vendor_stack_blur__ = __webpack_require__(59);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__vendor_stack_blur___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_6__vendor_stack_blur__);






var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor___default()(object, property); if (desc === undefined) { var parent = __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if ("value" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




var Vector2 = __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Math"].Vector2;

var BlurFilter = function (_Engine$Filter) {
  _inherits(BlurFilter, _Engine$Filter);

  function BlurFilter() {
    var _ref;

    _classCallCheck(this, BlurFilter);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this = _possibleConstructorReturn(this, (_ref = BlurFilter.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(BlurFilter)).call.apply(_ref, [this].concat(args)));

    _this._fragmentSource = __webpack_require__(240);

    _this._lastBlurRadius = null;
    _this._lastDimensions = new Vector2(0, 0);

    _this._blurredRenderTarget = new __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Engine"].CanvasRenderTarget(100, 100, 1);
    return _this;
  }

  /**
   * Applies this filter to the given inputTarget and renders it to
   * the given outputTarget using the CanvasRenderer
   * @param  {CanvasRenderer} renderer
   * @param  {RenderTarget} inputTarget
   * @param  {RenderTarget} outputTarget
   * @param  {Boolean} clear = false
   * @private
   */


  _createClass(BlurFilter, [{
    key: '_applyCanvas',
    value: function _applyCanvas(renderer, inputTarget, outputTarget) {
      var clear = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;

      var inputDimensions = inputTarget.getDimensions();
      var dimensionsChanged = !this._lastDimensions.equals(inputDimensions);

      this._blurredRenderTarget.setPixelRatio(inputTarget.getPixelRatio());
      this._blurredRenderTarget.resizeTo(inputTarget.getDimensions());

      outputTarget.setPixelRatio(inputTarget.getPixelRatio());
      outputTarget.resizeTo(inputTarget.getDimensions());

      if (this._lastBlurRadius !== this._options.blurRadius || dimensionsChanged) {
        this._blurImage(inputTarget);
        this._lastBlurRadius = this._options.blurRadius;
      }

      var outputContext = outputTarget.getContext();
      outputContext.drawImage(this._blurredRenderTarget.getCanvas(), 0, 0);

      this._lastDimensions.copy(inputDimensions);
    }

    /**
     * Creates a blurred copy of the image
     * @param  {CanvasRenderTarget} inputTarget
     * @return {Canvas}
     * @private
     */

  }, {
    key: '_blurImage',
    value: function _blurImage(inputTarget) {
      var inputCanvas = inputTarget.getCanvas();
      var inputContext = inputTarget.getContext();

      var inputDimensions = new Vector2(inputCanvas.width, inputCanvas.height);
      var blurryImageData = inputContext.getImageData(0, 0, inputCanvas.width, inputCanvas.height);
      __WEBPACK_IMPORTED_MODULE_6__vendor_stack_blur___default.a.stackBlurCanvasRGBA(blurryImageData, 0, 0, inputCanvas.width, inputCanvas.height, this._options.blurRadius * inputDimensions.min());

      var outputContext = this._blurredRenderTarget.getContext();
      outputContext.putImageData(blurryImageData, 0, 0);
    }

    /**
     * Disposes this filter
     */

  }, {
    key: 'dispose',
    value: function dispose() {
      _get(BlurFilter.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(BlurFilter.prototype), 'dispose', this).call(this);
      this._blurredRenderTarget.dispose();
    }
  }]);

  return BlurFilter;
}(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Engine"].Filter);

BlurFilter.prototype.availableOptions = {
  blurRadius: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].NUMBER, default: 30, uniformType: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["UniformType"].FLOAT },
  delta: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].VECTOR2, default: new Vector2(1, 1), uniformType: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["UniformType"].FLOAT2 },
  texSize: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].VECTOR2, default: new Vector2(100, 100), uniformType: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["UniformType"].FLOAT2 }
};

/* harmony default export */ __webpack_exports__["a"] = (BlurFilter);

/***/ }),
/* 127 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__filter__ = __webpack_require__(5);





var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




/**
 * Identity Filter
 * @class
 * @extends PhotoEditorSDK.Filter
 * @memberof PhotoEditorSDK.Filters
 */

var IdentityFilter = function (_Filter) {
  _inherits(IdentityFilter, _Filter);

  function IdentityFilter() {
    _classCallCheck(this, IdentityFilter);

    return _possibleConstructorReturn(this, (IdentityFilter.__proto__ || __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default()(IdentityFilter)).apply(this, arguments));
  }

  _createClass(IdentityFilter, [{
    key: 'render',

    /**
     * Renders the filter
     * @param  {PhotoEditorSDK} sdk
     * @param  {Engine.RenderTexture}
     * @return {Promise}
     */
    value: function render(sdk, inputTexture, outputTexture) {
      return __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Promise"].resolve(outputTexture);
    }

    /**
     * Checks if the operation has changes/modifications
     * @return {Boolean}
     */

  }, {
    key: 'hasChanges',
    value: function hasChanges() {
      return false;
    }
  }]);

  return IdentityFilter;
}(__WEBPACK_IMPORTED_MODULE_5__filter__["a" /* default */]);

IdentityFilter.isIdentity = true;

/**
 * This filter's identifier
 * @type {String}
 * @default
 */
IdentityFilter.identifier = 'identity';

/* harmony default export */ __webpack_exports__["a"] = (IdentityFilter);

/***/ }),
/* 128 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_get_own_property_descriptor__ = __webpack_require__(7);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_get_own_property_descriptor___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_get_own_property_descriptor__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__primitive__ = __webpack_require__(13);






var _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_get_own_property_descriptor___default()(object, property); if (desc === undefined) { var parent = __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if ("value" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




var LookupTableFilter = function (_Engine$Filter) {
  _inherits(LookupTableFilter, _Engine$Filter);

  function LookupTableFilter() {
    var _ref;

    _classCallCheck(this, LookupTableFilter);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this = _possibleConstructorReturn(this, (_ref = LookupTableFilter.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(LookupTableFilter)).call.apply(_ref, [this].concat(args)));

    _this._fragmentSource = __webpack_require__(260);
    return _this;
  }

  /**
   * Applies this filter to the given inputTarget and renders it to
   * the given outputTarget using the CanvasRenderer
   * @param  {CanvasRenderer} renderer
   * @param  {RenderTarget} inputTarget
   * @param  {RenderTarget} outputTarget
   * @param  {Boolean} clear = false
   * @private
   */


  _createClass(LookupTableFilter, [{
    key: '_applyCanvas',
    value: function _applyCanvas(renderer, inputTarget, outputTarget) {
      var clear = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;

      var canvas = inputTarget.getCanvas();
      var inputContext = inputTarget.getContext();
      var outputContext = outputTarget.getContext();

      var imageData = inputContext.getImageData(0, 0, canvas.width, canvas.height);

      var table = this._options.lookupTableData;
      for (var i = 0; i < canvas.width * canvas.height; i++) {
        var index = i * 4;

        var r = imageData.data[index];
        imageData.data[index] = table[r * 4];
        var g = imageData.data[index + 1];
        imageData.data[index + 1] = table[1 + g * 4];
        var b = imageData.data[index + 2];
        imageData.data[index + 2] = table[2 + b * 4];
      }

      outputContext.putImageData(imageData, 0, 0);
    }
  }]);

  return LookupTableFilter;
}(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Engine"].Filter);

/**
 * Specifies the available options for this filter
 * @type {Object}
 * @ignore
 */


LookupTableFilter.prototype.availableOptions = {
  lookupTable: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].NUMBER, default: 1, uniformType: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["UniformType"].INT },
  lookupTableData: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].ARRAY, default: [] }

  /**
   * Stores a 256 byte long lookup table in a 2d texture which will be
   * used to look up the corresponding value for each channel.
   * @class
   * @extends PhotoEditorSDK.Filters.Primitive
   * @memberof PhotoEditorSDK.FilterPrimitives
   */
};
var LookupTable = function (_Primitive) {
  _inherits(LookupTable, _Primitive);

  function LookupTable() {
    var _ref2;

    _classCallCheck(this, LookupTable);

    for (var _len2 = arguments.length, args = Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {
      args[_key2] = arguments[_key2];
    }

    var _this2 = _possibleConstructorReturn(this, (_ref2 = LookupTable.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(LookupTable)).call.apply(_ref2, [this].concat(args)));

    _this2._filter = new LookupTableFilter({
      lookupTable: _this2._options.textureGLUnit
    });
    _this2._textures = {};
    _this2._renderers = {};
    return _this2;
  }

  /**
   * Gets called before this primitive's filter is being applied
   * @param {PhotoEditorSDK} sdk
   */


  _createClass(LookupTable, [{
    key: 'update',
    value: function update(sdk) {
      var renderer = sdk.getRenderer();

      /* istanbul ignore if */
      if (renderer.isOfType(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["RendererType"].WEBGL)) {
        this._updateWebGLTexture(sdk);
      } else if (renderer.isOfType(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["RendererType"].CANVAS)) {
        this._filter.setLookupTableData(this._options.data);
      }
    }

    /**
     * Updates the lookup table texture (WebGL only)
     * @param {PhotoEditorSDK} sdk
     * @private
     */
    /* istanbul ignore next */

  }, {
    key: '_updateWebGLTexture',
    value: function _updateWebGLTexture(sdk) {
      if (typeof this._options.data === 'undefined') {
        throw new Error('LookupTable: No data specified.');
      }

      var data = new Uint8Array(this._options.data);

      var renderer = sdk.getRenderer();
      var id = renderer.id;

      this._renderers[id] = renderer;
      if (!this._textures[id]) {
        this._textures[id] = new __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Engine"].BaseTexture();
      }

      var texture = this._textures[id];
      var pixelArrayImage = new __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Engine"].PixelArrayImage(256, 1, data);
      texture.setSource(pixelArrayImage);
      texture.setGLUnit(this._options.textureGLUnit);

      /* istanbul ignore next */
      if (renderer.isOfType(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["RendererType"].WEBGL)) {
        renderer.updateTexture(texture);
      }
    }

    /**
     * Cleans up this primitive
     */

  }, {
    key: 'dispose',
    value: function dispose() {
      _get(LookupTable.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(LookupTable.prototype), 'dispose', this).call(this);
      for (var id in this._textures) {
        this._textures[id].dispose();
        delete this._textures[id];
      }
      delete this._options.data;
    }
  }]);

  return LookupTable;
}(__WEBPACK_IMPORTED_MODULE_6__primitive__["a" /* default */]);

/* harmony default export */ __webpack_exports__["a"] = (LookupTable);

/***/ }),
/* 129 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor__ = __webpack_require__(7);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__brush_path__ = __webpack_require__(317);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__sprite__ = __webpack_require__(60);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__brush_brushes_brush__ = __webpack_require__(130);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9__brush_brushes_radial_brush__ = __webpack_require__(319);






var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor___default()(object, property); if (desc === undefined) { var parent = __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if ("value" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */







var Vector2 = __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Math"].Vector2;

/**
 * A Brush that can be drawn by SpriteOperation. Should only be created via {@link PhotoEditorSDK.Operations.SpriteOperation#createBrush}
 * @class
 * @memberof PhotoEditorSDK.Operations.SpriteOperation
 */

var BrushSprite = function (_Sprite) {
  _inherits(BrushSprite, _Sprite);

  /**
   * Creates a new Sticker
   * @param  {PhotoEditorSDK.Operations.SpriteOperation} operation
   * @param  {Object} [options]
   */
  function BrushSprite() {
    var _ref;

    _classCallCheck(this, BrushSprite);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this = _possibleConstructorReturn(this, (_ref = BrushSprite.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(BrushSprite)).call.apply(_ref, [this].concat(args)));

    _this._persistedPaths = [];
    _this._outputCanvasDirty = true;
    _this._outputCanvas = __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Utils"].createCanvas();
    _this._outputContext = _this._outputCanvas.getContext('2d');
    _this._persistCanvas = __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Utils"].createCanvas();
    _this._persistContext = _this._persistCanvas.getContext('2d');
    _this._nextCanvas = __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Utils"].createCanvas();

    _this._texture = __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Engine"].Texture.fromCanvas(_this._outputCanvas);
    _this._sprite.setTexture(_this._texture);

    _this._onPathUpdate = _this._onPathUpdate.bind(_this);
    return _this;
  }

  /**
   * Applies a flip in the given direction
   * @param  {String} direction
   */


  _createClass(BrushSprite, [{
    key: 'applyFlip',
    value: function applyFlip(direction) {
      this._options.paths.forEach(function (path) {
        path.forEachControlPoint(function (controlPoint) {
          var position = controlPoint.getPosition().clone();
          switch (direction) {
            case 'horizontal':
              position.x = 1 - position.x;
              break;
            case 'vertical':
              position.y = 1 - position.y;
              break;
          }
          controlPoint.setPosition(position);
        });
        path.setDirty(true);
      });

      this._reset();
    }

    /**
     * Applies a rotation with the given degrees
     * @param  {Number} degrees
     */

  }, {
    key: 'applyRotation',
    value: function applyRotation(degrees) {
      this._options.paths.forEach(function (path) {
        path.forEachControlPoint(function (controlPoint) {
          var position = controlPoint.getPosition().clone();
          if (degrees === 90) {
            position.flip();
            position.x = 1 - position.x;
          } else if (degrees === -90) {
            position.flip();
            position.y = 1 - position.y;
          }
          controlPoint.setPosition(position);
        });

        path.setDirty(true);
      });

      this._reset();
    }

    /**
     * Applies the given transform change
     * @param  {PhotoEditorSDK.Operations.TransformOperation.TransformChange} transformChange
     * @private
     */

  }, {
    key: 'applyTransform',
    value: function applyTransform(transformChange) {
      var lastBrush = null;
      this._options.paths.forEach(function (path) {
        path.forEachControlPoint(function (controlPoint) {
          controlPoint.setPosition(transformChange.applyToRelativePoint(controlPoint.getPosition()));
        });

        // Brushes can be re-used across paths
        var brush = path.getBrush();
        if (brush !== lastBrush) {
          brush.setSize(transformChange.applyToRelativeSize(brush.getSize()));
          lastBrush = brush;
        }
        path.setDirty(true);
      });

      // Update
      this._reset();
    }

    /**
     * Clears the canvas
     */

  }, {
    key: 'clearCanvas',
    value: function clearCanvas() {
      if (!this._outputCanvas) {
        // `clearCanvas` is called when paths are set in Sprite's constructor. At this
        // point, `this._outputCanvas` does not exist yet.
        return;
      }

      this._outputCanvasDirty = true;

      var _outputCanvas = this._outputCanvas,
          width = _outputCanvas.width,
          height = _outputCanvas.height;

      this._outputContext.clearRect(0, 0, width, height);
    }

    /**
     * Clears the persist canvas
     */

  }, {
    key: 'clearPersistCanvas',
    value: function clearPersistCanvas() {
      if (!this._persistCanvas) {
        // `clearCanvas` is called when paths are set in Sprite's constructor. At this
        // point, `this._persistCanvas` does not exist yet.
        return;
      }

      var _persistCanvas = this._persistCanvas,
          width = _persistCanvas.width,
          height = _persistCanvas.height;

      this._persistContext.clearRect(0, 0, width, height);
    }

    /**
     * Returns a serialized version of this configurable
     * @param {String[]} keys
     * @param {Boolean} toObject = false
     * @return {Object}
     */

  }, {
    key: 'serializeOptions',
    value: function serializeOptions(keys) {
      var toObject = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;

      var options = _get(BrushSprite.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(BrushSprite.prototype), 'serializeOptions', this).call(this, keys, toObject);
      if (!keys) options.type = 'brush';
      return options;
    }

    /**
     * Returns a serialized version of the given option
     * @param {String} optionName
     * @param {Boolean} toObject = false
     * @return {*}
     */

  }, {
    key: 'serializeOption',
    value: function serializeOption(optionName) {
      var toObject = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;

      if (optionName === 'paths') {
        return this._options.paths.map(function (path) {
          return path.serializeOptions(undefined, toObject);
        });
      }

      return _get(BrushSprite.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(BrushSprite.prototype), 'serializeOption', this).call(this, optionName, toObject);
    }

    /**
     * Creates and adds a new path
     * @param {PhotoEditorSDK.Operations.SpriteOperation.BrushSprite.Brush} brush
     * @return {PhotoEditorSDK.Operations.SpriteOperation.BrushSprite.Path}
     */

  }, {
    key: 'createPath',
    value: function createPath(brush) {
      var path = new __WEBPACK_IMPORTED_MODULE_6__brush_path__["a" /* default */](this._operation, { brush: brush }, this._nextCanvas);
      path.on('update', this._onPathUpdate);
      this._options.paths.push(path);
      this.setDirty(true);
      return path;
    }

    /**
     * Gets called when a path has been updated
     * @private
     */

  }, {
    key: '_onPathUpdate',
    value: function _onPathUpdate() {
      this._operation.setDirty(true);
      this.setDirty(true);
    }

    /**
     * Gets called when a path has been closed / persisted
     * @param  {PhotoEditorSDK.Operations.SpriteOperation.BrushSprite.Path} path
     * @private
     */

  }, {
    key: '_onPathPersist',
    value: function _onPathPersist(path) {
      path.renderToCanvas(this._persistCanvas);
      this._nextCanvas = path.getCanvas();

      var context = this._nextCanvas.getContext('2d');
      context.clearRect(0, 0, this._nextCanvas.width, this._nextCanvas.height);

      this._persistedPaths.push(path);
    }

    /**
     * Returns the Texture for the sprite that should be rendered
     * @return {PhotoEditorSDK.Engine.Texture}
     * @private
     * @abstract
     */

  }, {
    key: '_getTexture',
    value: function _getTexture() {
      return this._texture;
    }

    /**
     * Sets the dirtiness for the given renderer
     * @param {Boolean} dirty
     * @param {PhotoEditorSDK.Engine.BaseRenderer} renderer
     * @param {Boolean} dimensionsChanged = false
     */

  }, {
    key: 'setDirtyForRenderer',
    value: function setDirtyForRenderer(dirty, renderer) {
      var dimensionsChanged = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;

      _get(BrushSprite.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(BrushSprite.prototype), 'setDirtyForRenderer', this).call(this, dirty, renderer, dimensionsChanged);
      if (dirty && dimensionsChanged) {
        this._persistedPaths = [];
        this._options.paths.forEach(function (path) {
          path.setDirty(true);
        });
      }
    }

    /**
     * Sets this brush to dirty
     * @param {Boolean} dirty
     * @param {Boolean} dimensionsChanged = false
     */

  }, {
    key: 'setDirty',
    value: function setDirty(dirty) {
      var dimensionsChanged = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;

      for (var rendererId in this._dirtiness) {
        this.setDirtyForRenderer(dirty, this._renderers[rendererId], dimensionsChanged);
      }
    }

    /**
     * Renders all paths to the canvas
     * @param {PhotoEditorSDK.Math.Vector2} inputDimensions
     */

  }, {
    key: 'render',
    value: function render(inputDimensions) {
      var _this2 = this;

      var renderer = this._operation.getSDK().getRenderer();

      if (!this.isDirtyForRenderer(renderer)) {
        return;
      }

      __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Utils"].ensureCanvasDimensions(this._outputCanvas, inputDimensions);
      __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Utils"].ensureCanvasDimensions(this._persistCanvas, inputDimensions);

      // Make sure all paths are rendered to their canvases
      this._options.paths.forEach(function (path) {
        path.render(inputDimensions);

        if (path.getClosed() && _this2._persistedPaths.indexOf(path) === -1) {
          _this2._onPathPersist(path);
        }
      });

      // Render persisted paths to output in one go
      this.clearCanvas();
      this._outputContext.drawImage(this._persistCanvas, 0, 0);

      // Render unpersisted paths to output
      this._options.paths.forEach(function (path) {
        if (!path.getClosed()) {
          path.renderToCanvas(_this2._outputCanvas);
        }
      });

      this.setDirtyForRenderer(false, renderer);
    }

    /**
     * Updates this sprite
     * @param  {PhotoEditorSDK} sdk
     * @param  {PhotoEditorSDK.Math.Vector2} inputDimensions
     */

  }, {
    key: 'update',
    value: function update(sdk, inputDimensions) {
      if (inputDimensions) {
        __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Utils"].ensureCanvasDimensions(this._outputCanvas, inputDimensions);
        __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Utils"].ensureCanvasDimensions(this._persistCanvas, inputDimensions);

        // Update texture dimensions
        this._texture.getBaseTexture().update();
      }

      // Render paths and control points
      this.render(inputDimensions);

      // Upload canvas to texture
      var renderer = sdk.getRenderer();
      /* istanbul ignore next */
      if (renderer.isOfType(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["RendererType"].WEBGL)) {
        renderer.updateTexture(this._texture.getBaseTexture());
      }

      _get(BrushSprite.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(BrushSprite.prototype), 'update', this).call(this, sdk, inputDimensions);
    }

    /**
     * Resets this brush so that it can be re-rendered
     * @private
     */

  }, {
    key: '_reset',
    value: function _reset() {
      this._persistedPaths = [];
      if (this._operation) {
        this._operation.setDirty(true);
      }
      this.setDirty(true);
      this.clearCanvas();
      this.clearPersistCanvas();
    }

    // -------------------------------------------------------------------------- GETTERS / SETTERS

    /**
     * Returns the canvas we're rendering brushes to
     * @return {CanvasElement}
     */

  }, {
    key: 'getCanvas',
    value: function getCanvas() {
      return this._outputCanvas;
    }

    // -------------------------------------------------------------------------- DISPOSAL

    /**
     * Disposes this Brush
     */

  }, {
    key: 'dispose',
    value: function dispose() {
      _get(BrushSprite.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(BrushSprite.prototype), 'dispose', this).call(this);
      this._texture.getBaseTexture().dispose();
    }
  }]);

  return BrushSprite;
}(__WEBPACK_IMPORTED_MODULE_7__sprite__["a" /* default */]);

BrushSprite.prototype.availableOptions = {
  id: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].STRING, default: function _default() {
      return __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Utils"].getUUID();
    } },
  position: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].VECTOR2, default: new Vector2(0, 0) },
  scale: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].VECTOR2, default: new Vector2(1.0, 1.0) },
  anchor: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].VECTOR2, default: new Vector2(0.0, 0.0) },
  pivot: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].VECTOR2, default: new Vector2(0.0, 0.0) },
  rotation: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].NUMBER, default: 0 },
  paths: {
    type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].ARRAY,
    default: [],
    setter: function setter(paths) {
      var _this3 = this;

      paths = paths.map(function (path) {
        if (path instanceof __WEBPACK_IMPORTED_MODULE_6__brush_path__["a" /* default */]) return path;

        var brush = path.brush,
            closed = path.closed;

        var newPath = new __WEBPACK_IMPORTED_MODULE_6__brush_path__["a" /* default */](_this3._operation, { brush: brush, closed: closed }, _this3._nextCanvas);
        path.controlPoints.forEach(function (position) {
          newPath.addControlPoint(position);
        });
        return newPath;
      });

      this._reset();
      return paths;
    }
  }
};

BrushSprite.type = 'brush';
BrushSprite.Brush = __WEBPACK_IMPORTED_MODULE_8__brush_brushes_brush__["a" /* default */];
BrushSprite.Path = __WEBPACK_IMPORTED_MODULE_6__brush_path__["a" /* default */];
BrushSprite.Brushes = {
  RadialBrush: __WEBPACK_IMPORTED_MODULE_9__brush_brushes_radial_brush__["a" /* default */]
};

/* harmony default export */ __webpack_exports__["a"] = (BrushSprite);

/***/ }),
/* 130 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__);





var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */


var Vector2 = __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Math"].Vector2;

var Brush = function (_Configurable) {
  _inherits(Brush, _Configurable);

  function Brush() {
    var _ref;

    _classCallCheck(this, Brush);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this = _possibleConstructorReturn(this, (_ref = Brush.__proto__ || __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default()(Brush)).call.apply(_ref, [this].concat(args)));

    _this._lastOptions = {};
    _this._lastInputDimensions = new Vector2(0, 0);
    _this._brush = null;
    return _this;
  }

  /**
   * Returns the prepared brush image (colored and resized)
   * @param  {PhotoEditorSDK.Math.Vector2} inputDimensions
   * @return {HTMLImageElement|HTMLCanvasElement}
   */


  _createClass(Brush, [{
    key: 'getBrushImage',
    value: function getBrushImage(inputDimensions) {
      if (this._brush && this.optionsEqual(this._lastOptions) && inputDimensions.equals(this._lastInputDimensions)) {
        return this._brush;
      }

      var _options = this._options,
          image = _options.image,
          size = _options.size;

      image.width = image.height = Math.ceil(size * inputDimensions.min());

      var canvas = __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Utils"].createCanvas();
      canvas.width = image.width;
      canvas.height = image.height;

      var context = canvas.getContext('2d');
      context.drawImage(image, 0, 0, canvas.width, canvas.height);

      var tintedBrush = this._tintImageData(context.getImageData(0, 0, canvas.width, canvas.height), canvas.width, canvas.height);
      context.putImageData(tintedBrush, 0, 0);

      this._lastOptions = this.serializeOptions(['size', 'color']);
      this._brush = canvas;
      this._lastInputDimensions = inputDimensions.clone();

      return canvas;
    }

    /**
     * Tints the given image data in the current color
     * @param  {ImageData} imageData
     * @return {ImageData}
     * @private
     */

  }, {
    key: '_tintImageData',
    value: function _tintImageData(imageData) {
      var color = this._options.color;


      for (var i = 0; i < imageData.data.length; i += 4) {
        imageData.data[i] += (color.r * 255 - imageData.data[i]) * color.a;
        imageData.data[i + 1] += (color.g * 255 - imageData.data[i + 1]) * color.a;
        imageData.data[i + 2] += (color.b * 255 - imageData.data[i + 2]) * color.a;
      }

      return imageData;
    }

    /**
     * Returns a clone of this brush
     * @return {PhotoEditorSDK.Operations.SpriteOperation.BrushSprite.Brush}
     */

  }, {
    key: 'clone',
    value: function clone() {
      var Constructor = this.constructor;
      return new Constructor(this._options);
    }
  }]);

  return Brush;
}(__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Configurable"]);

/* harmony default export */ __webpack_exports__["a"] = (Brush);


Brush.prototype.availableOptions = {
  identifier: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].STRING },
  image: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].IMAGE },
  size: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].NUMBER, default: 0.05 },
  color: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].COLOR, default: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Color"].RED }
};

/***/ }),
/* 131 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */

/* harmony default export */ __webpack_exports__["a"] = ({
  DEFAULTS: {
    FILTERS: [
    // {
    //   identifier: 'imgly_filters_test',
    //   defaultName: 'Test',
    //   filters: [
    //     {
    //       identifier: 'imgly_lut_identity_5_5',
    //       defaultName: 'Identity 5x5',
    //       lutImage: 'filters/imgly_lut_identity_5_5_128.png'
    //     }
    //   ]
    // },
    {
      identifier: 'imgly_filters_analog',
      defaultName: 'Analog',
      filters: [{
        identifier: 'imgly_lut_cool',
        defaultName: 'Cool',
        lutImage: 'filters/imgly_lut_cool_5_5_128.png'
      }, {
        identifier: 'imgly_lut_blues',
        defaultName: 'Blues',
        lutImage: 'filters/imgly_lut_blues_5_5_128.png'
      }, {
        identifier: 'imgly_lut_blueshadows',
        defaultName: 'Blue Shadows',
        lutImage: 'filters/imgly_lut_blueshadows_5_5_128.png'
      }, {
        identifier: 'imgly_lut_k6',
        defaultName: 'K6',
        lutImage: 'filters/imgly_lut_k6_5_5_128.png'
      }, {
        identifier: 'imgly_lut_kdynamic',
        defaultName: 'KDynamic',
        lutImage: 'filters/imgly_lut_kdynamic_5_5_128.png'
      }, {
        identifier: 'imgly_lut_lucid',
        defaultName: 'Lucid',
        lutImage: 'filters/imgly_lut_lucid_5_5_128.png'
      }, {
        identifier: 'imgly_lut_pale',
        defaultName: 'Pale',
        lutImage: 'filters/imgly_lut_pale_5_5_128.png'
      }]
    }, {
      identifier: 'imgly_filters_bw',
      defaultName: 'Black & White',
      filters: [{
        identifier: 'imgly_lut_sin',
        defaultName: 'Sin',
        lutImage: 'filters/imgly_lut_sin_8_8_512.png',
        resolution: 512,
        horizontalTileCount: 8,
        verticalTileCount: 8
      }, {
        identifier: 'imgly_lut_ad1920',
        defaultName: '1920 A.D.',
        lutImage: 'filters/imgly_lut_ad1920_5_5_128.png'
      }, {
        identifier: 'imgly_lut_bw',
        defaultName: 'B & W',
        lutImage: 'filters/imgly_lut_bw_5_5_128.png'
      }, {
        identifier: 'imgly_lut_litho',
        defaultName: 'Litho',
        lutImage: 'filters/imgly_lut_litho_5_5_128.png'
      }, {
        identifier: 'imgly_lut_plate',
        defaultName: 'Plate',
        lutImage: 'filters/imgly_lut_plate_5_5_128.png'
      }, {
        identifier: 'imgly_lut_x400',
        defaultName: 'X400',
        lutImage: 'filters/imgly_lut_x400_5_5_128.png'
      }]
    }, {
      identifier: 'imgly_filters_retro',
      defaultName: 'Retro',
      filters: [{
        identifier: 'imgly_lut_celsius',
        defaultName: 'Celsius',
        lutImage: 'filters/imgly_lut_celsius_8_8_512.png',
        resolution: 512,
        horizontalTileCount: 8,
        verticalTileCount: 8
      }, {
        identifier: 'imgly_lut_k2',
        defaultName: 'K2',
        lutImage: 'filters/imgly_lut_k2_8_8_512.png',
        resolution: 512,
        horizontalTileCount: 8,
        verticalTileCount: 8
      }, {
        identifier: 'imgly_lut_sepiahigh',
        defaultName: 'Sepia High',
        lutImage: 'filters/imgly_lut_sepiahigh_5_5_128.png'
      }, {
        identifier: 'imgly_lut_ancient',
        defaultName: 'Ancient',
        lutImage: 'filters/imgly_lut_ancient_5_5_128.png'
      }, {
        identifier: 'imgly_lut_classic',
        defaultName: 'Classic',
        lutImage: 'filters/imgly_lut_classic_5_5_128.png'
      }, {
        identifier: 'imgly_lut_eighties',
        defaultName: 'Eighties',
        lutImage: 'filters/imgly_lut_eighties_5_5_128.png'
      }, {
        identifier: 'imgly_lut_elder',
        defaultName: 'Elder',
        lutImage: 'filters/imgly_lut_elder_5_5_128.png'
      }, {
        identifier: 'imgly_lut_glam',
        defaultName: 'Glam',
        lutImage: 'filters/imgly_lut_glam_5_5_128.png'
      }, {
        identifier: 'imgly_lut_gobblin',
        defaultName: 'Gobblin',
        lutImage: 'filters/imgly_lut_gobblin_5_5_128.png'
      }, {
        identifier: 'imgly_lut_orchid',
        defaultName: 'Orchid',
        lutImage: 'filters/imgly_lut_orchid_5_5_128.png'
      }, {
        identifier: 'imgly_lut_seventies',
        defaultName: 'Seventies',
        lutImage: 'filters/imgly_lut_seventies_5_5_128.png'
      }]
    }, {
      identifier: 'imgly_filters_special',
      defaultName: 'Special',
      filters: [{
        identifier: 'imgly_lut_fixie',
        defaultName: 'Fixie',
        lutImage: 'filters/imgly_lut_fixie_8_8_512.png',
        resolution: 512,
        horizontalTileCount: 8,
        verticalTileCount: 8
      }, {
        identifier: 'imgly_lut_colorful',
        defaultName: 'Colorful',
        lutImage: 'filters/imgly_lut_colorful_5_5_128.png'
      }, {
        identifier: 'imgly_lut_cottoncandy',
        defaultName: 'Cotton Candy',
        lutImage: 'filters/imgly_lut_cottoncandy_5_5_128.png'
      }, {
        identifier: 'imgly_lut_food',
        defaultName: 'Food',
        lutImage: 'filters/imgly_lut_food_5_5_128.png'
      }, {
        identifier: 'imgly_lut_highcontrast',
        defaultName: 'High Contrast',
        lutImage: 'filters/imgly_lut_highcontrast_5_5_128.png'
      }, {
        identifier: 'imgly_lut_k1',
        defaultName: 'K1',
        lutImage: 'filters/imgly_lut_k1_5_5_128.png'
      }, {
        identifier: 'imgly_lut_lomo100',
        defaultName: 'Lomo 100',
        lutImage: 'filters/imgly_lut_lomo100_5_5_128.png'
      }, {
        identifier: 'imgly_lut_neat',
        defaultName: 'Neat',
        lutImage: 'filters/imgly_lut_neat_5_5_128.png'
      }, {
        identifier: 'imgly_lut_nogreen',
        defaultName: 'No Green',
        lutImage: 'filters/imgly_lut_nogreen_5_5_128.png'
      }, {
        identifier: 'imgly_lut_pola669',
        defaultName: 'Pola 669',
        lutImage: 'filters/imgly_lut_pola669_5_5_128.png'
      }, {
        identifier: 'imgly_lut_polasx',
        defaultName: 'Pola SX',
        lutImage: 'filters/imgly_lut_polasx_5_5_128.png'
      }, {
        identifier: 'imgly_lut_pro400',
        defaultName: 'Pro 400',
        lutImage: 'filters/imgly_lut_pro400_5_5_128.png'
      }, {
        identifier: 'imgly_lut_twilight',
        defaultName: 'Twilight',
        lutImage: 'filters/imgly_lut_twilight_5_5_128.png'
      }, {
        identifier: 'imgly_lut_settled',
        defaultName: 'Settled',
        lutImage: 'filters/imgly_lut_settled_5_5_128.png'
      }, {
        identifier: 'imgly_lut_steel',
        defaultName: 'Steel',
        lutImage: 'filters/imgly_lut_steel_5_5_128.png'
      }]
    }, {
      identifier: 'imgly_filters_summer',
      defaultName: 'Summer',
      filters: [{
        identifier: 'imgly_lut_texas',
        defaultName: 'Texas',
        lutImage: 'filters/imgly_lut_texas_8_8_512.png',
        resolution: 512,
        horizontalTileCount: 8,
        verticalTileCount: 8
      }, {
        identifier: 'imgly_lut_mellow',
        defaultName: 'Mellow',
        lutImage: 'filters/imgly_lut_mellow_8_8_512.png',
        resolution: 512,
        horizontalTileCount: 8,
        verticalTileCount: 8
      }, {
        identifier: 'imgly_lut_chest',
        defaultName: 'Chest',
        lutImage: 'filters/imgly_lut_chest_8_8_512.png',
        resolution: 512,
        horizontalTileCount: 8,
        verticalTileCount: 8
      }, {
        identifier: 'imgly_lut_creamy',
        defaultName: 'Creamy',
        lutImage: 'filters/imgly_lut_creamy_5_5_128.png'
      }, {
        identifier: 'imgly_lut_evening',
        defaultName: 'Evening',
        lutImage: 'filters/imgly_lut_evening_5_5_128.png'
      }, {
        identifier: 'imgly_lut_fall',
        defaultName: 'Fall',
        lutImage: 'filters/imgly_lut_fall_5_5_128.png'
      }, {
        identifier: 'imgly_lut_front',
        defaultName: 'Front',
        lutImage: 'filters/imgly_lut_front_8_8_512.png',
        resolution: 512,
        horizontalTileCount: 8,
        verticalTileCount: 8
      }, {
        identifier: 'imgly_lut_highcarb',
        defaultName: 'High Carb',
        lutImage: 'filters/imgly_lut_highcarb_5_5_128.png'
      }, {
        identifier: 'imgly_lut_keen',
        defaultName: 'Keen',
        lutImage: 'filters/imgly_lut_keen_5_5_128.png'
      }, {
        identifier: 'imgly_lut_pitched',
        defaultName: 'Pitched',
        lutImage: 'filters/imgly_lut_pitched_5_5_128.png'
      }, {
        identifier: 'imgly_lut_soft',
        defaultName: 'Soft',
        lutImage: 'filters/imgly_lut_soft_5_5_128.png'
      }, {
        identifier: 'imgly_lut_summer',
        defaultName: 'Summer',
        lutImage: 'filters/imgly_lut_summer_5_5_128.png'
      }, {
        identifier: 'imgly_lut_sunset',
        defaultName: 'Sunset',
        lutImage: 'filters/imgly_lut_sunset_5_5_128.png'
      }, {
        identifier: 'imgly_lut_tender',
        defaultName: 'Tender',
        lutImage: 'filters/imgly_lut_tender_5_5_128.png'
      }]
    }, {
      identifier: 'imgly_filters_winter',
      defaultName: 'Winter',
      filters: [{
        identifier: 'imgly_lut_fridge',
        defaultName: 'Fridge',
        lutImage: 'filters/imgly_lut_fridge_8_8_512.png',
        resolution: 512,
        horizontalTileCount: 8,
        verticalTileCount: 8
      }, {
        identifier: 'imgly_lut_bleached',
        defaultName: 'Bleached',
        lutImage: 'filters/imgly_lut_bleached_5_5_128.png'
      }, {
        identifier: 'imgly_lut_bleachedblue',
        defaultName: 'Bleached Blue',
        lutImage: 'filters/imgly_lut_bleachedblue_5_5_128.png'
      }, {
        identifier: 'imgly_lut_breeze',
        defaultName: 'Breeze',
        lutImage: 'filters/imgly_lut_breeze_5_5_128.png'
      }, {
        identifier: 'imgly_lut_lenin',
        defaultName: 'Lenin',
        lutImage: 'filters/imgly_lut_lenin_5_5_128.png'
      }, {
        identifier: 'imgly_lut_quozi',
        defaultName: 'Quozi',
        lutImage: 'filters/imgly_lut_quozi_5_5_128.png'
      }, {
        identifier: 'imgly_lut_winter',
        defaultName: 'Winter',
        lutImage: 'filters/imgly_lut_winter_5_5_128.png'
      }]
    }],
    OVERLAYS: [{
      identifier: 'imgly_overlay_golden',
      defaultName: 'Golden',
      image: 'overlays/imgly_overlay_golden.jpg',
      thumbnail: 'overlays/imgly_overlay_golden_thumb.jpg',
      blendMode: 'lighten'
    }, {
      identifier: 'imgly_overlay_bokeh',
      defaultName: 'Bokeh',
      image: 'overlays/imgly_overlay_bokeh.jpg',
      thumbnail: 'overlays/imgly_overlay_bokeh_thumb.jpg',
      blendMode: 'lighten'
    }, {
      identifier: 'imgly_overlay_hearts',
      defaultName: 'Hearts',
      image: 'overlays/imgly_overlay_hearts.jpg',
      thumbnail: 'overlays/imgly_overlay_hearts_thumb.jpg',
      blendMode: 'screen'
    }, {
      identifier: 'imgly_overlay_lightleak1',
      defaultName: 'Light Leak',
      image: 'overlays/imgly_overlay_lightleak1.jpg',
      thumbnail: 'overlays/imgly_overlay_lightleak1_thumb.jpg',
      blendMode: 'screen'
    }, {
      identifier: 'imgly_overlay_lightleak2',
      defaultName: 'Light Leak 2',
      image: 'overlays/imgly_overlay_lightleak2.jpg',
      thumbnail: 'overlays/imgly_overlay_lightleak2_thumb.jpg',
      blendMode: 'lighten'
    }, {
      identifier: 'imgly_overlay_rain',
      defaultName: 'Rain',
      image: 'overlays/imgly_overlay_rain.jpg',
      thumbnail: 'overlays/imgly_overlay_rain_thumb.jpg',
      blendMode: 'overlay'
    }, {
      identifier: 'imgly_overlay_wood',
      defaultName: 'Wood',
      image: 'overlays/imgly_overlay_wood.jpg',
      thumbnail: 'overlays/imgly_overlay_wood_thumb.jpg',
      blendMode: 'multiply'
    }, {
      identifier: 'imgly_overlay_mosaic',
      defaultName: 'Mosaic',
      image: 'overlays/imgly_overlay_mosaic.jpg',
      thumbnail: 'overlays/imgly_overlay_mosaic_thumb.jpg',
      blendMode: 'multiply'
    }, {
      identifier: 'imgly_overlay_chop',
      defaultName: 'Chop',
      image: 'overlays/imgly_overlay_chop.jpg',
      thumbnail: 'overlays/imgly_overlay_chop_thumb.jpg',
      blendMode: 'multiply'
    }, {
      identifier: 'imgly_overlay_vintage',
      defaultName: 'Vintage',
      image: 'overlays/imgly_overlay_vintage.jpg',
      thumbnail: 'overlays/imgly_overlay_vintage_thumb.jpg',
      blendMode: 'darken'
    }, {
      identifier: 'imgly_overlay_metal',
      defaultName: 'Metal',
      image: 'overlays/imgly_overlay_metal.jpg',
      thumbnail: 'overlays/imgly_overlay_metal_thumb.jpg',
      blendMode: 'overlay'
    }, {
      identifier: 'imgly_overlay_paper',
      defaultName: 'Paper',
      image: 'overlays/imgly_overlay_paper.jpg',
      thumbnail: 'overlays/imgly_overlay_paper_thumb.jpg',
      blendMode: 'multiply'
    }, {
      identifier: 'imgly_overlay_painting',
      defaultName: 'Painting',
      image: 'overlays/imgly_overlay_painting.jpg',
      thumbnail: 'overlays/imgly_overlay_painting_thumb.jpg',
      blendMode: 'overlay'
    }, {
      identifier: 'imgly_overlay_grain',
      defaultName: 'Grain',
      image: 'overlays/imgly_overlay_grain.jpg',
      thumbnail: 'overlays/imgly_overlay_grain_thumb.jpg',
      blendMode: 'overlay'
    }, {
      identifier: 'imgly_overlay_clouds',
      defaultName: 'Clouds',
      image: 'overlays/imgly_overlay_clouds.jpg',
      thumbnail: 'overlays/imgly_overlay_clouds_thumb.jpg',
      blendMode: 'softLight'
    }, {
      identifier: 'imgly_overlay_wall1',
      defaultName: 'Wall',
      image: 'overlays/imgly_overlay_wall1.jpg',
      thumbnail: 'overlays/imgly_overlay_wall1_thumb.jpg',
      blendMode: 'lighten'
    }, {
      identifier: 'imgly_overlay_wall2',
      defaultName: 'Wall 2',
      image: 'overlays/imgly_overlay_wall2.jpg',
      thumbnail: 'overlays/imgly_overlay_wall2_thumb.jpg',
      blendMode: 'overlay'
    }],
    FRAME_CATEGORIES: [{
      identifier: 'imgly_frame_generic',
      defaultName: 'Generic',
      metaData: {
        backgroundImage: 'frames/generic.png' // Not used yet
      },
      frames: [{
        identifier: 'imgly_frame_dia',
        defaultName: 'Dia',
        layoutMode: 'horizontal-inside',
        thumbnail: 'frames/imgly_frame_dia/imgly_frame_dia_thumb.png',
        imageGroups: {
          top: {
            mid: {
              image: 'frames/imgly_frame_dia/imgly_frame_dia_top.png',
              mode: 'repeat'
            }
          },
          left: {
            start: 'frames/imgly_frame_dia/imgly_frame_dia_top_corner_left.png',
            mid: 'frames/imgly_frame_dia/imgly_frame_dia_left.png',
            end: 'frames/imgly_frame_dia/imgly_frame_dia_bottom_corner_left.png'
          },
          right: {
            start: 'frames/imgly_frame_dia/imgly_frame_dia_top_corner_right.png',
            mid: 'frames/imgly_frame_dia/imgly_frame_dia_right.png',
            end: 'frames/imgly_frame_dia/imgly_frame_dia_bottom_corner_right.png'
          },
          bottom: {
            mid: {
              image: 'frames/imgly_frame_dia/imgly_frame_dia_bottom.png',
              mode: 'repeat'
            }
          }
        }
      }, {
        identifier: 'imgly_frame_art_decor',
        defaultName: 'Art Decor',
        tintable: true,
        layoutMode: 'horizontal-inside',
        thumbnail: 'frames/imgly_frame_art_decor/imgly_frame_art_decor_thumb.png',
        imageGroups: {
          top: {
            start: 'frames/imgly_frame_art_decor/imgly_frame_art_decor_top_corner_left.png',
            mid: {
              image: 'frames/imgly_frame_art_decor/imgly_frame_art_decor_top.png',
              mode: 'stretch'
            },
            end: 'frames/imgly_frame_art_decor/imgly_frame_art_decor_top_corner_right.png'
          },
          left: {
            mid: {
              image: 'frames/imgly_frame_art_decor/imgly_frame_art_decor_left.png',
              mode: 'stretch'
            }
          },
          right: {
            mid: {
              image: 'frames/imgly_frame_art_decor/imgly_frame_art_decor_right.png',
              mode: 'stretch'
            }
          },
          bottom: {
            start: 'frames/imgly_frame_art_decor/imgly_frame_art_decor_bottom_corner_left.png',
            mid: {
              image: 'frames/imgly_frame_art_decor/imgly_frame_art_decor_bottom.png',
              mode: 'stretch'
            },
            end: 'frames/imgly_frame_art_decor/imgly_frame_art_decor_bottom_corner_right.png'
          }
        }
      }, {
        identifier: 'imgly_frame_black_passepartout',
        defaultName: 'Black Passepartout',
        layoutMode: 'horizontal-inside',
        thumbnail: 'frames/imgly_frame_black_passepartout/imgly_frame_black_passepartout_thumb.png',
        imageGroups: {
          top: {
            start: 'frames/imgly_frame_black_passepartout/imgly_frame_black_passepartout_top_corner_left.png',
            mid: {
              image: 'frames/imgly_frame_black_passepartout/imgly_frame_black_passepartout_top.png',
              mode: 'stretch'
            },
            end: 'frames/imgly_frame_black_passepartout/imgly_frame_black_passepartout_top_corner_right.png'
          },
          left: {
            mid: {
              image: 'frames/imgly_frame_black_passepartout/imgly_frame_black_passepartout_left.png',
              mode: 'stretch'
            }
          },
          right: {
            mid: {
              image: 'frames/imgly_frame_black_passepartout/imgly_frame_black_passepartout_right.png',
              mode: 'stretch'
            }
          },
          bottom: {
            start: 'frames/imgly_frame_black_passepartout/imgly_frame_black_passepartout_bottom_corner_left.png',
            mid: {
              image: 'frames/imgly_frame_black_passepartout/imgly_frame_black_passepartout_bottom.png',
              mode: 'stretch'
            },
            end: 'frames/imgly_frame_black_passepartout/imgly_frame_black_passepartout_bottom_corner_right.png'
          }
        }
      }, {
        identifier: 'imgly_frame_lowpoly_shadow',
        defaultName: 'Low Poly',
        layoutMode: 'horizontal-inside',
        thumbnail: 'frames/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_thumb.png',
        imageGroups: {
          top: {
            start: 'frames/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_top_corner_left.png',
            mid: {
              image: 'frames/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_top.png',
              mode: 'stretch'
            },
            end: 'frames/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_top_corner_right.png'
          },
          left: {
            mid: {
              image: 'frames/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_left.png',
              mode: 'stretch'
            }
          },
          right: {
            mid: {
              image: 'frames/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_right.png',
              mode: 'stretch'
            }
          },
          bottom: {
            start: 'frames/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_bottom_corner_left.png',
            mid: {
              image: 'frames/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_bottom.png',
              mode: 'stretch'
            },
            end: 'frames/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_bottom_corner_right.png'
          }
        }
      }, {
        identifier: 'imgly_frame_wood_passepartout',
        defaultName: 'Wood Passepartout',
        layoutMode: 'horizontal-inside',
        thumbnail: 'frames/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_thumb.png',
        imageGroups: {
          top: {
            start: 'frames/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_top_corner_left.png',
            mid: {
              image: 'frames/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_top.png',
              mode: 'stretch'
            },
            end: 'frames/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_top_corner_right.png'
          },
          left: {
            mid: {
              image: 'frames/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_left.png',
              mode: 'stretch'
            }
          },
          right: {
            mid: {
              image: 'frames/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_right.png',
              mode: 'stretch'
            }
          },
          bottom: {
            start: 'frames/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_bottom_corner_left.png',
            mid: {
              image: 'frames/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_bottom.png',
              mode: 'stretch'
            },
            end: 'frames/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_bottom_corner_right.png'
          }
        }
      }]
    }],
    STICKER_CATEGORIES: [{
      identifier: 'imgly_sticker_emoticons',
      defaultName: 'Emoticons',
      'metaData': {
        'backgroundImage': 'stickers/emoticons/background.png'
      },
      'stickers': [{
        identifier: 'imgly_sticker_emoticons_alien',
        defaultName: 'Alien',
        images: {
          mediaThumb: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_alien.svg', 'stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_alien.png'],
            width: 62,
            height: 58
          },
          mediaBase: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_alien.svg', 'stickers/emoticons/stickers/base/imgly_sticker_emoticons_alien.png'],
            width: 1000,
            height: 935
          }
        }
      }, {
        identifier: 'imgly_sticker_emoticons_angel',
        defaultName: 'Angel',
        images: {
          mediaThumb: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_angel.svg', 'stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_angel.png'],
            width: 62,
            height: 64
          },
          mediaBase: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_angel.svg', 'stickers/emoticons/stickers/base/imgly_sticker_emoticons_angel.png']
          }
        }
      }, {
        identifier: 'imgly_sticker_emoticons_angry',
        defaultName: 'Angry',
        images: {
          mediaThumb: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_angry.svg', 'stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_angry.png'],
            width: 62,
            height: 62
          },
          mediaBase: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_angry.svg', 'stickers/emoticons/stickers/base/imgly_sticker_emoticons_angry.png']
          }
        }
      }, {
        identifier: 'imgly_sticker_emoticons_anxious',
        defaultName: 'Anxious',
        images: {
          mediaThumb: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_anxious.svg', 'stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_anxious.png'],
            width: 62,
            height: 58
          },
          mediaBase: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_anxious.svg', 'stickers/emoticons/stickers/base/imgly_sticker_emoticons_anxious.png']
          }
        }
      }, {
        identifier: 'imgly_sticker_emoticons_asleep',
        defaultName: 'Asleep',
        images: {
          mediaThumb: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_asleep.svg', 'stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_asleep.png'],
            width: 62,
            height: 58
          },
          mediaBase: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_asleep.svg', 'stickers/emoticons/stickers/base/imgly_sticker_emoticons_asleep.png']
          }
        }
      }, {
        identifier: 'imgly_sticker_emoticons_attention',
        defaultName: 'Attention',
        images: {
          mediaThumb: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_attention.svg', 'stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_attention.png'],
            width: 62,
            height: 60
          },
          mediaBase: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_attention.svg', 'stickers/emoticons/stickers/base/imgly_sticker_emoticons_attention.png']
          }
        }
      }, {
        identifier: 'imgly_sticker_emoticons_baby_chicken',
        defaultName: 'Baby Chicken',
        images: {
          mediaThumb: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_baby_chicken.svg', 'stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_baby_chicken.png'],
            width: 61,
            height: 42
          },
          mediaBase: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_baby_chicken.svg', 'stickers/emoticons/stickers/base/imgly_sticker_emoticons_baby_chicken.png']
          }
        }
      }, {
        identifier: 'imgly_sticker_emoticons_batman',
        defaultName: 'Batman',
        images: {
          mediaThumb: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_batman.svg', 'stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_batman.png'],
            width: 62,
            height: 58
          },
          mediaBase: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_batman.svg', 'stickers/emoticons/stickers/base/imgly_sticker_emoticons_batman.png']
          }
        }
      }, {
        identifier: 'imgly_sticker_emoticons_beer',
        defaultName: 'Beer',
        images: {
          mediaThumb: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_beer.svg', 'stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_beer.png'],
            width: 62,
            height: 59
          },
          mediaBase: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_beer.svg', 'stickers/emoticons/stickers/base/imgly_sticker_emoticons_beer.png']
          }
        }
      }, {
        identifier: 'imgly_sticker_emoticons_blush',
        defaultName: 'Blush',
        images: {
          mediaThumb: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_blush.svg', 'stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_blush.png'],
            width: 62,
            height: 58
          },
          mediaBase: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_blush.svg', 'stickers/emoticons/stickers/base/imgly_sticker_emoticons_blush.png']
          }
        }
      }, {
        identifier: 'imgly_sticker_emoticons_boxer',
        defaultName: 'Boxer',
        images: {
          mediaThumb: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_boxer.svg', 'stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_boxer.png'],
            width: 62,
            height: 62
          },
          mediaBase: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_boxer.svg', 'stickers/emoticons/stickers/base/imgly_sticker_emoticons_boxer.png']
          }
        }
      }, {
        identifier: 'imgly_sticker_emoticons_business',
        defaultName: 'Business',
        images: {
          mediaThumb: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_business.svg', 'stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_business.png'],
            width: 60,
            height: 63
          },
          mediaBase: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_business.svg', 'stickers/emoticons/stickers/base/imgly_sticker_emoticons_business.png']
          }
        }
      }, {
        identifier: 'imgly_sticker_emoticons_chicken',
        defaultName: 'Chicken',
        images: {
          mediaThumb: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_chicken.svg', 'stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_chicken.png'],
            width: 63,
            height: 55
          },
          mediaBase: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_chicken.svg', 'stickers/emoticons/stickers/base/imgly_sticker_emoticons_chicken.png']
          }
        }
      }, {
        identifier: 'imgly_sticker_emoticons_cool',
        defaultName: 'Cool',
        images: {
          mediaThumb: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_cool.svg', 'stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_cool.png'],
            width: 62,
            height: 58
          },
          mediaBase: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_cool.svg', 'stickers/emoticons/stickers/base/imgly_sticker_emoticons_cool.png']
          }
        }
      }, {
        identifier: 'imgly_sticker_emoticons_cry',
        defaultName: 'Cry',
        images: {
          mediaThumb: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_cry.svg', 'stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_cry.png'],
            width: 62,
            height: 58
          },
          mediaBase: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_cry.svg', 'stickers/emoticons/stickers/base/imgly_sticker_emoticons_cry.png']
          }
        }
      }, {
        identifier: 'imgly_sticker_emoticons_deceased',
        defaultName: 'Deceased',
        images: {
          mediaThumb: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_deceased.svg', 'stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_deceased.png'],
            width: 62,
            height: 58
          },
          mediaBase: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_deceased.svg', 'stickers/emoticons/stickers/base/imgly_sticker_emoticons_deceased.png']
          }
        }
      }, {
        identifier: 'imgly_sticker_emoticons_devil',
        defaultName: 'Devil',
        images: {
          mediaThumb: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_devil.svg', 'stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_devil.png'],
            width: 62,
            height: 58
          },
          mediaBase: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_devil.svg', 'stickers/emoticons/stickers/base/imgly_sticker_emoticons_devil.png']
          }
        }
      }, {
        identifier: 'imgly_sticker_emoticons_duckface',
        defaultName: 'Duckface',
        images: {
          mediaThumb: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_duckface.svg', 'stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_duckface.png'],
            width: 62,
            height: 58
          },
          mediaBase: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_duckface.svg', 'stickers/emoticons/stickers/base/imgly_sticker_emoticons_duckface.png']
          }
        }
      }, {
        identifier: 'imgly_sticker_emoticons_furious',
        defaultName: 'Furious',
        images: {
          mediaThumb: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_furious.svg', 'stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_furious.png'],
            width: 62,
            height: 61
          },
          mediaBase: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_furious.svg', 'stickers/emoticons/stickers/base/imgly_sticker_emoticons_furious.png']
          }
        }
      }, {
        identifier: 'imgly_sticker_emoticons_grin',
        defaultName: 'Grin',
        images: {
          mediaThumb: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_grin.svg', 'stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_grin.png'],
            width: 62,
            height: 58
          },
          mediaBase: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_grin.svg', 'stickers/emoticons/stickers/base/imgly_sticker_emoticons_grin.png']
          }
        }
      }, {
        identifier: 'imgly_sticker_emoticons_guitar',
        defaultName: 'Guitar',
        images: {
          mediaThumb: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_guitar.svg', 'stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_guitar.png'],
            width: 64,
            height: 60
          },
          mediaBase: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_guitar.svg', 'stickers/emoticons/stickers/base/imgly_sticker_emoticons_guitar.png']
          }
        }
      }, {
        identifier: 'imgly_sticker_emoticons_harry_potter',
        defaultName: 'Harry Potter',
        images: {
          mediaThumb: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_harry_potter.svg', 'stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_harry_potter.png'],
            width: 64,
            height: 62
          },
          mediaBase: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_harry_potter.svg', 'stickers/emoticons/stickers/base/imgly_sticker_emoticons_harry_potter.png']
          }
        }
      }, {
        identifier: 'imgly_sticker_emoticons_hippie',
        defaultName: 'Hippie',
        images: {
          mediaThumb: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_hippie.svg', 'stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_hippie.png'],
            width: 62,
            height: 62
          },
          mediaBase: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_hippie.svg', 'stickers/emoticons/stickers/base/imgly_sticker_emoticons_hippie.png']
          }
        }
      }, {
        identifier: 'imgly_sticker_emoticons_hitman',
        defaultName: 'Hitman',
        images: {
          mediaThumb: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_hitman.svg', 'stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_hitman.png'],
            width: 64,
            height: 60
          },
          mediaBase: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_hitman.svg', 'stickers/emoticons/stickers/base/imgly_sticker_emoticons_hitman.png']
          }
        }
      }, {
        identifier: 'imgly_sticker_emoticons_humourous',
        defaultName: 'Humourous',
        images: {
          mediaThumb: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_humourous.svg', 'stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_humourous.png'],
            width: 64,
            height: 64
          },
          mediaBase: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_humourous.svg', 'stickers/emoticons/stickers/base/imgly_sticker_emoticons_humourous.png']
          }
        }
      }, {
        identifier: 'imgly_sticker_emoticons_idea',
        defaultName: 'Idea',
        images: {
          mediaThumb: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_idea.svg', 'stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_idea.png'],
            width: 64,
            height: 62
          },
          mediaBase: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_idea.svg', 'stickers/emoticons/stickers/base/imgly_sticker_emoticons_idea.png']
          }
        }
      }, {
        identifier: 'imgly_sticker_emoticons_impatient',
        defaultName: 'Impatient',
        images: {
          mediaThumb: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_impatient.svg', 'stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_impatient.png'],
            width: 62,
            height: 58
          },
          mediaBase: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_impatient.svg', 'stickers/emoticons/stickers/base/imgly_sticker_emoticons_impatient.png']
          }
        }
      }, {
        identifier: 'imgly_sticker_emoticons_kiss',
        defaultName: 'Kiss',
        images: {
          mediaThumb: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_kiss.svg', 'stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_kiss.png'],
            width: 62,
            height: 58
          },
          mediaBase: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_kiss.svg', 'stickers/emoticons/stickers/base/imgly_sticker_emoticons_kiss.png']
          }
        }
      }, {
        identifier: 'imgly_sticker_emoticons_kisses',
        defaultName: 'Kisses',
        images: {
          mediaThumb: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_kisses.svg', 'stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_kisses.png'],
            width: 62,
            height: 58
          },
          mediaBase: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_kisses.svg', 'stickers/emoticons/stickers/base/imgly_sticker_emoticons_kisses.png']
          }
        }
      }, {
        identifier: 'imgly_sticker_emoticons_laugh',
        defaultName: 'Laugh',
        images: {
          mediaThumb: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_laugh.svg', 'stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_laugh.png'],
            width: 62,
            height: 58
          },
          mediaBase: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_laugh.svg', 'stickers/emoticons/stickers/base/imgly_sticker_emoticons_laugh.png']
          }
        }
      }, {
        identifier: 'imgly_sticker_emoticons_loud_cry',
        defaultName: 'Loud Cry',
        images: {
          mediaThumb: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_loud_cry.svg', 'stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_loud_cry.png'],
            width: 64,
            height: 58
          },
          mediaBase: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_loud_cry.svg', 'stickers/emoticons/stickers/base/imgly_sticker_emoticons_loud_cry.png']
          }
        }
      }, {
        identifier: 'imgly_sticker_emoticons_loving',
        defaultName: 'Loving',
        images: {
          mediaThumb: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_loving.svg', 'stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_loving.png'],
            width: 62,
            height: 58
          },
          mediaBase: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_loving.svg', 'stickers/emoticons/stickers/base/imgly_sticker_emoticons_loving.png']
          }
        }
      }, {
        identifier: 'imgly_sticker_emoticons_masked',
        defaultName: 'Masked',
        images: {
          mediaThumb: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_masked.svg', 'stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_masked.png'],
            width: 62,
            height: 62
          },
          mediaBase: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_masked.svg', 'stickers/emoticons/stickers/base/imgly_sticker_emoticons_masked.png']
          }
        }
      }, {
        identifier: 'imgly_sticker_emoticons_music',
        defaultName: 'Music',
        images: {
          mediaThumb: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_music.svg', 'stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_music.png'],
            width: 62,
            height: 54
          },
          mediaBase: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_music.svg', 'stickers/emoticons/stickers/base/imgly_sticker_emoticons_music.png']
          }
        }
      }, {
        identifier: 'imgly_sticker_emoticons_nerd',
        defaultName: 'Nerd',
        images: {
          mediaThumb: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_nerd.svg', 'stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_nerd.png']
          },
          mediaBase: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_nerd.svg', 'stickers/emoticons/stickers/base/imgly_sticker_emoticons_nerd.png']
          }
        }
      }, {
        identifier: 'imgly_sticker_emoticons_ninja',
        defaultName: 'Ninja',
        images: {
          mediaThumb: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_ninja.svg', 'stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_ninja.png'],
            width: 62,
            height: 58
          },
          mediaBase: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_ninja.svg', 'stickers/emoticons/stickers/base/imgly_sticker_emoticons_ninja.png']
          }
        }
      }, {
        identifier: 'imgly_sticker_emoticons_not_speaking_to_you',
        defaultName: 'Not Speaking To You',
        images: {
          mediaThumb: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_not_speaking_to_you.svg', 'stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_not_speaking_to_you.png'],
            width: 62,
            height: 58
          },
          mediaBase: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_not_speaking_to_you.svg', 'stickers/emoticons/stickers/base/imgly_sticker_emoticons_not_speaking_to_you.png']
          }
        }
      }, {
        identifier: 'imgly_sticker_emoticons_pig',
        defaultName: 'Pig',
        images: {
          mediaThumb: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_pig.svg', 'stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_pig.png'],
            width: 63,
            height: 41
          },
          mediaBase: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_pig.svg', 'stickers/emoticons/stickers/base/imgly_sticker_emoticons_pig.png']
          }
        }
      }, {
        identifier: 'imgly_sticker_emoticons_pumpkin',
        defaultName: 'Pumpkin',
        images: {
          mediaThumb: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_pumpkin.svg', 'stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_pumpkin.png'],
            width: 62,
            height: 60
          },
          mediaBase: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_pumpkin.svg', 'stickers/emoticons/stickers/base/imgly_sticker_emoticons_pumpkin.png']
          }
        }
      }, {
        identifier: 'imgly_sticker_emoticons_question',
        defaultName: 'Question',
        images: {
          mediaThumb: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_question.svg', 'stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_question.png'],
            width: 62,
            height: 62
          },
          mediaBase: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_question.svg', 'stickers/emoticons/stickers/base/imgly_sticker_emoticons_question.png']
          }
        }
      }, {
        identifier: 'imgly_sticker_emoticons_rabbit',
        defaultName: 'Rabbit',
        images: {
          mediaThumb: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_rabbit.svg', 'stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_rabbit.png'],
            width: 65,
            height: 47
          },
          mediaBase: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_rabbit.svg', 'stickers/emoticons/stickers/base/imgly_sticker_emoticons_rabbit.png']
          }
        }
      }, {
        identifier: 'imgly_sticker_emoticons_sad',
        defaultName: 'Sad',
        images: {
          mediaThumb: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_sad.svg', 'stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_sad.png']
          },
          mediaBase: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_sad.svg', 'stickers/emoticons/stickers/base/imgly_sticker_emoticons_sad.png']
          }
        }
      }, {
        identifier: 'imgly_sticker_emoticons_sick',
        defaultName: 'Sick',
        images: {
          mediaThumb: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_sick.svg', 'stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_sick.png'],
            width: 62,
            height: 58
          },
          mediaBase: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_sick.svg', 'stickers/emoticons/stickers/base/imgly_sticker_emoticons_sick.png']
          }
        }
      }, {
        identifier: 'imgly_sticker_emoticons_skateboard',
        defaultName: 'Skateboard',
        images: {
          mediaThumb: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_skateboard.svg', 'stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_skateboard.png'],
            width: 62,
            height: 64
          },
          mediaBase: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_skateboard.svg', 'stickers/emoticons/stickers/base/imgly_sticker_emoticons_skateboard.png']
          }
        }
      }, {
        identifier: 'imgly_sticker_emoticons_skull',
        defaultName: 'Skull',
        images: {
          mediaThumb: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_skull.svg', 'stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_skull.png'],
            width: 62,
            height: 62
          },
          mediaBase: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_skull.svg', 'stickers/emoticons/stickers/base/imgly_sticker_emoticons_skull.png']
          }
        }
      }, {
        identifier: 'imgly_sticker_emoticons_sleepy',
        defaultName: 'Sleepy',
        images: {
          mediaThumb: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_sleepy.svg', 'stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_sleepy.png'],
            width: 62,
            height: 60
          },
          mediaBase: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_sleepy.svg', 'stickers/emoticons/stickers/base/imgly_sticker_emoticons_sleepy.png']
          }
        }
      }, {
        identifier: 'imgly_sticker_emoticons_smile',
        defaultName: 'Smile',
        images: {
          mediaThumb: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_smile.svg', 'stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_smile.png'],
            width: 62,
            height: 58
          },
          mediaBase: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_smile.svg', 'stickers/emoticons/stickers/base/imgly_sticker_emoticons_smile.png']
          }
        }
      }, {
        identifier: 'imgly_sticker_emoticons_smoking',
        defaultName: 'Smoking',
        images: {
          mediaThumb: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_smoking.svg', 'stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_smoking.png'],
            width: 62,
            height: 58
          },
          mediaBase: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_smoking.svg', 'stickers/emoticons/stickers/base/imgly_sticker_emoticons_smoking.png']
          }
        }
      }, {
        identifier: 'imgly_sticker_emoticons_sobbing',
        defaultName: 'Sobbing',
        images: {
          mediaThumb: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_sobbing.svg', 'stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_sobbing.png'],
            width: 62,
            height: 59
          },
          mediaBase: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_sobbing.svg', 'stickers/emoticons/stickers/base/imgly_sticker_emoticons_sobbing.png']
          }
        }
      }, {
        identifier: 'imgly_sticker_emoticons_star',
        defaultName: 'Star',
        images: {
          mediaThumb: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_star.svg', 'stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_star.png'],
            width: 64,
            height: 64
          },
          mediaBase: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_star.svg', 'stickers/emoticons/stickers/base/imgly_sticker_emoticons_star.png']
          }
        }
      }, {
        identifier: 'imgly_sticker_emoticons_steaming_furious',
        defaultName: 'Steaming Furious',
        images: {
          mediaThumb: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_steaming_furious.svg', 'stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_steaming_furious.png'],
            width: 62,
            height: 58
          },
          mediaBase: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_steaming_furious.svg', 'stickers/emoticons/stickers/base/imgly_sticker_emoticons_steaming_furious.png']
          }
        }
      }, {
        identifier: 'imgly_sticker_emoticons_sunbathing',
        defaultName: 'Sunbathing',
        images: {
          mediaThumb: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_sunbathing.svg', 'stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_sunbathing.png'],
            width: 62,
            height: 58
          },
          mediaBase: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_sunbathing.svg', 'stickers/emoticons/stickers/base/imgly_sticker_emoticons_sunbathing.png']
          }
        }
      }, {
        identifier: 'imgly_sticker_emoticons_tired',
        defaultName: 'Tired',
        images: {
          mediaThumb: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_tired.svg', 'stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_tired.png'],
            width: 62,
            height: 60
          },
          mediaBase: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_tired.svg', 'stickers/emoticons/stickers/base/imgly_sticker_emoticons_tired.png']
          }
        }
      }, {
        identifier: 'imgly_sticker_emoticons_tongue_out_wink',
        defaultName: 'Tongue Out Wink',
        images: {
          mediaThumb: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_tongue_out_wink.svg', 'stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_tongue_out_wink.png'],
            width: 62,
            height: 58
          },
          mediaBase: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_tongue_out_wink.svg', 'stickers/emoticons/stickers/base/imgly_sticker_emoticons_tongue_out_wink.png']
          }
        }
      }, {
        identifier: 'imgly_sticker_emoticons_wave',
        defaultName: 'Wave',
        images: {
          mediaThumb: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_wave.svg', 'stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_wave.png'],
            width: 62,
            height: 60
          },
          mediaBase: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_wave.svg', 'stickers/emoticons/stickers/base/imgly_sticker_emoticons_wave.png']
          }
        }
      }, {
        identifier: 'imgly_sticker_emoticons_wide_grin',
        defaultName: 'Wide Grin',
        images: {
          mediaThumb: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_wide_grin.svg', 'stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_wide_grin.png'],
            width: 62,
            height: 58
          },
          mediaBase: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_wide_grin.svg', 'stickers/emoticons/stickers/base/imgly_sticker_emoticons_wide_grin.png']
          }
        }
      }, {
        identifier: 'imgly_sticker_emoticons_wink',
        defaultName: 'Wink',
        images: {
          mediaThumb: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_wink.svg', 'stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_wink.png'],
            width: 62,
            height: 58
          },
          mediaBase: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_wink.svg', 'stickers/emoticons/stickers/base/imgly_sticker_emoticons_wink.png']
          }
        }
      }, {
        identifier: 'imgly_sticker_emoticons_wrestler',
        defaultName: 'Wrestler',
        images: {
          mediaThumb: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_wrestler.svg', 'stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_wrestler.png'],
            width: 62,
            height: 60
          },
          mediaBase: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_wrestler.svg', 'stickers/emoticons/stickers/base/imgly_sticker_emoticons_wrestler.png']
          }
        }
      }]
    }, {
      identifier: 'imgly_sticker_shapes',
      defaultName: 'Shapes',
      'metaData': {
        'backgroundImage': 'stickers/shapes/background.png'
      },
      'stickers': [{
        identifier: 'imgly_sticker_shapes_arrow_02',
        defaultName: 'Arrow 1',
        tintMode: 'solid',
        images: {
          mediaThumb: {
            uris: ['stickers/shapes/stickers/imgly_sticker_shapes_arrow_02.svg', 'stickers/shapes/stickers/thumbs/imgly_sticker_shapes_arrow_02.png'],
            width: 2000,
            height: 1236
          },
          mediaBase: {
            uris: ['stickers/shapes/stickers/imgly_sticker_shapes_arrow_02.svg', 'stickers/shapes/stickers/base/imgly_sticker_shapes_arrow_02.png'],
            width: 2000,
            height: 1236
          }
        }
      }, {
        identifier: 'imgly_sticker_shapes_arrow_03',
        defaultName: 'Arrow 2',
        tintMode: 'solid',
        images: {
          mediaThumb: {
            uris: ['stickers/shapes/stickers/imgly_sticker_shapes_arrow_03.svg', 'stickers/shapes/stickers/thumbs/imgly_sticker_shapes_arrow_03.png'],
            width: 2000,
            height: 2000
          },
          mediaBase: {
            uris: ['stickers/shapes/stickers/imgly_sticker_shapes_arrow_03.svg', 'stickers/shapes/stickers/base/imgly_sticker_shapes_arrow_03.png'],
            width: 2000,
            height: 2000
          }
        }
      }, {
        identifier: 'imgly_sticker_shapes_badge_01',
        defaultName: 'Badge 1',
        tintMode: 'solid',
        images: {
          mediaThumb: {
            uris: ['stickers/shapes/stickers/imgly_sticker_shapes_badge_01.svg', 'stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_01.png'],
            width: 2000,
            height: 2000
          },
          mediaBase: {
            uris: ['stickers/shapes/stickers/imgly_sticker_shapes_badge_01.svg', 'stickers/shapes/stickers/base/imgly_sticker_shapes_badge_01.png'],
            width: 2000,
            height: 2000
          }
        }
      }, {
        identifier: 'imgly_sticker_shapes_badge_04',
        defaultName: 'Badge 2',
        tintMode: 'solid',
        images: {
          mediaThumb: {
            uris: ['stickers/shapes/stickers/imgly_sticker_shapes_badge_04.svg', 'stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_04.png'],
            width: 2000,
            height: 1589
          },
          mediaBase: {
            uris: ['stickers/shapes/stickers/imgly_sticker_shapes_badge_04.svg', 'stickers/shapes/stickers/base/imgly_sticker_shapes_badge_04.png'],
            width: 2000,
            height: 1589
          }
        }
      }, {
        identifier: 'imgly_sticker_shapes_badge_06',
        defaultName: 'Badge 3',
        tintMode: 'solid',
        images: {
          mediaThumb: {
            uris: ['stickers/shapes/stickers/imgly_sticker_shapes_badge_06.svg', 'stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_06.png'],
            width: 2000,
            height: 1733
          },
          mediaBase: {
            uris: ['stickers/shapes/stickers/imgly_sticker_shapes_badge_06.svg', 'stickers/shapes/stickers/base/imgly_sticker_shapes_badge_06.png'],
            width: 2000,
            height: 1733
          }
        }
      }, {
        identifier: 'imgly_sticker_shapes_badge_08',
        defaultName: 'Badge 4',
        tintMode: 'solid',
        images: {
          mediaThumb: {
            uris: ['stickers/shapes/stickers/imgly_sticker_shapes_badge_08.svg', 'stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_08.png'],
            width: 2000,
            height: 2000
          },
          mediaBase: {
            uris: ['stickers/shapes/stickers/imgly_sticker_shapes_badge_08.svg', 'stickers/shapes/stickers/base/imgly_sticker_shapes_badge_08.png'],
            width: 2000,
            height: 2000
          }
        }
      }, {
        identifier: 'imgly_sticker_shapes_badge_11',
        defaultName: 'Badge 5',
        tintMode: 'solid',
        images: {
          mediaThumb: {
            uris: ['stickers/shapes/stickers/imgly_sticker_shapes_badge_11.svg', 'stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_11.png'],
            width: 2000,
            height: 2000
          },
          mediaBase: {
            uris: ['stickers/shapes/stickers/imgly_sticker_shapes_badge_11.svg', 'stickers/shapes/stickers/base/imgly_sticker_shapes_badge_11.png'],
            width: 2000,
            height: 2000
          }
        }
      }, {
        identifier: 'imgly_sticker_shapes_badge_12',
        defaultName: 'Badge 6',
        tintMode: 'solid',
        images: {
          mediaThumb: {
            uris: ['stickers/shapes/stickers/imgly_sticker_shapes_badge_12.svg', 'stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_12.png'],
            width: 2001,
            height: 1903
          },
          mediaBase: {
            uris: ['stickers/shapes/stickers/imgly_sticker_shapes_badge_12.svg', 'stickers/shapes/stickers/base/imgly_sticker_shapes_badge_12.png'],
            width: 2001,
            height: 1903
          }
        }
      }, {
        identifier: 'imgly_sticker_shapes_badge_13',
        defaultName: 'Badge 7',
        tintMode: 'solid',
        images: {
          mediaThumb: {
            uris: ['stickers/shapes/stickers/imgly_sticker_shapes_badge_13.svg', 'stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_13.png'],
            width: 2000,
            height: 1718
          },
          mediaBase: {
            uris: ['stickers/shapes/stickers/imgly_sticker_shapes_badge_13.svg', 'stickers/shapes/stickers/base/imgly_sticker_shapes_badge_13.png'],
            width: 2000,
            height: 1718
          }
        }
      }, {
        identifier: 'imgly_sticker_shapes_badge_15',
        defaultName: 'Badge 8',
        tintMode: 'solid',
        images: {
          mediaThumb: {
            uris: ['stickers/shapes/stickers/imgly_sticker_shapes_badge_15.svg', 'stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_15.png'],
            width: 1618,
            height: 2000
          },
          mediaBase: {
            uris: ['stickers/shapes/stickers/imgly_sticker_shapes_badge_15.svg', 'stickers/shapes/stickers/base/imgly_sticker_shapes_badge_15.png'],
            width: 1618,
            height: 2000
          }
        }
      }, {
        identifier: 'imgly_sticker_shapes_badge_18',
        defaultName: 'Badge 9',
        tintMode: 'solid',
        images: {
          mediaThumb: {
            uris: ['stickers/shapes/stickers/imgly_sticker_shapes_badge_18.svg', 'stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_18.png'],
            width: 1198,
            height: 2000
          },
          mediaBase: {
            uris: ['stickers/shapes/stickers/imgly_sticker_shapes_badge_18.svg', 'stickers/shapes/stickers/base/imgly_sticker_shapes_badge_18.png'],
            width: 1198,
            height: 2000
          }
        }
      }, {
        identifier: 'imgly_sticker_shapes_badge_19',
        defaultName: 'Badge 10',
        tintMode: 'solid',
        images: {
          mediaThumb: {
            uris: ['stickers/shapes/stickers/imgly_sticker_shapes_badge_19.svg', 'stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_19.png'],
            width: 2127,
            height: 481
          },
          mediaBase: {
            uris: ['stickers/shapes/stickers/imgly_sticker_shapes_badge_19.svg', 'stickers/shapes/stickers/base/imgly_sticker_shapes_badge_19.png'],
            width: 2127,
            height: 481
          }
        }
      }, {
        identifier: 'imgly_sticker_shapes_badge_20',
        defaultName: 'Badge 11',
        tintMode: 'solid',
        images: {
          mediaThumb: {
            uris: ['stickers/shapes/stickers/imgly_sticker_shapes_badge_20.svg', 'stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_20.png'],
            width: 2000,
            height: 1404
          },
          mediaBase: {
            uris: ['stickers/shapes/stickers/imgly_sticker_shapes_badge_20.svg', 'stickers/shapes/stickers/base/imgly_sticker_shapes_badge_20.png'],
            width: 2000,
            height: 1404
          }
        }
      }, {
        identifier: 'imgly_sticker_shapes_badge_28',
        defaultName: 'Badge 12',
        tintMode: 'solid',
        images: {
          mediaThumb: {
            uris: ['stickers/shapes/stickers/imgly_sticker_shapes_badge_28.svg', 'stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_28.png'],
            width: 2000,
            height: 2000
          },
          mediaBase: {
            uris: ['stickers/shapes/stickers/imgly_sticker_shapes_badge_28.svg', 'stickers/shapes/stickers/base/imgly_sticker_shapes_badge_28.png'],
            width: 2000,
            height: 2000
          }
        }
      }, {
        identifier: 'imgly_sticker_shapes_badge_32',
        defaultName: 'Badge 13',
        tintMode: 'solid',
        images: {
          mediaThumb: {
            uris: ['stickers/shapes/stickers/imgly_sticker_shapes_badge_32.svg', 'stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_32.png'],
            width: 1960,
            height: 2000
          },
          mediaBase: {
            uris: ['stickers/shapes/stickers/imgly_sticker_shapes_badge_32.svg', 'stickers/shapes/stickers/base/imgly_sticker_shapes_badge_32.png'],
            width: 1960,
            height: 2000
          }
        }
      }, {
        identifier: 'imgly_sticker_shapes_badge_35',
        defaultName: 'Badge 14',
        tintMode: 'solid',
        images: {
          mediaThumb: {
            uris: ['stickers/shapes/stickers/imgly_sticker_shapes_badge_35.svg', 'stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_35.png'],
            width: 2000,
            height: 2002
          },
          mediaBase: {
            uris: ['stickers/shapes/stickers/imgly_sticker_shapes_badge_35.svg', 'stickers/shapes/stickers/base/imgly_sticker_shapes_badge_35.png'],
            width: 2000,
            height: 2002
          }
        }
      }, {
        identifier: 'imgly_sticker_shapes_badge_36',
        defaultName: 'Badge 15',
        tintMode: 'solid',
        images: {
          mediaThumb: {
            uris: ['stickers/shapes/stickers/imgly_sticker_shapes_badge_36.svg', 'stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_36.png'],
            width: 2000,
            height: 1668
          },
          mediaBase: {
            uris: ['stickers/shapes/stickers/imgly_sticker_shapes_badge_36.svg', 'stickers/shapes/stickers/base/imgly_sticker_shapes_badge_36.png'],
            width: 2000,
            height: 1668
          }
        }
      }, {
        identifier: 'imgly_sticker_shapes_spray_01',
        defaultName: 'Spray 1',
        tintMode: 'solid',
        images: {
          mediaThumb: {
            uris: ['stickers/shapes/stickers/imgly_sticker_shapes_spray_01.svg', 'stickers/shapes/stickers/thumbs/imgly_sticker_shapes_spray_01.png'],
            width: 1912,
            height: 2039
          },
          mediaBase: {
            uris: ['stickers/shapes/stickers/imgly_sticker_shapes_spray_01.svg', 'stickers/shapes/stickers/base/imgly_sticker_shapes_spray_01.png'],
            width: 1912,
            height: 2039
          }
        }
      }, {
        identifier: 'imgly_sticker_shapes_spray_03',
        defaultName: 'Spray 2',
        tintMode: 'solid',
        images: {
          mediaThumb: {
            uris: ['stickers/shapes/stickers/imgly_sticker_shapes_spray_03.svg', 'stickers/shapes/stickers/thumbs/imgly_sticker_shapes_spray_03.png'],
            width: 1681,
            height: 1779
          },
          mediaBase: {
            uris: ['stickers/shapes/stickers/imgly_sticker_shapes_spray_03.svg', 'stickers/shapes/stickers/base/imgly_sticker_shapes_spray_03.png'],
            width: 1681,
            height: 1779
          }
        }
      }, {
        identifier: 'imgly_sticker_shapes_spray_04',
        defaultName: 'Spray 3',
        tintMode: 'solid',
        images: {
          mediaThumb: {
            uris: ['stickers/shapes/stickers/imgly_sticker_shapes_spray_04.svg', 'stickers/shapes/stickers/thumbs/imgly_sticker_shapes_spray_04.png'],
            width: 1407,
            height: 2248
          },
          mediaBase: {
            uris: ['stickers/shapes/stickers/imgly_sticker_shapes_spray_04.svg', 'stickers/shapes/stickers/base/imgly_sticker_shapes_spray_04.png'],
            width: 1407,
            height: 2248
          }
        }
      }]
    }]
  }
});

/***/ }),
/* 132 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_globals__ = __webpack_require__(9);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__assets_font__ = __webpack_require__(334);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__log__ = __webpack_require__(17);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__assets_font_variation__ = __webpack_require__(335);


var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */






var FontManager = function () {
  function FontManager(ui, options) {
    _classCallCheck(this, FontManager);

    this._ui = ui;
    this._options = options;
    this._fonts = [];
    this._variationsByIdentifier = {};
    this._fontsByFontFamily = {};

    this._initFonts();
  }

  /**
   * Initializes the fonts
   * @private
   */


  _createClass(FontManager, [{
    key: '_initFonts',
    value: function _initFonts() {
      var _this = this;

      var _options = this._options,
          additionalFonts = _options.fonts,
          replaceFonts = _options.replaceFonts,
          availableVariations = _options.availableVariations;

      // Replace or append fonts

      var fonts = __WEBPACK_IMPORTED_MODULE_1_globals__["c" /* Constants */].DEFAULTS.FONTS;
      if (replaceFonts) {
        fonts = additionalFonts;
      } else {
        fonts = fonts.concat(additionalFonts || []);
      }

      // Turn fonts into actual Font objects with FontVariation objects
      var defaultVariation = void 0;
      fonts = fonts.map(function (font) {
        var fontFamily = font.fontFamily;

        var variations = font.variations;

        if (availableVariations) {
          variations = variations.filter(function (variation) {
            return availableVariations.indexOf(variation.identifier) !== -1;
          });
        }

        if (variations.length === 0) return null;

        var fontInstance = new __WEBPACK_IMPORTED_MODULE_2__assets_font__["a" /* default */]({
          fontFamily: fontFamily
        });
        variations = variations.map(function (variation) {
          var variationInstance = new __WEBPACK_IMPORTED_MODULE_4__assets_font_variation__["a" /* default */](variation);
          variationInstance.setFontFamily(fontFamily);
          variationInstance.setFont(fontInstance);
          if (variation.default && !defaultVariation) {
            defaultVariation = variationInstance;
          }

          if (variationInstance.getTextMetrics() == null) {
            __WEBPACK_IMPORTED_MODULE_3__log__["a" /* default */].warn('Missing font metrics for ' + variationInstance.getIdentifier() + '. The SDK will fall back to basic font rendering, which may lead to layout issues. Please provide font metrics for your custom fonts. See https://docs.photoeditorsdk.com/guides/html5/ for more details.');
          }

          _this._variationsByIdentifier[variationInstance.getIdentifier()] = variationInstance;
          return variationInstance;
        });
        fontInstance.setVariations(variations);
        _this._fontsByFontFamily[fontFamily] = fontInstance;
        return fontInstance;
      }).filter(function (f) {
        return f;
      });

      if (!defaultVariation) {
        defaultVariation = fonts[0].getVariations()[0];
      }

      this._defaultVariation = defaultVariation;
      this._fonts = fonts;
    }

    /**
     * Returns all available fonts
     * @return {PhotoEditorSDK.UI.DesktopUI.Font[]}
     */

  }, {
    key: 'getFonts',
    value: function getFonts() {
      return this._fonts;
    }

    /**
     * Returns the font for the given font family
     * @param  {String} fontFamily
     * @return {PhotoEditorSDK.UI.DesktopUI.Font}
     */

  }, {
    key: 'getFontByFontFamily',
    value: function getFontByFontFamily(fontFamily) {
      return this._fontsByFontFamily[fontFamily];
    }

    /**
     * Returns the font variation for the given identifier
     * @param  {String} identifier
     * @return {PhotoEditorSDK.UI.DesktopUI.FontVariation}
     */

  }, {
    key: 'getVariationByIdentifier',
    value: function getVariationByIdentifier(identifier) {
      return this._variationsByIdentifier[identifier];
    }

    /**
     * Returns the default variation
     * @return {PhotoEditorSDK.UI.DesktopUI.FontVariation}
     */

  }, {
    key: 'getDefaultVariation',
    value: function getDefaultVariation() {
      return this._defaultVariation;
    }
  }]);

  return FontManager;
}();

/* harmony default export */ __webpack_exports__["a"] = (FontManager);

/***/ }),
/* 133 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_promise__ = __webpack_require__(11);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_promise___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_promise__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_globals__ = __webpack_require__(9);



var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */


var TWICE_PI = Math.PI * 2;

var v100Serializer = function () {
  function v100Serializer(editor) {
    _classCallCheck(this, v100Serializer);

    this._editor = editor;

    this._serializeOperations = this._serializeOperations.bind(this);
  }

  // -------------------------------------------------------------------------- SERIALIZATION

  /**
   * Serializes the editor state
   * @param {Object} options = {}
   * @return {Promise}
   */


  _createClass(v100Serializer, [{
    key: 'serialize',
    value: function serialize() {
      var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};

      this._options = __WEBPACK_IMPORTED_MODULE_2_globals__["k" /* SDKUtils */].defaults(options, {
        image: true
      });

      var data = {
        version: this.constructor.version
      };

      return this._serializeInputImage(data).then(this._serializeOperations);
    }

    /**
     * Serializes the input image as base64 and attaches it to `data`
     * @param  {Object} data
     * @return {Promise}
     * @private
     */

  }, {
    key: '_serializeInputImage',
    value: function _serializeInputImage(data) {
      var image = this._editor.getImage();
      var width = image.width,
          height = image.height;


      if (!this._options.image) {
        data.inputImage = { width: width, height: height };
        return __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_promise___default.a.resolve(data);
      }

      var canvas = __WEBPACK_IMPORTED_MODULE_2_globals__["k" /* SDKUtils */].createCanvas();
      canvas.width = image.width;
      canvas.height = image.height;
      var context = canvas.getContext('2d');
      context.drawImage(image, 0, 0);

      var dataUrl = canvas.toDataURL(__WEBPACK_IMPORTED_MODULE_2_globals__["e" /* ImageFormat */].PNG);
      data.inputImage = {
        type: __WEBPACK_IMPORTED_MODULE_2_globals__["e" /* ImageFormat */].PNG,
        data: dataUrl.replace(/^data:image\/(.*?);base64,/, ''),
        width: width,
        height: height
      };
      return __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_promise___default.a.resolve(data);
    }

    /**
     * Serializes the operations and attaches them to `data`
     * @param  {Object} data
     * @return {Promise}
     * @private
     */

  }, {
    key: '_serializeOperations',
    value: function _serializeOperations(data) {
      var _this = this;

      var operations = [];
      var stack = this._editor.operations.getStack();
      stack.forEach(function (operation) {
        var data = _this._serializeOperation(operation, operations);
        if (data) {
          operations.push(data);
        }
      });
      data.operations = operations.filter(function (o) {
        return o;
      }); // Remove possible `null` operations
      return __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_promise___default.a.resolve(data);
    }

    /**
     * Serializes the given operation
     * @param  {PhotoEditorSDK.Operation} operation
     * @param  {PhotoEditorSDK.Operation[]} operations
     * @return {Object}
     * @private
     */

  }, {
    key: '_serializeOperation',
    value: function _serializeOperation(operation, operations) {
      switch (operation.constructor.identifier) {
        case 'transform':
          return this._serializeTransformOperation(operation);
        case 'orientation':
          return this._serializeOrientationOperation(operation);
        case 'filter':
          return this._serializeFilterOperation(operation);
        case 'adjustments':
          return this._serializeAdjustmentsOperation(operation);
        case 'sprite':
          return this._serializeSpriteOperation(operation, operations);
        case 'radial-focus':
          return this._serializeRadialFocusOperation(operation);
        case 'mirrored-focus':
          return this._serializeLinearFocusOperation(operation);
        default:
          __WEBPACK_IMPORTED_MODULE_2_globals__["g" /* Log */].warn('Unable to serialize operation of type ' + operation.constructor.identifier);
      }
    }

    /**
     * Serializes the given transform operation
     * @param  {PhotoEditorSDK.Operation.TransformOperation} operation
     * @return {Object}
     * @private
     */

  }, {
    key: '_serializeTransformOperation',
    value: function _serializeTransformOperation(operation) {
      var options = operation.serializeOptions(['start', 'end', 'rotation'], true);
      options.rotation = (options.rotation + TWICE_PI) % TWICE_PI;
      return {
        type: 'crop',
        options: options
      };
    }

    /**
     * Serializes the given orientation operation
     * @param  {PhotoEditorSDK.Operation.OrientationOperation} operation
     * @return {Object}
     * @private
     */

  }, {
    key: '_serializeOrientationOperation',
    value: function _serializeOrientationOperation(operation) {
      return {
        type: 'orientation',
        options: operation.serializeOptions(['flipVertically', 'flipHorizontally', 'rotation'], true)
      };
    }

    /**
     * Serializes the given filter operation
     * @param  {PhotoEditorSDK.Operations.FilterOperation} operation
     * @return {Object}
     * @private
     */

  }, {
    key: '_serializeFilterOperation',
    value: function _serializeFilterOperation(operation) {
      if (operation.getIdentifier() === 'identity') return null;

      return {
        type: 'filter',
        options: {
          intensity: operation.getIntensity(),
          name: operation.getIdentifier()
        }
      };
    }

    /**
     * Serializes the given adjustments operation
     * @param  {PhotoEditorSDK.Operations.AdjustmentsOperation} operation
     * @return {Object}
     * @private
     */

  }, {
    key: '_serializeAdjustmentsOperation',
    value: function _serializeAdjustmentsOperation(operation) {
      var availableOptions = operation.availableOptions;


      var optionNames = ['brightness', 'saturation', 'contrast', 'exposure', 'shadows', 'highlights', 'clarity'];
      var options = {};
      optionNames.forEach(function (optionName) {
        var option = availableOptions[optionName];
        var value = operation.getOption(optionName);
        var minValue = option.minValue,
            midValue = option.midValue,
            maxValue = option.maxValue;

        options[optionName] = value <= midValue ? (value - minValue) / (midValue - minValue) - 1 : (value - midValue) / (maxValue - midValue);
      });
      return {
        type: 'adjustments',
        options: options
      };
    }

    /**
     * Serializes the given sprite operation
     * @return {PhotoEditorSDK.Operations.SpriteOperation} operation
     * @private
     */

  }, {
    key: '_serializeSpriteOperation',
    value: function _serializeSpriteOperation(operation, operations) {
      var _this2 = this;

      var spriteOperations = operations.filter(function (o) {
        return o.type === 'sprite';
      });
      var spriteOperation = void 0;
      var returnOperation = true;
      if (spriteOperations.length) {
        spriteOperation = spriteOperations.pop();
        returnOperation = false;
      } else {
        // No sprite operation exists, create a new one
        spriteOperation = {
          type: 'sprite',
          options: {
            sprites: []
          }
        };
      }

      operation.getSprites().forEach(function (sprite) {
        var spriteItem = null;
        if (sprite instanceof operation.constructor.StickerSprite) {
          spriteItem = _this2._serializeSticker(operation, sprite);
        } else if (sprite instanceof operation.constructor.TextSprite) {
          spriteItem = _this2._serializeText(operation, sprite);
        } else if (sprite instanceof operation.constructor.BrushSprite) {
          spriteItem = _this2._serializeBrush(operation, sprite);
        }

        if (spriteItem) {
          spriteOperation.options.sprites.push(spriteItem);
        }
      });

      if (returnOperation) {
        return spriteOperation;
      }
    }

    /**
     * Serializes the given sticker
     * @param  {PhotoEditorSDK.Operation} operation
     * @param  {PhotoEditorSDK.Operations.SpriteOperation.StickerSprite} sprite
     * @return {Object}
     * @private
     */

  }, {
    key: '_serializeSticker',
    value: function _serializeSticker(operation, sprite) {
      var adjustments = sprite.getAdjustments();

      var options = sprite.serializeOptions(['identifier', 'position', 'dimensions', 'flipVertically', 'flipHorizontally', 'rotation'], true);

      options.name = options.identifier;
      delete options.identifier;

      options.rotation = (options.rotation + TWICE_PI) % TWICE_PI;

      var adjustmentsOptions = adjustments.availableOptions;
      options.adjustments = {
        brightness: adjustments.getBrightness() - adjustmentsOptions.brightness.default,
        saturation: adjustments.getSaturation() - adjustmentsOptions.saturation.default,
        contrast: adjustments.getContrast() - adjustmentsOptions.contrast.default
      };

      return {
        type: 'sticker',
        options: options
      };
    }

    /**
     * Serializes the given text sprite
     * @param  {PhotoEditorSDK.Operation} operation
     * @param  {PhotoEditorSDK.Operations.SpriteOperation.TextSprite} sprite
     * @return {Object}
     * @private
     */

  }, {
    key: '_serializeText',
    value: function _serializeText(operation, sprite) {
      var options = sprite.serializeOptions(['fontSize', 'lineHeight', 'fontFamily', 'fontWeight', 'alignment', 'color', 'backgroundColor', 'position', 'rotation', 'text', 'maxWidth'], true);
      options.rotation = (options.rotation + TWICE_PI) % TWICE_PI;

      return {
        type: 'text',
        options: options
      };
    }

    /**
     * Serializes the given brush sprite
     * @param  {PhotoEditorSDK.Operation} operation
     * @param  {PhotoEditorSDK.Operations.SpriteOperation.BrushSprite} sprite
     * @return {Object}
     * @private
     */

  }, {
    key: '_serializeBrush',
    value: function _serializeBrush(operation, sprite) {
      var _this3 = this;

      return {
        type: 'brush',
        options: {
          paths: sprite.getPaths().map(function (path) {
            return _this3._serializePath(path);
          })
        }
      };
    }

    /**
     * Serializes the given path
     * @param  {PhotoEditorSDK.Operations.SpriteOperation.BrushSprite.Path} path
     * @return {Object}
     * @private
     */

  }, {
    key: '_serializePath',
    value: function _serializePath(path) {
      var options = path.getBrush().serializeOptions(['color', 'size'], true);

      options.points = path.getControlPoints().map(function (point) {
        return point.getPosition().toObject();
      });
      return options;
    }

    /**
     * Serializes the given radial focus operation
     * @param  {PhotoEditorSDK.Operations.RadialFocusOperation} operation
     * @return {Object}
     * @private
     */

  }, {
    key: '_serializeRadialFocusOperation',
    value: function _serializeRadialFocusOperation(operation) {
      return {
        type: 'focus',
        options: {
          type: 'radial',
          options: operation.serializeOptions(['position', 'radius', 'gradientRadius', 'blurRadius'], true)
        }
      };
    }

    /**
     * Serializes the given linear focus operation
     * @param  {PhotoEditorSDK.Operations.MirroredFocusOperation} operation
     * @return {Object}
     * @private
     */

  }, {
    key: '_serializeLinearFocusOperation',
    value: function _serializeLinearFocusOperation(operation) {
      return {
        type: 'focus',
        options: {
          type: 'linear',
          options: operation.serializeOptions(['start', 'end', 'blurRadius', 'size', 'gradientSize'], true)
        }
      };
    }

    /**
     * Returns the input dimensions for the given operation
     * @param  {PhotoEditorSDK.Operation} operation
     * @return {PhotoEditorSDK.Math.Vector2}
     * @private
     */

  }, {
    key: '_getInputDimensionsForOperation',
    value: function _getInputDimensionsForOperation(operation) {
      var operationFound = false;
      var inputDimensions = this._editor.getInputDimensions();

      this._editor.operations.getStack().forEach(function (op) {
        if (op === operation) operationFound = true;
        if (operationFound) return;
        inputDimensions = op.getNewDimensions(inputDimensions);
      });

      return inputDimensions;
    }
  }]);

  return v100Serializer;
}();

/* harmony default export */ __webpack_exports__["a"] = (v100Serializer);


v100Serializer.version = '1.0.0';

/***/ }),
/* 134 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_promise__ = __webpack_require__(11);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_promise___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_promise__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_globals__ = __webpack_require__(9);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_shared_managers_filter_manager__ = __webpack_require__(339);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7_shared_managers_sticker_manager__ = __webpack_require__(89);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8_shared_managers_brush_manager__ = __webpack_require__(340);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9_shared_managers_font_manager__ = __webpack_require__(132);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10_lib_font_loader__ = __webpack_require__(90);






var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */








var Brush = void 0;
if (typeof __WEBPACK_IMPORTED_MODULE_5_globals__["j" /* SDK */].Operations.SpriteOperation !== 'undefined') {
  Brush = __WEBPACK_IMPORTED_MODULE_5_globals__["j" /* SDK */].Operations.SpriteOperation.BrushSprite;
}

var v100Deserializer = function () {
  function v100Deserializer(editor, data) {
    _classCallCheck(this, v100Deserializer);

    this._editor = editor;
    this._ui = this._editor.getUI();
    this._data = data;

    this._filterManager = new __WEBPACK_IMPORTED_MODULE_6_shared_managers_filter_manager__["a" /* default */](this._ui, this._getOptions('filter'));
    this._stickerManager = new __WEBPACK_IMPORTED_MODULE_7_shared_managers_sticker_manager__["a" /* default */](this._ui, this._getOptions('sticker'));
    this._brushManager = new __WEBPACK_IMPORTED_MODULE_8_shared_managers_brush_manager__["a" /* default */](this._ui, this._getOptions('brush'));
    this._fontManager = new __WEBPACK_IMPORTED_MODULE_9_shared_managers_font_manager__["a" /* default */](this._ui, this._getOptions('text'));
  }

  _createClass(v100Deserializer, [{
    key: '_getOptions',
    value: function _getOptions(control) {
      var controls = this._editor.controls;

      var defaultOptions = {};
      if (controls && controls.get(control)) {
        defaultOptions = controls.get(control).defaultOptions;
      }

      var editorOptions = this._editor.getOptions();
      return __WEBPACK_IMPORTED_MODULE_5_globals__["k" /* SDKUtils */].deepDefaults({}, editorOptions.editor.controlsOptions[control] || {}, defaultOptions);
    }

    /**
     * Deserializes the given data
     * @return {Promise}
     */

  }, {
    key: 'deserialize',
    value: function deserialize() {
      var _this = this;

      return this._validateVersion().then(function () {
        return _this._deserializeInputImage();
      }).then(function () {
        return _this._deserializeOperations();
      });
    }

    /**
     * Validates the version
     * @return {Promise}
     */

  }, {
    key: '_validateVersion',
    value: function _validateVersion() {
      if (this._data.version !== this.constructor.version) {
        return __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_promise___default.a.reject(new Error('Invalid version ' + this._data.version + ', expected ' + this.constructor.version));
      }
      return __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_promise___default.a.resolve();
    }

    /**
     * Deserializes the input image (if present)
     * @return {Promise}
     * @private
     */

  }, {
    key: '_deserializeInputImage',
    value: function _deserializeInputImage() {
      var _this2 = this;

      return new __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_promise___default.a(function (resolve, reject) {
        var _data$inputImage = _this2._data.inputImage,
            data = _data$inputImage.data,
            type = _data$inputImage.type;

        if (data && type) {
          var image = new window.Image();
          image.addEventListener('load', function () {
            _this2._editor.setImage(image);
            resolve();
          });
          image.src = 'data:' + type + ';base64,' + data;
        } else {
          resolve();
        }
      });
    }

    /**
     * Deserializes the operations
     * @return {Promise}
     * @private
     */

  }, {
    key: '_deserializeOperations',
    value: function _deserializeOperations() {
      var _this3 = this;

      var promises = this._data.operations.map(function (operation) {
        return _this3._deserializeOperation(operation).then(function (instance) {
          if (instance) {
            _this3._editor.getMediator().emit(__WEBPACK_IMPORTED_MODULE_5_globals__["c" /* Constants */].EVENTS.OPERATION_UPDATED, instance);
          }
          return instance;
        });
      });

      return __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_promise___default.a.all(promises);
    }

    /**
     * Deserializes the given operation
     * @param  {PhotoEditorSDK.Operation} operation
     * @return {Promise}
     * @private
     */

  }, {
    key: '_deserializeOperation',
    value: function _deserializeOperation(operation) {
      switch (operation.type) {
        case 'crop':
          return this._deserializeCropOperation(operation);
        case 'orientation':
          return this._deserializeOrientationOperation(operation);
        case 'filter':
          return this._deserializeFilterOperation(operation);
        case 'adjustments':
          return this._deserializeAdjustmentsOperation(operation);
        case 'sprite':
          return this._deserializeSpriteOperation(operation);
        case 'focus':
          return this._deserializeFocusOperation(operation);
      }
    }

    /**
     * Deserializes the given crop operation
     * @param  {Object} operation
     * @return {Promise}
     * @private
     */

  }, {
    key: '_deserializeCropOperation',
    value: function _deserializeCropOperation(operation) {
      var options = operation.options;
      var rotation = options.rotation;

      var start = __WEBPACK_IMPORTED_MODULE_5_globals__["n" /* Vector2 */].fromObject(options.start);
      var end = __WEBPACK_IMPORTED_MODULE_5_globals__["n" /* Vector2 */].fromObject(options.end);

      // Normalize rotation
      if (rotation > Math.PI) {
        rotation -= Math.PI * 2;
      }

      var cropOptions = { start: start, end: end };
      if (typeof rotation !== 'undefined') {
        cropOptions.rotation = rotation;
      }

      var transformOperation = this._editor.operations.getOrCreate('transform');
      this._editor.broadcastTransform(transformOperation, cropOptions);
      transformOperation.set(cropOptions);
      return __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_promise___default.a.resolve(transformOperation);
    }

    /**
     * Deserializes the given orientation operation
     * @param  {Object} operation
     * @return {Promise}
     * @private
     */

  }, {
    key: '_deserializeOrientationOperation',
    value: function _deserializeOrientationOperation(operation) {
      var options = operation.options;

      var orientationOperation = this._editor.operations.getOrCreate('orientation');
      if (!orientationOperation) return __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_promise___default.a.resolve();
      orientationOperation.set(options);
      return __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_promise___default.a.resolve(orientationOperation);
    }

    /**
     * Deserializes the given filter operation
     * @param  {Object} operation
     * @return {Promise}
     * @private
     */

  }, {
    key: '_deserializeFilterOperation',
    value: function _deserializeFilterOperation(operation) {
      var _this4 = this;

      var options = operation.options;


      if (!this._filterManager.getFilterByIdentifier(options.name)) {
        __WEBPACK_IMPORTED_MODULE_5_globals__["g" /* Log */].warn('Deserializer', 'Unknown filter `' + options.name + '`');
        return __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_promise___default.a.resolve();
      }

      return this._filterManager.instantiateFilterWithIdentifier(options.name).then(function (filter) {
        var filterOperation = _this4._editor.operations.getOrCreate('filter');
        filterOperation.set({
          identifier: options.name,
          filter: filter,
          intensity: options.intensity
        });
        return filterOperation;
      });
    }

    /**
     * Deserializes the given adjustments operation
     * @param  {Object} operation
     * @return {Promise}
     * @private
     */

  }, {
    key: '_deserializeAdjustmentsOperation',
    value: function _deserializeAdjustmentsOperation(operation) {
      var AdjustmentsOperation = __WEBPACK_IMPORTED_MODULE_5_globals__["j" /* SDK */].Operations.AdjustmentsOperation;
      var options = operation.options;


      var knownOptions = ['brightness', 'saturation', 'contrast', 'exposure', 'shadows', 'highlights', 'clarity'];

      var operationOptions = {};

      knownOptions.forEach(function (optionName) {
        if (typeof options[optionName] === 'undefined') return;

        var _AdjustmentsOperation = AdjustmentsOperation.prototype.availableOptions[optionName],
            minValue = _AdjustmentsOperation.minValue,
            midValue = _AdjustmentsOperation.midValue,
            maxValue = _AdjustmentsOperation.maxValue;

        var value = options[optionName];

        value = value < 0 ? midValue + (midValue - minValue) * value : midValue + (maxValue - midValue) * value;
        operationOptions[optionName] = value;
      });

      return __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_promise___default.a.resolve(this._editor.operations.getOrCreate('adjustments', operationOptions));
    }

    /**
     * Deserializes the given sprite operation
     * @param  {Object} operation
     * @return {Promise}
     * @private
     */

  }, {
    key: '_deserializeSpriteOperation',
    value: function _deserializeSpriteOperation(operation) {
      var _this5 = this;

      var options = operation.options;

      var spriteOperation = this._editor.operations.getOrCreate('sprite');
      if (!spriteOperation) return __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_promise___default.a.resolve();

      var promises = options.sprites.map(function (sprite) {
        return _this5._deserializeSprite(spriteOperation, sprite);
      }).filter(function (p) {
        return p;
      });
      return __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_promise___default.a.all(promises).then(function (sprites) {
        spriteOperation.setSprites(sprites.filter(function (s) {
          return s;
        }));
        return spriteOperation;
      });
    }

    /**
     * Deserializes the given sprite
     * @param  {PhotoEditorSDK.Operations.SpriteOperation} spriteOperation
     * @param  {PhotoEditorSDK.Operations.SpriteOperation.Sprite} sprite
     * @return {Promise}
     * @private
     */

  }, {
    key: '_deserializeSprite',
    value: function _deserializeSprite(spriteOperation, sprite) {
      switch (sprite.type) {
        case 'sticker':
          return this._deserializeSticker(spriteOperation, sprite);
        case 'text':
          return this._deserializeText(spriteOperation, sprite);
        case 'brush':
          return this._deserializeBrush(spriteOperation, sprite);
      }
    }

    /**
     * Deserializes the given sticker for the given operation
     * @param  {PhotoEditorSDK.Operations.SpriteOperation} operation
     * @param  {Object} sprite
     * @return {PhotoEditorSDK.Operations.SpriteOperation.StickerSprite}
     * @private
     */

  }, {
    key: '_deserializeSticker',
    value: function _deserializeSticker(operation, sprite) {
      var _this6 = this;

      var SpriteOperation = __WEBPACK_IMPORTED_MODULE_5_globals__["j" /* SDK */].Operations.SpriteOperation;
      var options = sprite.options;


      var sticker = this._stickerManager.getStickerByIdentifier(options.name);
      var url = this._stickerManager.getURLForSticker(sticker);
      if (!sticker) {
        __WEBPACK_IMPORTED_MODULE_5_globals__["g" /* Log */].warn('Deserializer', 'Unknown sticker \'' + options.name + '\'. Skipping sprite.');
        return __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_promise___default.a.resolve();
      }
      return new __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_promise___default.a(function (resolve, reject) {
        var image = new window.Image();
        image.addEventListener('load', function () {
          var adjustments = SpriteOperation.StickerSprite.prototype.availableOptions.adjustments.structure;
          var rotation = options.rotation,
              flipHorizontally = options.flipHorizontally,
              flipVertically = options.flipVertically;

          var stickerOptions = {
            identifier: options.name,
            image: image,
            position: __WEBPACK_IMPORTED_MODULE_5_globals__["n" /* Vector2 */].fromObject(options.position),
            dimensions: __WEBPACK_IMPORTED_MODULE_5_globals__["n" /* Vector2 */].fromObject(options.dimensions),
            rotation: rotation,
            flipHorizontally: flipHorizontally,
            flipVertically: flipVertically,
            adjustments: {}
          };

          if (typeof options.adjustments !== 'undefined') {
            ['brightness', 'contrast', 'saturation'].forEach(function (option) {
              if (typeof options.adjustments[option] !== 'undefined') {
                stickerOptions.adjustments[option] = options.adjustments[option] + adjustments[option].default;
              }
            });
          }

          resolve(operation.createSticker(stickerOptions));
        });
        image.crossOrigin = 'Anonymous';
        image.src = _this6._editor.getUI().getAssetPath(url);
      });
    }

    /**
     * Deserializes the given text for the given operation
     * @param  {PhotoEditorSDK.Operations.SpriteOperation} operation
     * @param  {Object} text
     * @return {PhotoEditorSDK.Operations.SpriteOperation.TextSprite}
     * @private
     */

  }, {
    key: '_deserializeText',
    value: function _deserializeText(operation, text) {
      var options = text.options;
      var fontSize = options.fontSize,
          lineHeight = options.lineHeight,
          fontFamily = options.fontFamily,
          fontWeight = options.fontWeight,
          alignment = options.alignment,
          rotation = options.rotation,
          maxWidth = options.maxWidth,
          color = options.color,
          backgroundColor = options.backgroundColor;


      var fontLoader = new __WEBPACK_IMPORTED_MODULE_10_lib_font_loader__["a" /* default */](this._ui);
      var font = this._fontManager.getFontByFontFamily(fontFamily);
      if (!font) font = this._fontManager.getDefaultFont();
      fontLoader.setFonts([font]);
      return fontLoader.load().then(function () {
        return operation.createText({
          fontSize: fontSize,
          lineHeight: lineHeight,
          fontFamily: fontFamily,
          fontWeight: fontWeight,
          alignment: alignment,
          rotation: rotation,
          maxWidth: maxWidth,
          text: options.text,
          color: __WEBPACK_IMPORTED_MODULE_5_globals__["b" /* Color */].fromArray(color),
          backgroundColor: __WEBPACK_IMPORTED_MODULE_5_globals__["b" /* Color */].fromArray(backgroundColor),
          position: __WEBPACK_IMPORTED_MODULE_5_globals__["n" /* Vector2 */].fromObject(options.position)
        });
      });
    }

    /**
     * Deserializes the given brush for the given operation
     * @param  {PhotoEditorSDK.Operations.SpriteOperation} operation
     * @param  {Object} brush
     * @return {PhotoEditorSDK.Operations.SpriteOperation.BrushSprite}
     * @private
     */

  }, {
    key: '_deserializeBrush',
    value: function _deserializeBrush(operation, brush) {
      var _this7 = this;

      var options = brush.options;
      var paths = options.paths;


      var brushSprite = operation.createBrush();
      paths.forEach(function (path) {
        _this7._deserializeBrushPath(brushSprite, path);
      });
      return __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_promise___default.a.resolve(brushSprite);
    }
  }, {
    key: '_deserializeBrushPath',
    value: function _deserializeBrushPath(brushSprite, path) {
      var points = path.points;


      var brushInstance = this._createBrushForPath(path);
      var pathObject = brushSprite.createPath(brushInstance);
      pathObject.setClosed(true);
      points.forEach(function (point) {
        pathObject.addControlPoint(__WEBPACK_IMPORTED_MODULE_5_globals__["n" /* Vector2 */].fromObject(point));
      });
    }

    /**
     * Creates a brush face with the given options
     * @param  {PhotoEditorSDK.Operations.SpriteOperation.Sprites.BrushSprite.Path} path
     * @return {PhotoEditorSDK.Operations.SpriteOperation.Sprites.BrushSprite.Brush}
     */

  }, {
    key: '_createBrushForPath',
    value: function _createBrushForPath(path) {
      var color = path.color,
          size = path.size;

      var colorObject = __WEBPACK_IMPORTED_MODULE_5_globals__["b" /* Color */].fromArray(color);

      var brushOptions = {
        color: colorObject,
        size: size
      };

      var rawBrush = this._brushManager.getFirstBrush();
      if (rawBrush.prototype && rawBrush.prototype instanceof Brush) {
        // Custom Brush instance, used for special brushes such as radial brush, which has
        // an additional hardness option
        var BrushClass = rawBrush;
        return new BrushClass(brushOptions);
      } else {
        var _brush = __WEBPACK_IMPORTED_MODULE_5_globals__["k" /* SDKUtils */].extend({}, rawBrush);
        delete _brush.image;

        var _BrushClass = function (_Brush) {
          _inherits(_BrushClass, _Brush);

          function _BrushClass() {
            _classCallCheck(this, _BrushClass);

            return _possibleConstructorReturn(this, (_BrushClass.__proto__ || __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default()(_BrushClass)).apply(this, arguments));
          }

          return _BrushClass;
        }(Brush);

        _BrushClass.identifier = rawBrush.identifier;

        // Plain JS object, used for simple image brushes
        return new _BrushClass(__WEBPACK_IMPORTED_MODULE_5_globals__["k" /* SDKUtils */].extend({}, _brush, brushOptions));
      }
    }

    /**
     * Deserializes the given focus operation
     * @param  {Object} operation
     * @return {Promise}
     * @private
     */

  }, {
    key: '_deserializeFocusOperation',
    value: function _deserializeFocusOperation(operation) {
      var options = operation.options.options;

      switch (operation.options.type) {
        case 'radial':
          {
            var position = options.position,
                radius = options.radius,
                gradientRadius = options.gradientRadius,
                blurRadius = options.blurRadius;

            return __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_promise___default.a.resolve(this._editor.operations.getOrCreate('radial-focus', {
              position: __WEBPACK_IMPORTED_MODULE_5_globals__["n" /* Vector2 */].fromObject(position),
              radius: radius,
              gradientRadius: gradientRadius,
              blurRadius: blurRadius
            }));
          }
        case 'linear':
          {
            var start = options.start,
                end = options.end,
                size = options.size,
                gradientSize = options.gradientSize,
                _blurRadius = options.blurRadius;

            return __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_promise___default.a.resolve(this._editor.operations.getOrCreate('mirrored-focus', {
              start: __WEBPACK_IMPORTED_MODULE_5_globals__["n" /* Vector2 */].fromObject(start),
              end: __WEBPACK_IMPORTED_MODULE_5_globals__["n" /* Vector2 */].fromObject(end),
              size: size,
              gradientSize: gradientSize,
              blurRadius: _blurRadius
            }));
          }
      }
    }

    /**
     * Returns the input dimensions for the given operation
     * @param  {PhotoEditorSDK.Operation} operation
     * @return {PhotoEditorSDK.Math.Vector2}
     * @private
     */

  }, {
    key: '_getInputDimensionsForOperation',
    value: function _getInputDimensionsForOperation(operation) {
      var operationFound = false;
      var inputDimensions = this._editor.getInputDimensions();

      this._editor.operations.getStack().forEach(function (op) {
        if (op === operation) operationFound = true;
        if (operationFound) return;
        inputDimensions = op.getNewDimensions(inputDimensions);
      });

      return inputDimensions;
    }
  }]);

  return v100Deserializer;
}();

/* harmony default export */ __webpack_exports__["a"] = (v100Deserializer);


v100Deserializer.version = '1.0.0';

/***/ }),
/* 135 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__1_0_0_serializer__ = __webpack_require__(133);





var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */



var TWICE_PI = Math.PI * 2;

var v101Serializer = function (_PreviousSerializer) {
  _inherits(v101Serializer, _PreviousSerializer);

  function v101Serializer() {
    _classCallCheck(this, v101Serializer);

    return _possibleConstructorReturn(this, (v101Serializer.__proto__ || __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default()(v101Serializer)).apply(this, arguments));
  }

  _createClass(v101Serializer, [{
    key: '_serializeTransformOperation',

    /**
     * Serializes the given transform operation
     * @param  {PhotoEditorSDK.Operation.TransformOperation} operation
     * @return {Object}
     * @private
     */
    value: function _serializeTransformOperation(operation) {
      var options = operation.serializeOptions(['start', 'end', 'rotation', 'textureScale'], true);
      options.rotation = (options.rotation + TWICE_PI) % TWICE_PI;
      if (options.textureScale !== 1) {
        options.dimensions = operation.getNewDimensions(operation.getInputDimensions(false));
      }

      delete options.textureScale;
      return {
        type: 'crop',
        options: options
      };
    }
  }]);

  return v101Serializer;
}(__WEBPACK_IMPORTED_MODULE_4__1_0_0_serializer__["a" /* default */]);

/* harmony default export */ __webpack_exports__["a"] = (v101Serializer);


v101Serializer.version = '1.0.1';

/***/ }),
/* 136 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor__ = __webpack_require__(7);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_promise__ = __webpack_require__(11);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_promise___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_promise__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_globals__ = __webpack_require__(9);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__1_0_0_deserializer__ = __webpack_require__(134);







var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor___default()(object, property); if (desc === undefined) { var parent = __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default()(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if ("value" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




var v101Deserializer = function (_PreviousDeserializer) {
  _inherits(v101Deserializer, _PreviousDeserializer);

  function v101Deserializer() {
    _classCallCheck(this, v101Deserializer);

    return _possibleConstructorReturn(this, (v101Deserializer.__proto__ || __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default()(v101Deserializer)).apply(this, arguments));
  }

  _createClass(v101Deserializer, [{
    key: '_deserializeOperation',

    /**
     * Deserializes the given operation
     * @param  {PhotoEditorSDK.Operation} operation
     * @return {Promise}
     * @private
     */
    value: function _deserializeOperation(operation) {
      if (operation.type === 'selective-blur') {
        return this._deserializeSelectiveBlurOperation(operation);
      }
      return _get(v101Deserializer.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default()(v101Deserializer.prototype), '_deserializeOperation', this).call(this, operation);
    }

    /**
     * Deserializes the given crop operation
     * @param  {PhotoEditorSDK.Operation} operation
     * @return {Promise}
     * @private
     */

  }, {
    key: '_deserializeCropOperation',
    value: function _deserializeCropOperation(operation) {
      // New in 1.0.1: `dimensions` option
      var options = operation.options;
      var rotation = options.rotation;

      var start = __WEBPACK_IMPORTED_MODULE_6_globals__["n" /* Vector2 */].fromObject(options.start);
      var end = __WEBPACK_IMPORTED_MODULE_6_globals__["n" /* Vector2 */].fromObject(options.end);
      var dimensions = options.dimensions ? __WEBPACK_IMPORTED_MODULE_6_globals__["n" /* Vector2 */].fromObject(options.dimensions) : null;

      // Normalize rotation
      if (rotation > Math.PI) {
        rotation -= Math.PI * 2;
      }

      var cropOptions = {
        start: start, end: end
      };

      if (typeof rotation !== 'undefined') cropOptions.rotation = rotation;

      var transformOperation = this._editor.operations.getOrCreate('transform');
      if (!transformOperation) return __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_promise___default.a.resolve();

      this._editor.broadcastTransform(transformOperation, cropOptions);
      transformOperation.set(cropOptions);

      if (dimensions) {
        var size = end.clone().subtract(start);
        var transformDimensions = transformOperation.getInputDimensions(false).multiply(size);
        transformOperation.setTextureScale(dimensions.x / transformDimensions.x);
      }

      return __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_promise___default.a.resolve(transformOperation);
    }
  }]);

  return v101Deserializer;
}(__WEBPACK_IMPORTED_MODULE_7__1_0_0_deserializer__["a" /* default */]);

/* harmony default export */ __webpack_exports__["a"] = (v101Deserializer);


v101Deserializer.version = '1.0.1';

/***/ }),
/* 137 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor__ = __webpack_require__(7);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__1_0_1_serializer__ = __webpack_require__(135);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__blend_modes__ = __webpack_require__(138);






var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor___default()(object, property); if (desc === undefined) { var parent = __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if ("value" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




var v200Serializer = function (_PreviousSerializer) {
  _inherits(v200Serializer, _PreviousSerializer);

  function v200Serializer() {
    _classCallCheck(this, v200Serializer);

    return _possibleConstructorReturn(this, (v200Serializer.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(v200Serializer)).apply(this, arguments));
  }

  _createClass(v200Serializer, [{
    key: '_serializeSticker',

    /**
     * Serializes the given sticker
     * @param  {PhotoEditorSDK.Operation} operation
     * @param  {PhotoEditorSDK.Operations.SpriteOperation.StickerSprite} sprite
     * @return {Object}
     * @private
     */
    value: function _serializeSticker(operation, sprite) {
      var inputDimensions = operation.getInputDimensions(false);
      var response = _get(v200Serializer.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(v200Serializer.prototype), '_serializeSticker', this).call(this, operation, sprite);

      // New in 2.0.0: `tintColor`
      if (sprite.getTintMode() !== 'none') {
        response.options.tintColor = sprite.serializeOption('tintColor', true);
      }

      // Dimensions are relative, not absolute anymore
      response.options.dimensions = sprite.getDimensions().clone().divide(inputDimensions.min()).toObject();

      // `name` is now `identifier`
      response.options.identifier = response.options.name;
      delete response.options.name;

      return response;
    }

    /**
     * Serializes the given path
     * @param  {PhotoEditorSDK.Operations.SpriteOperation.BrushSprite.Path} path
     * @return {Object}
     * @private
     */

  }, {
    key: '_serializePath',
    value: function _serializePath(path) {
      var response = _get(v200Serializer.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(v200Serializer.prototype), '_serializePath', this).call(this, path);

      var brush = path.getBrush();
      if (brush.hasOption('hardness')) {
        response.hardness = brush.getOption('hardness');
      }

      return response;
    }

    /**
     * Serializes the given operation
     * @param  {PhotoEditorSDK.Operation} operation
     * @param  {PhotoEditorSDK.Operation[]} operations
     * @return {Object}
     * @private
     */

  }, {
    key: '_serializeOperation',
    value: function _serializeOperation(operation, operations) {
      if (operation.constructor.identifier === 'frame') {
        this._serializeFrameOperation(operation, operations);
        return null;
      }

      if (operation.constructor.identifier === 'overlay') {
        this._serializeOverlayOperation(operation, operations);
        return null;
      }

      return _get(v200Serializer.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(v200Serializer.prototype), '_serializeOperation', this).call(this, operation, operations);
    }

    /**
     * Serializes the frame operation
     * @param {PhotoEditorSDK.Operation.FrameOperation} operation
     * @param {PhotoEditorSDK.Operation[]} operations
     * @private
     */

  }, {
    key: '_serializeFrameOperation',
    value: function _serializeFrameOperation(operation, operations) {
      // Since serialization 2.0.0 stores frames as part of the SpriteOperation, we need
      // to check if a sprite operation is present and extend its `sprites` option
      var spriteOperations = operations.filter(function (o) {
        return o.type === 'sprite';
      });
      var spriteOperation = void 0;
      if (spriteOperations.length) {
        spriteOperation = spriteOperations.pop();
      } else {
        // No sprite operation exists, create a new one
        spriteOperation = {
          type: 'sprite',
          options: {
            sprites: []
          }
        };
        operations.push(spriteOperation);
      }

      spriteOperation.options.sprites.push({
        type: 'frame',
        options: this._getFrameOptions(operation)
      });
    }

    /**
     * Serializes the overlay operation
     * @param {PhotoEditorSDK.Operation.OverlayOperation} operation
     * @param {PhotoEditorSDK.Operation[]} operations
     * @private
     */

  }, {
    key: '_serializeOverlayOperation',
    value: function _serializeOverlayOperation(operation, operations) {
      if (!operation.getIdentifier()) return;

      // Since serialization 2.0.0 stores overlays as part of the SpriteOperation, we need
      // to check if a sprite operation is present and extend its `sprites` option
      var spriteOperations = operations.filter(function (o) {
        return o.type === 'sprite';
      });
      var spriteOperation = void 0;
      if (spriteOperations.length) {
        spriteOperation = spriteOperations.pop();
      } else {
        // No sprite operation exists, create a new one
        spriteOperation = {
          type: 'sprite',
          options: {
            sprites: []
          }
        };
        operations.push(spriteOperation);
      }

      spriteOperation.options.sprites.push({
        type: 'overlay',
        options: {
          identifier: operation.getIdentifier(),
          intensity: operation.getAlpha(),
          blendMode: __WEBPACK_IMPORTED_MODULE_6__blend_modes__["a" /* default */][operation.getBlendMode()]
        }
      });
    }

    /**
     * Returns the options object for the given FrameOperation
     * @param  {PhotoEditorSDK.Operations.FrameOperation} operation
     * @return {Object}
     * @private
     */

  }, {
    key: '_getFrameOptions',
    value: function _getFrameOptions(operation) {
      return {
        identifier: operation.getFrame().identifier
      };
    }
  }, {
    key: '_serializeOrientationOperation',
    value: function _serializeOrientationOperation(operation) {
      var response = _get(v200Serializer.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(v200Serializer.prototype), '_serializeOrientationOperation', this).call(this, operation);

      // For some unknown reason, we start this "first rotate, then flip" thing with 2.0.0
      if (response.options.rotation === 90 || response.options.rotation === 270) {
        response.options.flipHorizontally = !response.options.flipHorizontally;
        response.options.flipVertically = !response.options.flipVertically;
      }

      return response;
    }

    /**
     * Serializes the given transform operation
     * @param  {PhotoEditorSDK.Operation.TransformOperation} operation
     * @return {Object}
     * @private
     */

  }, {
    key: '_serializeTransformOperation',
    value: function _serializeTransformOperation(operation) {
      var operations = this._editor.operations;

      // Version 2.0 and up has different operation order: First transform, then orientation.

      if (operations.exists('orientation')) {
        // Updating the original operation will mess up the editor state
        operation = operation.clone();

        // Undo orientation that has been applied to the transforms
        var orientationOperation = operations.get('orientation');
        operation.rotate(-orientationOperation.getRotation());
        if (orientationOperation.getFlipVertically()) {
          operation.flip('vertical');
          operation.setRotation(operation.getRotation() * -1);
        }
        if (orientationOperation.getFlipHorizontally()) {
          operation.flip('horizontal');
          operation.setRotation(operation.getRotation() * -1);
        }
      }

      // Version 2.0 and up: Crop operation is now called transform operation
      var response = _get(v200Serializer.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(v200Serializer.prototype), '_serializeTransformOperation', this).call(this, operation);

      response.type = 'transform';
      return response;
    }

    /**
     * Serializes the given text sprite
     * @param  {PhotoEditorSDK.Operation} operation
     * @param  {PhotoEditorSDK.Operations.SpriteOperation.TextSprite} sprite
     * @return {Object}
     * @private
     */

  }, {
    key: '_serializeText',
    value: function _serializeText(operation, sprite) {
      var response = _get(v200Serializer.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(v200Serializer.prototype), '_serializeText', this).call(this, operation, sprite);

      var inputDimensions = operation.getInputDimensions(false);
      response.options.fontIdentifier = sprite.getFontIdentifier();

      // For whatever reason, max width is relative to shortest side, while font size isn't
      response.options.maxWidth = response.options.maxWidth * inputDimensions.x / inputDimensions.min();
      delete response.options.fontFamily;

      return response;
    }

    /**
     * Serializes the given filter operation
     * @param  {PhotoEditorSDK.Operations.FilterOperation} operation
     * @return {Object}
     * @private
     */

  }, {
    key: '_serializeFilterOperation',
    value: function _serializeFilterOperation(operation) {
      var response = _get(v200Serializer.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(v200Serializer.prototype), '_serializeFilterOperation', this).call(this, operation);
      if (!response) return null;

      response.options.identifier = response.options.name;
      delete response.options.name;

      return response;
    }

    /**
     * Serializes the given radial focus operation
     * @param  {PhotoEditorSDK.Operations.RadialFocusOperation} operation
     * @return {Object}
     * @private
     */

  }, {
    key: '_serializeRadialFocusOperation',
    value: function _serializeRadialFocusOperation(operation) {
      var response = _get(v200Serializer.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(v200Serializer.prototype), '_serializeRadialFocusOperation', this).call(this, operation);

      var focusOptions = response.options.options;
      focusOptions.start = focusOptions.position;
      delete focusOptions.position;
      focusOptions.end = {
        x: focusOptions.start.x + focusOptions.radius,
        y: focusOptions.start.y
      };
      delete focusOptions.radius;

      return response;
    }
  }]);

  return v200Serializer;
}(__WEBPACK_IMPORTED_MODULE_5__1_0_1_serializer__["a" /* default */]);

/* harmony default export */ __webpack_exports__["a"] = (v200Serializer);


v200Serializer.version = '2.0.0';

/***/ }),
/* 138 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_globals__ = __webpack_require__(9);


var _OverlayFilter$BLEND_;

function _defineProperty(obj, key, value) { if (key in obj) { __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */


var OverlayFilter = __WEBPACK_IMPORTED_MODULE_1_globals__["j" /* SDK */].Engine.Filters.OverlayFilter;


/* harmony default export */ __webpack_exports__["a"] = (_OverlayFilter$BLEND_ = {}, _defineProperty(_OverlayFilter$BLEND_, OverlayFilter.BLEND_MODES.NORMAL, 'normal'), _defineProperty(_OverlayFilter$BLEND_, OverlayFilter.BLEND_MODES.OVERLAY, 'overlay'), _defineProperty(_OverlayFilter$BLEND_, OverlayFilter.BLEND_MODES.HARD_LIGHT, 'hard light'), _defineProperty(_OverlayFilter$BLEND_, OverlayFilter.BLEND_MODES.SOFT_LIGHT, 'soft light'), _defineProperty(_OverlayFilter$BLEND_, OverlayFilter.BLEND_MODES.MULTIPLY, 'multiply'), _defineProperty(_OverlayFilter$BLEND_, OverlayFilter.BLEND_MODES.DARKEN, 'darken'), _defineProperty(_OverlayFilter$BLEND_, OverlayFilter.BLEND_MODES.LIGHTEN, 'lighten'), _defineProperty(_OverlayFilter$BLEND_, OverlayFilter.BLEND_MODES.SCREEN, 'screen'), _defineProperty(_OverlayFilter$BLEND_, OverlayFilter.BLEND_MODES.COLOR_BURN, 'color burn'), _OverlayFilter$BLEND_);

/***/ }),
/* 139 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor__ = __webpack_require__(7);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_promise__ = __webpack_require__(11);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_promise___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_promise__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_globals__ = __webpack_require__(9);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__1_0_1_deserializer__ = __webpack_require__(136);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8_shared_managers_frame_manager__ = __webpack_require__(345);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9_shared_managers_overlay_manager__ = __webpack_require__(346);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10_shared_managers_sticker_manager__ = __webpack_require__(89);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_11_lib_frame__ = __webpack_require__(347);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_12_lib_font_loader__ = __webpack_require__(90);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_13_shared_loaders_image_loader__ = __webpack_require__(48);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_14__blend_modes__ = __webpack_require__(138);







var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor___default()(object, property); if (desc === undefined) { var parent = __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default()(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if ("value" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */












var blendModeByName = __WEBPACK_IMPORTED_MODULE_6_globals__["k" /* SDKUtils */].flipObject(__WEBPACK_IMPORTED_MODULE_14__blend_modes__["a" /* default */]);

var v200Deserializer = function (_PreviousDeserializer) {
  _inherits(v200Deserializer, _PreviousDeserializer);

  function v200Deserializer() {
    var _ref;

    _classCallCheck(this, v200Deserializer);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this = _possibleConstructorReturn(this, (_ref = v200Deserializer.__proto__ || __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default()(v200Deserializer)).call.apply(_ref, [this].concat(args)));

    _this._frameManager = new __WEBPACK_IMPORTED_MODULE_8_shared_managers_frame_manager__["a" /* default */](_this._ui, _this._getOptions('frame'));

    var overlayOptions = _this._getOptions('overlay');
    if (overlayOptions) {
      _this._overlayManager = new __WEBPACK_IMPORTED_MODULE_9_shared_managers_overlay_manager__["a" /* default */](_this._ui, overlayOptions);
    }
    return _this;
  }

  /**
   * Deserializes the given sprite
   * @param  {PhotoEditorSDK.Operations.SpriteOperation} spriteOperation
   * @param  {PhotoEditorSDK.Operations.SpriteOperation.Sprite} sprite
   * @return {Promise}
   * @private
   */


  _createClass(v200Deserializer, [{
    key: '_deserializeSprite',
    value: function _deserializeSprite(spriteOperation, sprite) {
      if (sprite.type === 'frame') {
        return this._deserializeFrame(spriteOperation, sprite);
      }
      if (sprite.type === 'overlay') {
        return this._deserializeOverlay(spriteOperation, sprite);
      }
      return _get(v200Deserializer.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default()(v200Deserializer.prototype), '_deserializeSprite', this).call(this, spriteOperation, sprite);
    }

    /**
     * Deserializes the given operation
     * @param  {PhotoEditorSDK.Operation} operation
     * @return {Promise}
     * @private
     */

  }, {
    key: '_deserializeOperation',
    value: function _deserializeOperation(operation) {
      if (operation.type === 'transform') {
        return this._deserializeTransformOperation(operation);
      }
      return _get(v200Deserializer.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default()(v200Deserializer.prototype), '_deserializeOperation', this).call(this, operation);
    }
  }, {
    key: '_deserializeOrientationOperation',
    value: function _deserializeOrientationOperation(operationData) {
      if (operationData.options.rotation === 90 || operationData.options.rotation === 270) {
        operationData.options.flipHorizontally = !operationData.options.flipHorizontally;
        operationData.options.flipVertically = !operationData.options.flipVertically;
      }

      return _get(v200Deserializer.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default()(v200Deserializer.prototype), '_deserializeOrientationOperation', this).call(this, operationData);
    }

    /**
     * Deserializes the given transform operation
     * @param  {Object} operationData
     * @return {Promise}
     * @private
     */

  }, {
    key: '_deserializeTransformOperation',
    value: function _deserializeTransformOperation(operationData) {
      var _this2 = this;

      // Version 2.0 and up: Crop operation is now called transform operation
      return _get(v200Deserializer.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default()(v200Deserializer.prototype), '_deserializeCropOperation', this).call(this, operationData).then(function (operation) {
        if (!operation) return;
        var orientationData = _this2._data.operations.orientation;

        if (orientationData) {
          var options = orientationData.options;

          operation.rotate(options.rotation);
          if (options.flipHorizontally) {
            operation.flip('horizontal');
            operation.setRotation(operation.getRotation() * -1);
          }
          if (options.flipVertically) {
            operation.flip('vertical');
            operation.setRotation(operation.getRotation() * -1);
          }
        }

        return operation;
      });
    }

    /**
     * Deserializes the given frame sprite
     * @param  {PhotoEditorSDK.Operations.SpriteOperation} spriteOperation
     * @param  {Object} frame
     * @return {Promise}
     * @private
     */

  }, {
    key: '_deserializeFrame',
    value: function _deserializeFrame(spriteOperation, frame) {
      var _this3 = this;

      var identifier = frame.options.identifier;


      var frameData = this._frameManager.getFrameByIdentifier(identifier);
      if (!frameData) {
        __WEBPACK_IMPORTED_MODULE_6_globals__["g" /* Log */].warn('Deserializer', 'Unknown frame `' + identifier + '`. Skipping frame.');
        return __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_promise___default.a.resolve();
      }
      var frameInstance = new __WEBPACK_IMPORTED_MODULE_11_lib_frame__["a" /* default */](this._ui, frameData);
      return frameInstance.load().then(function () {
        _this3._editor.operations.getOrCreate('frame', {
          frame: frameInstance.getFrame()
        });
      });
    }

    /**
     * Deserializes the given overlay sprite
     * @param  {PhotoEditorSDK.Operations.SpriteOperation} spriteOperation
     * @param  {Object} overlay
     * @return {Promise}
     * @private
     */

  }, {
    key: '_deserializeOverlay',
    value: function _deserializeOverlay(spriteOperation, overlay) {
      var _this4 = this;

      var _overlay$options = overlay.options,
          blendMode = _overlay$options.blendMode,
          intensity = _overlay$options.intensity,
          identifier = _overlay$options.identifier;


      var overlayData = this._overlayManager.getOverlayByIdentifier(identifier);
      if (!overlayData) {
        __WEBPACK_IMPORTED_MODULE_6_globals__["g" /* Log */].warn('Deserializer', 'Unknown overlay `' + identifier + '`. Skipping overlay.');
        return __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_promise___default.a.resolve();
      }

      var overlayPath = this._editor.getUI().getAssetPath(overlayData.image);
      return __WEBPACK_IMPORTED_MODULE_13_shared_loaders_image_loader__["a" /* default */].load(overlayPath).then(function (image) {
        _this4._editor.operations.getOrCreate('overlay', {
          alpha: intensity,
          identifier: identifier,
          blendMode: parseInt(blendModeByName[blendMode || overlayData.blendMode], 10),
          image: image
        });
      });
    }

    /**
     * Creates a brush face with the given options
     * @param  {PhotoEditorSDK.Operations.SpriteOperation.Sprites.BrushSprite.Path} path
     * @return {PhotoEditorSDK.Operations.SpriteOperation.Sprites.BrushSprite.Brush}
     */

  }, {
    key: '_createBrushForPath',
    value: function _createBrushForPath(path) {
      var brush = _get(v200Deserializer.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default()(v200Deserializer.prototype), '_createBrushForPath', this).call(this, path);
      if (typeof path.hardness !== 'undefined' && brush.hasOption('hardness')) {
        brush.setHardness(path.hardness);
      }
      return brush;
    }

    /**
     * Deserializes the given sticker for the given operation
     * @param  {PhotoEditorSDK.Operations.SpriteOperation} operation
     * @param  {Object} sprite
     * @return {PhotoEditorSDK.Operations.SpriteOperation.StickerSprite}
     * @private
     */

  }, {
    key: '_deserializeSticker',
    value: function _deserializeSticker(operation, sprite) {
      var _this5 = this;

      var SpriteOperation = __WEBPACK_IMPORTED_MODULE_6_globals__["j" /* SDK */].Operations.SpriteOperation;
      var options = sprite.options;

      var sticker = this._stickerManager.getStickerByIdentifier(options.identifier);
      var url = __WEBPACK_IMPORTED_MODULE_10_shared_managers_sticker_manager__["a" /* default */].getURLForSticker(sticker, 'base');
      if (!sticker) {
        __WEBPACK_IMPORTED_MODULE_6_globals__["g" /* Log */].warn('Deserializer', 'Unknown sticker `' + options.identifier + '`. Skipping sprite.');
        return __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_promise___default.a.resolve();
      }
      var inputDimensions = operation.getInputDimensions(false);
      return new __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_promise___default.a(function (resolve, reject) {
        var image = new window.Image();
        image.addEventListener('load', function () {
          var adjustments = SpriteOperation.StickerSprite.prototype.availableOptions.adjustments.structure;
          var rotation = options.rotation,
              flipHorizontally = options.flipHorizontally,
              flipVertically = options.flipVertically;

          var stickerOptions = {
            identifier: options.identifier,
            image: image,
            position: __WEBPACK_IMPORTED_MODULE_6_globals__["n" /* Vector2 */].fromObject(options.position),
            dimensions: __WEBPACK_IMPORTED_MODULE_6_globals__["n" /* Vector2 */].fromObject(options.dimensions).multiply(inputDimensions.min()),
            rotation: rotation,
            flipHorizontally: flipHorizontally,
            flipVertically: flipVertically,
            adjustments: {}
          };

          if (typeof options.adjustments !== 'undefined') {
            ['brightness', 'contrast', 'saturation'].forEach(function (option) {
              if (typeof options.adjustments[option] !== 'undefined') {
                stickerOptions.adjustments[option] = options.adjustments[option] + adjustments[option].default;
              }
            });
          }

          if (typeof options.tintColor !== 'undefined' && typeof sticker.tintMode !== 'undefined') {
            stickerOptions.tintColor = __WEBPACK_IMPORTED_MODULE_6_globals__["b" /* Color */].fromArray(options.tintColor);
            stickerOptions.tintMode = sticker.tintMode;
          }
          resolve(operation.createSticker(stickerOptions));
        });
        image.crossOrigin = 'Anonymous';
        image.src = _this5._editor.getUI().getAssetPath(url);
      });
    }

    /**
     * Deserializes the given filter operation
     * @param  {Object} operation
     * @return {Promise}
     * @private
     */

  }, {
    key: '_deserializeFilterOperation',
    value: function _deserializeFilterOperation(operation) {
      var _this6 = this;

      var options = operation.options;


      if (!this._filterManager.getFilterByIdentifier(options.identifier)) {
        __WEBPACK_IMPORTED_MODULE_6_globals__["g" /* Log */].warn('Deserializer', 'Unknown filter `' + options.identifier + '`');
        return __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_promise___default.a.resolve();
      }

      return this._filterManager.instantiateFilterWithIdentifier(options.identifier).then(function (filter) {
        var filterOperation = _this6._editor.operations.getOrCreate('filter');
        if (!filterOperation) return;
        filterOperation.set({
          identifier: options.identifier,
          filter: filter,
          intensity: options.intensity
        });
        return filterOperation;
      });
    }

    /**
     * Deserializes the given focus operation
     * @param  {Object} operation
     * @return {Promise}
     * @private
     */

  }, {
    key: '_deserializeFocusOperation',
    value: function _deserializeFocusOperation(operation) {
      var _operation$options = operation.options,
          options = _operation$options.options,
          type = _operation$options.type;

      if (type !== 'radial') return _get(v200Deserializer.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default()(v200Deserializer.prototype), '_deserializeFocusOperation', this).call(this, operation);

      var start = options.start,
          end = options.end,
          gradientRadius = options.gradientRadius,
          blurRadius = options.blurRadius;

      var radius = __WEBPACK_IMPORTED_MODULE_6_globals__["n" /* Vector2 */].fromObject(end).subtract(__WEBPACK_IMPORTED_MODULE_6_globals__["n" /* Vector2 */].fromObject(start)).len();
      return __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_promise___default.a.resolve(this._editor.operations.getOrCreate('radial-focus', {
        position: __WEBPACK_IMPORTED_MODULE_6_globals__["n" /* Vector2 */].fromObject(start),
        radius: radius,
        gradientRadius: gradientRadius,
        blurRadius: blurRadius
      }));
    }

    /**
     * Deserializes the given text for the given operation
     * @param  {PhotoEditorSDK.Operations.SpriteOperation} operation
     * @param  {Object} text
     * @return {PhotoEditorSDK.Operations.SpriteOperation.TextSprite}
     * @private
     */

  }, {
    key: '_deserializeText',
    value: function _deserializeText(operation, text) {
      var options = text.options;
      var fontSize = options.fontSize,
          lineHeight = options.lineHeight,
          fontIdentifier = options.fontIdentifier,
          alignment = options.alignment,
          rotation = options.rotation,
          maxWidth = options.maxWidth,
          color = options.color,
          backgroundColor = options.backgroundColor;


      var fontLoader = new __WEBPACK_IMPORTED_MODULE_12_lib_font_loader__["a" /* default */](this._ui);
      var variation = this._fontManager.getVariationByIdentifier(fontIdentifier);
      if (!variation) {
        variation = this._fontManager.getDefaultFont();
      } else {
        fontLoader.setFonts([variation.getFont()]);
      }
      return fontLoader.load().then(function () {
        var inputDimensions = operation.getInputDimensions(false);

        // For whatever reason, max width is relative to shortest side, while font size isn't
        var fixedMaxWidth = maxWidth * inputDimensions.min() / inputDimensions.x;
        return operation.createText({
          fontSize: fontSize,
          lineHeight: lineHeight,
          fontFamily: variation.getFontFamily(),
          fontWeight: variation.getFontWeight(),
          fontIdentifier: variation.getIdentifier(),
          alignment: alignment,
          rotation: rotation,
          maxWidth: fixedMaxWidth,
          text: options.text,
          color: __WEBPACK_IMPORTED_MODULE_6_globals__["b" /* Color */].fromArray(color),
          backgroundColor: __WEBPACK_IMPORTED_MODULE_6_globals__["b" /* Color */].fromArray(backgroundColor),
          position: __WEBPACK_IMPORTED_MODULE_6_globals__["n" /* Vector2 */].fromObject(options.position)
        });
      });
    }
  }]);

  return v200Deserializer;
}(__WEBPACK_IMPORTED_MODULE_7__1_0_1_deserializer__["a" /* default */]);

/* harmony default export */ __webpack_exports__["a"] = (v200Deserializer);


v200Deserializer.version = '2.0.0';

/***/ }),
/* 140 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
Object.defineProperty(__webpack_exports__, "__esModule", { value: true });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_globals__ = __webpack_require__(9);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__lib_editor__ = __webpack_require__(331);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_shared_loaders_json_loader__ = __webpack_require__(47);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__lib_font_loader__ = __webpack_require__(90);





var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/*!
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */





var bd = function bd(str) {
  return __WEBPACK_IMPORTED_MODULE_4_globals__["k" /* SDKUtils */].byteArrayToString(__WEBPACK_IMPORTED_MODULE_4_globals__["a" /* Base64 */].decode(str));
};

/**
 * @namespace PhotoEditorSDK.UI
 */

/**
 * The NodeJS Server
 * @class
 * @alias Server
 * @extends PhotoEditorSDK.EventEmitter
 * @memberof PhotoEditorSDK
 */

var Server = function (_EventEmitter) {
  _inherits(Server, _EventEmitter);

  function Server() {
    var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};

    _classCallCheck(this, Server);

    var _this = _possibleConstructorReturn(this, (Server.__proto__ || __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default()(Server)).call(this));

    _this._mediator = new __WEBPACK_IMPORTED_MODULE_4_globals__["d" /* EventEmitter */]();
    _this._fontLoader = new __WEBPACK_IMPORTED_MODULE_7__lib_font_loader__["a" /* default */](_this);
    _this._options = options;
    _this._initOptions();
    _this._initEvents();
    _this._disposed = false;

    _this._editor = new __WEBPACK_IMPORTED_MODULE_5__lib_editor__["a" /* default */](_this, _this._options, _this._mediator);
    if (_this._options.editor.image) {
      _this._editor.setImage(_this._options.editor.image);
    }

    __WEBPACK_IMPORTED_MODULE_4_globals__["g" /* Log */].setLevel(_this._options.logLevel);

    _this._v();
    return _this;
  }

  /**
   * Exports an image
   * @param {Boolean} download = false
   * @return {Promise}
   */


  _createClass(Server, [{
    key: 'export',
    value: function _export() {
      var _editor;

      return (_editor = this._editor).export.apply(_editor, arguments);
    }

    /**
     * Serializes the editor state
     * @return {Promise}
     */

  }, {
    key: 'serialize',
    value: function serialize() {
      var _editor2;

      return (_editor2 = this._editor).serialize.apply(_editor2, arguments);
    }

    /**
     * Deserializes the given data
     * @param  {Object} data
     * @return {Promise}
     */

  }, {
    key: 'deserialize',
    value: function deserialize(data) {
      return this._editor.deserialize(data);
    }

    /**
     * Returns the editor
     * @return {PhotoEditorSDK.Server.Editor}
     */

  }, {
    key: 'getEditor',
    value: function getEditor() {
      return this._editor;
    }

    // -------------------------------------------------------------------------- INITIALIZATION

    /**
     * Initializes the default options
     * @private
     */

  }, {
    key: '_initOptions',
    value: function _initOptions() {
      this._options = __WEBPACK_IMPORTED_MODULE_4_globals__["k" /* SDKUtils */].defaults(this._options, {
        logLevel: 'warn',

        editor: {},
        assets: {},
        responsive: false,
        preloader: true
      });

      this._options.editor = __WEBPACK_IMPORTED_MODULE_4_globals__["k" /* SDKUtils */].defaults(this._options.editor || {}, {
        preferredRenderer: 'webgl',
        displayResizeMessage: true,
        controlsOptions: {},
        operationsOrder: [
        // First, all operations that affect the image dimensions
        'exif-orientation', // Automatically created by SDK
        'orientation', 'transform',

        // Then color operations (first filter, then fine-tuning)
        'filter', 'adjustments',

        // Then post-processing
        'radial-focus', 'mirrored-focus', 'linear-focus', 'blur', 'selective-blur', 'overlay', 'sprite', 'frame', 'watermark'],
        maxMegaPixels: null
      });

      this._options.editor.export = __WEBPACK_IMPORTED_MODULE_4_globals__["k" /* SDKUtils */].defaults(this._options.editor.export || {}, {
        format: 'image/png',
        type: __WEBPACK_IMPORTED_MODULE_4_globals__["i" /* RenderType */].IMAGE,
        download: true,
        fileBasename: 'photoeditorsdk-export',
        quality: 0.8
      });

      this._options.assets = __WEBPACK_IMPORTED_MODULE_4_globals__["k" /* SDKUtils */].defaults(this._options.assets || {}, {
        baseUrl: process.cwd(),
        resolver: null
      });
    }

    /**
     * Validates presence of the API key
     * @return {Boolean}
     * @private
     */

  }, {
    key: '_v',
    value: function _v() {
      if (!this[bd('X29wdGlvbnM=')][bd('bGljZW5zZQ==')]) {
        __WEBPACK_IMPORTED_MODULE_4_globals__["g" /* Log */].error(bd('TGljZW5zaW5n'), bd('Tm8gYGxpY2Vuc2VgIG9wdGlvbiBnaXZlbg=='));
        __WEBPACK_IMPORTED_MODULE_4_globals__["g" /* Log */].error(bd('TGljZW5zaW5n'), bd('SW4gY2FzZSB5b3UgZG9uJ3QgaGF2ZSBhIGxpY2Vuc2UgeWV0LCBwbGVhc2UgY29udGFjdCBvdXIgc2FsZXMgc3RhZmYgYXQgc2FsZXNAcGhvdG9lZGl0b3JzZGsuY29tIHRvIG9idGFpbiBhIGxpY2Vuc2Ugb3IgbG9nIGluIHRvIHlvdXIgY3VzdG9tZXIgZGFzaGJvYXJkLg=='));
        return false;
      }
      return true;
    }

    // -------------------------------------------------------------------------- EVENTS

    /**
     * Catches mediator events and emits them here
     * @private
     */

  }, {
    key: '_initEvents',
    value: function _initEvents() {
      this._mediator.pipeEvents(this);
    }

    /**
     * Unpipes the vents
     * @private
     */

  }, {
    key: '_disposeEvents',
    value: function _disposeEvents() {
      this._mediator.unpipeEvents(this);
    }

    /**
     * Sets the image to the given one
     * @param {Image} image
     */

  }, {
    key: 'setImage',
    value: function setImage(image) {
      this._editor.setImage(image);
    }

    /**
     * Returns the resolved asset path for the given asset name
     * @param  {String} asset
     * @param  {Boolean} uiAsset = false
     * @param  {Boolean} disableRetina = false
     * @return {String}
     */

  }, {
    key: 'getAssetPath',
    value: function getAssetPath(asset) {
      var uiAsset = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;
      var disableRetina = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;
      var _options$assets = this._options.assets,
          baseUrl = _options$assets.baseUrl,
          resolver = _options$assets.resolver;

      var path = baseUrl + '/' + asset;

      // Don't prepend baseUrl to absolute urls
      if (asset.match(/(ftp|http|https):\/\//)) {
        path = asset;
      }

      if (uiAsset) {
        if (!disableRetina) {
          // Append @2x if device's pixel ratio > 1
          var pixelRatio = typeof window !== 'undefined' && window.devicePixelRatio || 1;
          if (pixelRatio > 1) {
            var regex = /\.[\w?=]+$/;
            asset = asset.replace(regex, function (match) {
              return '@2x' + match;
            });
          }
        }

        path = baseUrl + '/ui/desktop/' + asset;
      }

      if (typeof resolver !== 'undefined' && resolver !== null) {
        path = resolver(path);
      }

      return path;
    }

    /**
     * Returns the font loader
     * @return {PhotoEditorSDK.Server.FontLoader}
     */

  }, {
    key: 'getFontLoader',
    value: function getFontLoader() {
      return this._fontLoader;
    }

    /**
     * Disposes the UI
     */

  }, {
    key: 'dispose',
    value: function dispose() {
      if (this._disposed) {
        throw new Error('This instance of PhotoEditorSDK is already disposed.');
      }
      this._disposed = true;
      this._disposeEvents();
    }

    /** Render image given the configuration
     * @param {Object} config
     * @returns {Promise}
     **/

  }, {
    key: 'render',
    value: function render(config) {
      var _this2 = this;

      return this.deserialize(config).then(function () {
        return _this2.export();
      });
    }
  }]);

  return Server;
}(__WEBPACK_IMPORTED_MODULE_4_globals__["d" /* EventEmitter */]);

/**
 * A unique string that represents this
 * @type {String}
 */


Server.prototype.identifier = 'node';

// Export extendable stuff
Server.Constants = __WEBPACK_IMPORTED_MODULE_4_globals__["c" /* Constants */];
Server.Utils = __WEBPACK_IMPORTED_MODULE_4_globals__["m" /* Utils */];
Server.JSONLoader = __WEBPACK_IMPORTED_MODULE_6_shared_loaders_json_loader__["a" /* default */];
Server.SDK = __WEBPACK_IMPORTED_MODULE_4_globals__["j" /* SDK */];

/* harmony default export */ __webpack_exports__["default"] = (Server);

/***/ }),
/* 141 */
/***/ (function(module, exports, __webpack_require__) {

__webpack_require__(142);
var $Object = __webpack_require__(10).Object;
module.exports = function defineProperty(it, key, desc) {
  return $Object.defineProperty(it, key, desc);
};


/***/ }),
/* 142 */
/***/ (function(module, exports, __webpack_require__) {

var $export = __webpack_require__(15);
// 19.1.2.4 / 15.2.3.6 Object.defineProperty(O, P, Attributes)
$export($export.S + $export.F * !__webpack_require__(21), 'Object', { defineProperty: __webpack_require__(18).f });


/***/ }),
/* 143 */
/***/ (function(module, exports, __webpack_require__) {

__webpack_require__(144);
module.exports = __webpack_require__(10).Object.setPrototypeOf;


/***/ }),
/* 144 */
/***/ (function(module, exports, __webpack_require__) {

// 19.1.3.19 Object.setPrototypeOf(O, proto)
var $export = __webpack_require__(15);
$export($export.S, 'Object', { setPrototypeOf: __webpack_require__(145).set });


/***/ }),
/* 145 */
/***/ (function(module, exports, __webpack_require__) {

// Works with __proto__ only. Old v8 can't work with null proto objects.
/* eslint-disable no-proto */
var isObject = __webpack_require__(20);
var anObject = __webpack_require__(16);
var check = function (O, proto) {
  anObject(O);
  if (!isObject(proto) && proto !== null) throw TypeError(proto + ": can't set as prototype!");
};
module.exports = {
  set: Object.setPrototypeOf || ('__proto__' in {} ? // eslint-disable-line
    function (test, buggy, set) {
      try {
        set = __webpack_require__(30)(Function.call, __webpack_require__(63).f(Object.prototype, '__proto__').set, 2);
        set(test, []);
        buggy = !(test instanceof Array);
      } catch (e) { buggy = true; }
      return function setPrototypeOf(O, proto) {
        check(O, proto);
        if (buggy) O.__proto__ = proto;
        else set(O, proto);
        return O;
      };
    }({}, false) : undefined),
  check: check
};


/***/ }),
/* 146 */
/***/ (function(module, exports, __webpack_require__) {

__webpack_require__(147);
var $Object = __webpack_require__(10).Object;
module.exports = function create(P, D) {
  return $Object.create(P, D);
};


/***/ }),
/* 147 */
/***/ (function(module, exports, __webpack_require__) {

var $export = __webpack_require__(15);
// 19.1.2.2 / 15.2.3.5 Object.create(O [, Properties])
$export($export.S, 'Object', { create: __webpack_require__(65) });


/***/ }),
/* 148 */
/***/ (function(module, exports, __webpack_require__) {

var dP = __webpack_require__(18);
var anObject = __webpack_require__(16);
var getKeys = __webpack_require__(37);

module.exports = __webpack_require__(21) ? Object.defineProperties : function defineProperties(O, Properties) {
  anObject(O);
  var keys = getKeys(Properties);
  var length = keys.length;
  var i = 0;
  var P;
  while (length > i) dP.f(O, P = keys[i++], Properties[P]);
  return O;
};


/***/ }),
/* 149 */
/***/ (function(module, exports, __webpack_require__) {

// false -> Array#indexOf
// true  -> Array#includes
var toIObject = __webpack_require__(26);
var toLength = __webpack_require__(66);
var toAbsoluteIndex = __webpack_require__(150);
module.exports = function (IS_INCLUDES) {
  return function ($this, el, fromIndex) {
    var O = toIObject($this);
    var length = toLength(O.length);
    var index = toAbsoluteIndex(fromIndex, length);
    var value;
    // Array#includes uses SameValueZero equality algorithm
    // eslint-disable-next-line no-self-compare
    if (IS_INCLUDES && el != el) while (length > index) {
      value = O[index++];
      // eslint-disable-next-line no-self-compare
      if (value != value) return true;
    // Array#indexOf ignores holes, Array#includes - not
    } else for (;length > index; index++) if (IS_INCLUDES || index in O) {
      if (O[index] === el) return IS_INCLUDES || index || 0;
    } return !IS_INCLUDES && -1;
  };
};


/***/ }),
/* 150 */
/***/ (function(module, exports, __webpack_require__) {

var toInteger = __webpack_require__(67);
var max = Math.max;
var min = Math.min;
module.exports = function (index, length) {
  index = toInteger(index);
  return index < 0 ? max(index + length, 0) : min(index, length);
};


/***/ }),
/* 151 */
/***/ (function(module, exports, __webpack_require__) {

__webpack_require__(152);
module.exports = __webpack_require__(10).Object.getPrototypeOf;


/***/ }),
/* 152 */
/***/ (function(module, exports, __webpack_require__) {

// 19.1.2.9 Object.getPrototypeOf(O)
var toObject = __webpack_require__(38);
var $getPrototypeOf = __webpack_require__(95);

__webpack_require__(71)('getPrototypeOf', function () {
  return function getPrototypeOf(it) {
    return $getPrototypeOf(toObject(it));
  };
});


/***/ }),
/* 153 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_photoeditorsdk__ = __webpack_require__(39);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_photoeditorsdk___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_photoeditorsdk__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_shared_log__ = __webpack_require__(17);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_shared_loaders_json_loader__ = __webpack_require__(47);
/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */





var SDKUtils = __WEBPACK_IMPORTED_MODULE_0_photoeditorsdk___default.a.Utils;
var Vector2 = __WEBPACK_IMPORTED_MODULE_0_photoeditorsdk___default.a.Math.Vector2;


var UIUtils = {
  /**
   * Returns the inner dimensions (size - padding) of the given
   * DOM element
   * @param  {DOMElement} element
   * @return {Vector2}
   */
  getInnerDimensionsForElement: function getInnerDimensionsForElement(element) {
    var size = new Vector2(element.offsetWidth, element.offsetHeight);
    var computedStyle = window.getComputedStyle(element, null);
    size.x -= parseInt(computedStyle.getPropertyValue('padding-left'), 10);
    size.x -= parseInt(computedStyle.getPropertyValue('padding-right'), 10);
    size.y -= parseInt(computedStyle.getPropertyValue('padding-top'), 10);
    size.y -= parseInt(computedStyle.getPropertyValue('padding-bottom'), 10);
    return size;
  },


  /**
   * Gets the x and y position for the given event.
   * @param {Event} e
   * @return {Vector2}
   */
  getEventPosition: function getEventPosition(e) {
    var x = e.clientX;
    var y = e.clientY;
    if (e.type.indexOf('touch') !== -1) {
      if (!e.touches.length) return;

      x = e.touches[0].clientX;
      y = e.touches[0].clientY;
    }
    return new Vector2(x, y);
  },


  /**
   * Creates a canvas with a transparency pattern
   * @return {Canvas}
   */
  createTransparentPatternCanvas: function createTransparentPatternCanvas() {
    var canvas = document.createElement('canvas');
    var context = canvas.getContext('2d');

    canvas.width = 10;
    canvas.height = 10;

    context.fillStyle = 'white';
    context.fillRect(0, 0, canvas.width, canvas.height);
    context.fillStyle = '#cccccc';
    context.fillRect(0, 0, canvas.width / 2, canvas.height / 2);
    context.fillRect(canvas.width / 2, canvas.height / 2, canvas.width, canvas.height);

    return canvas;
  },


  /**
   * Checks if the browser supports canvas.msToBlob
   * @return {Boolean}
   */
  supportsMSBlob: function supportsMSBlob() {
    var canvas = document.createElement('canvas');
    return typeof canvas.msToBlob !== 'undefined';
  },


  /**
   * Translates the given key using the given options
   * @param  {Object} phrases
   * @param  {String} key
   * @param  {Object} interpolationOptions = {}
   * @return {String}
   */
  translate: function translate(phrases, key) {
    var interpolationOptions = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};

    var response = this.fetch(phrases, key);
    if (!response) {
      __WEBPACK_IMPORTED_MODULE_1_shared_log__["a" /* default */].info('Utils#translate', 'Unable to translate `' + key + '`');
      return null;
    }
    for (var _key in interpolationOptions) {
      response = response.replace('${' + _key + '}', interpolationOptions[_key]);
    }
    return response;
  },


  /**
   * Gets the property value at `path` of `object`
   * @param  {Object} object
   * @param  {String} path
   * @param  {?} [defaultValue]
   * @return {?}
   */
  fetch: function fetch(object, path, defaultValue) {
    // Replace indexes with property accessors
    path = path.replace(/\[(\w+)]/g, '.$1');
    // Strip leading dot (when path begins with [0] for example)
    path = path.replace(/^\./, '');

    var pathSegments = path.split('.');
    for (var i = 0; i < pathSegments.length; i++) {
      var segment = pathSegments[i];
      object = object[segment];
      if (!object) {
        break;
      }
    }

    if (typeof object === 'undefined') {
      return false;
    }

    return object;
  },


  /**
   * Checks whether the user agent represents a mobile device
   * @return {Boolean}
   */
  isMobile: function isMobile() {
    var a = navigator.userAgent || navigator.vendor || window.opera;
    /* eslint-disable */
    return (/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(a) || /1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(a.substr(0, 4))
    );
    /* eslint-enable */
  },


  /**
   * Selects the `selectedItems` from `items`. `selector` is called for every item, return value
   * is matched against `selectedItems`
   * @param  {Array} items
   * @param  {Array} selectedItems
   * @param  {Function} [selector = null]
   * @return {Array}
   */
  select: function select(items, selectedItems) {
    var selector = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;

    if (!selector) selector = function selector(i) {
      return i;
    };

    var newItems = [];
    selectedItems.forEach(function (selectedItem) {
      items.forEach(function (item) {
        var itemIdentifier = selector(item);
        if (itemIdentifier === selectedItem) {
          newItems.push(item);
        }
      });
    });
    return newItems;
  },


  /**
   * Gets the given URL using JSON(P)
   * @param  {String} url
   * @return {Promise}
   */
  getJSONP: function getJSONP(url) {
    var loader = new __WEBPACK_IMPORTED_MODULE_2_shared_loaders_json_loader__["a" /* default */](url);
    return loader.load();
  },


  /**
   * Clones the given `categories` array
   * @param  {Object[]} categories
   * @param {String} itemsProperty
   * @return {Object[]}
   */
  cloneCategories: function cloneCategories(categories, itemsProperty) {
    return categories.map(function (category) {
      category = SDKUtils.clone(category);
      category[itemsProperty] = category[itemsProperty].slice(0);
      return category;
    });
  },


  /**
   * Merges the given `newCategories` into the given `categories`
   * @param  {Object[]} categories
   * @param  {Object[]} newCategories
   * @param  {String} itemsProperty
   * @private
   */
  mergeCategories: function mergeCategories(categories, newCategories, itemsProperty) {
    categories = this.cloneCategories(categories, itemsProperty);

    var existingCategory = null;
    newCategories.forEach(function (newCategory) {
      categories.forEach(function (category) {
        if (newCategory.identifier === category.identifier) {
          existingCategory = category;
        }
      });

      if (!existingCategory) {
        categories.push(newCategory);
      } else {
        existingCategory[itemsProperty] = existingCategory[itemsProperty].concat(newCategory[itemsProperty]);
      }
    });

    return categories;
  },


  /**
   * Returns a camelized style object for the given DOMElement
   * @param  {DOMElement} el
   * @return {Object}
   */
  getStyleObject: function getStyleObject(el) {
    var styleProperties = window.getComputedStyle(el);
    var styleObject = {};
    for (var property in styleProperties) {
      var value = styleProperties.getPropertyValue(property);
      var camelizedAttr = property.replace(/-([a-z])/g, function (a, b) {
        return b.toUpperCase();
      });
      if (value !== '') {
        styleObject[camelizedAttr] = value;
      }
    }
    return styleObject;
  },


  /**
   * Applies the given styles to the given element
   * @param  {DOMElement} element
   * @param  {Object} styles
   */
  styleElement: function styleElement(element, styles) {
    for (var prop in styles) {
      element.style[prop] = styles[prop];
    }
  },


  /**
   * Debounces the given function to trigger only every so often
   * @param  {Function} fn
   * @param  {Number}   wait
   * @param  {Boolean}
   * @return {Function}
   */
  debounce: function debounce(fn, wait, immediate) {
    var timeout;
    return function () {
      var _this = this;

      var args = arguments;
      var later = function later() {
        timeout = null;
        if (!immediate) fn.apply(_this, args);
      };
      var callNow = immediate && !timeout;
      clearTimeout(timeout);
      timeout = setTimeout(later, wait);
      if (callNow) fn.apply(this, args);
    };
  },


  /**
   * Finds the native scrollbar width for the current browser
   * @return {Number}
   */
  getScrollbarWidth: function getScrollbarWidth() {
    var outer = document.createElement('div');
    outer.style.visibility = 'hidden';
    outer.style.width = '100px';
    outer.style.msOverflowStyle = 'scrollbar';
    document.body.appendChild(outer);

    var widthNoScroll = outer.offsetWidth;
    outer.style.overflow = 'scroll';

    var inner = document.createElement('div');
    inner.style.width = '100%';
    outer.appendChild(inner);

    var widthWithScroll = inner.offsetWidth;
    outer.parentNode.removeChild(outer);

    return widthNoScroll - widthWithScroll;
  },


  /**
   * Finds the closest integer fraction for the given Number
   * @param  {Number} ratio
   * @param  {Number} maxIterations = 100
   * @return {Vector2}
   */
  findIntegerFraction: function findIntegerFraction(ratio) {
    var maxIterations = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 100;

    var bestDelta = Number.MAX_VALUE;
    var bestX = 0;
    var bestY = 0;
    var x = 1;
    var y = 1;
    for (var iterations = 0; iterations < maxIterations; iterations++) {
      var delta = x / y - ratio;

      if (delta < 0) {
        x++;
      } else if (delta > 0) {
        y++;
      } else {
        return new Vector2(x, y);
      }

      var newDelta = Math.abs(x / y - ratio);
      if (newDelta < bestDelta) {
        bestDelta = newDelta;
        bestX = x;
        bestY = y;
      }
    }

    return new Vector2(bestX, bestY);
  },


  /**
   * Returns the given number with the given amount of decimals, but removes trailing
   * zeroes by casting it to a float
   * @param  {Number} number
   * @param  {Number} decimals
   * @return {Number}
   */
  toFixed: function toFixed(number) {
    var decimals = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 2;

    var fixed = number.toFixed(decimals);
    return parseFloat(fixed);
  },


  /**
   * Returns the given string with the first character uppercased
   * @param  {String} str
   * @return {String}
   */
  capitalize: function capitalize(str) {
    return str.charAt(0).toUpperCase() + str.slice(1);
  },


  /**
   * Returns a new object with flipped values and keys
   * @param  {Object} obj
   * @return {Object}
   */
  flipObject: function flipObject(obj) {
    var newObj = {};
    for (var key in obj) {
      newObj[obj[key]] = key;
    }
    return newObj;
  }
};

/* harmony default export */ __webpack_exports__["a"] = (UIUtils);

/***/ }),
/* 154 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
Object.defineProperty(__webpack_exports__, "__esModule", { value: true });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__sdk__ = __webpack_require__(155);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__lib_math___ = __webpack_require__(119);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__operations___ = __webpack_require__(120);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__engine___ = __webpack_require__(55);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__lib_color__ = __webpack_require__(41);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__operations_operation__ = __webpack_require__(121);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__lib_event_emitter__ = __webpack_require__(42);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__lib_utils__ = __webpack_require__(24);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__lib_env__ = __webpack_require__(230);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9__lib_operations_stack__ = __webpack_require__(123);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10__lib_exif__ = __webpack_require__(86);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_11__shared_vendor_promise__ = __webpack_require__(29);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_12__lib_configurable__ = __webpack_require__(46);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_13__shared_log__ = __webpack_require__(17);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_14__shared_loaders__ = __webpack_require__(231);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_15__constants__ = __webpack_require__(28);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_16__lib_base64__ = __webpack_require__(43);
/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 * @license
 */

/* eslint-disable import/first */



/**
 * The current version of the SDK
 * @name PhotoEditorSDK.version
 * @internal Keep in sync with package.json
 */
__WEBPACK_IMPORTED_MODULE_0__sdk__["a" /* default */].version = __webpack_require__(124).version;

// Namespaces

__WEBPACK_IMPORTED_MODULE_0__sdk__["a" /* default */].Math = __WEBPACK_IMPORTED_MODULE_1__lib_math___;


__WEBPACK_IMPORTED_MODULE_0__sdk__["a" /* default */].Operations = __WEBPACK_IMPORTED_MODULE_2__operations___;


__WEBPACK_IMPORTED_MODULE_0__sdk__["a" /* default */].Engine = __WEBPACK_IMPORTED_MODULE_3__engine___["a" /* default */];

// Classes

__WEBPACK_IMPORTED_MODULE_0__sdk__["a" /* default */].Color = __WEBPACK_IMPORTED_MODULE_4__lib_color__["a" /* default */];


__WEBPACK_IMPORTED_MODULE_0__sdk__["a" /* default */].Operation = __WEBPACK_IMPORTED_MODULE_5__operations_operation__["a" /* default */];


__WEBPACK_IMPORTED_MODULE_0__sdk__["a" /* default */].EventEmitter = __WEBPACK_IMPORTED_MODULE_6__lib_event_emitter__["a" /* default */];


__WEBPACK_IMPORTED_MODULE_0__sdk__["a" /* default */].Utils = __WEBPACK_IMPORTED_MODULE_7__lib_utils__["a" /* default */];


__WEBPACK_IMPORTED_MODULE_0__sdk__["a" /* default */].Env = __WEBPACK_IMPORTED_MODULE_8__lib_env__["a" /* default */];


__WEBPACK_IMPORTED_MODULE_0__sdk__["a" /* default */].OperationsStack = __WEBPACK_IMPORTED_MODULE_9__lib_operations_stack__["a" /* default */];


__WEBPACK_IMPORTED_MODULE_0__sdk__["a" /* default */].EXIF = __WEBPACK_IMPORTED_MODULE_10__lib_exif__["a" /* default */];


__WEBPACK_IMPORTED_MODULE_0__sdk__["a" /* default */].Promise = __WEBPACK_IMPORTED_MODULE_11__shared_vendor_promise__["a" /* default */];


__WEBPACK_IMPORTED_MODULE_0__sdk__["a" /* default */].Configurable = __WEBPACK_IMPORTED_MODULE_12__lib_configurable__["a" /* default */];


__WEBPACK_IMPORTED_MODULE_0__sdk__["a" /* default */].Log = __WEBPACK_IMPORTED_MODULE_13__shared_log__["a" /* default */];


__WEBPACK_IMPORTED_MODULE_0__sdk__["a" /* default */].Loaders = __WEBPACK_IMPORTED_MODULE_14__shared_loaders__;
// Constants

__WEBPACK_IMPORTED_MODULE_0__sdk__["a" /* default */].RenderType = __WEBPACK_IMPORTED_MODULE_15__constants__["RenderType"];
__WEBPACK_IMPORTED_MODULE_0__sdk__["a" /* default */].ImageFormat = __WEBPACK_IMPORTED_MODULE_15__constants__["ImageFormat"];
__WEBPACK_IMPORTED_MODULE_0__sdk__["a" /* default */].OptionType = __WEBPACK_IMPORTED_MODULE_15__constants__["OptionType"];
__WEBPACK_IMPORTED_MODULE_0__sdk__["a" /* default */].RendererType = __WEBPACK_IMPORTED_MODULE_15__constants__["RendererType"];
__WEBPACK_IMPORTED_MODULE_0__sdk__["a" /* default */].UniformType = __WEBPACK_IMPORTED_MODULE_15__constants__["UniformType"];

// Libs

__WEBPACK_IMPORTED_MODULE_0__sdk__["a" /* default */].Base64 = __WEBPACK_IMPORTED_MODULE_16__lib_base64__["a" /* default */];

__WEBPACK_IMPORTED_MODULE_0__sdk__["a" /* default */].UI = {};

/* harmony default export */ __webpack_exports__["default"] = (__WEBPACK_IMPORTED_MODULE_0__sdk__["a" /* default */]);

/***/ }),
/* 155 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_symbol_iterator__ = __webpack_require__(22);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_symbol_iterator___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_symbol_iterator__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_symbol__ = __webpack_require__(23);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_symbol___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_symbol__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_promise__ = __webpack_require__(11);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_promise___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_promise__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_6_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__globals__ = __webpack_require__(33);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__operations___ = __webpack_require__(120);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9__lib_operations_stack__ = __webpack_require__(123);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10__lib_version_checker__ = __webpack_require__(226);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_11__lib_exif__ = __webpack_require__(86);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_12__lib_image_exporter__ = __webpack_require__(229);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_13__lib_performance_test__ = __webpack_require__(122);








var _typeof = typeof __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_symbol___default.a === "function" && typeof __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_symbol_iterator___default.a === "symbol" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_symbol___default.a === "function" && obj.constructor === __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_symbol___default.a && obj !== __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_symbol___default.a.prototype ? "symbol" : typeof obj; };

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 * @license
 */








var bd = function bd(str) {
  return Utils.byteArrayToString(Base64.decode(str));
};

var Rectangle = __WEBPACK_IMPORTED_MODULE_7__globals__["Rectangle"],
    Constants = __WEBPACK_IMPORTED_MODULE_7__globals__["Constants"],
    Engine = __WEBPACK_IMPORTED_MODULE_7__globals__["Engine"],
    Utils = __WEBPACK_IMPORTED_MODULE_7__globals__["Utils"],
    EventEmitter = __WEBPACK_IMPORTED_MODULE_7__globals__["EventEmitter"],
    Vector2 = __WEBPACK_IMPORTED_MODULE_7__globals__["Vector2"],
    Log = __WEBPACK_IMPORTED_MODULE_7__globals__["Log"],
    Base64 = __WEBPACK_IMPORTED_MODULE_7__globals__["Base64"];
var RenderType = Constants.RenderType,
    ImageFormat = Constants.ImageFormat,
    Events = Constants.Events,
    RendererType = Constants.RendererType;

/**
 * The main SDK class which handles rendering and manages
 * operations.
 * @class
 * @alias PhotoEditorSDK
 */

var PhotoEditorSDK = function (_EventEmitter) {
  _inherits(PhotoEditorSDK, _EventEmitter);

  /**
   * Creates a PhotoEditorSDK instance
   * @param  {String} [preferredRenderer = webgl] - `webgl` or `canvas`
   * @param  {Object} options
   * @param  {String} options.license - Your license
   * @param  {Image} [options.image] - The image that should be rendered
   * @param  {String} [options.renderMode = dynamic] - `dynamic` or `export`
   * @param  {Boolean} [options.versionCheck = true] - Should a version check be performed?
   * @param  {Boolean} [options.displayWelcomeMessage = true] - Should a welcome message be printed
   *   in the console?
   * @param  {Boolean} [options.transparent = false] - Should the canvas background be transparent?
   * @param  {HTMLCanvasElement} [options.canvas] - The canvas element the SDK should render to
   * @param  {Number} [options.zoom = 1] - The zoom level. Only available in `dynamic` mode
   * @param  {Number} [options.spriteScale = 1] - The output sprite's scale. Only available in `dynamic` mode
   * @param  {String} [options.logLevel = warn] - `trace`, `info`, `warn`, `error` or `log`
   * @param  {Number} [options.pixelRatio = 1] - If none is given, PhotoEditorSDK automatically
   *   detects the current device's pixel ratio
   * @param  {Boolean} [options.smoothDownscaling = false] - Toggles smooth downscaling
   * @param  {Boolean} [options.smoothUpscaling = false] - Toggles smooth upscaling
   */
  function PhotoEditorSDK(preferredRenderer) {
    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};

    _classCallCheck(this, PhotoEditorSDK);

    var _this = _possibleConstructorReturn(this, (PhotoEditorSDK.__proto__ || __WEBPACK_IMPORTED_MODULE_6_babel_runtime_core_js_object_get_prototype_of___default()(PhotoEditorSDK)).call(this));

    _this._onOperationUpdate = _this._onOperationUpdate.bind(_this);
    _this._onContextRestored = _this._onContextRestored.bind(_this);

    var _require = __webpack_require__(124),
        version = _require.version;

    _this.version = version;

    _this[bd('VG04Z1lHRndhVXRsZVdBZ2IzQjBhVzl1SUdkcGRtVnU=')] = true;
    _this._preferredRenderer = preferredRenderer;
    _this._options = Utils.defaults(options, {
      extensions: {},
      renderMode: 'dynamic',
      versionCheck: true,
      displayWelcomeMessage: true,
      image: null,
      canvas: null,
      transparent: false,
      textureQuality: 1,
      zoom: 1,
      spriteScale: 1,
      rotation: 0,
      smoothDownscaling: false,
      smoothUpscaling: false,
      logLevel: 'warn',
      pixelRatio: typeof window !== 'undefined' && window.devicePixelRatio || 1
    });

    if (_this._options.smoothUpscaling) {
      Engine.BaseTexture.DefaultMagFilter = Engine.BaseTexture.LinearFilter;
    }

    _this._options.extensions = Utils.defaults(_this._options.extensions, {
      operations: [],
      controls: [],
      languages: []
    });

    Log.setLevel(_this._options.logLevel);

    if (!_this._v()) return _possibleConstructorReturn(_this);

    // const L = globals.LicenseChecker
    var L = __WEBPACK_IMPORTED_MODULE_7__globals__[bd('TGljZW5zZUNoZWNrZXI=')];
    // this._l = new LicenseChecker(this._options.license)
    _this._l = new L(_this[bd('X29wdGlvbnM=')][bd('bGljZW5zZQ==')]);
    _this._cv(true).then(function () {
      _this._ct();
    }).catch(function (e) {
      Log.error(bd('TGljZW5zaW5n'), e.message);
    });

    _this._defaultRenderMode = _this._options.renderMode;
    _this._renderMode = _this._options.renderMode;

    _this._textureQuality = _this._options.textureQuality;
    _this._offset = new Vector2();
    _this._zoom = _this._options.zoom;
    _this._spriteScale = _this._options.spriteScale;
    _this._rotation = _this._options.rotation;
    _this._operations = {};
    _this._operationsStack = null;
    _this.setOperationsStack(new __WEBPACK_IMPORTED_MODULE_9__lib_operations_stack__["a" /* default */]());

    // Engine stuff
    _this._container = new Engine.Container();
    _this._sprite = new Engine.Sprite();
    _this._container.addChild(_this._sprite);

    _this._inputTexture = _this._options.inputTexture;
    _this._currentInputTexture = null;
    _this._currentTexture = null;

    _this._resizedTexture = null;
    _this._resizedContainer = new Engine.Container();
    _this._resizedSprite = new Engine.Sprite();
    _this._resizedContainer.addChild(_this._resizedSprite);

    _this.setSmoothDownscaling(_this._options.smoothDownscaling);

    _this._checkForUpdates();
    _this._registerOperations();
    _this._initRenderer();

    var renderer = _this._renderer.constructor.type;
    if (_this._options.displayWelcomeMessage) {
      Log.log('Version:', _this.version + ' (' + renderer + ') - https://www.photoeditorsdk.com');
    }

    // Async image handling
    if (_this._options.image) {
      _this.setImage(_this._options.image);
    }
    return _this;
  }

  /**
   * Validates presence of the license
   * @return {Boolean}
   * @private
   */


  _createClass(PhotoEditorSDK, [{
    key: '_v',
    value: function _v() {
      // this._options.license
      if (!this[bd('X29wdGlvbnM=')][bd('bGljZW5zZQ==')]) {
        // Log.error('license', 'No `license` option given.')
        Log.error(bd('TGljZW5zaW5n'), bd('Tm8gYGxpY2Vuc2VgIG9wdGlvbiBnaXZlbi4='));
        Log.error(bd('TGljZW5zaW5n'), bd('SW4gY2FzZSB5b3UgZG9uJ3QgaGF2ZSBhIGxpY2Vuc2UgeWV0LCBwbGVhc2UgY29udGFjdCBvdXIgc2FsZXMgc3RhZmYgYXQgc2FsZXNAcGhvdG9lZGl0b3JzZGsuY29tIHRvIG9idGFpbiBhIGxpY2Vuc2Ugb3IgbG9nIGluIHRvIHlvdXIgY3VzdG9tZXIgZGFzaGJvYXJkLg=='));
        return false;
      }
      return true;
    }

    /**
     * Checks if license expires at some point, prints message about days left
     * @private
     */

  }, {
    key: '_ct',
    value: function _ct() {
      if (this._l.exp()) {
        var expired = this._l.isExp();
        if (expired) {
          Log.error(bd('TGljZW5zaW5n'), bd('WW91ciB0cmlhbCBsaWNlbnNlIGhhcyBleHBpcmVkLiBQbGVhc2UgY29udGFjdCB1cyBhdCBzYWxlc0BwaG90b2VkaXRvcnNkay5jb20gdG8gb2J0YWluIGEgbGljZW5zZS4='));
        } else {
          Log.warn(bd('TGljZW5zaW5n'), bd('WW91ciB0cmlhbCBsaWNlbnNlIHdpbGwgZXhwaXJlIGluICVkIGRheXMu').replace('%d', this._l.dl()));
        }
      }
    }

    /**
     * Checks for valid license
     * @return {Promise}
     * @private
     */

  }, {
    key: '_cv',
    value: function _cv() {
      var _this2 = this;

      var print = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;

      return this._l.c().catch(function (e) {
        _this2[bd('VG04Z1lHRndhVXRsZVdBZ2IzQjBhVzl1SUdkcGRtVnU=')] = false;
        var errorMessage = bd('SW52YWxpZCBsaWNlbnNlLg==');
        if (print) {
          if (e.code === 'ELICEXP') {
            // 'Your trial license has expired. Please contact us at sales@photoeditorsdk.com to obtain a license.'
            errorMessage = bd('WW91ciB0cmlhbCBsaWNlbnNlIGhhcyBleHBpcmVkLiBQbGVhc2UgY29udGFjdCB1cyBhdCBzYWxlc0BwaG90b2VkaXRvcnNkay5jb20gdG8gb2J0YWluIGEgbGljZW5zZS4=');
          } else if (e.code === 'ELICINVHOST') {
            // 'This license is not valid for the hostname ...'
            errorMessage = bd('VGhpcyBsaWNlbnNlIGlzIG5vdCB2YWxpZCBmb3IgdGhlIGhvc3RuYW1lIA==') + window.location.hostname + '.';
          } else if (e.code === 'ELICINVPLAT') {
            // 'This license is not valid for the current platform.'
            errorMessage = bd('VGhpcyBsaWNlbnNlIGlzIG5vdCB2YWxpZCBmb3IgdGhlIGN1cnJlbnQgcGxhdGZvcm0u');
          } else if (e.code === 'ELICINVFMT') {
            // 'Invalid license format. Please make sure you're passing your license as a string, not as \`$format\`.'
            errorMessage = bd('SW52YWxpZCBsaWNlbnNlIGZvcm1hdC4gUGxlYXNlIG1ha2Ugc3VyZSB5b3UncmUgcGFzc2luZyB5b3VyIGxpY2Vuc2UgYXMgYSBzdHJpbmcsIG5vdCBhcyBgJGZvcm1hdGAu').replace('$format', _typeof(_this2._options.license));
          } else if (e.code === 'ELICINV') {
            // 'Invalid license! Please contact our sales staff at support@photoeditorsdk.com to obtain a license or log in to your customer dashboard.'
            errorMessage = bd('SW52YWxpZCBsaWNlbnNlISBQbGVhc2UgY29udGFjdCBvdXIgc2FsZXMgc3RhZmYgYXQgc3VwcG9ydEBwaG90b2VkaXRvcnNkay5jb20gdG8gb2J0YWluIGEgbGljZW5zZSBvciBsb2cgaW4gdG8geW91ciBjdXN0b21lciBkYXNoYm9hcmQu');
          } else {
            // 'In case you don't have a license yet, please contact our sales staff at sales@photoeditorsdk.com to obtain a license or log in to your customer dashboard.'
            errorMessage = bd('SW4gY2FzZSB5b3UgZG9uJ3QgaGF2ZSBhIGxpY2Vuc2UgeWV0LCBwbGVhc2UgY29udGFjdCBvdXIgc2FsZXMgc3RhZmYgYXQgc2FsZXNAcGhvdG9lZGl0b3JzZGsuY29tIHRvIG9idGFpbiBhIGxpY2Vuc2Ugb3IgbG9nIGluIHRvIHlvdXIgY3VzdG9tZXIgZGFzaGJvYXJkLg==');
          }
        }
        e.message = errorMessage;
        throw new Error(e);
      });
    }

    /**
     * Tracks an export / edit
     * @private
     */

  }, {
    key: '_t',
    value: function _t() {
      this._l.t();
    }

    // -------------------------------------------------------------------------- EVENTS

    /**
     * Gets called when an operation is updated. Delegates the event.
     * @private
     */

  }, {
    key: '_onOperationUpdate',
    value: function _onOperationUpdate() {
      for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
        args[_key] = arguments[_key];
      }

      this.emit.apply(this, [Events.OPERATION_UPDATED].concat(args));
    }

    /**
     * Gets called when the WebGL context has been restored. Re-triggers a render.
     * @private
     */
    /* istanbul ignore next */

  }, {
    key: '_onContextRestored',
    value: function _onContextRestored() {
      Log.warn(this.constructor.name, 'Trying to re-render after WebGL context has been restored.');
      this.setAllOperationsToDirty();
      this._operationsStack.forEach(function (operation) {
        operation.disposeRenderTextures();
      });
      this.render();
    }

    // -------------------------------------------------------------------------- RENDERING

    /**
     * Exports the image with the given options. Result of the Promise is the exported image or data url.
     * @param  {PhotoEditorSDK.RenderType} [renderType=PhotoEditorSDK.RenderType.DATAURL] - The output type
     * @param  {PhotoEditorSDK.ImageFormat} [imageFormat=PhotoEditorSDK.ImageFormat.PNG] - The output image format
     * @param  {Number} [quality=0.8] - The image quality, between 0 and 1
     * @return {Promise}
     */

  }, {
    key: 'export',
    value: function _export() {
      var renderType = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : RenderType.DATAURL;

      var _this3 = this;

      var imageFormat = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : ImageFormat.PNG;
      var quality = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0.8;

      return this._cv(true).then(function () {
        if (_this3.hasChanges()) {
          _this3._t(); // track exports
        }
        var imageExporter = new __WEBPACK_IMPORTED_MODULE_12__lib_image_exporter__["a" /* default */](_this3, {
          renderType: renderType, imageFormat: imageFormat, quality: quality
        });
        return imageExporter.export();
      });
    }

    /**
     * Renders the current image to the canvas
     * @param {Boolean} renderOutput = true
     * @return {Promise}
     */

  }, {
    key: 'render',
    value: function render() {
      var _this4 = this;

      var renderOutput = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : true;

      if (!this._inputTexture) {
        throw new Error('You need to set an image before calling PhotoEditorSDK#render.');
      }

      var context = this._renderer.getContext();
      if (context.startFrame) {
        context.startFrame();
      }

      var perfTest = void 0;
      if (Log.canLog('info')) {
        perfTest = new __WEBPACK_IMPORTED_MODULE_13__lib_performance_test__["a" /* default */]('', 'Frame rendering');
      }
      Log.info('', 'Rendering starts');

      var stack = this._operationsStack;
      stack.updateDirtinessForRenderer(this._renderer);

      return this._prepareTexture().then(function (texture) {
        if (_this4._renderMode === 'export') {
          texture = _this4._inputTexture;
        }

        _this4._currentTexture = texture;
        _this4._sprite.setTexture(texture);
        _this4._container.updateTransform();
      }).then(function () {
        return stack.validateSettings();
      }).then(function () {
        return stack.render(_this4, _this4._currentTexture);
      }).then(function (outputTexture) {
        // Input texture has been passed through all operations which return
        // a new RenderTexture. Use this texture for the Sprite and render it
        // to the output canvas.
        _this4._currentTexture = outputTexture;
        _this4._sprite.setTexture(_this4._currentTexture);

        switch (_this4._renderMode) {
          case 'dynamic':
            // Always center image, set scale to zoom level
            var center = _this4._renderer.getDimensions().clone().divide(2).add(_this4._offset);

            _this4._container.setScale(_this4._zoom / _this4.getTextureScale(), _this4._zoom / _this4.getTextureScale());
            _this4._container.setPosition(center);
            _this4._sprite.setAnchor(0.5, 0.5);
            _this4._sprite.setScale(_this4._spriteScale, _this4._spriteScale);
            _this4._sprite.setRotation(_this4._rotation);
            break;
          case 'export':
            // Move sprite to upper left hand corner, render at full scale
            _this4._container.setScale(1, 1);
            _this4._container.setPosition(0, 0);
            _this4._sprite.setAnchor(0, 0);
            _this4._sprite.setPosition(0, 0);
            _this4._sprite.setScale(_this4._spriteScale, _this4._spriteScale);
            _this4._sprite.setRotation(0);
            break;
        }

        // This renders to the output
        if (renderOutput) {
          _this4._renderer.render(_this4._container);
        }

        return outputTexture;
      }).then(function (texture) {
        if (perfTest) {
          perfTest.stop();
        }
        if (context.endFrame) {
          context.endFrame();
        }
        return texture;
      });
    }
  }, {
    key: 'getTextureScale',
    value: function getTextureScale() {
      return Math.min(1, this._textureQuality * this._options.pixelRatio);
    }

    /**
     * Prepares the input texture for the current zoom level
     * @private
     */

  }, {
    key: '_prepareTexture',
    value: function _prepareTexture() {
      var _this5 = this;

      return new __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_promise___default.a(function (resolve, reject) {
        var textureScale = _this5.getTextureScale();
        if (_this5._textureQuality === 1) {
          return resolve(_this5._inputTexture);
        }

        var dimensions = _this5.getInputDimensions().multiply(textureScale).floor();

        var needsRerender = void 0;
        if (!_this5._resizedTexture) {
          _this5._resizedTexture = new Engine.RenderTexture(_this5._renderer, dimensions.x, dimensions.y);
          needsRerender = true;
        } else if (!_this5._resizedTexture.getDimensions().equals(dimensions)) {
          _this5._resizedTexture.resizeTo(dimensions);
          needsRerender = true;
        }

        if (needsRerender) {
          _this5._resizedSprite.setScale(textureScale, textureScale);
          _this5._resizedSprite.setTexture(_this5._inputTexture);
          _this5._resizedTexture.render(_this5._resizedContainer);
        }

        resolve(_this5._resizedTexture);
      });
    }

    // -------------------------------------------------------------------------- OPERATIONS

    /**
     * Registers all default operations
     * @private
     */

  }, {
    key: '_registerOperations',
    value: function _registerOperations() {
      this._operations = {};

      for (var operationName in __WEBPACK_IMPORTED_MODULE_8__operations___) {
        var operation = __WEBPACK_IMPORTED_MODULE_8__operations___[operationName];
        this._operations[operation.identifier] = operation;
      }

      this._operations = Utils.extend(this._operations, this._options.extensions.operations);
    }

    /**
     * Registers the given operations
     * @param  {PhotoEditorSDK.Operation[]} operations
     */

  }, {
    key: 'registerOperations',
    value: function registerOperations(operations) {
      var _this6 = this;

      operations.forEach(function (operation) {
        _this6._operations[operation.identifier] = operation;
      });
    }

    /**
     * Sets all operations in the stack to dirty
     * @param {Boolean} dimensionsChanged = false
     */

  }, {
    key: 'setAllOperationsToDirty',
    value: function setAllOperationsToDirty() {
      var dimensionsChanged = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;

      this._operationsStack.setAllToDirty(dimensionsChanged);
    }

    /**
     * Creates an operation with the given identifier
     * @param {String} identifier
     * @param {Object} [options = {}]
     * @param {Boolean} [addToStack = true]
     * @returns {PhotoEditorSDK.Operation}
     */

  }, {
    key: 'createOperation',
    value: function createOperation(identifier) {
      var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
      var addToStack = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;

      var Operation = this._operations[identifier];
      if (!Operation) {
        throw new Error('No operation with identifier `' + identifier + '` found.');
      }

      var operation = new Operation(this, options);
      if (addToStack) {
        this.addOperation(operation);
      }
      return operation;
    }

    /**
     * Adds the given operation to the operations stack
     * @param {PhotoEditorSDK.Operation} operation
     */

  }, {
    key: 'addOperation',
    value: function addOperation(operation) {
      this._operationsStack.push(operation);
    }

    /**
     * Removes the given operation from the operations stack
     * @param  {PhotoEditorSDK.Operation} operation
     */

  }, {
    key: 'removeOperation',
    value: function removeOperation(operation) {
      this._operationsStack.remove(operation);
    }

    // -------------------------------------------------------------------------- DIMENSIONS

    /**
     * Returns the initial image dimensions
     * @return {PhotoEditorSDK.Math.Vector2}
     */

  }, {
    key: 'getInputDimensions',
    value: function getInputDimensions() {
      var frame = this._inputTexture.getFrame();
      return new Vector2(frame.width, frame.height);
    }

    /**
     * Returns the final dimensions that the input image would have
     * after all existing operations have been applied
     * @param {Boolean} incorporateSpriteScale = false
     * @return {PhotoEditorSDK.Math.Vector2}
     */

  }, {
    key: 'getFinalDimensions',
    value: function getFinalDimensions() {
      var incorporateSpriteScale = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;

      var dimensions = this.getInputDimensions();
      var operationsStack = this._operationsStack;

      operationsStack.forEach(function (operation) {
        if (!operation.getEnabled()) return;
        dimensions = operation.getNewDimensions(dimensions);
      });

      if (incorporateSpriteScale) {
        dimensions.multiply(this._spriteScale);
      }

      return dimensions.floor();
    }

    /**
     * Returns the current sprite dimensions
     * @param {Boolean} incorporateSpriteScale = false
     * @return {Vector2}
     */

  }, {
    key: 'getOutputDimensions',
    value: function getOutputDimensions() {
      var incorporateSpriteScale = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;

      return this.getFinalDimensions(incorporateSpriteScale).clone().multiply(this._zoom).floor();
    }

    /**
     * Returns the dimensions of the output texture
     * @param  {Boolean} incorporateSpriteScale = false
     * @return {Vector2}
     */

  }, {
    key: 'getOutputTextureDimensions',
    value: function getOutputTextureDimensions() {
      var incorporateSpriteScale = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;

      var textureScale = this.getTextureScale();
      var dimensions = this.getInputDimensions().multiply(textureScale).floor();
      this._operationsStack.forEach(function (op) {
        dimensions = op.getNewDimensions(dimensions);
      });
      return dimensions;
    }

    // -------------------------------------------------------------------------- MISC

    /**
     * Checks for version updates
     * @private
     */

  }, {
    key: '_checkForUpdates',
    value: function _checkForUpdates() {
      if (!this._l.isENT()) {
        this._versionChecker = new __WEBPACK_IMPORTED_MODULE_10__lib_version_checker__["a" /* default */](this.version);
      }
    }

    /**
     * Initializes the renderer
     * @private
     */

  }, {
    key: '_initRenderer',
    value: function _initRenderer() {
      var rendererOptions = {
        canvas: this._options.canvas,
        pixelRatio: this._options.pixelRatio,
        debug: this._options.debug,
        transparent: this._options.transparent
      };

      var width = void 0,
          height = void 0;
      if (this._renderMode === 'dynamic' && this._options.canvas) {
        var canvas = this._options.canvas;

        width = canvas.width;
        height = canvas.height;
      } else if (this._inputTexture) {
        var dimensions = this.getFinalDimensions();
        width = dimensions.x;
        height = dimensions.y;
      } else {
        width = 1;
        height = 1;
      }

      switch (this._preferredRenderer) {
        /* istanbul ignore next */
        case RendererType.WEBGL:
          this._renderer = Engine.autoDetectRenderer(width, height, rendererOptions);
          this._renderer.on('context-restored', this._onContextRestored);
          break;
        case RendererType.CANVAS:
          this._renderer = new Engine.CanvasRenderer(width, height, rendererOptions);
          this._renderer.on('context-restored', this._onContextRestored);
          break;
        default:
          Log.warn('PhotoEditorSDK', 'PhotoEditorSDK Error: Renderer `' + this._preferredRenderer + '` not supported. Falling back to automatically detected renderer.');
          this._renderer = Engine.autoDetectRenderer(width, height, rendererOptions);
      }
    }

    /**
     * Resizes the renderer to the given dimensions
     * @param  {PhotoEditorSDK.Math.Vector2} dimensions
     */

  }, {
    key: 'resizeTo',
    value: function resizeTo(dimensions) {
      this._renderer.resizeTo(dimensions, true);
    }

    /**
     * Resets all custom and selected operations
     */

  }, {
    key: 'reset',
    value: function reset() {
      this._operationsStack.clear();
    }

    // -------------------------------------------------------------------------- EXIF

    /**
     * Parses the exif data and fixes the orientation if necessary
     * @param {Image} image
     * @private
     * @TODO Move this somewhere else
     */

  }, {
    key: 'parseExif',
    value: function parseExif(image) {
      if (!image) {
        return;
      }
      var src = image.src;

      var isJPEG = false;
      var base64String = null;

      /* istanbul ignore else */

      var _require2 = __webpack_require__(19),
          Image = _require2.Image;

      if (image instanceof Image && image.rawSource) {
        var buf = image.rawSource;
        if (!(image.rawSource instanceof Buffer)) {
          var source = image.rawSource.replace('data:image/jpeg;base64,', '');
          buf = Buffer.from(source, 'base64');
          src = image.rawSource;
        } else {
          src = image.rawSource.toString('base64');
        }
        isJPEG = __WEBPACK_IMPORTED_MODULE_11__lib_exif__["a" /* default */].bufferIsJPEG(buf);
        if (isJPEG) {
          base64String = src;
        }
      }

      if (typeof WEBPACK !== 'undefined') {
        isJPEG = __WEBPACK_IMPORTED_MODULE_11__lib_exif__["a" /* default */].isJPEG(src);
        base64String = src;
      }

      if (isJPEG) {
        var exif = null;
        try {
          exif = __WEBPACK_IMPORTED_MODULE_11__lib_exif__["a" /* default */].fromBase64String(base64String);
        } catch (e) {}
        if (!exif) {
          return;
        }

        return exif;
      }
    }

    /**
     * Reads the EXIF orientation tag and fixes it with the OrientationOperation
     * @private
     */

  }, {
    key: '_handleExifOrientation',
    value: function _handleExifOrientation() {
      var exifTags = this._exif.getTags();

      if (exifTags && exifTags.Orientation) {
        var rotationNeedsChange = exifTags.Orientation !== 1 && exifTags.Orientation !== 2;
        var flipNeedsChange = [2, 4, 5, 7].indexOf(exifTags.Orientation) !== -1;

        if (rotationNeedsChange || flipNeedsChange) {
          if (!this._exifOperation) {
            this._exifOperation = this.createOperation('exif-orientation');
          }
          this._exifOperation.setTags(exifTags);

          // We fixed the orientation, new EXIF orientation is 1
          this._exif.setOrientation(1);
        }
      }
    }

    // -------------------------------------------------------------------------- GETTERS / SETTERS

    /**
     * Checks if an image is provided
     * @return {Boolean} [description]
     */

  }, {
    key: 'hasImage',
    value: function hasImage() {
      return this._image !== null && typeof this._image !== 'undefined';
    }

    /**
     * Returns the image
     * @return {Image}
     */

  }, {
    key: 'getImage',
    value: function getImage() {
      return this._image;
    }

    /**
     * Sets the image and parses the exif data
     * @param {Image} image
     * @param {PhotoEditorSDK.Exif} [exif = null]
     * @param {PhotoEditorSDK.Math.Vector2} [dimensions]
     */

  }, {
    key: 'setImage',
    value: function setImage(image) {
      var exif = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;
      var dimensions = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;

      // Reset exif orientation compensation
      if (this._exifOperation) {
        this.removeOperation(this._exifOperation);
        this._exifOperation = null;
      }

      this._options.image = image;
      this._image = image;

      this._exif = exif || this.parseExif(image);
      if (this._exif) {
        this._handleExifOrientation();
      }

      var baseTexture = new Engine.BaseTexture(this._image);
      var frame = new Rectangle(0, 0, this._image.naturalWidth || this._image.width, this._image.naturalHeight || this._image.height);
      if (dimensions) {
        frame.width = dimensions.x;
        frame.height = dimensions.y;
      }

      if (this._resizedTexture) {
        this._resizedTexture.dispose();
      }
      this._resizedTexture = null;

      if (this._inputTexture) {
        this._inputTexture.getBaseTexture().dispose();
      }
      this._inputTexture = new Engine.Texture(baseTexture, frame);
      this._currentTexture = this._inputTexture;
      this._sprite.clearTexture();
      this._sprite.setTexture(this._inputTexture);

      this.setAllOperationsToDirty(true);
    }

    /**
     * Set the input texture for this SDK as an alternative to passing in an image
     * @param {PhotoEditorSDK.Engine.Texture} texture
     */

  }, {
    key: 'setInputTexture',
    value: function setInputTexture(texture) {
      this._inputTexture = texture;
    }

    /**
     * Returns the canvas
     * @return {HTMLCanvasElement}
     */

  }, {
    key: 'getCanvas',
    value: function getCanvas() {
      return this._renderer.getCanvas();
    }

    /**
     * Sets the canvas
     * @param {HTMLCanvasElement} canvas
     */

  }, {
    key: 'setCanvas',
    value: function setCanvas(canvas) {
      this._renderer.setCanvas(canvas);
    }

    /**
     * Returns the sprite
     * @return {PhotoEditorSDK.Engine.Sprite}
     */

  }, {
    key: 'getSprite',
    value: function getSprite() {
      return this._sprite;
    }

    /**
     * Returns the container
     * @return {PhotoEditorSDK.Engine.Container}
     */

  }, {
    key: 'getContainer',
    value: function getContainer() {
      return this._container;
    }

    /**
     * Returns the operation stack
     * @return {PhotoEditorSDK.OperationsStack}
     */

  }, {
    key: 'getOperationsStack',
    value: function getOperationsStack() {
      return this._operationsStack;
    }

    /**
     * Sets the operations stack
     * @param {PhotoEditorSDK.OperationsStack} operationsStack
     */

  }, {
    key: 'setOperationsStack',
    value: function setOperationsStack(operationsStack) {
      if (this._operationsStack) {
        this._operationsStack.off(Events.OPERATION_UPDATED, this._onOperationUpdate);
      }

      this._operationsStack = operationsStack;
      this._operationsStack.on(Events.OPERATION_UPDATED, this._onOperationUpdate);
    }

    /**
     * Returns the available operations
     * @return {Operation[]}
     */

  }, {
    key: 'getOperations',
    value: function getOperations() {
      return this._operations;
    }

    /**
     * Returns the renderer
     * @return {PhotoEditorSDK.Engine.BaseRenderer}
     */

  }, {
    key: 'getRenderer',
    value: function getRenderer() {
      return this._renderer;
    }

    /**
     * Returns the rendering offset
     * @return {PhotoEditorSDK.Math.Vector2}
     */

  }, {
    key: 'getOffset',
    value: function getOffset() {
      return this._offset;
    }

    /**
     * Sets the rendering offset
     * @param {PhotoEditorSDK.Math.Vector2|Number} offset
     * @param {Number} y
     */

  }, {
    key: 'setOffset',
    value: function setOffset(offset, y) {
      if (offset instanceof Vector2) {
        this._offset.copy(offset);
      } else {
        this._offset.set(offset, y);
      }
    }

    /**
     * Returns the current render mode
     * @return {String}
     */

  }, {
    key: 'getRenderMode',
    value: function getRenderMode() {
      return this._renderMode;
    }

    /**
     * Sets the render mode
     * @param {String} renderMode
     */

  }, {
    key: 'setRenderMode',
    value: function setRenderMode(renderMode) {
      this._renderMode = renderMode;
    }

    /**
     * Returns the zoom level
     * @return {Number}
     */

  }, {
    key: 'getZoom',
    value: function getZoom() {
      return this._zoom;
    }

    /**
     * Sets the zoom level
     * @param {Number} zoom
     */

  }, {
    key: 'setZoom',
    value: function setZoom(zoom) {
      this._zoom = zoom;
      this._container.setScale(this._zoom, this._zoom);
      this._container.updateTransform();
    }

    /**
     * Returns the texture quality
     * @return {Number}
     */

  }, {
    key: 'getTextureQuality',
    value: function getTextureQuality() {
      if (this._renderMode === 'export') {
        return 1;
      }

      return this._textureQuality;
    }

    /**
     * Sets the texture quality
     * @param {Number} textureQuality
     */

  }, {
    key: 'setTextureQuality',
    value: function setTextureQuality(textureQuality) {
      if (textureQuality !== this._textureQuality) {
        this.setAllOperationsToDirty(true);
      }
      this._textureQuality = Math.min(1, textureQuality);

      // Clean up resized texture, not needed right now
      if (this._textureQuality === 1 && this._resizedTexture) {
        this._resizedTexture.dispose();
        this._resizedTexture = null;
      }
    }

    /**
     * Returns the output sprite's scale
     * @return {Number}
     */

  }, {
    key: 'getSpriteScale',
    value: function getSpriteScale() {
      return this._spriteScale;
    }

    /**
     * Sets the sprite scale to the given value
     * @param {Number} spriteScale
     */

  }, {
    key: 'setSpriteScale',
    value: function setSpriteScale(spriteScale) {
      this._spriteScale = spriteScale;
      this._sprite.setScale(spriteScale, spriteScale);
      this._sprite.updateTransform();
    }

    /**
     * Returns the pixel ratio
     * @return {Number}
     */

  }, {
    key: 'getPixelRatio',
    value: function getPixelRatio() {
      return this._options.pixelRatio;
    }

    /**
     * Returns the Exif instance
     * @return {PhotoEditorSDK.Exif} [description]
     */

  }, {
    key: 'getExif',
    value: function getExif() {
      return this._exif;
    }

    /**
     * Returns the options
     * @return {Object}
     */

  }, {
    key: 'getOptions',
    value: function getOptions() {
      return this._options;
    }

    /**
     * Returns the input texture
     * @return {PhotoEditorSDK.Engine.Texture}
     */

  }, {
    key: 'getInputTexture',
    value: function getInputTexture() {
      return this._inputTexture;
    }

    /**
     * Sets the smooth downscaling flag for the output sprite
     * @param {Boolean} smoothDownscaling
     */

  }, {
    key: 'setSmoothDownscaling',
    value: function setSmoothDownscaling(smoothDownscaling) {
      this._options.smoothDownscaling = smoothDownscaling;
      this._sprite.setSmoothDownscaling(smoothDownscaling);
      this._resizedSprite.setSmoothDownscaling(smoothDownscaling);
    }

    /**
     * Sets the rotation to the given value
     * @param {Number} rotation
     */

  }, {
    key: 'setRotation',
    value: function setRotation(rotation) {
      this._rotation = rotation;
    }

    /**
     * Returns the current rotation
     */

  }, {
    key: 'getRotation',
    value: function getRotation() {
      return this._rotation;
    }

    /**
     * Check if the OperationsStack has changes
     * @return {Boolean}
     */

  }, {
    key: 'hasChanges',
    value: function hasChanges() {
      return this.getOperationsStack().hasChanges();
    }
    // -------------------------------------------------------------------------- DISPOSAL

    /**
     * Disposes the SDK
     */

  }, {
    key: 'dispose',
    value: function dispose() {
      this._operationsStack.dispose();
      this._renderer.dispose();
      if (this._exif) {
        this._exif.dispose();
      }
      if (this._resizedTexture) {
        this._resizedTexture.dispose();
      }
    }
  }]);

  return PhotoEditorSDK;
}(EventEmitter);

/* harmony default export */ __webpack_exports__["a"] = (PhotoEditorSDK);

/***/ }),
/* 156 */
/***/ (function(module, exports, __webpack_require__) {

__webpack_require__(40);
__webpack_require__(54);
module.exports = __webpack_require__(72).f('iterator');


/***/ }),
/* 157 */
/***/ (function(module, exports, __webpack_require__) {

var toInteger = __webpack_require__(67);
var defined = __webpack_require__(64);
// true  -> String#at
// false -> String#codePointAt
module.exports = function (TO_STRING) {
  return function (that, pos) {
    var s = String(defined(that));
    var i = toInteger(pos);
    var l = s.length;
    var a, b;
    if (i < 0 || i >= l) return TO_STRING ? '' : undefined;
    a = s.charCodeAt(i);
    return a < 0xd800 || a > 0xdbff || i + 1 === l || (b = s.charCodeAt(i + 1)) < 0xdc00 || b > 0xdfff
      ? TO_STRING ? s.charAt(i) : a
      : TO_STRING ? s.slice(i, i + 2) : (a - 0xd800 << 10) + (b - 0xdc00) + 0x10000;
  };
};


/***/ }),
/* 158 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var create = __webpack_require__(65);
var descriptor = __webpack_require__(35);
var setToStringTag = __webpack_require__(53);
var IteratorPrototype = {};

// 25.1.2.1.1 %IteratorPrototype%[@@iterator]()
__webpack_require__(25)(IteratorPrototype, __webpack_require__(12)('iterator'), function () { return this; });

module.exports = function (Constructor, NAME, next) {
  Constructor.prototype = create(IteratorPrototype, { next: descriptor(1, next) });
  setToStringTag(Constructor, NAME + ' Iterator');
};


/***/ }),
/* 159 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var addToUnscopables = __webpack_require__(160);
var step = __webpack_require__(161);
var Iterators = __webpack_require__(32);
var toIObject = __webpack_require__(26);

// 22.1.3.4 Array.prototype.entries()
// 22.1.3.13 Array.prototype.keys()
// 22.1.3.29 Array.prototype.values()
// 22.1.3.30 Array.prototype[@@iterator]()
module.exports = __webpack_require__(96)(Array, 'Array', function (iterated, kind) {
  this._t = toIObject(iterated); // target
  this._i = 0;                   // next index
  this._k = kind;                // kind
// 22.1.5.2.1 %ArrayIteratorPrototype%.next()
}, function () {
  var O = this._t;
  var kind = this._k;
  var index = this._i++;
  if (!O || index >= O.length) {
    this._t = undefined;
    return step(1);
  }
  if (kind == 'keys') return step(0, index);
  if (kind == 'values') return step(0, O[index]);
  return step(0, [index, O[index]]);
}, 'values');

// argumentsList[@@iterator] is %ArrayProto_values% (9.4.4.6, 9.4.4.7)
Iterators.Arguments = Iterators.Array;

addToUnscopables('keys');
addToUnscopables('values');
addToUnscopables('entries');


/***/ }),
/* 160 */
/***/ (function(module, exports) {

module.exports = function () { /* empty */ };


/***/ }),
/* 161 */
/***/ (function(module, exports) {

module.exports = function (done, value) {
  return { value: value, done: !!done };
};


/***/ }),
/* 162 */
/***/ (function(module, exports, __webpack_require__) {

__webpack_require__(163);
__webpack_require__(99);
__webpack_require__(168);
__webpack_require__(169);
module.exports = __webpack_require__(10).Symbol;


/***/ }),
/* 163 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";

// ECMAScript 6 symbols shim
var global = __webpack_require__(14);
var has = __webpack_require__(27);
var DESCRIPTORS = __webpack_require__(21);
var $export = __webpack_require__(15);
var redefine = __webpack_require__(97);
var META = __webpack_require__(164).KEY;
var $fails = __webpack_require__(31);
var shared = __webpack_require__(69);
var setToStringTag = __webpack_require__(53);
var uid = __webpack_require__(51);
var wks = __webpack_require__(12);
var wksExt = __webpack_require__(72);
var wksDefine = __webpack_require__(73);
var enumKeys = __webpack_require__(165);
var isArray = __webpack_require__(166);
var anObject = __webpack_require__(16);
var isObject = __webpack_require__(20);
var toIObject = __webpack_require__(26);
var toPrimitive = __webpack_require__(62);
var createDesc = __webpack_require__(35);
var _create = __webpack_require__(65);
var gOPNExt = __webpack_require__(167);
var $GOPD = __webpack_require__(63);
var $DP = __webpack_require__(18);
var $keys = __webpack_require__(37);
var gOPD = $GOPD.f;
var dP = $DP.f;
var gOPN = gOPNExt.f;
var $Symbol = global.Symbol;
var $JSON = global.JSON;
var _stringify = $JSON && $JSON.stringify;
var PROTOTYPE = 'prototype';
var HIDDEN = wks('_hidden');
var TO_PRIMITIVE = wks('toPrimitive');
var isEnum = {}.propertyIsEnumerable;
var SymbolRegistry = shared('symbol-registry');
var AllSymbols = shared('symbols');
var OPSymbols = shared('op-symbols');
var ObjectProto = Object[PROTOTYPE];
var USE_NATIVE = typeof $Symbol == 'function';
var QObject = global.QObject;
// Don't use setters in Qt Script, https://github.com/zloirock/core-js/issues/173
var setter = !QObject || !QObject[PROTOTYPE] || !QObject[PROTOTYPE].findChild;

// fallback for old Android, https://code.google.com/p/v8/issues/detail?id=687
var setSymbolDesc = DESCRIPTORS && $fails(function () {
  return _create(dP({}, 'a', {
    get: function () { return dP(this, 'a', { value: 7 }).a; }
  })).a != 7;
}) ? function (it, key, D) {
  var protoDesc = gOPD(ObjectProto, key);
  if (protoDesc) delete ObjectProto[key];
  dP(it, key, D);
  if (protoDesc && it !== ObjectProto) dP(ObjectProto, key, protoDesc);
} : dP;

var wrap = function (tag) {
  var sym = AllSymbols[tag] = _create($Symbol[PROTOTYPE]);
  sym._k = tag;
  return sym;
};

var isSymbol = USE_NATIVE && typeof $Symbol.iterator == 'symbol' ? function (it) {
  return typeof it == 'symbol';
} : function (it) {
  return it instanceof $Symbol;
};

var $defineProperty = function defineProperty(it, key, D) {
  if (it === ObjectProto) $defineProperty(OPSymbols, key, D);
  anObject(it);
  key = toPrimitive(key, true);
  anObject(D);
  if (has(AllSymbols, key)) {
    if (!D.enumerable) {
      if (!has(it, HIDDEN)) dP(it, HIDDEN, createDesc(1, {}));
      it[HIDDEN][key] = true;
    } else {
      if (has(it, HIDDEN) && it[HIDDEN][key]) it[HIDDEN][key] = false;
      D = _create(D, { enumerable: createDesc(0, false) });
    } return setSymbolDesc(it, key, D);
  } return dP(it, key, D);
};
var $defineProperties = function defineProperties(it, P) {
  anObject(it);
  var keys = enumKeys(P = toIObject(P));
  var i = 0;
  var l = keys.length;
  var key;
  while (l > i) $defineProperty(it, key = keys[i++], P[key]);
  return it;
};
var $create = function create(it, P) {
  return P === undefined ? _create(it) : $defineProperties(_create(it), P);
};
var $propertyIsEnumerable = function propertyIsEnumerable(key) {
  var E = isEnum.call(this, key = toPrimitive(key, true));
  if (this === ObjectProto && has(AllSymbols, key) && !has(OPSymbols, key)) return false;
  return E || !has(this, key) || !has(AllSymbols, key) || has(this, HIDDEN) && this[HIDDEN][key] ? E : true;
};
var $getOwnPropertyDescriptor = function getOwnPropertyDescriptor(it, key) {
  it = toIObject(it);
  key = toPrimitive(key, true);
  if (it === ObjectProto && has(AllSymbols, key) && !has(OPSymbols, key)) return;
  var D = gOPD(it, key);
  if (D && has(AllSymbols, key) && !(has(it, HIDDEN) && it[HIDDEN][key])) D.enumerable = true;
  return D;
};
var $getOwnPropertyNames = function getOwnPropertyNames(it) {
  var names = gOPN(toIObject(it));
  var result = [];
  var i = 0;
  var key;
  while (names.length > i) {
    if (!has(AllSymbols, key = names[i++]) && key != HIDDEN && key != META) result.push(key);
  } return result;
};
var $getOwnPropertySymbols = function getOwnPropertySymbols(it) {
  var IS_OP = it === ObjectProto;
  var names = gOPN(IS_OP ? OPSymbols : toIObject(it));
  var result = [];
  var i = 0;
  var key;
  while (names.length > i) {
    if (has(AllSymbols, key = names[i++]) && (IS_OP ? has(ObjectProto, key) : true)) result.push(AllSymbols[key]);
  } return result;
};

// 19.4.1.1 Symbol([description])
if (!USE_NATIVE) {
  $Symbol = function Symbol() {
    if (this instanceof $Symbol) throw TypeError('Symbol is not a constructor!');
    var tag = uid(arguments.length > 0 ? arguments[0] : undefined);
    var $set = function (value) {
      if (this === ObjectProto) $set.call(OPSymbols, value);
      if (has(this, HIDDEN) && has(this[HIDDEN], tag)) this[HIDDEN][tag] = false;
      setSymbolDesc(this, tag, createDesc(1, value));
    };
    if (DESCRIPTORS && setter) setSymbolDesc(ObjectProto, tag, { configurable: true, set: $set });
    return wrap(tag);
  };
  redefine($Symbol[PROTOTYPE], 'toString', function toString() {
    return this._k;
  });

  $GOPD.f = $getOwnPropertyDescriptor;
  $DP.f = $defineProperty;
  __webpack_require__(98).f = gOPNExt.f = $getOwnPropertyNames;
  __webpack_require__(50).f = $propertyIsEnumerable;
  __webpack_require__(74).f = $getOwnPropertySymbols;

  if (DESCRIPTORS && !__webpack_require__(52)) {
    redefine(ObjectProto, 'propertyIsEnumerable', $propertyIsEnumerable, true);
  }

  wksExt.f = function (name) {
    return wrap(wks(name));
  };
}

$export($export.G + $export.W + $export.F * !USE_NATIVE, { Symbol: $Symbol });

for (var es6Symbols = (
  // 19.4.2.2, 19.4.2.3, 19.4.2.4, 19.4.2.6, 19.4.2.8, 19.4.2.9, 19.4.2.10, 19.4.2.11, 19.4.2.12, 19.4.2.13, 19.4.2.14
  'hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables'
).split(','), j = 0; es6Symbols.length > j;)wks(es6Symbols[j++]);

for (var wellKnownSymbols = $keys(wks.store), k = 0; wellKnownSymbols.length > k;) wksDefine(wellKnownSymbols[k++]);

$export($export.S + $export.F * !USE_NATIVE, 'Symbol', {
  // 19.4.2.1 Symbol.for(key)
  'for': function (key) {
    return has(SymbolRegistry, key += '')
      ? SymbolRegistry[key]
      : SymbolRegistry[key] = $Symbol(key);
  },
  // 19.4.2.5 Symbol.keyFor(sym)
  keyFor: function keyFor(sym) {
    if (!isSymbol(sym)) throw TypeError(sym + ' is not a symbol!');
    for (var key in SymbolRegistry) if (SymbolRegistry[key] === sym) return key;
  },
  useSetter: function () { setter = true; },
  useSimple: function () { setter = false; }
});

$export($export.S + $export.F * !USE_NATIVE, 'Object', {
  // 19.1.2.2 Object.create(O [, Properties])
  create: $create,
  // 19.1.2.4 Object.defineProperty(O, P, Attributes)
  defineProperty: $defineProperty,
  // 19.1.2.3 Object.defineProperties(O, Properties)
  defineProperties: $defineProperties,
  // 19.1.2.6 Object.getOwnPropertyDescriptor(O, P)
  getOwnPropertyDescriptor: $getOwnPropertyDescriptor,
  // 19.1.2.7 Object.getOwnPropertyNames(O)
  getOwnPropertyNames: $getOwnPropertyNames,
  // 19.1.2.8 Object.getOwnPropertySymbols(O)
  getOwnPropertySymbols: $getOwnPropertySymbols
});

// 24.3.2 JSON.stringify(value [, replacer [, space]])
$JSON && $export($export.S + $export.F * (!USE_NATIVE || $fails(function () {
  var S = $Symbol();
  // MS Edge converts symbol values to JSON as {}
  // WebKit converts symbol values to JSON as null
  // V8 throws on boxed symbols
  return _stringify([S]) != '[null]' || _stringify({ a: S }) != '{}' || _stringify(Object(S)) != '{}';
})), 'JSON', {
  stringify: function stringify(it) {
    var args = [it];
    var i = 1;
    var replacer, $replacer;
    while (arguments.length > i) args.push(arguments[i++]);
    $replacer = replacer = args[1];
    if (!isObject(replacer) && it === undefined || isSymbol(it)) return; // IE8 returns string on undefined
    if (!isArray(replacer)) replacer = function (key, value) {
      if (typeof $replacer == 'function') value = $replacer.call(this, key, value);
      if (!isSymbol(value)) return value;
    };
    args[1] = replacer;
    return _stringify.apply($JSON, args);
  }
});

// 19.4.3.4 Symbol.prototype[@@toPrimitive](hint)
$Symbol[PROTOTYPE][TO_PRIMITIVE] || __webpack_require__(25)($Symbol[PROTOTYPE], TO_PRIMITIVE, $Symbol[PROTOTYPE].valueOf);
// 19.4.3.5 Symbol.prototype[@@toStringTag]
setToStringTag($Symbol, 'Symbol');
// 20.2.1.9 Math[@@toStringTag]
setToStringTag(Math, 'Math', true);
// 24.3.3 JSON[@@toStringTag]
setToStringTag(global.JSON, 'JSON', true);


/***/ }),
/* 164 */
/***/ (function(module, exports, __webpack_require__) {

var META = __webpack_require__(51)('meta');
var isObject = __webpack_require__(20);
var has = __webpack_require__(27);
var setDesc = __webpack_require__(18).f;
var id = 0;
var isExtensible = Object.isExtensible || function () {
  return true;
};
var FREEZE = !__webpack_require__(31)(function () {
  return isExtensible(Object.preventExtensions({}));
});
var setMeta = function (it) {
  setDesc(it, META, { value: {
    i: 'O' + ++id, // object ID
    w: {}          // weak collections IDs
  } });
};
var fastKey = function (it, create) {
  // return primitive with prefix
  if (!isObject(it)) return typeof it == 'symbol' ? it : (typeof it == 'string' ? 'S' : 'P') + it;
  if (!has(it, META)) {
    // can't set metadata to uncaught frozen object
    if (!isExtensible(it)) return 'F';
    // not necessary to add metadata
    if (!create) return 'E';
    // add missing metadata
    setMeta(it);
  // return object ID
  } return it[META].i;
};
var getWeak = function (it, create) {
  if (!has(it, META)) {
    // can't set metadata to uncaught frozen object
    if (!isExtensible(it)) return true;
    // not necessary to add metadata
    if (!create) return false;
    // add missing metadata
    setMeta(it);
  // return hash weak collections IDs
  } return it[META].w;
};
// add metadata on freeze-family methods calling
var onFreeze = function (it) {
  if (FREEZE && meta.NEED && isExtensible(it) && !has(it, META)) setMeta(it);
  return it;
};
var meta = module.exports = {
  KEY: META,
  NEED: false,
  fastKey: fastKey,
  getWeak: getWeak,
  onFreeze: onFreeze
};


/***/ }),
/* 165 */
/***/ (function(module, exports, __webpack_require__) {

// all enumerable object keys, includes symbols
var getKeys = __webpack_require__(37);
var gOPS = __webpack_require__(74);
var pIE = __webpack_require__(50);
module.exports = function (it) {
  var result = getKeys(it);
  var getSymbols = gOPS.f;
  if (getSymbols) {
    var symbols = getSymbols(it);
    var isEnum = pIE.f;
    var i = 0;
    var key;
    while (symbols.length > i) if (isEnum.call(it, key = symbols[i++])) result.push(key);
  } return result;
};


/***/ }),
/* 166 */
/***/ (function(module, exports, __webpack_require__) {

// 7.2.2 IsArray(argument)
var cof = __webpack_require__(36);
module.exports = Array.isArray || function isArray(arg) {
  return cof(arg) == 'Array';
};


/***/ }),
/* 167 */
/***/ (function(module, exports, __webpack_require__) {

// fallback for IE11 buggy Object.getOwnPropertyNames with iframe and window
var toIObject = __webpack_require__(26);
var gOPN = __webpack_require__(98).f;
var toString = {}.toString;

var windowNames = typeof window == 'object' && window && Object.getOwnPropertyNames
  ? Object.getOwnPropertyNames(window) : [];

var getWindowNames = function (it) {
  try {
    return gOPN(it);
  } catch (e) {
    return windowNames.slice();
  }
};

module.exports.f = function getOwnPropertyNames(it) {
  return windowNames && toString.call(it) == '[object Window]' ? getWindowNames(it) : gOPN(toIObject(it));
};


/***/ }),
/* 168 */
/***/ (function(module, exports, __webpack_require__) {

__webpack_require__(73)('asyncIterator');


/***/ }),
/* 169 */
/***/ (function(module, exports, __webpack_require__) {

__webpack_require__(73)('observable');


/***/ }),
/* 170 */
/***/ (function(module, exports, __webpack_require__) {

__webpack_require__(99);
__webpack_require__(40);
__webpack_require__(54);
__webpack_require__(171);
__webpack_require__(178);
__webpack_require__(179);
module.exports = __webpack_require__(10).Promise;


/***/ }),
/* 171 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var LIBRARY = __webpack_require__(52);
var global = __webpack_require__(14);
var ctx = __webpack_require__(30);
var classof = __webpack_require__(75);
var $export = __webpack_require__(15);
var isObject = __webpack_require__(20);
var aFunction = __webpack_require__(49);
var anInstance = __webpack_require__(172);
var forOf = __webpack_require__(173);
var speciesConstructor = __webpack_require__(102);
var task = __webpack_require__(77).set;
var microtask = __webpack_require__(175)();
var newPromiseCapabilityModule = __webpack_require__(78);
var perform = __webpack_require__(103);
var promiseResolve = __webpack_require__(104);
var PROMISE = 'Promise';
var TypeError = global.TypeError;
var process = global.process;
var $Promise = global[PROMISE];
var isNode = classof(process) == 'process';
var empty = function () { /* empty */ };
var Internal, newGenericPromiseCapability, OwnPromiseCapability, Wrapper;
var newPromiseCapability = newGenericPromiseCapability = newPromiseCapabilityModule.f;

var USE_NATIVE = !!function () {
  try {
    // correct subclassing with @@species support
    var promise = $Promise.resolve(1);
    var FakePromise = (promise.constructor = {})[__webpack_require__(12)('species')] = function (exec) {
      exec(empty, empty);
    };
    // unhandled rejections tracking support, NodeJS Promise without it fails @@species test
    return (isNode || typeof PromiseRejectionEvent == 'function') && promise.then(empty) instanceof FakePromise;
  } catch (e) { /* empty */ }
}();

// helpers
var isThenable = function (it) {
  var then;
  return isObject(it) && typeof (then = it.then) == 'function' ? then : false;
};
var notify = function (promise, isReject) {
  if (promise._n) return;
  promise._n = true;
  var chain = promise._c;
  microtask(function () {
    var value = promise._v;
    var ok = promise._s == 1;
    var i = 0;
    var run = function (reaction) {
      var handler = ok ? reaction.ok : reaction.fail;
      var resolve = reaction.resolve;
      var reject = reaction.reject;
      var domain = reaction.domain;
      var result, then;
      try {
        if (handler) {
          if (!ok) {
            if (promise._h == 2) onHandleUnhandled(promise);
            promise._h = 1;
          }
          if (handler === true) result = value;
          else {
            if (domain) domain.enter();
            result = handler(value);
            if (domain) domain.exit();
          }
          if (result === reaction.promise) {
            reject(TypeError('Promise-chain cycle'));
          } else if (then = isThenable(result)) {
            then.call(result, resolve, reject);
          } else resolve(result);
        } else reject(value);
      } catch (e) {
        reject(e);
      }
    };
    while (chain.length > i) run(chain[i++]); // variable length - can't use forEach
    promise._c = [];
    promise._n = false;
    if (isReject && !promise._h) onUnhandled(promise);
  });
};
var onUnhandled = function (promise) {
  task.call(global, function () {
    var value = promise._v;
    var unhandled = isUnhandled(promise);
    var result, handler, console;
    if (unhandled) {
      result = perform(function () {
        if (isNode) {
          process.emit('unhandledRejection', value, promise);
        } else if (handler = global.onunhandledrejection) {
          handler({ promise: promise, reason: value });
        } else if ((console = global.console) && console.error) {
          console.error('Unhandled promise rejection', value);
        }
      });
      // Browsers should not trigger `rejectionHandled` event if it was handled here, NodeJS - should
      promise._h = isNode || isUnhandled(promise) ? 2 : 1;
    } promise._a = undefined;
    if (unhandled && result.e) throw result.v;
  });
};
var isUnhandled = function (promise) {
  return promise._h !== 1 && (promise._a || promise._c).length === 0;
};
var onHandleUnhandled = function (promise) {
  task.call(global, function () {
    var handler;
    if (isNode) {
      process.emit('rejectionHandled', promise);
    } else if (handler = global.onrejectionhandled) {
      handler({ promise: promise, reason: promise._v });
    }
  });
};
var $reject = function (value) {
  var promise = this;
  if (promise._d) return;
  promise._d = true;
  promise = promise._w || promise; // unwrap
  promise._v = value;
  promise._s = 2;
  if (!promise._a) promise._a = promise._c.slice();
  notify(promise, true);
};
var $resolve = function (value) {
  var promise = this;
  var then;
  if (promise._d) return;
  promise._d = true;
  promise = promise._w || promise; // unwrap
  try {
    if (promise === value) throw TypeError("Promise can't be resolved itself");
    if (then = isThenable(value)) {
      microtask(function () {
        var wrapper = { _w: promise, _d: false }; // wrap
        try {
          then.call(value, ctx($resolve, wrapper, 1), ctx($reject, wrapper, 1));
        } catch (e) {
          $reject.call(wrapper, e);
        }
      });
    } else {
      promise._v = value;
      promise._s = 1;
      notify(promise, false);
    }
  } catch (e) {
    $reject.call({ _w: promise, _d: false }, e); // wrap
  }
};

// constructor polyfill
if (!USE_NATIVE) {
  // 25.4.3.1 Promise(executor)
  $Promise = function Promise(executor) {
    anInstance(this, $Promise, PROMISE, '_h');
    aFunction(executor);
    Internal.call(this);
    try {
      executor(ctx($resolve, this, 1), ctx($reject, this, 1));
    } catch (err) {
      $reject.call(this, err);
    }
  };
  // eslint-disable-next-line no-unused-vars
  Internal = function Promise(executor) {
    this._c = [];             // <- awaiting reactions
    this._a = undefined;      // <- checked in isUnhandled reactions
    this._s = 0;              // <- state
    this._d = false;          // <- done
    this._v = undefined;      // <- value
    this._h = 0;              // <- rejection state, 0 - default, 1 - handled, 2 - unhandled
    this._n = false;          // <- notify
  };
  Internal.prototype = __webpack_require__(176)($Promise.prototype, {
    // 25.4.5.3 Promise.prototype.then(onFulfilled, onRejected)
    then: function then(onFulfilled, onRejected) {
      var reaction = newPromiseCapability(speciesConstructor(this, $Promise));
      reaction.ok = typeof onFulfilled == 'function' ? onFulfilled : true;
      reaction.fail = typeof onRejected == 'function' && onRejected;
      reaction.domain = isNode ? process.domain : undefined;
      this._c.push(reaction);
      if (this._a) this._a.push(reaction);
      if (this._s) notify(this, false);
      return reaction.promise;
    },
    // 25.4.5.1 Promise.prototype.catch(onRejected)
    'catch': function (onRejected) {
      return this.then(undefined, onRejected);
    }
  });
  OwnPromiseCapability = function () {
    var promise = new Internal();
    this.promise = promise;
    this.resolve = ctx($resolve, promise, 1);
    this.reject = ctx($reject, promise, 1);
  };
  newPromiseCapabilityModule.f = newPromiseCapability = function (C) {
    return C === $Promise || C === Wrapper
      ? new OwnPromiseCapability(C)
      : newGenericPromiseCapability(C);
  };
}

$export($export.G + $export.W + $export.F * !USE_NATIVE, { Promise: $Promise });
__webpack_require__(53)($Promise, PROMISE);
__webpack_require__(177)(PROMISE);
Wrapper = __webpack_require__(10)[PROMISE];

// statics
$export($export.S + $export.F * !USE_NATIVE, PROMISE, {
  // 25.4.4.5 Promise.reject(r)
  reject: function reject(r) {
    var capability = newPromiseCapability(this);
    var $$reject = capability.reject;
    $$reject(r);
    return capability.promise;
  }
});
$export($export.S + $export.F * (LIBRARY || !USE_NATIVE), PROMISE, {
  // 25.4.4.6 Promise.resolve(x)
  resolve: function resolve(x) {
    return promiseResolve(LIBRARY && this === Wrapper ? $Promise : this, x);
  }
});
$export($export.S + $export.F * !(USE_NATIVE && __webpack_require__(105)(function (iter) {
  $Promise.all(iter)['catch'](empty);
})), PROMISE, {
  // 25.4.4.1 Promise.all(iterable)
  all: function all(iterable) {
    var C = this;
    var capability = newPromiseCapability(C);
    var resolve = capability.resolve;
    var reject = capability.reject;
    var result = perform(function () {
      var values = [];
      var index = 0;
      var remaining = 1;
      forOf(iterable, false, function (promise) {
        var $index = index++;
        var alreadyCalled = false;
        values.push(undefined);
        remaining++;
        C.resolve(promise).then(function (value) {
          if (alreadyCalled) return;
          alreadyCalled = true;
          values[$index] = value;
          --remaining || resolve(values);
        }, reject);
      });
      --remaining || resolve(values);
    });
    if (result.e) reject(result.v);
    return capability.promise;
  },
  // 25.4.4.4 Promise.race(iterable)
  race: function race(iterable) {
    var C = this;
    var capability = newPromiseCapability(C);
    var reject = capability.reject;
    var result = perform(function () {
      forOf(iterable, false, function (promise) {
        C.resolve(promise).then(capability.resolve, reject);
      });
    });
    if (result.e) reject(result.v);
    return capability.promise;
  }
});


/***/ }),
/* 172 */
/***/ (function(module, exports) {

module.exports = function (it, Constructor, name, forbiddenField) {
  if (!(it instanceof Constructor) || (forbiddenField !== undefined && forbiddenField in it)) {
    throw TypeError(name + ': incorrect invocation!');
  } return it;
};


/***/ }),
/* 173 */
/***/ (function(module, exports, __webpack_require__) {

var ctx = __webpack_require__(30);
var call = __webpack_require__(100);
var isArrayIter = __webpack_require__(101);
var anObject = __webpack_require__(16);
var toLength = __webpack_require__(66);
var getIterFn = __webpack_require__(76);
var BREAK = {};
var RETURN = {};
var exports = module.exports = function (iterable, entries, fn, that, ITERATOR) {
  var iterFn = ITERATOR ? function () { return iterable; } : getIterFn(iterable);
  var f = ctx(fn, that, entries ? 2 : 1);
  var index = 0;
  var length, step, iterator, result;
  if (typeof iterFn != 'function') throw TypeError(iterable + ' is not iterable!');
  // fast case for arrays with default iterator
  if (isArrayIter(iterFn)) for (length = toLength(iterable.length); length > index; index++) {
    result = entries ? f(anObject(step = iterable[index])[0], step[1]) : f(iterable[index]);
    if (result === BREAK || result === RETURN) return result;
  } else for (iterator = iterFn.call(iterable); !(step = iterator.next()).done;) {
    result = call(iterator, f, step.value, entries);
    if (result === BREAK || result === RETURN) return result;
  }
};
exports.BREAK = BREAK;
exports.RETURN = RETURN;


/***/ }),
/* 174 */
/***/ (function(module, exports) {

// fast apply, http://jsperf.lnkit.com/fast-apply/5
module.exports = function (fn, args, that) {
  var un = that === undefined;
  switch (args.length) {
    case 0: return un ? fn()
                      : fn.call(that);
    case 1: return un ? fn(args[0])
                      : fn.call(that, args[0]);
    case 2: return un ? fn(args[0], args[1])
                      : fn.call(that, args[0], args[1]);
    case 3: return un ? fn(args[0], args[1], args[2])
                      : fn.call(that, args[0], args[1], args[2]);
    case 4: return un ? fn(args[0], args[1], args[2], args[3])
                      : fn.call(that, args[0], args[1], args[2], args[3]);
  } return fn.apply(that, args);
};


/***/ }),
/* 175 */
/***/ (function(module, exports, __webpack_require__) {

var global = __webpack_require__(14);
var macrotask = __webpack_require__(77).set;
var Observer = global.MutationObserver || global.WebKitMutationObserver;
var process = global.process;
var Promise = global.Promise;
var isNode = __webpack_require__(36)(process) == 'process';

module.exports = function () {
  var head, last, notify;

  var flush = function () {
    var parent, fn;
    if (isNode && (parent = process.domain)) parent.exit();
    while (head) {
      fn = head.fn;
      head = head.next;
      try {
        fn();
      } catch (e) {
        if (head) notify();
        else last = undefined;
        throw e;
      }
    } last = undefined;
    if (parent) parent.enter();
  };

  // Node.js
  if (isNode) {
    notify = function () {
      process.nextTick(flush);
    };
  // browsers with MutationObserver, except iOS Safari - https://github.com/zloirock/core-js/issues/339
  } else if (Observer && !(global.navigator && global.navigator.standalone)) {
    var toggle = true;
    var node = document.createTextNode('');
    new Observer(flush).observe(node, { characterData: true }); // eslint-disable-line no-new
    notify = function () {
      node.data = toggle = !toggle;
    };
  // environments with maybe non-completely correct, but existent Promise
  } else if (Promise && Promise.resolve) {
    var promise = Promise.resolve();
    notify = function () {
      promise.then(flush);
    };
  // for other environments - macrotask based on:
  // - setImmediate
  // - MessageChannel
  // - window.postMessag
  // - onreadystatechange
  // - setTimeout
  } else {
    notify = function () {
      // strange IE + webpack dev server bug - use .call(global)
      macrotask.call(global, flush);
    };
  }

  return function (fn) {
    var task = { fn: fn, next: undefined };
    if (last) last.next = task;
    if (!head) {
      head = task;
      notify();
    } last = task;
  };
};


/***/ }),
/* 176 */
/***/ (function(module, exports, __webpack_require__) {

var hide = __webpack_require__(25);
module.exports = function (target, src, safe) {
  for (var key in src) {
    if (safe && target[key]) target[key] = src[key];
    else hide(target, key, src[key]);
  } return target;
};


/***/ }),
/* 177 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var global = __webpack_require__(14);
var core = __webpack_require__(10);
var dP = __webpack_require__(18);
var DESCRIPTORS = __webpack_require__(21);
var SPECIES = __webpack_require__(12)('species');

module.exports = function (KEY) {
  var C = typeof core[KEY] == 'function' ? core[KEY] : global[KEY];
  if (DESCRIPTORS && C && !C[SPECIES]) dP.f(C, SPECIES, {
    configurable: true,
    get: function () { return this; }
  });
};


/***/ }),
/* 178 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
// https://github.com/tc39/proposal-promise-finally

var $export = __webpack_require__(15);
var core = __webpack_require__(10);
var global = __webpack_require__(14);
var speciesConstructor = __webpack_require__(102);
var promiseResolve = __webpack_require__(104);

$export($export.P + $export.R, 'Promise', { 'finally': function (onFinally) {
  var C = speciesConstructor(this, core.Promise || global.Promise);
  var isFunction = typeof onFinally == 'function';
  return this.then(
    isFunction ? function (x) {
      return promiseResolve(C, onFinally()).then(function () { return x; });
    } : onFinally,
    isFunction ? function (e) {
      return promiseResolve(C, onFinally()).then(function () { throw e; });
    } : onFinally
  );
} });


/***/ }),
/* 179 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";

// https://github.com/tc39/proposal-promise-try
var $export = __webpack_require__(15);
var newPromiseCapability = __webpack_require__(78);
var perform = __webpack_require__(103);

$export($export.S, 'Promise', { 'try': function (callbackfn) {
  var promiseCapability = newPromiseCapability.f(this);
  var result = perform(callbackfn);
  (result.e ? promiseCapability.reject : promiseCapability.resolve)(result.v);
  return promiseCapability.promise;
} });


/***/ }),
/* 180 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__globals__ = __webpack_require__(8);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__utils_context_performance_hook__ = __webpack_require__(111);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__base_renderer__ = __webpack_require__(112);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__utils_canvas_render_target__ = __webpack_require__(57);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__managers_canvas_filter_manager__ = __webpack_require__(81);





var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */







var RendererType = __WEBPACK_IMPORTED_MODULE_4__globals__["c" /* Constants */].RendererType;

/**
 * The renderer that is used for Canvas2D rendering
 * @class
 * @extends PhotoEditorSDK.Engine.BaseRenderer
 * @memberof PhotoEditorSDK.Engine
 */

var CanvasRenderer = function (_BaseRenderer) {
  _inherits(CanvasRenderer, _BaseRenderer);

  /**
   * Creates a CanvasRenderer
   * @override
   */
  function CanvasRenderer() {
    var _ref;

    _classCallCheck(this, CanvasRenderer);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this = _possibleConstructorReturn(this, (_ref = CanvasRenderer.__proto__ || __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default()(CanvasRenderer)).call.apply(_ref, [this].concat(args)));

    _this._type = RendererType.CANVAS;

    _this.setCanvas(_this._options.canvas || _this._createCanvas());
    return _this;
  }

  /**
   * Creates a canvas element
   * @return {Canvas}
   * @private
   */


  _createClass(CanvasRenderer, [{
    key: '_createCanvas',
    value: function _createCanvas() {
      return __WEBPACK_IMPORTED_MODULE_4__globals__["i" /* Utils */].createCanvas();
    }

    /**
     * Gets the rendering context for this renderer
     * @returns {Object}
     * @private
     */

  }, {
    key: '_createContext',
    value: function _createContext() {
      var canvas = this._canvas;
      var ctx = canvas.getContext('2d');

      if (this._options.debug) {
        ctx = new __WEBPACK_IMPORTED_MODULE_5__utils_context_performance_hook__["a" /* default */](ctx);
      }

      this.id = ctx.id = CanvasRenderer.contextId++;
      this._context = ctx;
      ctx.renderer = this;

      this.emit('context', ctx);

      return ctx;
    }

    /**
     * Sets up the rendering context for this renderer
     * @private
     */

  }, {
    key: '_setupContext',
    value: function _setupContext() {
      var ctx = this._context;

      // Enable image smoothing if available
      if (!('imageSmoothingEnabled' in ctx)) {
        ['moz', 'webkit', 'ms'].forEach(function (prop) {
          if (ctx[prop]) {
            ctx[prop] = true;
          }
        });
      } else {
        ctx.imageSmoothingEnabled = true;
      }

      this._defaultRenderTarget = new __WEBPACK_IMPORTED_MODULE_7__utils_canvas_render_target__["a" /* default */](this._width, this._height, this._pixelRatio, this._canvas, this._context);
      this.setRenderTarget(this._defaultRenderTarget);

      this._filterManager = new __WEBPACK_IMPORTED_MODULE_8__managers_canvas_filter_manager__["a" /* default */](this);
    }

    /**
     * Renders the given DisplayObject
     * @param  {PhotoEditorSDK.Engine.DisplayObject} displayObject
     */

  }, {
    key: 'render',
    value: function render(displayObject) {
      var ctx = this._renderTarget.getContext();

      // Since the given displayObject is the "root" object
      // right now, we need to give it a dummy / fake object
      // as parent with the default world transform and alpha
      var originalParent = displayObject.getParent();
      displayObject.setParent(this._fakeObject);

      // Update transforms and render this object
      displayObject.updateTransform();

      // Reset parent
      displayObject.setParent(originalParent);

      // Reset transform
      ctx.setTransform(1, 0, 0, 1, 0, 0);

      // Reset alpha
      ctx.globalAlpha = 1;

      // Clear the view
      var _canvas = this._canvas,
          width = _canvas.width,
          height = _canvas.height;

      ctx.clearRect(0, 0, width, height);
      if (this._clearColor.a !== 0) {
        ctx.save();
        ctx.fillStyle = this._clearColor.toRGBA();
        ctx.fillRect(0, 0, width, height);
        ctx.restore();
      }

      this.renderDisplayObject(displayObject, this._renderTarget);
    }

    /**
     * Renders the given DisplayObject
     * @param  {PhotoEditorSDK.Engine.DisplayObject} displayObject
     * @param  {PhotoEditorSDK.Engine.RenderTarget} renderTarget
     */

  }, {
    key: 'renderDisplayObject',
    value: function renderDisplayObject(displayObject, renderTarget) {
      var originalRenderTarget = this._renderTarget;
      this._filterManager.setFilterStack(renderTarget.getFilterStack());
      this.setRenderTarget(renderTarget);
      displayObject.renderCanvas(this);
      this.setRenderTarget(originalRenderTarget);
    }

    /**
     * Returns the current render target
     * @return {PhotoEditorSDK.Engine.RenderTarget}
     */

  }, {
    key: 'getCurrentRenderTarget',
    value: function getCurrentRenderTarget() {
      return this._renderTarget;
    }

    /**
     * Sets the render target
     * @param {PhotoEditorSDK.Engine.RenderTarget} renderTarget
     */

  }, {
    key: 'setRenderTarget',
    value: function setRenderTarget(renderTarget) {
      this._renderTarget = renderTarget;
    }

    /**
     * Returns the current rendering context
     * @return {RenderingContext}
     */

  }, {
    key: 'getContext',
    value: function getContext() {
      return this._renderTarget.getContext();
    }

    /**
     * Disposes this Renderer
     */

  }, {
    key: 'dispose',
    value: function dispose() {
      this._filterManager.dispose();
    }
  }]);

  return CanvasRenderer;
}(__WEBPACK_IMPORTED_MODULE_6__base_renderer__["a" /* default */]);

CanvasRenderer.contextId = 0;
CanvasRenderer.type = 'Canvas2D';

/* harmony default export */ __webpack_exports__["a"] = (CanvasRenderer);

/***/ }),
/* 181 */
/***/ (function(module, exports, __webpack_require__) {

__webpack_require__(54);
__webpack_require__(40);
module.exports = __webpack_require__(182);


/***/ }),
/* 182 */
/***/ (function(module, exports, __webpack_require__) {

var classof = __webpack_require__(75);
var ITERATOR = __webpack_require__(12)('iterator');
var Iterators = __webpack_require__(32);
module.exports = __webpack_require__(10).isIterable = function (it) {
  var O = Object(it);
  return O[ITERATOR] !== undefined
    || '@@iterator' in O
    // eslint-disable-next-line no-prototype-builtins
    || Iterators.hasOwnProperty(classof(O));
};


/***/ }),
/* 183 */
/***/ (function(module, exports, __webpack_require__) {

__webpack_require__(54);
__webpack_require__(40);
module.exports = __webpack_require__(184);


/***/ }),
/* 184 */
/***/ (function(module, exports, __webpack_require__) {

var anObject = __webpack_require__(16);
var get = __webpack_require__(76);
module.exports = __webpack_require__(10).getIterator = function (it) {
  var iterFn = get(it);
  if (typeof iterFn != 'function') throw TypeError(it + ' is not iterable!');
  return anObject(iterFn.call(it));
};


/***/ }),
/* 185 */
/***/ (function(module, exports, __webpack_require__) {

__webpack_require__(186);
module.exports = __webpack_require__(10).Object.assign;


/***/ }),
/* 186 */
/***/ (function(module, exports, __webpack_require__) {

// 19.1.3.1 Object.assign(target, source)
var $export = __webpack_require__(15);

$export($export.S + $export.F, 'Object', { assign: __webpack_require__(187) });


/***/ }),
/* 187 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";

// 19.1.2.1 Object.assign(target, source, ...)
var getKeys = __webpack_require__(37);
var gOPS = __webpack_require__(74);
var pIE = __webpack_require__(50);
var toObject = __webpack_require__(38);
var IObject = __webpack_require__(92);
var $assign = Object.assign;

// should work with symbols and should have deterministic property order (V8 bug)
module.exports = !$assign || __webpack_require__(31)(function () {
  var A = {};
  var B = {};
  // eslint-disable-next-line no-undef
  var S = Symbol();
  var K = 'abcdefghijklmnopqrst';
  A[S] = 7;
  K.split('').forEach(function (k) { B[k] = k; });
  return $assign({}, A)[S] != 7 || Object.keys($assign({}, B)).join('') != K;
}) ? function assign(target, source) { // eslint-disable-line no-unused-vars
  var T = toObject(target);
  var aLen = arguments.length;
  var index = 1;
  var getSymbols = gOPS.f;
  var isEnum = pIE.f;
  while (aLen > index) {
    var S = IObject(arguments[index++]);
    var keys = getSymbols ? getKeys(S).concat(getSymbols(S)) : getKeys(S);
    var length = keys.length;
    var j = 0;
    var key;
    while (length > j) if (isEnum.call(S, key = keys[j++])) T[key] = S[key];
  } return T;
} : $assign;


/***/ }),
/* 188 */
/***/ (function(module, exports, __webpack_require__) {

module.exports = { "default": __webpack_require__(189), __esModule: true };

/***/ }),
/* 189 */
/***/ (function(module, exports, __webpack_require__) {

__webpack_require__(40);
__webpack_require__(190);
module.exports = __webpack_require__(10).Array.from;


/***/ }),
/* 190 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var ctx = __webpack_require__(30);
var $export = __webpack_require__(15);
var toObject = __webpack_require__(38);
var call = __webpack_require__(100);
var isArrayIter = __webpack_require__(101);
var toLength = __webpack_require__(66);
var createProperty = __webpack_require__(191);
var getIterFn = __webpack_require__(76);

$export($export.S + $export.F * !__webpack_require__(105)(function (iter) { Array.from(iter); }), 'Array', {
  // 22.1.2.1 Array.from(arrayLike, mapfn = undefined, thisArg = undefined)
  from: function from(arrayLike /* , mapfn = undefined, thisArg = undefined */) {
    var O = toObject(arrayLike);
    var C = typeof this == 'function' ? this : Array;
    var aLen = arguments.length;
    var mapfn = aLen > 1 ? arguments[1] : undefined;
    var mapping = mapfn !== undefined;
    var index = 0;
    var iterFn = getIterFn(O);
    var length, result, step, iterator;
    if (mapping) mapfn = ctx(mapfn, aLen > 2 ? arguments[2] : undefined, 2);
    // if object isn't iterable or it's array with default iterator - use simple case
    if (iterFn != undefined && !(C == Array && isArrayIter(iterFn))) {
      for (iterator = iterFn.call(O), result = new C(); !(step = iterator.next()).done; index++) {
        createProperty(result, index, mapping ? call(iterator, mapfn, [step.value, index], true) : step.value);
      }
    } else {
      length = toLength(O.length);
      for (result = new C(length); length > index; index++) {
        createProperty(result, index, mapping ? mapfn(O[index], index) : O[index]);
      }
    }
    result.length = index;
    return result;
  }
});


/***/ }),
/* 191 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var $defineProperty = __webpack_require__(18);
var createDesc = __webpack_require__(35);

module.exports = function (object, index, value) {
  if (index in object) $defineProperty.f(object, index, createDesc(0, value));
  else object[index] = value;
};


/***/ }),
/* 192 */
/***/ (function(module, exports, __webpack_require__) {

__webpack_require__(193);
module.exports = __webpack_require__(10).Object.keys;


/***/ }),
/* 193 */
/***/ (function(module, exports, __webpack_require__) {

// 19.1.2.14 Object.keys(O)
var toObject = __webpack_require__(38);
var $keys = __webpack_require__(37);

__webpack_require__(71)('keys', function () {
  return function keys(it) {
    return $keys(toObject(it));
  };
});


/***/ }),
/* 194 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */

/**
 * A couple of utility functions
 * @type {Object}
 */
var Utils = {
  /**
   * Assigns own enumerable properties of source object(s) to the destination
   * object for all destination properties that resolve to undefined. Once a
   * property is set, additional values of the same property are ignored.
   * @param  {Object} object
   * @param  {Object} ...sources
   * @return {Object}
   */
  defaults: function defaults(object) {
    for (var _len = arguments.length, sources = Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
      sources[_key - 1] = arguments[_key];
    }

    // Shallow clone
    var newObject = {};
    for (var key in object) {
      newObject[key] = object[key];
    }

    // Clone sources
    for (var i = 0; i < sources.length; i++) {
      var source = sources[i];
      for (var _key2 in source) {
        if (typeof newObject[_key2] === 'undefined') {
          newObject[_key2] = source[_key2];
        }
      }
    }

    return newObject;
  },

  /**
   * Assigns own enumerable properties of source object(s) to the destination
   * object. Subsequent sources overwrite property assignments of previous
   * sources.
   * @param {Object} object
   * @param {Object} ...sources
   * @return {Object}
   */
  extend: function extend(object) {
    for (var _len2 = arguments.length, sources = Array(_len2 > 1 ? _len2 - 1 : 0), _key3 = 1; _key3 < _len2; _key3++) {
      sources[_key3 - 1] = arguments[_key3];
    }

    // Shallow clone
    var newObject = {};
    for (var key in object) {
      newObject[key] = object[key];
    }

    // Extend sources
    for (var i = 0; i < sources.length; i++) {
      var source = sources[i];
      for (var _key4 in source) {
        newObject[_key4] = source[_key4];
      }
    }

    return newObject;
  }
};

/* harmony default export */ __webpack_exports__["a"] = (Utils);

/***/ }),
/* 195 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor__ = __webpack_require__(7);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__globals__ = __webpack_require__(8);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__base_renderer__ = __webpack_require__(112);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__utils_webgl_render_target__ = __webpack_require__(58);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__object_renderers_object_renderer__ = __webpack_require__(113);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9__object_renderers_sprite_renderer__ = __webpack_require__(198);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10__shaders_texture_shader__ = __webpack_require__(82);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_11__display_display_object__ = __webpack_require__(84);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_12__managers_webgl_filter_manager__ = __webpack_require__(85);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_13__utils_context_performance_hook__ = __webpack_require__(111);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_14__utils_pixel_array_image__ = __webpack_require__(114);






var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor___default()(object, property); if (desc === undefined) { var parent = __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if ("value" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* global WEBPACK */
/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */












var RendererType = __WEBPACK_IMPORTED_MODULE_5__globals__["c" /* Constants */].RendererType;

// For server-side environments

var Canvas = __webpack_require__(19);
var NodeCanvasImage = typeof Canvas !== 'undefined' ? Canvas.Image : undefined;

/**
 * The renderer that is used for WebGL rendering
 * @class
 * @extends PhotoEditorSDK.Engine.BaseRenderer
 * @memberof PhotoEditorSDK.Engine
 */
/* istanbul ignore next */

var WebGLRenderer = function (_BaseRenderer) {
  _inherits(WebGLRenderer, _BaseRenderer);

  /**
   * Creates a WebGLRenderer
   * @override
   */
  function WebGLRenderer() {
    var _ref;

    _classCallCheck(this, WebGLRenderer);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this = _possibleConstructorReturn(this, (_ref = WebGLRenderer.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(WebGLRenderer)).call.apply(_ref, [this].concat(args)));

    _this._type = RendererType.WEBGL;

    _this._textures = [];
    _this._fakeObject = new __WEBPACK_IMPORTED_MODULE_11__display_display_object__["a" /* default */]();
    _this._onContextLost = _this._onContextLost.bind(_this);
    _this._onContextRestored = _this._onContextRestored.bind(_this);

    _this.setCanvas(_this._options.canvas || __WEBPACK_IMPORTED_MODULE_5__globals__["i" /* Utils */].createCanvas());

    _this.shaders = _this._initShaders();
    _this.renderers = _this._initRenderers();
    return _this;
  }

  // -------------------------------------------------------------------------- CONTEXT LOSS

  /**
   * Gets called when the WebGL context has been lost
   * @param  {Event} e
   * @private
   */


  _createClass(WebGLRenderer, [{
    key: '_onContextLost',
    value: function _onContextLost(e) {
      e.preventDefault();
      __WEBPACK_IMPORTED_MODULE_5__globals__["f" /* Log */].warn(this.constructor.name, 'WebGL context has been lost - trying to restore.');
    }

    /**
     * Gets called when the WebGL context could not be created
     * @param  {Object} e
     * @private
     */

  }, {
    key: '_onContextCreationError',
    value: function _onContextCreationError(e) {
      e.preventDefault();
      __WEBPACK_IMPORTED_MODULE_5__globals__["f" /* Log */].warn(this.constructor.name, 'Failed to create WebGL context: ' + (e.statusMessage || 'Unknown error'));
    }

    /**
     * Gets called when the WebGL context has been restored. Cleans up and resets everything.
     * @private
     */

  }, {
    key: '_onContextRestored',
    value: function _onContextRestored() {
      var _this2 = this;

      __WEBPACK_IMPORTED_MODULE_5__globals__["f" /* Log */].warn(this.constructor.name, 'WebGL context has been restored. Clearing all textures.');

      this._textures.forEach(function (texture) {
        texture.disposeGLTexturesForRenderer(_this2);
      });

      this._createContext();
      this._setupContext();
      this.emit('context-restored');
    }

    /**
     * Gets called before the context has been set up
     * @private
     */

  }, {
    key: '_onBeforeContext',
    value: function _onBeforeContext() {
      if (this._filterManager) {
        this._filterManager.dispose();
      }
      this._filterManager = new __WEBPACK_IMPORTED_MODULE_12__managers_webgl_filter_manager__["a" /* default */](this);
      this._currentObjectRenderer = new __WEBPACK_IMPORTED_MODULE_8__object_renderers_object_renderer__["a" /* default */](this);
    }

    /**
     * Sets the given shader to active
     * @param {PhotoEditorSDK.Engine.Shader} shader
     */

  }, {
    key: 'setShader',
    value: function setShader(shader) {
      this._currentShader = shader;
      this._context.useProgram(shader.getProgram());
      this._setAttributesForShader(shader);
    }

    /**
     * Sets the canvas to the given one
     * @param {HTMLCanvasElement} canvas
     */

  }, {
    key: 'setCanvas',
    value: function setCanvas(canvas) {
      if (this._canvas) {
        this._removeContextEventListeners();
      }

      _get(WebGLRenderer.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(WebGLRenderer.prototype), 'setCanvas', this).call(this, canvas);

      if (this._canvas.addEventListener) {
        // node-canvas doesn't have events
        this._addContextEventListeners();
      }
    }

    /**
     * Adds the context lost / restored / creation error event handlers
     * @private
     */

  }, {
    key: '_addContextEventListeners',
    value: function _addContextEventListeners() {
      this._canvas.addEventListener('webglcontextlost', this._onContextLost);
      this._canvas.addEventListener('webglcontextrestored', this._onContextRestored);
      this._canvas.addEventListener('webglcontextcreationerror', this._onContextCreationError);
    }

    /**
     * Removes the context lost / restored / creation error event handlers
     * @private
     */

  }, {
    key: '_removeContextEventListeners',
    value: function _removeContextEventListeners() {
      this._canvas.removeEventListener('webglcontextlost', this._onContextLost);
      this._canvas.removeEventListener('webglcontextrestored', this._onContextRestored);
      this._canvas.removeEventListener('webglcontextcreationerror', this._onContextCreationError);
    }

    /**
     * Uploads the given shader's attributes to the GPU
     * @param {PhotoEditorSDK.Engine.Shader} shader
     */

  }, {
    key: '_setAttributesForShader',
    value: function _setAttributesForShader(shader) {
      var gl = this._context;
      var attributes = shader.getAttributes();
      var attributeLocations = shader.getAttributeLocations();

      attributes.forEach(function (attributeName) {
        var attributeLocation = attributeLocations[attributeName];
        gl.enableVertexAttribArray(attributeLocation);
      });
    }

    /**
     * Initializes the default shaders
     * @return {Object}
     * @private
     */

  }, {
    key: '_initShaders',
    value: function _initShaders() {
      return {
        default: new __WEBPACK_IMPORTED_MODULE_10__shaders_texture_shader__["a" /* default */](this)
      };
    }

    /**
     * Initializes the available object renderers
     * @return {Object}
     * @private
     */

  }, {
    key: '_initRenderers',
    value: function _initRenderers() {
      return {
        sprite: new __WEBPACK_IMPORTED_MODULE_9__object_renderers_sprite_renderer__["a" /* default */](this)
      };
    }

    /**
     * Gets the rendering context for this renderer
     * @returns {Object}
     * @private
     */

  }, {
    key: '_createContext',
    value: function _createContext() {
      var canvas = this._canvas;
      var gl = null;

      var contextOptions = {
        preserveDrawingBuffer: true
        // If node-gl is available, use it for context creation. This allows us
        // to render images on the server-side with hardware accelerated graphics
      };var createContext = __webpack_require__(115);
      gl = createContext(canvas.width, canvas.height, contextOptions);

      // Hook up WebGLDebugUtils if present
      if (typeof window !== 'undefined' && window.WebGLDebugUtils && this._options.debug) {
        var logGL = function logGL(functionName, args) {
          console.error('gl.' + functionName + '(' + window.WebGLDebugUtils.glFunctionArgsToString(functionName, args) + ')');
        };
        gl = window.WebGLDebugUtils.makeDebugContext(gl, null, logGL);
      }

      // Hook up ContextPerformanceHook if debug is enabled
      if (this._options.debug) {
        gl = new __WEBPACK_IMPORTED_MODULE_13__utils_context_performance_hook__["a" /* default */](gl);
      }

      this.id = gl.id = WebGLRenderer.contextId++;
      this._context = gl;
      gl.renderer = this;

      this._maxTextureSize = gl.getParameter(gl.MAX_TEXTURE_SIZE);

      this.emit('context', gl);

      return gl;
    }

    /**
     * Sets up the rendering context for this renderer
     * @private
     */

  }, {
    key: '_setupContext',
    value: function _setupContext() {
      var gl = this._context;

      gl.disable(gl.DEPTH_TEST);
      gl.disable(gl.CULL_FACE);
      gl.enable(gl.BLEND);
      gl.blendFunc(gl.ONE, gl.ONE_MINUS_SRC_ALPHA);

      this._defaultRenderTarget = new __WEBPACK_IMPORTED_MODULE_7__utils_webgl_render_target__["a" /* default */](this, this._width, this._height, this._pixelRatio, true);
      this.setRenderTarget(this._defaultRenderTarget);
      this._getMaxPrecision();
    }

    /**
     * Finds the maximum int / float precision for this device
     * @private
     */

  }, {
    key: '_getMaxPrecision',
    value: function _getMaxPrecision() {
      var gl = this._context;
      var highFloat = gl.getShaderPrecisionFormat(gl.FRAGMENT_SHADER, gl.HIGH_FLOAT);
      this._maxFloatPrecision = highFloat.precision !== 0 ? 'highp' : 'mediump';

      var highInt = gl.getShaderPrecisionFormat(gl.FRAGMENT_SHADER, gl.HIGH_INT);
      this._maxIntPrecision = highInt.rangeMax !== 0 ? 'highp' : 'lowp';
    }

    /**
     * Resizes the context and view to the given size
     * @param  {PhotoEditorSDK.Math.Vector2} dimensions
     * @param  {Boolean} resizeCanvas = true
     */

  }, {
    key: 'resizeTo',
    value: function resizeTo(dimensions) {
      var resizeCanvas = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;

      _get(WebGLRenderer.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(WebGLRenderer.prototype), 'resizeTo', this).call(this, dimensions, resizeCanvas);

      if (this._currentRenderTarget) {
        this._currentRenderTarget.resizeTo(dimensions);
      }

      this._context.resize(dimensions.x, dimensions.y);
    }

    /**
     * Sets the current render target to the passed one and activates
     * it for rendering
     * @param {PhotoEditorSDK.Engine.RenderTarget} renderTarget
     */

  }, {
    key: 'setRenderTarget',
    value: function setRenderTarget() {
      var renderTarget = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this._defaultRenderTarget;

      this._currentRenderTarget = renderTarget;
      this._currentRenderTarget.activate();
    }

    /**
     * Sets the current object renderer to the given one
     * @param {PhotoEditorSDK.Engine.ObjectRenderer} objectRenderer
     */

  }, {
    key: 'setObjectRenderer',
    value: function setObjectRenderer(objectRenderer) {
      this._currentObjectRenderer.stop();
      this._currentObjectRenderer = objectRenderer;
      this._currentObjectRenderer.start();
    }

    /**
     * Renders the given DisplayObject
     * @param  {PhotoEditorSDK.Engine.DisplayObject} displayObject
     */

  }, {
    key: 'render',
    value: function render(displayObject) {
      this.setRenderTarget(this._defaultRenderTarget);
      this._defaultRenderTarget.clear(this._clearColor);

      // Since the given displayObject is the "root" object
      // right now, we need to give it a dummy / fake object
      // as parent with the default world transform and alpha
      var originalParent = displayObject.getParent();
      displayObject.setParent(this._fakeObject);

      // Update transforms and render this object
      displayObject.updateTransform();

      // Reset parent
      displayObject.setParent(originalParent);

      this.renderDisplayObject(displayObject, this._defaultRenderTarget);
    }

    /**
     * Renders the given DisplayObject
     * @param  {PhotoEditorSDK.Engine.DisplayObject} displayObject
     * @param  {PhotoEditorSDK.Engine.RenderTarget} renderTarget
     */

  }, {
    key: 'renderDisplayObject',
    value: function renderDisplayObject(displayObject, renderTarget) {
      this.setRenderTarget(renderTarget);
      this._filterManager.setFilterStack(renderTarget.getFilterStack());
      displayObject.renderWebGL(this);
      this._currentObjectRenderer.flush();
    }

    /**
     * Clears the context
     */

  }, {
    key: 'clear',
    value: function clear() {
      var gl = this._context;

      gl.clearColor.apply(gl, this._clearColor.toGLColor());
      gl.clear(gl.COLOR_BUFFER_BIT);
    }

    /**
     * Saves the renderer state and returns the state object
     * @return {Object}
     */

  }, {
    key: 'save',
    value: function save() {
      return {
        renderTarget: this._currentRenderTarget,
        objectRenderer: this._currentObjectRenderer,
        filterStack: this._filterManager.getFilterStack()
      };
    }

    /**
     * Restores the given renderer state
     * @param  {Object} save
     */

  }, {
    key: 'restore',
    value: function restore(save) {
      this.setRenderTarget(save.renderTarget);
      this._filterManager.setFilterStack(save.filterStack);
      this._currentObjectRenderer = save.objectRenderer;
    }

    /**
     * Returns and/or creates a WebGLTexture for the given BaseTexture object
     * @param  {PhotoEditorSDK.Engine.BaseTexture} texture
     * @return {PhotoEditorSDK.Engine.WebGLTexture}
     */

  }, {
    key: 'getOrCreateGLTexture',
    value: function getOrCreateGLTexture(texture) {
      var gl = this._context;

      var glTexture = texture.getGLTextureForRenderer(this);
      if (!glTexture) {
        glTexture = gl.createTexture();
        texture.setGLTextureForRenderer(glTexture, this);

        // Hold reference to texture for easier disposal
        this._textures.push(texture);
      }

      return glTexture;
    }

    /**
     * Updates the given texture
     * @param  {PhotoEditorSDK.Engine.BaseTexture} texture
     * @param  {Boolean} [upload = true]
     */

  }, {
    key: 'updateTexture',
    value: function updateTexture(texture) {
      var upload = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;

      var source = texture.getSource();
      var hasSource = !!source;

      var gl = this._context;
      var glUnit = texture.getGLUnit();
      var glTexture = this.getOrCreateGLTexture(texture);

      gl.activeTexture(gl.TEXTURE0 + glUnit);
      gl.bindTexture(gl.TEXTURE_2D, glTexture);

      gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, true);

      if (upload && hasSource) {
        if (typeof WEBPACK === 'undefined') {
          if (source instanceof NodeCanvasImage || source instanceof Canvas.Canvas) {
            source = __WEBPACK_IMPORTED_MODULE_14__utils_pixel_array_image__["a" /* default */].fromNodeCanvasImage(source);
          }

          // Upload the PixelArrayImage's data (a Uint8Array)
          gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, source.width, source.height, 0, gl.RGBA, gl.UNSIGNED_BYTE, source.data);
        } else {
          if (source instanceof __WEBPACK_IMPORTED_MODULE_14__utils_pixel_array_image__["a" /* default */]) {
            gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, source.width, source.height, 0, gl.RGBA, gl.UNSIGNED_BYTE, source.data);
          } else {
            gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, source);
          }
        }
      }

      if (texture.isMipMappingEnabled()) {
        gl.generateMipmap(gl.TEXTURE_2D);
      } else {
        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, texture.getGLRepeat(gl, 'x'));
        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, texture.getGLRepeat(gl, 'y'));
      }
      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, texture.getGLFilter(gl, 'min'));
      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, texture.getGLFilter(gl, 'mag'));
      gl.activeTexture(gl.TEXTURE0);
    }

    /**
     * Returns the maximum dimensions
     * @return {Number}
     */

  }, {
    key: 'getMaxDimensions',
    value: function getMaxDimensions() {
      // node-gl support
      if (typeof WEBPACK === 'undefined') {
        var createContext = __webpack_require__(115);
        var gl = createContext(1, 1);
        return gl.getParameter(gl.MAX_TEXTURE_SIZE);
      } else {
        var canvas = __WEBPACK_IMPORTED_MODULE_5__globals__["i" /* Utils */].createCanvas();
        var _gl = canvas.getContext('webgl') || canvas.getContext('experimental-webgl');
        if (!_gl) {
          return null;
        } else {
          var maxTextureSize = _gl.getParameter(_gl.MAX_TEXTURE_SIZE);
          var loseContextExtension = _gl.getExtension('WEBGL_lose_context');
          if (loseContextExtension) {
            loseContextExtension.loseContext();
          }
          return maxTextureSize;
        }
      }
    }

    /**
     * Returns the current render target
     * @return {PhotoEditorSDK.Engine.RenderTarget}
     */

  }, {
    key: 'getCurrentRenderTarget',
    value: function getCurrentRenderTarget() {
      return this._currentRenderTarget;
    }

    /**
     * Returns the current object renderer
     * @return {PhotoEditorSDK.Engine.ObjectRenderer}
     */

  }, {
    key: 'getCurrentObjectRenderer',
    value: function getCurrentObjectRenderer() {
      return this._currentObjectRenderer;
    }

    /**
     * Checks if this renderer is supported on the current device and browser
     * @return {Boolean}
     */

  }, {
    key: 'getMaxFloatPrecision',


    /**
     * Returns the maximum float precision for this device (lowp/mediump/highp)
     * @return {String}
     */
    value: function getMaxFloatPrecision() {
      return this._maxFloatPrecision;
    }

    /**
     * Returns the maximum int precision for this device (lowp/mediump/highp)
     * @return {String}
     */

  }, {
    key: 'getMaxIntPrecision',
    value: function getMaxIntPrecision() {
      return this._maxIntPrecision;
    }

    /**
     * Disposes this Renderer
     */

  }, {
    key: 'dispose',
    value: function dispose() {
      var _this3 = this;

      this._filterManager.dispose();
      this._currentObjectRenderer.dispose();
      this._defaultRenderTarget.dispose();
      this._textures.forEach(function (texture) {
        texture.disposeGLTexturesForRenderer(_this3);
      });
      for (var shader in this.shaders) {
        this.shaders[shader].dispose();
        delete this.shaders[shader];
      }

      this._removeContextEventListeners();

      var gl = this._context;
      var loseContextExtension = gl.getExtension('WEBGL_lose_context');
      if (loseContextExtension) {
        loseContextExtension.loseContext();
      }
    }
  }], [{
    key: 'isSupported',
    value: function isSupported() {
      if (typeof WEBPACK === 'undefined') {
        return true;
      } else {
        var canvas = __WEBPACK_IMPORTED_MODULE_5__globals__["i" /* Utils */].createCanvas();
        canvas.addEventListener('webglcontextcreationerror', this.prototype._onContextCreationError);
        var gl = canvas.getContext('webgl') || canvas.getContext('experimental-webgl');
        canvas.removeEventListener('webglcontextcreationerror', this.prototype._onContextCreationError);
        return !!gl;
      }
    }
  }]);

  return WebGLRenderer;
}(__WEBPACK_IMPORTED_MODULE_6__base_renderer__["a" /* default */]);

WebGLRenderer.contextId = 0;
WebGLRenderer.type = 'WebGL';

/* harmony default export */ __webpack_exports__["a"] = (WebGLRenderer);

/***/ }),
/* 196 */
/***/ (function(module, exports, __webpack_require__) {

__webpack_require__(197);
var $Object = __webpack_require__(10).Object;
module.exports = function getOwnPropertyDescriptor(it, key) {
  return $Object.getOwnPropertyDescriptor(it, key);
};


/***/ }),
/* 197 */
/***/ (function(module, exports, __webpack_require__) {

// 19.1.2.6 Object.getOwnPropertyDescriptor(O, P)
var toIObject = __webpack_require__(26);
var $getOwnPropertyDescriptor = __webpack_require__(63).f;

__webpack_require__(71)('getOwnPropertyDescriptor', function () {
  return function getOwnPropertyDescriptor(it, key) {
    return $getOwnPropertyDescriptor(toIObject(it), key);
  };
});


/***/ }),
/* 198 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor__ = __webpack_require__(7);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__globals__ = __webpack_require__(8);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__object_renderer__ = __webpack_require__(113);






var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor___default()(object, property); if (desc === undefined) { var parent = __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if ("value" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* eslint constructor-super: 0 */
/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




/**
 * The ObjectRenderer that is responsible for rendering Sprite instances
 * @class
 * @extends PhotoEditorSDK.Engine.ObjectRenderer
 * @memberof PhotoEditorSDK.Engine
 */
/* istanbul ignore next */

var SpriteRenderer = function (_ObjectRenderer) {
  _inherits(SpriteRenderer, _ObjectRenderer);

  /**
   * Creates a SpriteRenderer
   * @override
   */
  function SpriteRenderer() {
    var _ref;

    _classCallCheck(this, SpriteRenderer);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this = _possibleConstructorReturn(this, (_ref = SpriteRenderer.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(SpriteRenderer)).call.apply(_ref, [this].concat(args)));

    _this._maxBatchSize = __WEBPACK_IMPORTED_MODULE_5__globals__["a" /* BATCH_SIZE */];
    _this._vertices = new ArrayBuffer(__WEBPACK_IMPORTED_MODULE_5__globals__["a" /* BATCH_SIZE */] * 4 * __WEBPACK_IMPORTED_MODULE_5__globals__["j" /* VERTEX_BYTE_SIZE */]);
    _this._positions = new Float32Array(_this._vertices);
    _this._colors = new Uint32Array(_this._vertices);
    _this._indices = new Uint16Array(__WEBPACK_IMPORTED_MODULE_5__globals__["a" /* BATCH_SIZE */] * 6);

    // Fill vertex position indices
    for (var i = 0, j = 0; i < __WEBPACK_IMPORTED_MODULE_5__globals__["a" /* BATCH_SIZE */] * 6; i += 6, j += 4) {
      _this._indices[i + 0] = j + 0;
      _this._indices[i + 1] = j + 1;
      _this._indices[i + 2] = j + 2;
      _this._indices[i + 3] = j + 0;
      _this._indices[i + 4] = j + 2;
      _this._indices[i + 5] = j + 3;
    }

    _this._shaders = [];
    _this._sprites = [];

    _this._currentBatchSize = 0;
    _this._currentBaseTexture = null;

    _this._onContextChange();
    return _this;
  }

  /**
   * Adds the given sprite to the batch
   * @param  {PhotoEditorSDK.Engine.Sprite} sprite
   */


  _createClass(SpriteRenderer, [{
    key: 'render',
    value: function render(sprite) {
      var texture = sprite.getTexture();
      var textureFrame = texture.getFrame();
      var baseTexture = texture.getBaseTexture();

      // Has the maximum batch size been reached? Flush!
      if (this._currentBatchSize >= this._maxBatchSize) {
        this.flush();
        this._currentBaseTexture = baseTexture;
      }

      // No updated UVs => No rendering
      var uvs = texture.getUVs();
      if (!uvs) {
        return;
      }

      // Fill positions array
      var index = this._currentBatchSize * __WEBPACK_IMPORTED_MODULE_5__globals__["j" /* VERTEX_BYTE_SIZE */];
      this._addVertexCoordinates(sprite, index, textureFrame);
      this._addTextureUVs(sprite, index, uvs);
      this._addColors(sprite, index);

      // Add the sprite to the list of sprites
      this._sprites[this._currentBatchSize] = sprite;
      this._currentBatchSize++;
    }

    /**
     * Adds the color to the positions array for the given sprite
     * @param {PhotoEditorSDK.Engine.Sprite} sprite
     * @param {Number} index
     * @private
     */

  }, {
    key: '_addColors',
    value: function _addColors(sprite, index) {
      var colors = this._colors;
      var tint = sprite.getTint();
      var color = (tint >> 16) + (tint & 0xff00) + ((tint & 0xff) << 16) + (sprite.getWorldAlpha() * 255 << 24);
      colors[index + 4] = colors[index + 9] = colors[index + 14] = colors[index + 19] = color;
    }

    /**
     * Adds the texture UV coordinates to the positions array for the given sprite
     * @param {PhotoEditorSDK.Engine.Sprite} sprite
     * @param {Number} index
     * @param {PhotoEditorSDK.Engine.TextureUVs} uvs
     * @private
     */

  }, {
    key: '_addTextureUVs',
    value: function _addTextureUVs(sprite, index, uvs) {
      var positions = this._positions;

      // Add UVs
      var uvCoords = uvs.getUVsAt(0);
      positions[index + 2] = uvCoords.x;
      positions[index + 3] = uvCoords.y;

      uvCoords = uvs.getUVsAt(1);
      positions[index + 7] = uvCoords.x;
      positions[index + 8] = uvCoords.y;

      uvCoords = uvs.getUVsAt(2);
      positions[index + 12] = uvCoords.x;
      positions[index + 13] = uvCoords.y;

      uvCoords = uvs.getUVsAt(3);
      positions[index + 17] = uvCoords.x;
      positions[index + 18] = uvCoords.y;
    }

    /**
     * Adds the vertex coordinates to the positions array for the given
     * sprite and texture frame
     * @param {PhotoEditorSDK.Engine.Sprite} sprite
     * @param {Number} index
     * @param {PhotoEditorSDK.Math.Rectangle} textureFrame
     * @private
     */

  }, {
    key: '_addVertexCoordinates',
    value: function _addVertexCoordinates(sprite, index, textureFrame) {
      var positions = this._positions;
      var worldTransform = sprite.getWorldTransform();

      // Transform sprite coords with anchor in mind
      var anchor = sprite.getAnchor();
      var rectPositions = worldTransform.rectangleToCoordinates(textureFrame, anchor);

      var stride = 5;
      for (var i = 0; i < 4; i++) {
        positions[index + i * stride] = rectPositions[i].x;
        positions[index + i * stride + 1] = rectPositions[i].y;
      }
    }

    /**
     * Gets called when the rendering context changes
     * @private
     */

  }, {
    key: '_onContextChange',
    value: function _onContextChange() {
      var gl = this._renderer.getContext();

      this._shader = this._renderer.shaders.default;

      this._vertexBuffer = gl.createBuffer();
      this._indexBuffer = gl.createBuffer();

      gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, this._indexBuffer);
      gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, this._indices, gl.STATIC_DRAW);

      gl.bindBuffer(gl.ARRAY_BUFFER, this._vertexBuffer);
      gl.bufferData(gl.ARRAY_BUFFER, this._vertices, gl.DYNAMIC_DRAW);
    }

    /**
     * Gets called when this object renderer is activated
     */

  }, {
    key: 'start',
    value: function start() {
      this._shader.setupBuffers(this._vertexBuffer, this._indexBuffer);
    }

    /**
     * Renders the queued sprites in batches, every time the base texture has changed,
     * it flushes the current batch to the graphics card
     */

  }, {
    key: 'flush',
    value: function flush() {
      var renderer = this._renderer;
      var gl = renderer.getContext();

      if (this._currentBatchSize === 0) {
        return;
      }

      if (this._currentBatchSize > __WEBPACK_IMPORTED_MODULE_5__globals__["a" /* BATCH_SIZE */] * 0.5) {
        // Upload whole ArrayBuffer
        gl.bufferSubData(gl.ARRAY_BUFFER, 0, this._vertices);
      } else {
        // Only upload sub array
        var subArray = this._positions.subarray(0, this._currentBatchSize * __WEBPACK_IMPORTED_MODULE_5__globals__["j" /* VERTEX_BYTE_SIZE */]);
        gl.bufferSubData(gl.ARRAY_BUFFER, 0, subArray);
      }

      // Init variables
      var currentBatchSize = 0;
      var currentBaseTexture = null;
      var nextBaseTexture = null;
      var currentShader = null;
      var nextShader = null;
      var shaderChanged = false;
      var textureChanged = false;
      var sprite = null;
      var batchStartIndex = 0;

      for (var i = 0, j = this._currentBatchSize; i < j; i++) {
        sprite = this._sprites[i];

        nextBaseTexture = sprite.getTexture().getBaseTexture();
        nextShader = sprite.getShader() || this._shader;
        shaderChanged = currentShader !== nextShader;
        textureChanged = currentBaseTexture !== nextBaseTexture;

        if (textureChanged || shaderChanged) {
          this._renderBatch(currentBaseTexture, currentBatchSize, batchStartIndex);

          batchStartIndex = i;
          currentBatchSize = 0;
          currentBaseTexture = nextBaseTexture;

          // Shader has changed, set it
          if (shaderChanged) {
            currentShader = nextShader;
            renderer.setShader(currentShader);

            var renderTarget = renderer.getCurrentRenderTarget();
            var projectionMatrix = renderTarget.getProjectionMatrix().toArray();
            currentShader.setUniform('u_projMatrix', projectionMatrix);
            currentShader.syncUniforms();

            gl.activeTexture(gl.TEXTURE0);
          }
        }

        currentBatchSize++;
      }

      this._renderBatch(currentBaseTexture, currentBatchSize, batchStartIndex);

      // Reset the batch
      this._currentBatchSize = 0;
      this._sprites = [];
    }

    /**
     * Renders the current batch
     * @param  {PhotoEditorSDK.Engine.BaseTexture} baseTexture
     * @param  {Number} batchSize
     * @param  {Number} batchStartIndex
     * @private
     */

  }, {
    key: '_renderBatch',
    value: function _renderBatch(baseTexture, batchSize, batchStartIndex) {
      if (batchSize === 0) {
        return;
      }

      var renderer = this._renderer;
      var gl = renderer.getContext();

      var glTexture = baseTexture.getGLTextureForRenderer(renderer);
      if (!glTexture) {
        glTexture = renderer.getOrCreateGLTexture(baseTexture);
      }

      if (baseTexture.isDirty()) {
        renderer.updateTexture(baseTexture);
        baseTexture.setDirty(false);
      }

      gl.activeTexture(gl.TEXTURE0 + baseTexture.getGLUnit());
      gl.bindTexture(gl.TEXTURE_2D, glTexture);

      var verticesCount = batchSize * 6;
      var vertexOffset = batchStartIndex * 6 * 2;
      gl.drawElements(gl.TRIANGLES, verticesCount, gl.UNSIGNED_SHORT, vertexOffset);
    }

    /**
     * Disposes this ObjectRenderer
     */

  }, {
    key: 'dispose',
    value: function dispose() {
      var renderer = this._renderer;
      var gl = renderer.getContext();

      gl.deleteBuffer(this._vertexBuffer);
      gl.deleteBuffer(this._indexBuffer);

      this._vertices = null;
      this._positions = null;
      this._colors = null;
      this._indices = null;

      _get(SpriteRenderer.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(SpriteRenderer.prototype), 'dispose', this).call(this);
    }
  }]);

  return SpriteRenderer;
}(__WEBPACK_IMPORTED_MODULE_6__object_renderer__["a" /* default */]);

/* harmony default export */ __webpack_exports__["a"] = (SpriteRenderer);

/***/ }),
/* 199 */
/***/ (function(module, exports) {

module.exports = "attribute vec2 a_position;\nattribute vec2 a_texCoord;\nattribute vec4 a_color;\nvarying vec2 v_texCoord;\nvarying vec4 v_color;\nuniform mat3 u_projMatrix;\n\nvoid main() {\n  gl_Position = vec4((u_projMatrix * vec3(a_position, 1)).xy, 0, 1);\n  v_texCoord = a_texCoord;\n  v_color = vec4(a_color.rgb * a_color.a, a_color.a);\n}\n"

/***/ }),
/* 200 */
/***/ (function(module, exports) {

module.exports = "uniform sampler2D u_image;\nvarying vec2 v_texCoord;\nvarying vec4 v_color;\n\nvoid main() {\n  gl_FragColor = texture2D(u_image, v_texCoord) * v_color;\n}\n"

/***/ }),
/* 201 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);


var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */

/**
 * Represents a rectangle that is rendered using WebGL
 * @class
 * @memberof PhotoEditorSDK.Engine
 * @ignore
 */
/* istanbul ignore next */
var Quad = function () {
  function Quad(renderer) {
    _classCallCheck(this, Quad);

    this._renderer = renderer;
    this._context = this._renderer.getContext();

    this._vertices = new Float32Array([0, 0, 100, 0, 100, 100, 0, 100]);

    this._uvs = new Float32Array([0, 0, 1, 0, 1, 1, 0, 1]);

    this._indices = new Uint16Array([0, 1, 2, 0, 3, 2]);

    this._colors = new Float32Array([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]);

    this._initBuffers();
    this._uploadBuffers();
  }

  /**
   * Maps the given rectangles to the quad
   * @param  {Rectangle} rect1
   * @param  {Rectangle} rect2
   */


  _createClass(Quad, [{
    key: "map",
    value: function map(rect1, rect2) {
      var x = rect2.x,
          y = rect2.y;

      // Update the UVs
      // We don't have any translation, so these four
      // values are all we need

      this._uvs[2] = rect2.width / rect1.width;
      this._uvs[4] = this._uvs[2];
      this._uvs[5] = rect2.height / rect1.height;
      this._uvs[7] = this._uvs[5];

      // Update the vertices
      this._vertices[0] = x;
      this._vertices[1] = y;

      this._vertices[2] = x + rect2.width;
      this._vertices[3] = y;

      this._vertices[4] = this._vertices[2];
      this._vertices[5] = y + rect2.height;

      this._vertices[6] = x;
      this._vertices[7] = this._vertices[5];

      this._uploadBuffers();
    }

    /**
     * Initializes the buffers
     * @private
     */

  }, {
    key: "_initBuffers",
    value: function _initBuffers() {
      var gl = this._context;

      // Init vertex buffer
      this._vertexBuffer = gl.createBuffer();
      gl.bindBuffer(gl.ARRAY_BUFFER, this._vertexBuffer);
      gl.bufferData(gl.ARRAY_BUFFER, (8 + 8 + 16) * 4, gl.DYNAMIC_DRAW);

      this._indexBuffer = gl.createBuffer();
      gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, this._indexBuffer);
      gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, this._indices, gl.STATIC_DRAW);
    }

    /**
     * Uploads the buffers
     * @private
     */

  }, {
    key: "_uploadBuffers",
    value: function _uploadBuffers() {
      var gl = this._context;

      gl.bindBuffer(gl.ARRAY_BUFFER, this._vertexBuffer);
      gl.bufferSubData(gl.ARRAY_BUFFER, 0, this._vertices);
      gl.bufferSubData(gl.ARRAY_BUFFER, 8 * 4, this._uvs);
      gl.bufferSubData(gl.ARRAY_BUFFER, (8 + 8) * 4, this._colors);
    }
  }, {
    key: "getVertexBuffer",
    value: function getVertexBuffer() {
      return this._vertexBuffer;
    }
  }, {
    key: "getIndexBuffer",
    value: function getIndexBuffer() {
      return this._indexBuffer;
    }

    /**
     * Cleans up this Quad's buffers
     */

  }, {
    key: "dispose",
    value: function dispose() {
      var gl = this._context;
      gl.deleteBuffer(this._vertexBuffer);
      gl.deleteBuffer(this._indexBuffer);
    }
  }]);

  return Quad;
}();

/* harmony default export */ __webpack_exports__["a"] = (Quad);

/***/ }),
/* 202 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__globals__ = __webpack_require__(8);


var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */



/**
 * Represents the UV coordinates of a texture
 * @class
 * @memberof PhotoEditorSDK.Engine
 */

var TextureUVs = function () {
  /**
   * Creates a TextureUVs instance
   */
  function TextureUVs() {
    _classCallCheck(this, TextureUVs);

    this._uvs = [new __WEBPACK_IMPORTED_MODULE_1__globals__["k" /* Vector2 */](0, 0), new __WEBPACK_IMPORTED_MODULE_1__globals__["k" /* Vector2 */](1, 0), new __WEBPACK_IMPORTED_MODULE_1__globals__["k" /* Vector2 */](1, 1), new __WEBPACK_IMPORTED_MODULE_1__globals__["k" /* Vector2 */](0, 1)];
  }

  /**
   * Updates the UVs based on the given baseframe
   * @param  {Rectangle} frame
   * @param  {Rectangle} baseFrame
   */


  _createClass(TextureUVs, [{
    key: 'update',
    value: function update(frame, baseFrame) {
      // Upper left
      var uv = this._uvs[0];
      uv.x = frame.x / baseFrame.width;
      uv.y = frame.y / baseFrame.height;

      // Upper right
      uv = this._uvs[1];
      uv.x = (frame.x + frame.width) / baseFrame.width;
      uv.y = frame.y / baseFrame.height;

      // Lower right
      uv = this._uvs[2];
      uv.x = (frame.x + frame.width) / baseFrame.width;
      uv.y = (frame.y + frame.height) / baseFrame.height;

      // Lower left
      uv = this._uvs[3];
      uv.x = frame.x / baseFrame.width;
      uv.y = (frame.y + frame.height) / baseFrame.height;
    }

    /**
     * Returns the UV coordinates for the given index
     * @param  {Number} index
     * @return {PhotoEditorSDK.Math.Vector2}
     */

  }, {
    key: 'getUVsAt',
    value: function getUVsAt(index) {
      return this._uvs[index];
    }

    /**
     * Returns the UV coordinates
     * @return {Array.<PhotoEditorSDK.Math.Vector2>}
     */

  }, {
    key: 'getUVs',
    value: function getUVs() {
      return this._uvs;
    }
  }]);

  return TextureUVs;
}();

/* harmony default export */ __webpack_exports__["a"] = (TextureUVs);

/***/ }),
/* 203 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__globals__ = __webpack_require__(8);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__texture__ = __webpack_require__(117);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__base_texture__ = __webpack_require__(44);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__utils_webgl_render_target__ = __webpack_require__(58);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__utils_canvas_render_target__ = __webpack_require__(57);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9__managers_webgl_filter_manager__ = __webpack_require__(85);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10__managers_canvas_filter_manager__ = __webpack_require__(81);





var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */









var RendererType = __WEBPACK_IMPORTED_MODULE_4__globals__["c" /* Constants */].RendererType;

/**
 * A texture that you can render to
 * @class
 * @extends PhotoEditorSDK.Engine.Texture
 * @memberof PhotoEditorSDK.Engine
 */

var RenderTexture = function (_Texture) {
  _inherits(RenderTexture, _Texture);

  /**
   * Creates a RenderTexture
   * @param  {PhotoEditorSDK.Engine.BaseRenderer} renderer
   * @param  {Number} [width = 100]
   * @param  {Number} [height = 100]
   * @param  {Number} [pixelRatio = 1]
   */
  function RenderTexture(renderer) {
    var width = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 100;
    var height = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 100;
    var pixelRatio = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 1;

    _classCallCheck(this, RenderTexture);

    // RenderTexture is always loaded!
    var _this = _possibleConstructorReturn(this, (RenderTexture.__proto__ || __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default()(RenderTexture)).call(this, new __WEBPACK_IMPORTED_MODULE_6__base_texture__["a" /* default */](), new __WEBPACK_IMPORTED_MODULE_4__globals__["h" /* Rectangle */](0, 0, width, height)));

    _this._loaded = true;
    _this._width = width;
    _this._height = height;
    _this._pixelRatio = pixelRatio;
    _this._renderer = renderer;

    _this._setupFilterManager();
    _this._setupBuffer();

    _this.setBaseTexture(_this._renderTarget.getBaseTexture());

    _this._updateUVs();
    return _this;
  }

  /**
   * Sets up the filter manager
   * @private
   */


  _createClass(RenderTexture, [{
    key: '_setupFilterManager',
    value: function _setupFilterManager() {
      /* istanbul ignore if */
      if (this._renderer.isOfType(RendererType.WEBGL)) {
        this._filterManager = new __WEBPACK_IMPORTED_MODULE_9__managers_webgl_filter_manager__["a" /* default */](this._renderer);
      } else if (this._renderer.isOfType(RendererType.CANVAS)) {
        this._filterManager = new __WEBPACK_IMPORTED_MODULE_10__managers_canvas_filter_manager__["a" /* default */](this._renderer);
      }

      this._filterManager.resizeTo(new __WEBPACK_IMPORTED_MODULE_4__globals__["k" /* Vector2 */](this._width, this._height));
    }

    /**
     * Sets up the buffer that we're rendering to
     * @private
     */

  }, {
    key: '_setupBuffer',
    value: function _setupBuffer() {
      /* istanbul ignore if */
      if (this._renderer.isOfType(RendererType.WEBGL)) {
        this._setupWebGLRenderTarget();
      } else if (this._renderer.isOfType(RendererType.CANVAS)) {
        this._setupCanvasRenderTarget();
      }
    }

    /**
     * Sets up the WebGLRenderTarget for this RenderTexture
     * @private
     */
    /* istanbul ignore next */

  }, {
    key: '_setupWebGLRenderTarget',
    value: function _setupWebGLRenderTarget() {
      this._renderTarget = new __WEBPACK_IMPORTED_MODULE_7__utils_webgl_render_target__["a" /* default */](this._renderer, this._width, this._height, this._pixelRatio);
    }

    /**
     * Sets up the CanvasRenderTarget for this RenderTexture
     * @private
     */

  }, {
    key: '_setupCanvasRenderTarget',
    value: function _setupCanvasRenderTarget() {
      this._renderTarget = new __WEBPACK_IMPORTED_MODULE_8__utils_canvas_render_target__["a" /* default */](this._width, this._height, this._pixelRatio);
    }

    /**
     * Clears this texture's render buffer
     * @param {PhotoEditorSDK.Color} color
     */

  }, {
    key: 'clear',
    value: function clear(color) {
      this._renderTarget.clear(color);
    }

    /**
     * Resizes this RenderTexture to the given dimensions
     * @param  {PhotoEditorSDK.Math.Vector2} dimensions
     */

  }, {
    key: 'resizeTo',
    value: function resizeTo(dimensions) {
      if (this._width === dimensions.x && this._height === dimensions.y) {
        return;
      }

      this._width = dimensions.x;
      this._height = dimensions.y;
      this._frame.width = dimensions.x;
      this._frame.height = dimensions.y;

      this._renderTarget.resizeTo(dimensions);
      this._filterManager.resizeTo(dimensions);
    }

    /**
     * Renders the given DisplayObject
     * @param  {PhotoEditorSDK.Engine.DisplayObject} displayObject
     */

  }, {
    key: 'render',
    value: function render(displayObject) {
      /* istanbul ignore if */
      if (this._renderer.isOfType(RendererType.WEBGL)) {
        this._renderWebGL(displayObject);
      } else if (this._renderer.isOfType(RendererType.CANVAS)) {
        this._renderCanvas(displayObject);
      } else {
        throw new Error('RenderTexture does not support rendering via ' + this._renderer.constructor.name);
      }
    }

    /**
     * Renders the given DisplayObject using WebGL
     * @param  {PhotoEditorSDK.Engine.DisplayObject} displayObject
     * @private
     */
    /* istanbul ignore next */

  }, {
    key: '_renderWebGL',
    value: function _renderWebGL(displayObject) {
      this._renderTarget.activate();

      displayObject.getWorldTransform().reset();
      displayObject.getChildren().forEach(function (child) {
        child.updateTransform();
      });

      var tempFilterManager = this._renderer.getFilterManager();
      this._renderer.setFilterManager(this._filterManager);
      this._renderer.renderDisplayObject(displayObject, this._renderTarget);
      // this._renderTarget.updateMipMap()
      this._renderer.setFilterManager(tempFilterManager);
    }

    /**
     * Renders the given DisplayObject using Canvas2D
     * @param  {PhotoEditorSDK.Engine.DisplayObject} displayObject
     * @private
     */

  }, {
    key: '_renderCanvas',
    value: function _renderCanvas(displayObject) {
      displayObject.getWorldTransform().reset();
      displayObject.getChildren().forEach(function (child) {
        child.updateTransform();
      });

      var tempFilterManager = this._renderer.getFilterManager();
      this._renderer.setFilterManager(this._filterManager);
      this._renderer.renderDisplayObject(displayObject, this._renderTarget);
      this._renderer.setFilterManager(tempFilterManager);
    }

    /**
     * Returns the render target
     * @return {PhotoEditorSDK.Engine.WebGLRenderTarget}
     */

  }, {
    key: 'getRenderTarget',
    value: function getRenderTarget() {
      return this._renderTarget;
    }

    /**
     * Disposes this RenderTexture
     */

  }, {
    key: 'dispose',
    value: function dispose() {
      this._renderTarget.dispose();
      this._filterManager.dispose();
    }
  }]);

  return RenderTexture;
}(__WEBPACK_IMPORTED_MODULE_5__texture__["a" /* default */]);

/* harmony default export */ __webpack_exports__["a"] = (RenderTexture);

/***/ }),
/* 204 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__globals__ = __webpack_require__(8);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__display_container__ = __webpack_require__(116);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__lib_pot_renderer__ = __webpack_require__(205);





var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */





/**
 * A drawable rectangle with a texture
 * @class
 * @extends PhotoEditorSDK.Engine.Container
 * @memberof PhotoEditorSDK.Engine
 */

var Sprite = function (_Container) {
  _inherits(Sprite, _Container);

  /**
   * Creates a Sprite
   * @param  {PhotoEditorSDK.Engine.Texture} texture
   */
  function Sprite(texture) {
    _classCallCheck(this, Sprite);

    var _this = _possibleConstructorReturn(this, (Sprite.__proto__ || __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default()(Sprite)).call(this));

    _this._onTextureUpdate = _this._onTextureUpdate.bind(_this);

    _this._texture = texture;
    _this._shader = null;

    // Cached dimensions
    _this._width = 0;
    _this._height = 0;

    _this._anchor = new __WEBPACK_IMPORTED_MODULE_4__globals__["k" /* Vector2 */](0, 0);

    _this.setTexture(texture);
    return _this;
  }

  // -------------------------------------------------------------------------- EVENTS

  /**
   * Gets called when this sprite's texture has been updated
   * @private
   */


  _createClass(Sprite, [{
    key: '_onTextureUpdate',
    value: function _onTextureUpdate() {
      this._boundsNeedUpdate = true;
      this._localBoundsNeedUpdate = true;
    }

    // -------------------------------------------------------------------------- RENDERING

    /**
     * Renders the contents of this container
     * @param {WebGLRenderer} renderer
     * @private
     */
    /* istanbul ignore next */

  }, {
    key: '_renderWebGL',
    value: function _renderWebGL(renderer) {
      var save = renderer.save();
      if (this._smoothDownscaling) {
        if (!this._potRenderer) {
          this._potRenderer = new __WEBPACK_IMPORTED_MODULE_6__lib_pot_renderer__["a" /* default */]();
        }

        this._potRenderer.render(renderer, this, this._texture);
      }
      renderer.restore(save);

      renderer.setObjectRenderer(renderer.renderers.sprite);
      renderer.renderers.sprite.render(this);
    }

    /**
     * Renders the contents of this container
     * @param  {CanvasRenderer} renderer
     * @private
     */

  }, {
    key: '_renderCanvas',
    value: function _renderCanvas(renderer) {
      // @TODO Move this to SpriteRenderer
      var transform = this._worldTransform;
      var textureFrame = this._texture.getFrame();

      var width = textureFrame.width,
          height = textureFrame.height;

      var pixelRatio = renderer.getCurrentRenderTarget().getPixelRatio();

      // Apply transform
      var dx = this._anchor.x * -width | 0;
      var dy = this._anchor.y * -height | 0;
      var ctx = renderer.getContext();
      ctx.setTransform(transform.a, transform.b, transform.c, transform.d, transform.tx * pixelRatio, transform.ty * pixelRatio);

      ctx.globalAlpha = this.getWorldAlpha();

      var baseTexture = this._texture.getBaseTexture();
      var texturePixelRatio = baseTexture.getPixelRatio();
      var source = baseTexture.getSource();
      ctx.drawImage(this._texture.getBaseTexture().getSource(),

      // Source x, y, width, height
      0, 0, (source.naturalWidth || width) * texturePixelRatio, (source.naturalHeight || height) * texturePixelRatio,

      // Destination x, y, width, height
      dx * pixelRatio, dy * pixelRatio, width * pixelRatio, height * pixelRatio);
    }

    // -------------------------------------------------------------------------- PUBLIC API

    /**
     * Checks if this sprite is located at the given position
     * @param  {PhotoEditorSDK.Math.Vector2}  position
     * @return {Boolean}
     */

  }, {
    key: 'isAtPosition',
    value: function isAtPosition(position) {
      var localPosition = this._worldTransform.applyInverseToVector(position);
      var textureFrame = this._texture.getFrame();
      var width = textureFrame.width,
          height = textureFrame.height;


      var upperLeft = new __WEBPACK_IMPORTED_MODULE_4__globals__["k" /* Vector2 */](-width, -height);
      upperLeft.multiply(this._anchor);
      var lowerRight = upperLeft.clone().add(width, height);

      if (localPosition.x < upperLeft.x || localPosition.x > lowerRight.x || localPosition.y < upperLeft.y || localPosition.y > lowerRight.y) {
        return false;
      }

      return true;
    }

    /**
     * Returns the non-global bounds of this DisplayObject
     * @return {PhotoEditorSDK.Math.Rectangle}
     */

  }, {
    key: 'getLocalBounds',
    value: function getLocalBounds() {
      if (this._localBoundsNeedUpdate) {
        var bounds = this._localBounds;
        var textureFrame = this._texture.getFrame();

        bounds.x = -textureFrame.width * this._anchor.x;
        bounds.y = -textureFrame.height * this._anchor.y;
        bounds.width = textureFrame.width;
        bounds.height = textureFrame.height;

        this._localBoundsNeedUpdate = false;
      }
      return this._localBounds.clone();
    }

    /**
     * Returns the bounds for this DisplayObject
     * @return {PhotoEditorSDK.Math.Rectangle}
     */

  }, {
    key: 'getBounds',
    value: function getBounds() {
      if (this._boundsNeedUpdate) {
        var bounds = this._bounds;
        var textureFrame = this._texture.getFrame();

        // @TODO Optimize this (if necessary). We could skip matrix application
        //       when there's no rotation
        var worldTransform = this._worldTransform;
        var anchor = this._anchor;
        var positions = worldTransform.rectangleToCoordinates(textureFrame, anchor);

        var minX = positions[0].x;
        var minY = positions[0].y;
        var maxX = minX;
        var maxY = minY;

        positions.forEach(function (_ref) {
          var x = _ref.x,
              y = _ref.y;

          minX = Math.min(minX, x);
          minY = Math.min(minY, y);
          maxX = Math.max(maxX, x);
          maxY = Math.max(maxY, y);
        });

        bounds.x = minX;
        bounds.width = Math.abs(maxX - minX);
        bounds.y = minY;
        bounds.height = Math.abs(maxY - minY);

        this._boundsNeedUpdate = false;
      }
      return this._bounds.clone();
    }

    // -------------------------------------------------------------------------- GETTERS / SETTERS

    /**
     * Returns the current texture
     * @return {PhotoEditorSDK.Engine.Texture} [description]
     */

  }, {
    key: 'getTexture',
    value: function getTexture() {
      return this._texture;
    }
  }, {
    key: 'clearTexture',
    value: function clearTexture() {
      if (!this._texture) {
        return;
      }

      this._texture.off('update', this._onTextureUpdate);
      this._texture.dispose();
      this._texture = null;

      if (this._potRenderer) {
        this._potRenderer.dispose();
        this._potRenderer = null;
      }
    }

    /**
     * Sets the texture
     * @param {PhotoEditorSDK.Engine.Texture} texture
     */

  }, {
    key: 'setTexture',
    value: function setTexture(texture) {
      if (!texture) {
        return;
      }

      if (this._texture) {
        this._texture.off('update', this._onTextureUpdate);
      }

      if (this._potRenderer) {
        this._potRenderer.getRenderTexture().getBaseTexture().setDirty(true);
      }

      this._texture = texture;
      if (texture.getBaseTexture().isLoaded()) {
        this._onTextureUpdate();
      }
      texture.on('update', this._onTextureUpdate);
    }

    /**
     * Returns the shader
     * @return {PhotoEditorSDK.Engine.Shader}
     */

  }, {
    key: 'getShader',
    value: function getShader() {
      return this._shader;
    }

    /**
     * Sets the shader
     * @param {PhotoEditorSDK.Engine.Shader} shader
     */

  }, {
    key: 'setShader',
    value: function setShader(shader) {
      this._shader = shader;
    }

    /**
     * Returns the width
     * @return {Number}
     */

  }, {
    key: 'getWidth',
    value: function getWidth() {
      return this._width;
    }

    /**
     * Sets the width
     * @param {Number} width
     */

  }, {
    key: 'setWidth',
    value: function setWidth(width) {
      this._scale.x = width / this._texture.getFrame().width;
      this._width = width;
      this._boundsNeedUpdate = true;
      this._localBoundsNeedUpdate = true;
    }

    /**
     * Returns the height
     * @return {Number}
     */

  }, {
    key: 'getHeight',
    value: function getHeight() {
      return this._height;
    }

    /**
     * Sets the height
     * @param {Number} height
     */

  }, {
    key: 'setHeight',
    value: function setHeight(height) {
      this._scale.y = height / this._texture.getFrame().height;
      this._height = height;
      this._boundsNeedUpdate = true;
      this._localBoundsNeedUpdate = true;
    }

    /**
     * Returns the current width and height of this sprite
     * @return {PhotoEditor.Math.Vector2}
     */

  }, {
    key: 'getDimensions',
    value: function getDimensions() {
      return new __WEBPACK_IMPORTED_MODULE_4__globals__["k" /* Vector2 */](this._width, this._height);
    }

    /**
     * Returns the anchor
     * @return {PhotoEditorSDK.Math.Vector2}
     */

  }, {
    key: 'getAnchor',
    value: function getAnchor() {
      return this._anchor;
    }

    /**
     * Sets the anchor
     * @param {PhotoEditorSDK.Math.Vector2} anchor
     */

  }, {
    key: 'setAnchor',
    value: function setAnchor(anchor, y) {
      if (anchor instanceof __WEBPACK_IMPORTED_MODULE_4__globals__["k" /* Vector2 */]) {
        this._anchor.copy(anchor);
      } else {
        this._anchor.set(anchor, y);
      }
      this._boundsNeedUpdate = true;
      this._localBoundsNeedUpdate = true;
    }

    /**
     * Returns whether smooth downscaling is enabled
     * @return {Boolean}
     */

  }, {
    key: 'isSmoothDownscaling',
    value: function isSmoothDownscaling() {
      return this._smoothDownscaling;
    }

    /**
     * Sets the smooth downscaling flag
     * @param {Boolean} smoothDownscaling
     */

  }, {
    key: 'setSmoothDownscaling',
    value: function setSmoothDownscaling(smoothDownscaling) {
      this._smoothDownscaling = smoothDownscaling;
    }

    /**
     * Disposes this Sprite
     * @param {Boolean} texture = false - Should the texture be disposed?
     * @param {Boolean} baseTexture = false - Should the base texture be disposed?
     */

  }, {
    key: 'dispose',
    value: function dispose() {
      var texture = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;
      var baseTexture = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;

      if (this._texture) {
        this._texture.off('update', this._onTextureUpdate);
      }
      (texture || baseTexture) && this._texture.dispose(baseTexture);
      if (this._potRenderer) {
        this._potRenderer.dispose();
      }
    }
  }]);

  return Sprite;
}(__WEBPACK_IMPORTED_MODULE_5__display_container__["a" /* default */]);

/* harmony default export */ __webpack_exports__["a"] = (Sprite);

/***/ }),
/* 205 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__globals__ = __webpack_require__(33);


var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */



/* istanbul ignore next */

var POTRenderer = function () {
  function POTRenderer() {
    _classCallCheck(this, POTRenderer);

    this._container = new __WEBPACK_IMPORTED_MODULE_1__globals__["Engine"].Container();
    this._sprite = new __WEBPACK_IMPORTED_MODULE_1__globals__["Engine"].Sprite();
    this._container.addChild(this._sprite);
  }

  /**
   * Renders the given input texture to a POT texture
   * @param  {PhotoEditorSDK.Engine.BaseRenderer} renderer
   * @param  {PhotoEditorSDK.Engine.Sprite} inputSprite
   * @param  {PhotoEditorSDK.Engine.Texture} inputTexture
   */


  _createClass(POTRenderer, [{
    key: 'render',
    value: function render(renderer, inputSprite, inputTexture) {
      var textureDimensions = inputTexture.getDimensions();
      var nextPOT = this._getNextHighestPOT(textureDimensions);

      if (!this._renderTexture) {
        this._renderTexture = new __WEBPACK_IMPORTED_MODULE_1__globals__["Engine"].RenderTexture(renderer, nextPOT.x, nextPOT.y);
      } else {
        this._renderTexture.resizeTo(nextPOT);
      }

      var newDimensions = this._renderTexture.getDimensions();
      this._sprite.setTexture(inputTexture);
      this._sprite.updateTransform();
      this._renderTexture.render(this._container);

      this._updateSprite(renderer, inputSprite, textureDimensions, newDimensions);
    }

    /**
     * Sets the input sprite's texture and makes sure only the relevant part of the
     * render texture is rendered
     * @param  {PhotoEditorSDK.Engine.Sprite} inputSprite
     * @param  {PhotoEditorSDK.Math.Vector2} initialDimensions
     * @param  {PhotoEditorSDK.Math.Vector2} newDimensions
     * @private
     */

  }, {
    key: '_updateSprite',
    value: function _updateSprite(renderer, inputSprite, initialDimensions, newDimensions) {
      inputSprite.setTexture(this._renderTexture);

      this._renderTexture.setFrame(new __WEBPACK_IMPORTED_MODULE_1__globals__["Rectangle"](0, 0, initialDimensions.x, initialDimensions.y));
    }

    /**
     * Returns the next highest POT dimensions for the given dimensions
     * @param  {PhotoEditorSDK.Math.Vector2} dimensions
     * @private
     */

  }, {
    key: '_getNextHighestPOT',
    value: function _getNextHighestPOT(dimensions) {
      return new __WEBPACK_IMPORTED_MODULE_1__globals__["Vector2"](__WEBPACK_IMPORTED_MODULE_1__globals__["Utils"].nextHighestPOT(dimensions.x), __WEBPACK_IMPORTED_MODULE_1__globals__["Utils"].nextHighestPOT(dimensions.y));
    }

    /**
     * Returns the render texture
     * @return {PhotoEditorSDK.Engine.RenderTexture}
     */

  }, {
    key: 'getRenderTexture',
    value: function getRenderTexture() {
      return this._renderTexture;
    }

    /**
     * Disposes this POT renderers
     */

  }, {
    key: 'dispose',
    value: function dispose() {
      if (!this._renderTexture) {
        return;
      }

      this._renderTexture.dispose();
      this._renderTexture = null;
    }
  }]);

  return POTRenderer;
}();

/* harmony default export */ __webpack_exports__["a"] = (POTRenderer);

/***/ }),
/* 206 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__texture_shader__ = __webpack_require__(82);
/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */



/* harmony default export */ __webpack_exports__["a"] = ({
  TextureShader: __WEBPACK_IMPORTED_MODULE_0__texture_shader__["a" /* default */]
});

/***/ }),
/* 207 */
/***/ (function(module, exports, __webpack_require__) {

module.exports = { "default": __webpack_require__(208), __esModule: true };

/***/ }),
/* 208 */
/***/ (function(module, exports, __webpack_require__) {

__webpack_require__(209);
module.exports = __webpack_require__(10).setImmediate;


/***/ }),
/* 209 */
/***/ (function(module, exports, __webpack_require__) {

var $export = __webpack_require__(15);
var $task = __webpack_require__(77);
$export($export.G + $export.B, {
  setImmediate: $task.set,
  clearImmediate: $task.clear
});


/***/ }),
/* 210 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
Object.defineProperty(__webpack_exports__, "__esModule", { value: true });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__unpremultiply_filter__ = __webpack_require__(211);
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "UnpremultiplyFilter", function() { return __WEBPACK_IMPORTED_MODULE_0__unpremultiply_filter__["a"]; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__color_overlay_filter__ = __webpack_require__(213);
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "ColorOverlayFilter", function() { return __WEBPACK_IMPORTED_MODULE_1__color_overlay_filter__["a"]; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__tint_filter__ = __webpack_require__(215);
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "TintFilter", function() { return __WEBPACK_IMPORTED_MODULE_2__tint_filter__["a"]; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__overlay_filter__ = __webpack_require__(217);
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "OverlayFilter", function() { return __WEBPACK_IMPORTED_MODULE_3__overlay_filter__["a"]; });
/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */

/**
 * @namespace PhotoEditorSDK.Engine.Filters
 */





/***/ }),
/* 211 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__filter__ = __webpack_require__(45);




function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */



/* istanbul ignore next */

var UnpremultiplyFilter = function (_Filter) {
  _inherits(UnpremultiplyFilter, _Filter);

  function UnpremultiplyFilter() {
    _classCallCheck(this, UnpremultiplyFilter);

    var _this = _possibleConstructorReturn(this, (UnpremultiplyFilter.__proto__ || __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default()(UnpremultiplyFilter)).call(this));

    _this._fragmentSource = __webpack_require__(212);
    return _this;
  }

  return UnpremultiplyFilter;
}(__WEBPACK_IMPORTED_MODULE_3__filter__["a" /* default */]);

/* harmony default export */ __webpack_exports__["a"] = (UnpremultiplyFilter);

/***/ }),
/* 212 */
/***/ (function(module, exports) {

module.exports = "uniform sampler2D u_image;\nvarying vec2 v_texCoord;\nvarying vec4 v_color;\n\nvoid main() {\n  vec4 color = texture2D(u_image, v_texCoord);\n  gl_FragColor = vec4(color.a > 0. ? color.rgb / color.a : vec3(0), color.a);\n}\n"

/***/ }),
/* 213 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__globals__ = __webpack_require__(8);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__filter__ = __webpack_require__(45);





var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




var OptionType = __WEBPACK_IMPORTED_MODULE_4__globals__["c" /* Constants */].OptionType,
    UniformType = __WEBPACK_IMPORTED_MODULE_4__globals__["c" /* Constants */].UniformType;

/* istanbul ignore next */

var ColorOverlayFilter = function (_Filter) {
  _inherits(ColorOverlayFilter, _Filter);

  function ColorOverlayFilter() {
    var _ref;

    _classCallCheck(this, ColorOverlayFilter);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this = _possibleConstructorReturn(this, (_ref = ColorOverlayFilter.__proto__ || __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default()(ColorOverlayFilter)).call.apply(_ref, [this].concat(args)));

    _this._fragmentSource = __webpack_require__(214);
    return _this;
  }

  /**
   * Applies this filter to the given inputTarget and renders it to
   * the given outputTarget using the CanvasRenderer
   * @param  {CanvasRenderer} renderer
   * @param  {RenderTarget} inputTarget
   * @param  {RenderTarget} outputTarget
   * @param  {Boolean} clear = false
   * @private
   */


  _createClass(ColorOverlayFilter, [{
    key: '_applyCanvas',
    value: function _applyCanvas(renderer, inputTarget, outputTarget) {
      var clear = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;

      var canvas = inputTarget.getCanvas();
      var inputContext = inputTarget.getContext();
      var outputContext = outputTarget.getContext();
      var color = this._options.color;


      var inputImageData = inputContext.getImageData(0, 0, canvas.width, canvas.height);
      var outputImageData = outputContext.getImageData(0, 0, canvas.width, canvas.height);
      var pixelCount = canvas.width * canvas.height;

      var inputColor = new __WEBPACK_IMPORTED_MODULE_4__globals__["b" /* Color */]();
      var outputColor = new __WEBPACK_IMPORTED_MODULE_4__globals__["b" /* Color */]();
      for (var i = 0; i < pixelCount * 4; i += 4) {
        inputColor.set(inputImageData.data[i] / 255, inputImageData.data[i + 1] / 255, inputImageData.data[i + 2] / 255, inputImageData.data[i + 3] / 255);
        outputColor.set(outputImageData.data[i] / 255, outputImageData.data[i + 1] / 255, outputImageData.data[i + 2] / 255, outputImageData.data[i + 3] / 255);

        var newR = outputColor.r + inputColor.a * (inputColor.r - outputColor.r);
        outputImageData.data[i] = (newR + inputColor.a * (color.r - newR)) * 255;

        var newG = outputColor.g + inputColor.a * (inputColor.g - outputColor.g);
        outputImageData.data[i + 1] = (newG + inputColor.a * (color.g - newG)) * 255;

        var newB = outputColor.b + inputColor.a * (inputColor.b - outputColor.b);
        outputImageData.data[i + 2] = (newB + inputColor.a * (color.b - newB)) * 255;
      }

      outputContext.putImageData(outputImageData, 0, 0);
    }
  }]);

  return ColorOverlayFilter;
}(__WEBPACK_IMPORTED_MODULE_5__filter__["a" /* default */]);

/**
 * Specifies the available options for this filter
 * @type {Object}
 * @ignore
 */


ColorOverlayFilter.prototype.availableOptions = {
  color: { type: OptionType.COLOR, default: __WEBPACK_IMPORTED_MODULE_4__globals__["b" /* Color */].WHITE, uniformType: UniformType.FLOAT4 }
};

/* harmony default export */ __webpack_exports__["a"] = (ColorOverlayFilter);

/***/ }),
/* 214 */
/***/ (function(module, exports) {

module.exports = "uniform sampler2D u_image;\nvarying vec2 v_texCoord;\nuniform vec4 u_color;\n\nvoid main() {\n  vec4 color = texture2D(u_image, v_texCoord);\n  gl_FragColor = vec4(mix(color.rgb, u_color.rgb, u_color.a), color.a) * color.a;\n}\n"

/***/ }),
/* 215 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__globals__ = __webpack_require__(8);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__filter__ = __webpack_require__(45);





var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




var OptionType = __WEBPACK_IMPORTED_MODULE_4__globals__["c" /* Constants */].OptionType,
    UniformType = __WEBPACK_IMPORTED_MODULE_4__globals__["c" /* Constants */].UniformType;

/* istanbul ignore next */

var TintFilter = function (_Filter) {
  _inherits(TintFilter, _Filter);

  function TintFilter() {
    var _ref;

    _classCallCheck(this, TintFilter);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this = _possibleConstructorReturn(this, (_ref = TintFilter.__proto__ || __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default()(TintFilter)).call.apply(_ref, [this].concat(args)));

    _this._fragmentSource = __webpack_require__(216);
    return _this;
  }

  /**
   * Applies this filter to the given inputTarget and renders it to
   * the given outputTarget using the CanvasRenderer
   * @param  {CanvasRenderer} renderer
   * @param  {RenderTarget} inputTarget
   * @param  {RenderTarget} outputTarget
   * @param  {Boolean} clear = false
   * @private
   */


  _createClass(TintFilter, [{
    key: '_applyCanvas',
    value: function _applyCanvas(renderer, inputTarget, outputTarget) {
      var clear = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;

      var canvas = inputTarget.getCanvas();
      var inputContext = inputTarget.getContext();
      var outputContext = outputTarget.getContext();

      var imageData = inputContext.getImageData(0, 0, canvas.width, canvas.height);
      var _options = this._options,
          mode = _options.mode,
          color = _options.color;
      var r = color.r,
          g = color.g,
          b = color.b,
          a = color.a;


      var W = [0.2125, 0.7154, 0.0721];

      switch (mode) {
        case TintFilter.MODES.SOLID:
          for (var i = 0; i < canvas.width * canvas.height; i++) {
            var index = i * 4;
            imageData.data[index] += (r * 255 - imageData.data[index]) * a;
            imageData.data[index + 1] += (g * 255 - imageData.data[index + 1]) * a;
            imageData.data[index + 2] += (b * 255 - imageData.data[index + 2]) * a;
          }
          break;
        case TintFilter.MODES.COLORIZED:
          for (var _i = 0; _i < canvas.width * canvas.height; _i++) {
            var _index = _i * 4;

            var luminance = imageData.data[_index] / 255 * W[0] + imageData.data[_index + 1] / 255 * W[1] + imageData.data[_index + 2] / 255 * W[2];
            var colorized = new __WEBPACK_IMPORTED_MODULE_4__globals__["b" /* Color */](luminance * r, luminance * g, luminance * b);
            imageData.data[_index] += (colorized.r * 255 - imageData.data[_index]) * a;
            imageData.data[_index + 1] += (colorized.g * 255 - imageData.data[_index + 1]) * a;
            imageData.data[_index + 2] += (colorized.b * 255 - imageData.data[_index + 2]) * a;
          }
          break;
      }

      outputContext.putImageData(imageData, 0, 0);
    }
  }]);

  return TintFilter;
}(__WEBPACK_IMPORTED_MODULE_5__filter__["a" /* default */]);

/**
 * Specifies the available tint modes
 * @type {Object}
 */


TintFilter.MODES = {
  NONE: 0,
  SOLID: 1,
  COLORIZED: 2

  /**
   * Specifies the available options for this filter
   * @type {Object}
   * @ignore
   */
};TintFilter.prototype.availableOptions = {
  color: { type: OptionType.COLOR, default: __WEBPACK_IMPORTED_MODULE_4__globals__["b" /* Color */].WHITE, uniformType: UniformType.FLOAT4 },
  mode: { type: OptionType.NUMBER, default: TintFilter.MODES.NONE, uniformType: UniformType.INT }
};

/* harmony default export */ __webpack_exports__["a"] = (TintFilter);

/***/ }),
/* 216 */
/***/ (function(module, exports) {

module.exports = "uniform sampler2D u_image;\nvarying vec2 v_texCoord;\nuniform vec4 u_color;\nuniform int u_mode;\n\nvec3 W = vec3(0.2125, 0.7154, 0.0721);\n\nvoid main() {\n  vec4 color = texture2D(u_image, v_texCoord);\n  if (u_mode == 0) {\n    gl_FragColor = color * color.a;\n  } else if (u_mode == 1) {\n    gl_FragColor = vec4(mix(color.rgb, u_color.rgb, u_color.a), color.a) * color.a;\n  } else if (u_mode == 2) {\n    float luminance = dot(color.rgb, W);\n    vec3 colorized = vec3(luminance) * u_color.rgb;\n    gl_FragColor = vec4(mix(color.rgb, colorized, u_color.a), color.a) * color.a;\n  }\n}\n"

/***/ }),
/* 217 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__globals__ = __webpack_require__(8);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__filter__ = __webpack_require__(45);





var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




var OptionType = __WEBPACK_IMPORTED_MODULE_4__globals__["c" /* Constants */].OptionType,
    UniformType = __WEBPACK_IMPORTED_MODULE_4__globals__["c" /* Constants */].UniformType;


var EPSILON = 0.000001;

/* istanbul ignore next */

var OverlayFilter = function (_Filter) {
  _inherits(OverlayFilter, _Filter);

  function OverlayFilter() {
    var _ref;

    _classCallCheck(this, OverlayFilter);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this = _possibleConstructorReturn(this, (_ref = OverlayFilter.__proto__ || __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default()(OverlayFilter)).call.apply(_ref, [this].concat(args)));

    _this._fragmentSource = __webpack_require__(218);

    _this._lastImage = null;
    return _this;
  }

  /**
   * Applies this filter to the given inputTarget and renders it to
   * the given outputTarget using the CanvasRenderer
   * @param  {CanvasRenderer} renderer
   * @param  {RenderTarget} inputTarget
   * @param  {RenderTarget} outputTarget
   * @param  {Boolean} clear = false
   * @private
   */


  _createClass(OverlayFilter, [{
    key: '_applyCanvas',
    value: function _applyCanvas(renderer, inputTarget, outputTarget) {
      var clear = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;

      // @todo Add support for non-rendertextures (usual textures)
      var overlayContext = this._options.overlayTexture.getRenderTarget().getContext();

      var canvas = inputTarget.getCanvas();
      var inputContext = inputTarget.getContext();
      var outputContext = outputTarget.getContext();

      var imageData = inputContext.getImageData(0, 0, canvas.width, canvas.height);
      var overlayImageData = overlayContext.getImageData(0, 0, canvas.width, canvas.height);
      var _options = this._options,
          blendMode = _options.blendMode,
          alpha = _options.alpha;


      var inputColor = new __WEBPACK_IMPORTED_MODULE_4__globals__["b" /* Color */]();
      var overlayColor = new __WEBPACK_IMPORTED_MODULE_4__globals__["b" /* Color */]();
      var outputColor = new __WEBPACK_IMPORTED_MODULE_4__globals__["b" /* Color */]();
      for (var i = 0; i < canvas.width * canvas.height * 4; i += 4) {
        inputColor.set(imageData.data[i] / 255, imageData.data[i + 1] / 255, imageData.data[i + 2] / 255, imageData.data[i + 3] / 255);
        overlayColor.set(overlayImageData.data[i] / 255, overlayImageData.data[i + 1] / 255, overlayImageData.data[i + 2] / 255, overlayImageData.data[i + 3] / 255);

        var rA = void 0,
            rB = void 0,
            newR = void 0;
        var gA = void 0,
            gB = void 0,
            newG = void 0;
        var bA = void 0,
            bB = void 0,
            newB = void 0;
        switch (blendMode) {
          case OverlayFilter.BLEND_MODES.NORMAL:
            outputColor.set(inputColor.r + overlayColor.a * alpha * (overlayColor.r - inputColor.r), inputColor.g + overlayColor.a * alpha * (overlayColor.g - inputColor.g), inputColor.b + overlayColor.a * alpha * (overlayColor.b - inputColor.b), inputColor.a);
            break;
          case OverlayFilter.BLEND_MODES.OVERLAY:
            rA = 1 - 2 * (1 - inputColor.r) * (1 - overlayColor.r);
            rB = 2 * inputColor.r * overlayColor.r;
            newR = rA + (inputColor.r < 0.5 ? 1 : 0) * (rB - rA);

            gA = 1 - 2 * (1 - inputColor.g) * (1 - overlayColor.g);
            gB = 2 * inputColor.g * overlayColor.g;
            newG = gA + (inputColor.g < 0.5 ? 1 : 0) * (gB - gA);

            bA = 1 - 2 * (1 - inputColor.b) * (1 - overlayColor.b);
            bB = 2 * inputColor.b * overlayColor.b;
            newB = bA + (inputColor.b < 0.5 ? 1 : 0) * (bB - bA);

            outputColor.set(inputColor.r + overlayColor.a * alpha * (newR - inputColor.r), inputColor.g + overlayColor.a * alpha * (newG - inputColor.g), inputColor.b + overlayColor.a * alpha * (newB - inputColor.b), inputColor.a);
            break;
          case OverlayFilter.BLEND_MODES.HARD_LIGHT:
            rA = 1 - 2 * (1 - overlayColor.r) * (1 - inputColor.r);
            rB = 2 * overlayColor.r * inputColor.r;
            newR = rA + (overlayColor.r < 0.5 ? 1 : 0) * (rB - rA);

            gA = 1 - 2 * (1 - overlayColor.g) * (1 - inputColor.g);
            gB = 2 * overlayColor.g * inputColor.g;
            newG = gA + (overlayColor.g < 0.5 ? 1 : 0) * (gB - gA);

            bA = 1 - 2 * (1 - overlayColor.b) * (1 - inputColor.b);
            bB = 2 * overlayColor.b * inputColor.b;
            newB = bA + (overlayColor.b < 0.5 ? 1 : 0) * (bB - bA);

            outputColor.set(inputColor.r + overlayColor.a * alpha * (newR - inputColor.r), inputColor.g + overlayColor.a * alpha * (newG - inputColor.g), inputColor.b + overlayColor.a * alpha * (newB - inputColor.b), inputColor.a);
            break;
          case OverlayFilter.BLEND_MODES.SOFT_LIGHT:
            rA = 2 * inputColor.r * (1 - overlayColor.r) + (2 * overlayColor.r - 1) * Math.sqrt(inputColor.r);
            rB = 2 * inputColor.r * overlayColor.r + inputColor.r * inputColor.r * (1 - 2 * overlayColor.r);
            newR = rA + (overlayColor.r < 0.5 ? 1 : 0) * (rB - rA);

            gA = 2 * inputColor.g * (1 - overlayColor.g) + (2 * overlayColor.g - 1) * Math.sqrt(inputColor.g);
            gB = 2 * inputColor.g * overlayColor.g + inputColor.g * inputColor.g * (1 - 2 * overlayColor.g);
            newG = gA + (overlayColor.g < 0.5 ? 1 : 0) * (gB - gA);

            bA = 2 * inputColor.b * (1 - overlayColor.b) + (2 * overlayColor.b - 1) * Math.sqrt(inputColor.b);
            bB = 2 * inputColor.b * overlayColor.b + inputColor.b * inputColor.b * (1 - 2 * overlayColor.b);
            newB = bA + (overlayColor.b < 0.5 ? 1 : 0) * (bB - bA);

            outputColor.set(inputColor.r + overlayColor.a * alpha * (newR - inputColor.r), inputColor.g + overlayColor.a * alpha * (newG - inputColor.g), inputColor.b + overlayColor.a * alpha * (newB - inputColor.b), inputColor.a);
            break;
          case OverlayFilter.BLEND_MODES.MULTIPLY:
            newR = inputColor.r * overlayColor.r;
            newG = inputColor.g * overlayColor.g;
            newB = inputColor.b * overlayColor.b;

            outputColor.set(inputColor.r + overlayColor.a * alpha * (newR - inputColor.r), inputColor.g + overlayColor.a * alpha * (newG - inputColor.g), inputColor.b + overlayColor.a * alpha * (newB - inputColor.b), inputColor.a);
            break;
          case OverlayFilter.BLEND_MODES.DARKEN:
            newR = Math.min(inputColor.r, overlayColor.r);
            newG = Math.min(inputColor.g, overlayColor.g);
            newB = Math.min(inputColor.b, overlayColor.b);

            outputColor.set(inputColor.r + overlayColor.a * alpha * (newR - inputColor.r), inputColor.g + overlayColor.a * alpha * (newG - inputColor.g), inputColor.b + overlayColor.a * alpha * (newB - inputColor.b), inputColor.a);
            break;
          case OverlayFilter.BLEND_MODES.LIGHTEN:
            newR = Math.max(inputColor.r, overlayColor.r);
            newG = Math.max(inputColor.g, overlayColor.g);
            newB = Math.max(inputColor.b, overlayColor.b);

            outputColor.set(inputColor.r + overlayColor.a * alpha * (newR - inputColor.r), inputColor.g + overlayColor.a * alpha * (newG - inputColor.g), inputColor.b + overlayColor.a * alpha * (newB - inputColor.b), inputColor.a);
            break;
          case OverlayFilter.BLEND_MODES.SCREEN:
            newR = 1 - (1 - inputColor.r) * (1 - overlayColor.r);
            newG = 1 - (1 - inputColor.g) * (1 - overlayColor.g);
            newB = 1 - (1 - inputColor.b) * (1 - overlayColor.b);

            outputColor.set(inputColor.r + overlayColor.a * alpha * (newR - inputColor.r), inputColor.g + overlayColor.a * alpha * (newG - inputColor.g), inputColor.b + overlayColor.a * alpha * (newB - inputColor.b), inputColor.a);
            break;
          case OverlayFilter.BLEND_MODES.COLOR_BURN:
            newR = Math.max(0, Math.min(1, 1 - (1 - inputColor.r) / Math.max(overlayColor.r, EPSILON)));
            newG = Math.max(0, Math.min(1, 1 - (1 - inputColor.g) / Math.max(overlayColor.g, EPSILON)));
            newB = Math.max(0, Math.min(1, 1 - (1 - inputColor.b) / Math.max(overlayColor.b, EPSILON)));

            outputColor.set(inputColor.r + overlayColor.a * alpha * (newR - inputColor.r), inputColor.g + overlayColor.a * alpha * (newG - inputColor.g), inputColor.b + overlayColor.a * alpha * (newB - inputColor.b), inputColor.a);
            break;
        }

        imageData.data[i] = outputColor.r * 255;
        imageData.data[i + 1] = outputColor.g * 255;
        imageData.data[i + 2] = outputColor.b * 255;
        imageData.data[i + 3] = outputColor.a * 255;
      }

      outputContext.putImageData(imageData, 0, 0);
    }
  }]);

  return OverlayFilter;
}(__WEBPACK_IMPORTED_MODULE_5__filter__["a" /* default */]);

/**
 * Specifies the available tint modes
 * @type {Object}
 */


OverlayFilter.BLEND_MODES = {
  NORMAL: 0,
  OVERLAY: 1,
  HARD_LIGHT: 2,
  SOFT_LIGHT: 3,
  MULTIPLY: 4,
  DARKEN: 5,
  LIGHTEN: 6,
  SCREEN: 7,
  COLOR_BURN: 8

  /**
   * Specifies the available options for this filter
   * @type {Object}
   * @ignore
   */
};OverlayFilter.prototype.availableOptions = {
  blendMode: { type: OptionType.NUMBER, default: OverlayFilter.BLEND_MODES.NORMAL, uniformType: UniformType.INT },
  overlayImage: { type: OptionType.NUMBER, required: true, uniformType: UniformType.SAMPLER2D },
  overlayTexture: { type: OptionType.OBJECT, required: true },
  alpha: { type: OptionType.NUMBER, default: 1, uniformType: UniformType.FLOAT }
};

/* harmony default export */ __webpack_exports__["a"] = (OverlayFilter);

/***/ }),
/* 218 */
/***/ (function(module, exports) {

module.exports = "uniform sampler2D u_image;\nvarying vec2 v_texCoord;\nuniform sampler2D u_overlayImage;\nuniform int u_blendMode;\nuniform float u_alpha;\n\nconst float EPSILON = 0.000001;\n\nvec4 overlay(vec4 a, vec4 b) {\n    vec3 result = mix(\n          1.0 - 2.0 * (1.0 - a.rgb) * (1.0 - b.rgb),\n          2.0 * a.rgb * b.rgb,\n          vec3(a.r < 0.5, a.g < 0.5, a.b < 0.5)\n      );\n    return mix(a, vec4(result, a.a), u_alpha * b.a);\n}\n\nvec4 hardLight(vec4 b, vec4 a) {\n    vec3 result = mix(\n          1.0 - 2.0 * (1.0 - a.rgb) * (1.0 - b.rgb),\n          2.0 * a.rgb * b.rgb,\n          vec3(a.r < 0.5, a.g < 0.5, a.b < 0.5)\n      );\n    return mix(b, vec4(result, b.a), u_alpha * a.a);\n}\n\nvec4 softLight(vec4 a, vec4 b) {\n    vec3 result = mix(\n          2.0 * a.rgb * (1.0 - b.rgb) + (2.0 * b.rgb - 1.0) * sqrt(a.rgb),\n          2.0 * a.rgb * b.rgb + a.rgb * a.rgb * (1.0 - 2.0 * b.rgb),\n          vec3(b.r < 0.5, b.g < 0.5, b.b < 0.5)\n      );\n    return mix(a, vec4(result, a.a), u_alpha * b.a);\n}\n\nvec4 multiply(vec4 a, vec4 b) {\n    vec3 result = a.rgb * b.rgb;\n    return mix(a, vec4(result, a.a), u_alpha * b.a);\n}\n\nvec4 darken(vec4 a, vec4 b) {\n    vec3 result = min(a.rgb, b.rgb);\n    return mix(a, vec4(result, a.a), u_alpha * b.a);\n}\n\nvec4 lighten(vec4 a, vec4 b) {\n    vec3 result = max(a.rgb, b.rgb);\n    return mix(a, vec4(result, a.a), u_alpha * b.a);\n}\n\nvec4 screen(vec4 a, vec4 b) {\n    vec3 result = 1.0 - (1.0 - a.rgb) * (1.0 - b.rgb);\n    return mix(a, vec4(result, a.a), u_alpha * b.a);\n}\n\nvec4 colorBurn(vec4 a, vec4 b) {\n    vec3 result = clamp(1.0 - (1.0 - a.rgb) / max(b.rgb, EPSILON), 0.0, 1.0);\n    return mix(a, vec4(result, a.a), u_alpha * b.a);\n}\n\nvec4 normal(vec4 a, vec4 b) {\n    return mix(a, vec4(b.rgb, a.a), 1.0);\n}\n\nvoid main() {\n  vec4 color = texture2D(u_image, v_texCoord);\n  vec4 overlayColor = texture2D(u_overlayImage, v_texCoord);\n\n  vec4 resultColor;\n  if (u_blendMode == 0) {\n    resultColor = normal(color, overlayColor);\n  } else if (u_blendMode == 1) {\n    resultColor = overlay(color, overlayColor);\n  } else if (u_blendMode == 2) {\n    resultColor = hardLight(color, overlayColor);\n  } else if (u_blendMode == 3) {\n    resultColor = softLight(color, overlayColor);\n  } else if (u_blendMode == 4) {\n    resultColor = multiply(color, overlayColor);\n  } else if (u_blendMode == 5) {\n    resultColor = darken(color, overlayColor);\n  } else if (u_blendMode == 6) {\n    resultColor = lighten(color, overlayColor);\n  } else if (u_blendMode == 7) {\n    resultColor = screen(color, overlayColor);\n  } else if (u_blendMode == 8) {\n    resultColor = colorBurn(color, overlayColor);\n  }\n  gl_FragColor = vec4(resultColor.rgb * resultColor.a, resultColor.a);\n}\n"

/***/ }),
/* 219 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_symbol_iterator__ = __webpack_require__(22);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_symbol_iterator___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_symbol_iterator__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_symbol__ = __webpack_require__(23);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_symbol___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_symbol__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_promise__ = __webpack_require__(11);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_promise___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_promise__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__utils__ = __webpack_require__(24);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__vendor_jsbn__ = __webpack_require__(220);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__lib_base64__ = __webpack_require__(43);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__shared_loaders_json_loader__ = __webpack_require__(47);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__vendor_sha256__ = __webpack_require__(222);





var _typeof = typeof __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_symbol___default.a === "function" && typeof __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_symbol_iterator___default.a === "symbol" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_symbol___default.a === "function" && obj.constructor === __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_symbol___default.a && obj !== __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_symbol___default.a.prototype ? "symbol" : typeof obj; };

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */






var bd = function bd(str) {
  return __WEBPACK_IMPORTED_MODULE_4__utils__["a" /* default */].byteArrayToString(__WEBPACK_IMPORTED_MODULE_6__lib_base64__["a" /* default */].decode(str));
};

function byteArraytoHexString(byteArray) {
  return byteArray.map(function (byte) {
    return ('0' + (byte & 0xFF).toString(16)).slice(-2);
  }).join('');
}

// /track?apiKey= (hashed twice)
var TRACK_PATH = 'TDNSeVlXTnJQMkZ3YVV0bGVUMD0=';
var ENTERPRISE_LICENSE = 'ZW50ZXJwcmlzZV9saWNlbnNl';
var APP_IDENTIFIERS = 'YXBwX2lkZW50aWZpZXJz';
var PLATFORM = 'cGxhdGZvcm0=';
var FEATURES = 'ZmVhdHVyZXM=';
var EXPIRES_AT = 'ZXhwaXJlc19hdA==';
var DOMAINS = 'ZG9tYWlucw==';
var API_TOKEN = 'YXBpX3Rva2Vu';
var SIGNATURE = 'c2lnbmF0dXJl';

/**
 * Checks whether the license of the SDK is valid
 * @class
 * @ignore
 */

var L = function () {
  /**
   * Creates a new VersionChecker
   */
  function L(license) {
    _classCallCheck(this, L);

    this._version = '2.0';
    this._l = typeof license === 'string' ? license.trim() : license;
    this._e = this._parseBigInt('65537', 10);
    this._n = this._parseBigInt('6819840423824240913788063375448466721602926474225172236787752309' + '8336604672061187336820404073576669839528249293719278301686716477' + '3742859209434481353888637963692711665138989982680829529436715362' + '5667358136346796192740590402327288838945110996697754005565843294' + '3537572395130934093465857147866505940324185122919531106934589987' + '0108307225910988692123234379186643268583453907260879685992156955' + '9365611423142339833978193569371093431275044410769200884553375977' + '3647508667624675016897621976339835025479716831395476245954274644' + '0628077261880980924552698138857743609502132632199713575442848784' + '2713045032260453199916894132342284390445225837907138900931659124' + '5542868850746377306421632875326596323793099870689104267910598717' + '5588970202082466871461192706070321938250462103821558100761330890' + '2281356202089358012868786573841087212687618786944368951946284113' + '9745420290435157777150691674661228996405349021099034285740903017' + '9406810634136188751670648983222653319056818302012063874664196648' + '8681563056966446643621715425036653214559713359559486988289399487' + '8672019313267274977616291309200066795329980321640466408798804658' + '4107737900256954976744353601826341965438148646041640662195744770' + '5440947482959458441845074598088031149173011240880824583060864734' + '90516969815873631', 10);
    this._parseLicense();
  }

  /**
   * Checks if the license is valid
   * @return {Boolean}
   */


  _createClass(L, [{
    key: 'v',
    value: function v() {
      return this._sigValid() && !this.isExp();
    }

    /**
     * Checks if the license is a valid JSON
     */

  }, {
    key: '_jsonValid',
    value: function _jsonValid() {
      try {
        this._decLic = JSON.parse(this._l);
      } catch (e) {
        this._decLic = {};
        return false; // not a valid json
      }
      return true;
    }

    /**
     * Checks if this license is valid for the current hostname
     * @return {Boolean}
     * @private
     */

  }, {
    key: '_hostnameValid',
    value: function _hostnameValid() {
      if (typeof window === 'undefined') return true;
      if (!this._decLic[bd(APP_IDENTIFIERS)].length) return true;

      var hostname = window.location.hostname;

      var valid = false;
      this._decLic[bd(APP_IDENTIFIERS)].forEach(function (appIdentifier) {
        if (__WEBPACK_IMPORTED_MODULE_4__utils__["a" /* default */].wildCardMatch(hostname, appIdentifier)) {
          valid = true;
        }
      });
      return valid;
    }

    /**
     * Checks if this license is valid for the current platform
     * @return {Boolean}
     * @private
     */

  }, {
    key: '_platformValid',
    value: function _platformValid() {
      var licensePlatform = this._decLic[bd(PLATFORM)];
      var systemPlatform = typeof WEBPACK === 'undefined' ? 'Server' : 'HTML5';
      return systemPlatform === licensePlatform;
    }

    /**
     * Throws an error if the license is not valid
     */

  }, {
    key: 'c',
    value: function c() {
      var _this = this;

      return new __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_promise___default.a(function (resolve, reject) {
        var licenseType = _typeof(_this._l);
        if (licenseType !== 'string' || !_this._jsonValid()) {
          var error = new Error();
          error.code = 'ELICINVFMT';
          return reject(error);
        }

        if (!_this._sigValid()) {
          var _error = new Error();
          _error.code = 'ELICINV';
          return reject(_error);
        }

        if (!_this._hostnameValid()) {
          var _error2 = new Error();
          _error2.code = 'ELICINVHOST';
          return reject(_error2);
        }

        if (!_this._platformValid()) {
          var _error3 = new Error();
          _error3.code = 'ELICINVPLAT';
          return reject(_error3);
        }

        if (_this.isExp()) {
          var _error4 = new Error();
          _error4.code = 'ELICEXP';
          return reject(_error4);
        }

        resolve();
      });
    }

    /**
     * Checks if the given tool identifier is available per license
     * @param  {String}  identifier
     * @return {Boolean}
     */

  }, {
    key: 'isToolAllowed',
    value: function isToolAllowed(identifier) {
      return this._decLic[bd(FEATURES)] && this._decLic[bd(FEATURES)].indexOf(identifier) !== -1;
    }

    /**
     * Tracks an edit
     * @return {Promise}
     */

  }, {
    key: 't',
    value: function t() {
      if (this._decLic.enterprise_license) return __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_promise___default.a.resolve();

      var trackPath = this._decLic[bd(DOMAINS)][0] + bd(bd(TRACK_PATH)) + this._decLic[bd(API_TOKEN)];
      var jsonLoader = new __WEBPACK_IMPORTED_MODULE_7__shared_loaders_json_loader__["a" /* default */](trackPath);
      return jsonLoader.load();
    }

    /**
     * Checks if this license is an enterprise license
     * @return {Boolean}
     */

  }, {
    key: 'isENT',
    value: function isENT() {
      if (!this._decLic) return false;
      return this._decLic[bd(ENTERPRISE_LICENSE)];
    }

    /**
     * Checks if the license signature is valid
     * @return {Boolean}
     * @private
     */

  }, {
    key: '_sigValid',
    value: function _sigValid() {
      return this._verify(this._message, this._sig);
    }
  }, {
    key: 'exp',
    value: function exp() {
      return !!this._decLic[bd(EXPIRES_AT)];
    }
  }, {
    key: 'dl',
    value: function dl() {
      return Math.ceil((this._expAt() - Date.now()) / (60 * 60 * 24 * 1000));
    }

    /**
     * Check if license is expired now
     * @param {number} current_time
     * @private
     */

  }, {
    key: 'isExp',
    value: function isExp() {
      var now = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : Date.now();

      if (this._decLic[bd(EXPIRES_AT)] === null) return false;
      return now > this._expAt();
    }

    /**
     * Returns the datetime that the license will expire at in milliseconds
     * @return {Number}
     * @private
     */

  }, {
    key: '_expAt',
    value: function _expAt() {
      return this._decLic[bd(EXPIRES_AT)] * 1000;
    }

    /**
     * Verify the signature
     * @param  {String} message
     * @param  {String} signature
     * @return {Boolean}
     * @private
     */

  }, {
    key: '_verify',
    value: function _verify(message, signature) {
      var verification = void 0;
      var messageDigest = void 0;
      // Encode message to messageDigest with sha256
      messageDigest = this._encodeMessage(message);
      // Decode signature
      verification = this._decodeSignature(signature);

      // Cut to correct length of sha256 hash
      verification = verification.substr(-64);
      var isValid = messageDigest === verification;
      return isValid;
    }

    /**
     * Encode the message to sha256 messageDigest
     * @param {String} message
     * @return {String}
     * @private
     */

  }, {
    key: '_encodeMessage',
    value: function _encodeMessage(message) {
      var messageDigest = Object(__WEBPACK_IMPORTED_MODULE_8__vendor_sha256__["a" /* sha256 */])(message);
      return messageDigest;
    }

    /**
     * Decode signature and extract messageDigest
     * @param  {String} signature
     */

  }, {
    key: '_decodeSignature',
    value: function _decodeSignature(signature) {
      var verification = void 0;
      // Decode Base64 to ByteArray
      signature = __WEBPACK_IMPORTED_MODULE_6__lib_base64__["a" /* default */].decode(signature);
      // Convert ByteArray to HexString
      signature = byteArraytoHexString(signature);
      // Convert hex to BigInteger
      signature = this._parseBigInt(signature, 16);
      // Calculate verification
      verification = signature.modPowInt(this._e, this._n);
      // convert to hex
      verification = verification.toString(16);
      return verification;
    }

    /**
     * Parse the given string as a BigInteger with the given base
     * @param {String} str
     * @param {Number} base
     * @return {BigInteger}
     * @private
     */

  }, {
    key: '_parseBigInt',
    value: function _parseBigInt(str, base) {
      return new __WEBPACK_IMPORTED_MODULE_5__vendor_jsbn__["a" /* default */](str, base);
    }

    /**
     * Parses the license
     * @private
     */

  }, {
    key: '_parseLicense',
    value: function _parseLicense() {
      if (typeof this._l !== 'string') return;
      if (!this._jsonValid()) return;

      this._sig = this._decLic[bd(SIGNATURE)] || '';
      delete this._decLic[bd(SIGNATURE)];

      // Replace invalid base64 characters. This includes newlines
      this._sig = this._sig.replace(/[^A-Za-z0-9+/=]/g, '');
      this._message = this._l.replace(new RegExp(',"' + bd(SIGNATURE) + '":"([^"]*)"'), '');
    }
  }]);

  return L;
}();

/* harmony default export */ __webpack_exports__["a"] = (L);

/***/ }),
/* 220 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* unused harmony export int2char */
/* eslint-disable */
/*!
 * Copyright (c) 2003-2005  Tom Wu
 * All Rights Reserved.
 *
 * Permission is hereby granted, free of charge, to any person obtaining
 * a copy of this software and associated documentation files (the
 * "Software"), to deal in the Software without restriction, including
 * without limitation the rights to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to
 * the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS-IS" AND WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS, IMPLIED OR OTHERWISE, INCLUDING WITHOUT LIMITATION, ANY
 * WARRANTY OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.
 *
 * IN NO EVENT SHALL TOM WU BE LIABLE FOR ANY SPECIAL, INCIDENTAL,
 * INDIRECT OR CONSEQUENTIAL DAMAGES OF ANY KIND, OR ANY DAMAGES WHATSOEVER
 * RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER OR NOT ADVISED OF
 * THE POSSIBILITY OF DAMAGE, AND ON ANY THEORY OF LIABILITY, ARISING OUT
 * OF OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * In addition, the following condition applies:
 *
 * All redistributions must retain an intact copy of this copyright notice
 * and disclaimer.
 */

// Polyfill navigator
var navigator = navigator || {};

// Basic JavaScript BN library - subset useful for RSA encryption.

// Bits per digit
var dbits;

// JavaScript engine analysis
var canary = 0xdeadbeefcafe;
var j_lm = (canary & 0xffffff) == 0xefcafe;

// (public) Constructor
function BigInteger(a, b, c) {
  if (a != null) if ("number" == typeof a) this.fromNumber(a, b, c);else if (b == null && "string" != typeof a) this.fromString(a, 256);else this.fromString(a, b);
}

// return new, unset BigInteger
function nbi() {
  return new BigInteger(null);
}

// am: Compute w_j += (x*this_i), propagate carries,
// c is initial carry, returns final carry.
// c < 3*dvalue, x < 2*dvalue, this_i < dvalue
// We need to select the fastest one that works in this environment.

// am1: use a single mult and divide to get the high bits,
// max digit bits should be 26 because
// max internal value = 2*dvalue^2-2*dvalue (< 2^53)
function am1(i, x, w, j, c, n) {
  while (--n >= 0) {
    var v = x * this[i++] + w[j] + c;
    c = Math.floor(v / 0x4000000);
    w[j++] = v & 0x3ffffff;
  }
  return c;
}
// am2 avoids a big mult-and-extract completely.
// Max digit bits should be <= 30 because we do bitwise ops
// on values up to 2*hdvalue^2-hdvalue-1 (< 2^31)
function am2(i, x, w, j, c, n) {
  var xl = x & 0x7fff,
      xh = x >> 15;
  while (--n >= 0) {
    var l = this[i] & 0x7fff;
    var h = this[i++] >> 15;
    var m = xh * l + h * xl;
    l = xl * l + ((m & 0x7fff) << 15) + w[j] + (c & 0x3fffffff);
    c = (l >>> 30) + (m >>> 15) + xh * h + (c >>> 30);
    w[j++] = l & 0x3fffffff;
  }
  return c;
}
// Alternately, set max digit bits to 28 since some
// browsers slow down when dealing with 32-bit numbers.
function am3(i, x, w, j, c, n) {
  var xl = x & 0x3fff,
      xh = x >> 14;
  while (--n >= 0) {
    var l = this[i] & 0x3fff;
    var h = this[i++] >> 14;
    var m = xh * l + h * xl;
    l = xl * l + ((m & 0x3fff) << 14) + w[j] + c;
    c = (l >> 28) + (m >> 14) + xh * h;
    w[j++] = l & 0xfffffff;
  }
  return c;
}

if (j_lm && navigator.appName == "Microsoft Internet Explorer") {
  BigInteger.prototype.am = am2;
  dbits = 30;
} else if (j_lm && navigator.appName != "Netscape") {
  BigInteger.prototype.am = am1;
  dbits = 26;
} else {
  // Mozilla/Netscape seems to prefer am3
  BigInteger.prototype.am = am3;
  dbits = 28;
}

BigInteger.prototype.DB = dbits;
BigInteger.prototype.DM = (1 << dbits) - 1;
BigInteger.prototype.DV = 1 << dbits;

var BI_FP = 52;
BigInteger.prototype.FV = Math.pow(2, BI_FP);
BigInteger.prototype.F1 = BI_FP - dbits;
BigInteger.prototype.F2 = 2 * dbits - BI_FP;

// Digit conversions
var BI_RM = "0123456789abcdefghijklmnopqrstuvwxyz";
var BI_RC = new Array();
var rr, vv;
rr = "0".charCodeAt(0);
for (vv = 0; vv <= 9; ++vv) {
  BI_RC[rr++] = vv;
}rr = "a".charCodeAt(0);
for (vv = 10; vv < 36; ++vv) {
  BI_RC[rr++] = vv;
}rr = "A".charCodeAt(0);
for (vv = 10; vv < 36; ++vv) {
  BI_RC[rr++] = vv;
}function int2char(n) {
  return BI_RM.charAt(n);
}
function intAt(s, i) {
  var c = BI_RC[s.charCodeAt(i)];
  return c == null ? -1 : c;
}

// (protected) copy this to r
function bnpCopyTo(r) {
  for (var i = this.t - 1; i >= 0; --i) {
    r[i] = this[i];
  }r.t = this.t;
  r.s = this.s;
}

// (protected) set from integer value x, -DV <= x < DV
function bnpFromInt(x) {
  this.t = 1;
  this.s = x < 0 ? -1 : 0;
  if (x > 0) this[0] = x;else if (x < -1) this[0] = x + this.DV;else this.t = 0;
}

// return bigint initialized to value
function nbv(i) {
  var r = nbi();r.fromInt(i);return r;
}

// (protected) set from string and radix
function bnpFromString(s, b) {
  var k;
  if (b == 16) k = 4;else if (b == 8) k = 3;else if (b == 256) k = 8; // byte array
  else if (b == 2) k = 1;else if (b == 32) k = 5;else if (b == 4) k = 2;else {
      this.fromRadix(s, b);return;
    }
  this.t = 0;
  this.s = 0;
  var i = s.length,
      mi = false,
      sh = 0;
  while (--i >= 0) {
    var x = k == 8 ? s[i] & 0xff : intAt(s, i);
    if (x < 0) {
      if (s.charAt(i) == "-") mi = true;
      continue;
    }
    mi = false;
    if (sh == 0) this[this.t++] = x;else if (sh + k > this.DB) {
      this[this.t - 1] |= (x & (1 << this.DB - sh) - 1) << sh;
      this[this.t++] = x >> this.DB - sh;
    } else this[this.t - 1] |= x << sh;
    sh += k;
    if (sh >= this.DB) sh -= this.DB;
  }
  if (k == 8 && (s[0] & 0x80) != 0) {
    this.s = -1;
    if (sh > 0) this[this.t - 1] |= (1 << this.DB - sh) - 1 << sh;
  }
  this.clamp();
  if (mi) BigInteger.ZERO.subTo(this, this);
}

// (protected) clamp off excess high words
function bnpClamp() {
  var c = this.s & this.DM;
  while (this.t > 0 && this[this.t - 1] == c) {
    --this.t;
  }
}

// (public) return string representation in given radix
function bnToString(b) {
  if (this.s < 0) return "-" + this.negate().toString(b);
  var k;
  if (b == 16) k = 4;else if (b == 8) k = 3;else if (b == 2) k = 1;else if (b == 32) k = 5;else if (b == 4) k = 2;else return this.toRadix(b);
  var km = (1 << k) - 1,
      d,
      m = false,
      r = "",
      i = this.t;
  var p = this.DB - i * this.DB % k;
  if (i-- > 0) {
    if (p < this.DB && (d = this[i] >> p) > 0) {
      m = true;r = int2char(d);
    }
    while (i >= 0) {
      if (p < k) {
        d = (this[i] & (1 << p) - 1) << k - p;
        d |= this[--i] >> (p += this.DB - k);
      } else {
        d = this[i] >> (p -= k) & km;
        if (p <= 0) {
          p += this.DB;--i;
        }
      }
      if (d > 0) m = true;
      if (m) r += int2char(d);
    }
  }
  return m ? r : "0";
}

// (public) -this
function bnNegate() {
  var r = nbi();BigInteger.ZERO.subTo(this, r);return r;
}

// (public) |this|
function bnAbs() {
  return this.s < 0 ? this.negate() : this;
}

// (public) return + if this > a, - if this < a, 0 if equal
function bnCompareTo(a) {
  var r = this.s - a.s;
  if (r != 0) return r;
  var i = this.t;
  r = i - a.t;
  if (r != 0) return this.s < 0 ? -r : r;
  while (--i >= 0) {
    if ((r = this[i] - a[i]) != 0) return r;
  }return 0;
}

// returns bit length of the integer x
function nbits(x) {
  var r = 1,
      t;
  if ((t = x >>> 16) != 0) {
    x = t;r += 16;
  }
  if ((t = x >> 8) != 0) {
    x = t;r += 8;
  }
  if ((t = x >> 4) != 0) {
    x = t;r += 4;
  }
  if ((t = x >> 2) != 0) {
    x = t;r += 2;
  }
  if ((t = x >> 1) != 0) {
    x = t;r += 1;
  }
  return r;
}

// (public) return the number of bits in "this"
function bnBitLength() {
  if (this.t <= 0) return 0;
  return this.DB * (this.t - 1) + nbits(this[this.t - 1] ^ this.s & this.DM);
}

// (protected) r = this << n*DB
function bnpDLShiftTo(n, r) {
  var i;
  for (i = this.t - 1; i >= 0; --i) {
    r[i + n] = this[i];
  }for (i = n - 1; i >= 0; --i) {
    r[i] = 0;
  }r.t = this.t + n;
  r.s = this.s;
}

// (protected) r = this >> n*DB
function bnpDRShiftTo(n, r) {
  for (var i = n; i < this.t; ++i) {
    r[i - n] = this[i];
  }r.t = Math.max(this.t - n, 0);
  r.s = this.s;
}

// (protected) r = this << n
function bnpLShiftTo(n, r) {
  var bs = n % this.DB;
  var cbs = this.DB - bs;
  var bm = (1 << cbs) - 1;
  var ds = Math.floor(n / this.DB),
      c = this.s << bs & this.DM,
      i;
  for (i = this.t - 1; i >= 0; --i) {
    r[i + ds + 1] = this[i] >> cbs | c;
    c = (this[i] & bm) << bs;
  }
  for (i = ds - 1; i >= 0; --i) {
    r[i] = 0;
  }r[ds] = c;
  r.t = this.t + ds + 1;
  r.s = this.s;
  r.clamp();
}

// (protected) r = this >> n
function bnpRShiftTo(n, r) {
  r.s = this.s;
  var ds = Math.floor(n / this.DB);
  if (ds >= this.t) {
    r.t = 0;return;
  }
  var bs = n % this.DB;
  var cbs = this.DB - bs;
  var bm = (1 << bs) - 1;
  r[0] = this[ds] >> bs;
  for (var i = ds + 1; i < this.t; ++i) {
    r[i - ds - 1] |= (this[i] & bm) << cbs;
    r[i - ds] = this[i] >> bs;
  }
  if (bs > 0) r[this.t - ds - 1] |= (this.s & bm) << cbs;
  r.t = this.t - ds;
  r.clamp();
}

// (protected) r = this - a
function bnpSubTo(a, r) {
  var i = 0,
      c = 0,
      m = Math.min(a.t, this.t);
  while (i < m) {
    c += this[i] - a[i];
    r[i++] = c & this.DM;
    c >>= this.DB;
  }
  if (a.t < this.t) {
    c -= a.s;
    while (i < this.t) {
      c += this[i];
      r[i++] = c & this.DM;
      c >>= this.DB;
    }
    c += this.s;
  } else {
    c += this.s;
    while (i < a.t) {
      c -= a[i];
      r[i++] = c & this.DM;
      c >>= this.DB;
    }
    c -= a.s;
  }
  r.s = c < 0 ? -1 : 0;
  if (c < -1) r[i++] = this.DV + c;else if (c > 0) r[i++] = c;
  r.t = i;
  r.clamp();
}

// (protected) r = this * a, r != this,a (HAC 14.12)
// "this" should be the larger one if appropriate.
function bnpMultiplyTo(a, r) {
  var x = this.abs(),
      y = a.abs();
  var i = x.t;
  r.t = i + y.t;
  while (--i >= 0) {
    r[i] = 0;
  }for (i = 0; i < y.t; ++i) {
    r[i + x.t] = x.am(0, y[i], r, i, 0, x.t);
  }r.s = 0;
  r.clamp();
  if (this.s != a.s) BigInteger.ZERO.subTo(r, r);
}

// (protected) r = this^2, r != this (HAC 14.16)
function bnpSquareTo(r) {
  var x = this.abs();
  var i = r.t = 2 * x.t;
  while (--i >= 0) {
    r[i] = 0;
  }for (i = 0; i < x.t - 1; ++i) {
    var c = x.am(i, x[i], r, 2 * i, 0, 1);
    if ((r[i + x.t] += x.am(i + 1, 2 * x[i], r, 2 * i + 1, c, x.t - i - 1)) >= x.DV) {
      r[i + x.t] -= x.DV;
      r[i + x.t + 1] = 1;
    }
  }
  if (r.t > 0) r[r.t - 1] += x.am(i, x[i], r, 2 * i, 0, 1);
  r.s = 0;
  r.clamp();
}

// (protected) divide this by m, quotient and remainder to q, r (HAC 14.20)
// r != q, this != m.  q or r may be null.
function bnpDivRemTo(m, q, r) {
  var pm = m.abs();
  if (pm.t <= 0) return;
  var pt = this.abs();
  if (pt.t < pm.t) {
    if (q != null) q.fromInt(0);
    if (r != null) this.copyTo(r);
    return;
  }
  if (r == null) r = nbi();
  var y = nbi(),
      ts = this.s,
      ms = m.s;
  var nsh = this.DB - nbits(pm[pm.t - 1]); // normalize modulus
  if (nsh > 0) {
    pm.lShiftTo(nsh, y);pt.lShiftTo(nsh, r);
  } else {
    pm.copyTo(y);pt.copyTo(r);
  }
  var ys = y.t;
  var y0 = y[ys - 1];
  if (y0 == 0) return;
  var yt = y0 * (1 << this.F1) + (ys > 1 ? y[ys - 2] >> this.F2 : 0);
  var d1 = this.FV / yt,
      d2 = (1 << this.F1) / yt,
      e = 1 << this.F2;
  var i = r.t,
      j = i - ys,
      t = q == null ? nbi() : q;
  y.dlShiftTo(j, t);
  if (r.compareTo(t) >= 0) {
    r[r.t++] = 1;
    r.subTo(t, r);
  }
  BigInteger.ONE.dlShiftTo(ys, t);
  t.subTo(y, y); // "negative" y so we can replace sub with am later
  while (y.t < ys) {
    y[y.t++] = 0;
  }while (--j >= 0) {
    // Estimate quotient digit
    var qd = r[--i] == y0 ? this.DM : Math.floor(r[i] * d1 + (r[i - 1] + e) * d2);
    if ((r[i] += y.am(0, qd, r, j, 0, ys)) < qd) {
      // Try it out
      y.dlShiftTo(j, t);
      r.subTo(t, r);
      while (r[i] < --qd) {
        r.subTo(t, r);
      }
    }
  }
  if (q != null) {
    r.drShiftTo(ys, q);
    if (ts != ms) BigInteger.ZERO.subTo(q, q);
  }
  r.t = ys;
  r.clamp();
  if (nsh > 0) r.rShiftTo(nsh, r); // Denormalize remainder
  if (ts < 0) BigInteger.ZERO.subTo(r, r);
}

// (public) this mod a
function bnMod(a) {
  var r = nbi();
  this.abs().divRemTo(a, null, r);
  if (this.s < 0 && r.compareTo(BigInteger.ZERO) > 0) a.subTo(r, r);
  return r;
}

// Modular reduction using "classic" algorithm
function Classic(m) {
  this.m = m;
}
function cConvert(x) {
  if (x.s < 0 || x.compareTo(this.m) >= 0) return x.mod(this.m);else return x;
}
function cRevert(x) {
  return x;
}
function cReduce(x) {
  x.divRemTo(this.m, null, x);
}
function cMulTo(x, y, r) {
  x.multiplyTo(y, r);this.reduce(r);
}
function cSqrTo(x, r) {
  x.squareTo(r);this.reduce(r);
}

Classic.prototype.convert = cConvert;
Classic.prototype.revert = cRevert;
Classic.prototype.reduce = cReduce;
Classic.prototype.mulTo = cMulTo;
Classic.prototype.sqrTo = cSqrTo;

// (protected) return "-1/this % 2^DB"; useful for Mont. reduction
// justification:
//         xy == 1 (mod m)
//         xy =  1+km
//   xy(2-xy) = (1+km)(1-km)
// x[y(2-xy)] = 1-k^2m^2
// x[y(2-xy)] == 1 (mod m^2)
// if y is 1/x mod m, then y(2-xy) is 1/x mod m^2
// should reduce x and y(2-xy) by m^2 at each step to keep size bounded.
// JS multiply "overflows" differently from C/C++, so care is needed here.
function bnpInvDigit() {
  if (this.t < 1) return 0;
  var x = this[0];
  if ((x & 1) == 0) return 0;
  var y = x & 3; // y == 1/x mod 2^2
  y = y * (2 - (x & 0xf) * y) & 0xf; // y == 1/x mod 2^4
  y = y * (2 - (x & 0xff) * y) & 0xff; // y == 1/x mod 2^8
  y = y * (2 - ((x & 0xffff) * y & 0xffff)) & 0xffff; // y == 1/x mod 2^16
  // last step - calculate inverse mod DV directly;
  // assumes 16 < DB <= 32 and assumes ability to handle 48-bit ints
  y = y * (2 - x * y % this.DV) % this.DV; // y == 1/x mod 2^dbits
  // we really want the negative inverse, and -DV < y < DV
  return y > 0 ? this.DV - y : -y;
}

// Montgomery reduction
function Montgomery(m) {
  this.m = m;
  this.mp = m.invDigit();
  this.mpl = this.mp & 0x7fff;
  this.mph = this.mp >> 15;
  this.um = (1 << m.DB - 15) - 1;
  this.mt2 = 2 * m.t;
}

// xR mod m
function montConvert(x) {
  var r = nbi();
  x.abs().dlShiftTo(this.m.t, r);
  r.divRemTo(this.m, null, r);
  if (x.s < 0 && r.compareTo(BigInteger.ZERO) > 0) this.m.subTo(r, r);
  return r;
}

// x/R mod m
function montRevert(x) {
  var r = nbi();
  x.copyTo(r);
  this.reduce(r);
  return r;
}

// x = x/R mod m (HAC 14.32)
function montReduce(x) {
  while (x.t <= this.mt2) {
    // pad x so am has enough room later
    x[x.t++] = 0;
  }for (var i = 0; i < this.m.t; ++i) {
    // faster way of calculating u0 = x[i]*mp mod DV
    var j = x[i] & 0x7fff;
    var u0 = j * this.mpl + ((j * this.mph + (x[i] >> 15) * this.mpl & this.um) << 15) & x.DM;
    // use am to combine the multiply-shift-add into one call
    j = i + this.m.t;
    x[j] += this.m.am(0, u0, x, i, 0, this.m.t);
    // propagate carry
    while (x[j] >= x.DV) {
      x[j] -= x.DV;x[++j]++;
    }
  }
  x.clamp();
  x.drShiftTo(this.m.t, x);
  if (x.compareTo(this.m) >= 0) x.subTo(this.m, x);
}

// r = "x^2/R mod m"; x != r
function montSqrTo(x, r) {
  x.squareTo(r);this.reduce(r);
}

// r = "xy/R mod m"; x,y != r
function montMulTo(x, y, r) {
  x.multiplyTo(y, r);this.reduce(r);
}

Montgomery.prototype.convert = montConvert;
Montgomery.prototype.revert = montRevert;
Montgomery.prototype.reduce = montReduce;
Montgomery.prototype.mulTo = montMulTo;
Montgomery.prototype.sqrTo = montSqrTo;

// (protected) true iff this is even
function bnpIsEven() {
  return (this.t > 0 ? this[0] & 1 : this.s) == 0;
}

// (protected) this^e, e < 2^32, doing sqr and mul with "r" (HAC 14.79)
function bnpExp(e, z) {
  if (e > 0xffffffff || e < 1) return BigInteger.ONE;
  var r = nbi(),
      r2 = nbi(),
      g = z.convert(this),
      i = nbits(e) - 1;
  g.copyTo(r);
  while (--i >= 0) {
    z.sqrTo(r, r2);
    if ((e & 1 << i) > 0) z.mulTo(r2, g, r);else {
      var t = r;r = r2;r2 = t;
    }
  }
  return z.revert(r);
}

// (public) this^e % m, 0 <= e < 2^32
function bnModPowInt(e, m) {
  var z;
  if (e < 256 || m.isEven()) z = new Classic(m);else z = new Montgomery(m);
  return this.exp(e, z);
}

// protected
BigInteger.prototype.copyTo = bnpCopyTo;
BigInteger.prototype.fromInt = bnpFromInt;
BigInteger.prototype.fromString = bnpFromString;
BigInteger.prototype.clamp = bnpClamp;
BigInteger.prototype.dlShiftTo = bnpDLShiftTo;
BigInteger.prototype.drShiftTo = bnpDRShiftTo;
BigInteger.prototype.lShiftTo = bnpLShiftTo;
BigInteger.prototype.rShiftTo = bnpRShiftTo;
BigInteger.prototype.subTo = bnpSubTo;
BigInteger.prototype.multiplyTo = bnpMultiplyTo;
BigInteger.prototype.squareTo = bnpSquareTo;
BigInteger.prototype.divRemTo = bnpDivRemTo;
BigInteger.prototype.invDigit = bnpInvDigit;
BigInteger.prototype.isEven = bnpIsEven;
BigInteger.prototype.exp = bnpExp;

// public
BigInteger.prototype.toString = bnToString;
BigInteger.prototype.negate = bnNegate;
BigInteger.prototype.abs = bnAbs;
BigInteger.prototype.compareTo = bnCompareTo;
BigInteger.prototype.bitLength = bnBitLength;
BigInteger.prototype.mod = bnMod;
BigInteger.prototype.modPowInt = bnModPowInt;

// "constants"
BigInteger.ZERO = nbv(0);
BigInteger.ONE = nbv(1);

// Copyright (c) 2005-2009  Tom Wu
// All Rights Reserved.
// See "LICENSE" for details.

// Extended JavaScript BN functions, required for RSA private ops.

// Version 1.1: new BigInteger("0", 10) returns "proper" zero
// Version 1.2: square() API, isProbablePrime fix

// (public)
function bnClone() {
  var r = nbi();this.copyTo(r);return r;
}

// (public) return value as integer
function bnIntValue() {
  if (this.s < 0) {
    if (this.t == 1) return this[0] - this.DV;else if (this.t == 0) return -1;
  } else if (this.t == 1) return this[0];else if (this.t == 0) return 0;
  // assumes 16 < DB < 32
  return (this[1] & (1 << 32 - this.DB) - 1) << this.DB | this[0];
}

// (public) return value as byte
function bnByteValue() {
  return this.t == 0 ? this.s : this[0] << 24 >> 24;
}

// (public) return value as short (assumes DB>=16)
function bnShortValue() {
  return this.t == 0 ? this.s : this[0] << 16 >> 16;
}

// (protected) return x s.t. r^x < DV
function bnpChunkSize(r) {
  return Math.floor(Math.LN2 * this.DB / Math.log(r));
}

// (public) 0 if this == 0, 1 if this > 0
function bnSigNum() {
  if (this.s < 0) return -1;else if (this.t <= 0 || this.t == 1 && this[0] <= 0) return 0;else return 1;
}

// (protected) convert to radix string
function bnpToRadix(b) {
  if (b == null) b = 10;
  if (this.signum() == 0 || b < 2 || b > 36) return "0";
  var cs = this.chunkSize(b);
  var a = Math.pow(b, cs);
  var d = nbv(a),
      y = nbi(),
      z = nbi(),
      r = "";
  this.divRemTo(d, y, z);
  while (y.signum() > 0) {
    r = (a + z.intValue()).toString(b).substr(1) + r;
    y.divRemTo(d, y, z);
  }
  return z.intValue().toString(b) + r;
}

// (protected) convert from radix string
function bnpFromRadix(s, b) {
  this.fromInt(0);
  if (b == null) b = 10;
  var cs = this.chunkSize(b);
  var d = Math.pow(b, cs),
      mi = false,
      j = 0,
      w = 0;
  for (var i = 0; i < s.length; ++i) {
    var x = intAt(s, i);
    if (x < 0) {
      if (s.charAt(i) == "-" && this.signum() == 0) mi = true;
      continue;
    }
    w = b * w + x;
    if (++j >= cs) {
      this.dMultiply(d);
      this.dAddOffset(w, 0);
      j = 0;
      w = 0;
    }
  }
  if (j > 0) {
    this.dMultiply(Math.pow(b, j));
    this.dAddOffset(w, 0);
  }
  if (mi) BigInteger.ZERO.subTo(this, this);
}

// (protected) alternate constructor
function bnpFromNumber(a, b, c) {
  if ("number" == typeof b) {
    // new BigInteger(int,int,RNG)
    if (a < 2) this.fromInt(1);else {
      this.fromNumber(a, c);
      if (!this.testBit(a - 1)) // force MSB set
        this.bitwiseTo(BigInteger.ONE.shiftLeft(a - 1), op_or, this);
      if (this.isEven()) this.dAddOffset(1, 0); // force odd
      while (!this.isProbablePrime(b)) {
        this.dAddOffset(2, 0);
        if (this.bitLength() > a) this.subTo(BigInteger.ONE.shiftLeft(a - 1), this);
      }
    }
  } else {
    // new BigInteger(int,RNG)
    var x = new Array(),
        t = a & 7;
    x.length = (a >> 3) + 1;
    b.nextBytes(x);
    if (t > 0) x[0] &= (1 << t) - 1;else x[0] = 0;
    this.fromString(x, 256);
  }
}

// (public) convert to bigendian byte array
function bnToByteArray() {
  var i = this.t,
      r = new Array();
  r[0] = this.s;
  var p = this.DB - i * this.DB % 8,
      d,
      k = 0;
  if (i-- > 0) {
    if (p < this.DB && (d = this[i] >> p) != (this.s & this.DM) >> p) r[k++] = d | this.s << this.DB - p;
    while (i >= 0) {
      if (p < 8) {
        d = (this[i] & (1 << p) - 1) << 8 - p;
        d |= this[--i] >> (p += this.DB - 8);
      } else {
        d = this[i] >> (p -= 8) & 0xff;
        if (p <= 0) {
          p += this.DB;--i;
        }
      }
      if ((d & 0x80) != 0) d |= -256;
      if (k == 0 && (this.s & 0x80) != (d & 0x80)) ++k;
      if (k > 0 || d != this.s) r[k++] = d;
    }
  }
  return r;
}

function bnEquals(a) {
  return this.compareTo(a) == 0;
}
function bnMin(a) {
  return this.compareTo(a) < 0 ? this : a;
}
function bnMax(a) {
  return this.compareTo(a) > 0 ? this : a;
}

// (protected) r = this op a (bitwise)
function bnpBitwiseTo(a, op, r) {
  var i,
      f,
      m = Math.min(a.t, this.t);
  for (i = 0; i < m; ++i) {
    r[i] = op(this[i], a[i]);
  }if (a.t < this.t) {
    f = a.s & this.DM;
    for (i = m; i < this.t; ++i) {
      r[i] = op(this[i], f);
    }r.t = this.t;
  } else {
    f = this.s & this.DM;
    for (i = m; i < a.t; ++i) {
      r[i] = op(f, a[i]);
    }r.t = a.t;
  }
  r.s = op(this.s, a.s);
  r.clamp();
}

// (public) this & a
function op_and(x, y) {
  return x & y;
}
function bnAnd(a) {
  var r = nbi();this.bitwiseTo(a, op_and, r);return r;
}

// (public) this | a
function op_or(x, y) {
  return x | y;
}
function bnOr(a) {
  var r = nbi();this.bitwiseTo(a, op_or, r);return r;
}

// (public) this ^ a
function op_xor(x, y) {
  return x ^ y;
}
function bnXor(a) {
  var r = nbi();this.bitwiseTo(a, op_xor, r);return r;
}

// (public) this & ~a
function op_andnot(x, y) {
  return x & ~y;
}
function bnAndNot(a) {
  var r = nbi();this.bitwiseTo(a, op_andnot, r);return r;
}

// (public) ~this
function bnNot() {
  var r = nbi();
  for (var i = 0; i < this.t; ++i) {
    r[i] = this.DM & ~this[i];
  }r.t = this.t;
  r.s = ~this.s;
  return r;
}

// (public) this << n
function bnShiftLeft(n) {
  var r = nbi();
  if (n < 0) this.rShiftTo(-n, r);else this.lShiftTo(n, r);
  return r;
}

// (public) this >> n
function bnShiftRight(n) {
  var r = nbi();
  if (n < 0) this.lShiftTo(-n, r);else this.rShiftTo(n, r);
  return r;
}

// return index of lowest 1-bit in x, x < 2^31
function lbit(x) {
  if (x == 0) return -1;
  var r = 0;
  if ((x & 0xffff) == 0) {
    x >>= 16;r += 16;
  }
  if ((x & 0xff) == 0) {
    x >>= 8;r += 8;
  }
  if ((x & 0xf) == 0) {
    x >>= 4;r += 4;
  }
  if ((x & 3) == 0) {
    x >>= 2;r += 2;
  }
  if ((x & 1) == 0) ++r;
  return r;
}

// (public) returns index of lowest 1-bit (or -1 if none)
function bnGetLowestSetBit() {
  for (var i = 0; i < this.t; ++i) {
    if (this[i] != 0) return i * this.DB + lbit(this[i]);
  }if (this.s < 0) return this.t * this.DB;
  return -1;
}

// return number of 1 bits in x
function cbit(x) {
  var r = 0;
  while (x != 0) {
    x &= x - 1;++r;
  }
  return r;
}

// (public) return number of set bits
function bnBitCount() {
  var r = 0,
      x = this.s & this.DM;
  for (var i = 0; i < this.t; ++i) {
    r += cbit(this[i] ^ x);
  }return r;
}

// (public) true iff nth bit is set
function bnTestBit(n) {
  var j = Math.floor(n / this.DB);
  if (j >= this.t) return this.s != 0;
  return (this[j] & 1 << n % this.DB) != 0;
}

// (protected) this op (1<<n)
function bnpChangeBit(n, op) {
  var r = BigInteger.ONE.shiftLeft(n);
  this.bitwiseTo(r, op, r);
  return r;
}

// (public) this | (1<<n)
function bnSetBit(n) {
  return this.changeBit(n, op_or);
}

// (public) this & ~(1<<n)
function bnClearBit(n) {
  return this.changeBit(n, op_andnot);
}

// (public) this ^ (1<<n)
function bnFlipBit(n) {
  return this.changeBit(n, op_xor);
}

// (protected) r = this + a
function bnpAddTo(a, r) {
  var i = 0,
      c = 0,
      m = Math.min(a.t, this.t);
  while (i < m) {
    c += this[i] + a[i];
    r[i++] = c & this.DM;
    c >>= this.DB;
  }
  if (a.t < this.t) {
    c += a.s;
    while (i < this.t) {
      c += this[i];
      r[i++] = c & this.DM;
      c >>= this.DB;
    }
    c += this.s;
  } else {
    c += this.s;
    while (i < a.t) {
      c += a[i];
      r[i++] = c & this.DM;
      c >>= this.DB;
    }
    c += a.s;
  }
  r.s = c < 0 ? -1 : 0;
  if (c > 0) r[i++] = c;else if (c < -1) r[i++] = this.DV + c;
  r.t = i;
  r.clamp();
}

// (public) this + a
function bnAdd(a) {
  var r = nbi();this.addTo(a, r);return r;
}

// (public) this - a
function bnSubtract(a) {
  var r = nbi();this.subTo(a, r);return r;
}

// (public) this * a
function bnMultiply(a) {
  var r = nbi();this.multiplyTo(a, r);return r;
}

// (public) this^2
function bnSquare() {
  var r = nbi();this.squareTo(r);return r;
}

// (public) this / a
function bnDivide(a) {
  var r = nbi();this.divRemTo(a, r, null);return r;
}

// (public) this % a
function bnRemainder(a) {
  var r = nbi();this.divRemTo(a, null, r);return r;
}

// (public) [this/a,this%a]
function bnDivideAndRemainder(a) {
  var q = nbi(),
      r = nbi();
  this.divRemTo(a, q, r);
  return new Array(q, r);
}

// (protected) this *= n, this >= 0, 1 < n < DV
function bnpDMultiply(n) {
  this[this.t] = this.am(0, n - 1, this, 0, 0, this.t);
  ++this.t;
  this.clamp();
}

// (protected) this += n << w words, this >= 0
function bnpDAddOffset(n, w) {
  if (n == 0) return;
  while (this.t <= w) {
    this[this.t++] = 0;
  }this[w] += n;
  while (this[w] >= this.DV) {
    this[w] -= this.DV;
    if (++w >= this.t) this[this.t++] = 0;
    ++this[w];
  }
}

// A "null" reducer
function NullExp() {}
function nNop(x) {
  return x;
}
function nMulTo(x, y, r) {
  x.multiplyTo(y, r);
}
function nSqrTo(x, r) {
  x.squareTo(r);
}

NullExp.prototype.convert = nNop;
NullExp.prototype.revert = nNop;
NullExp.prototype.mulTo = nMulTo;
NullExp.prototype.sqrTo = nSqrTo;

// (public) this^e
function bnPow(e) {
  return this.exp(e, new NullExp());
}

// (protected) r = lower n words of "this * a", a.t <= n
// "this" should be the larger one if appropriate.
function bnpMultiplyLowerTo(a, n, r) {
  var i = Math.min(this.t + a.t, n);
  r.s = 0; // assumes a,this >= 0
  r.t = i;
  while (i > 0) {
    r[--i] = 0;
  }var j;
  for (j = r.t - this.t; i < j; ++i) {
    r[i + this.t] = this.am(0, a[i], r, i, 0, this.t);
  }for (j = Math.min(a.t, n); i < j; ++i) {
    this.am(0, a[i], r, i, 0, n - i);
  }r.clamp();
}

// (protected) r = "this * a" without lower n words, n > 0
// "this" should be the larger one if appropriate.
function bnpMultiplyUpperTo(a, n, r) {
  --n;
  var i = r.t = this.t + a.t - n;
  r.s = 0; // assumes a,this >= 0
  while (--i >= 0) {
    r[i] = 0;
  }for (i = Math.max(n - this.t, 0); i < a.t; ++i) {
    r[this.t + i - n] = this.am(n - i, a[i], r, 0, 0, this.t + i - n);
  }r.clamp();
  r.drShiftTo(1, r);
}

// Barrett modular reduction
function Barrett(m) {
  // setup Barrett
  this.r2 = nbi();
  this.q3 = nbi();
  BigInteger.ONE.dlShiftTo(2 * m.t, this.r2);
  this.mu = this.r2.divide(m);
  this.m = m;
}

function barrettConvert(x) {
  if (x.s < 0 || x.t > 2 * this.m.t) return x.mod(this.m);else if (x.compareTo(this.m) < 0) return x;else {
    var r = nbi();x.copyTo(r);this.reduce(r);return r;
  }
}

function barrettRevert(x) {
  return x;
}

// x = x mod m (HAC 14.42)
function barrettReduce(x) {
  x.drShiftTo(this.m.t - 1, this.r2);
  if (x.t > this.m.t + 1) {
    x.t = this.m.t + 1;x.clamp();
  }
  this.mu.multiplyUpperTo(this.r2, this.m.t + 1, this.q3);
  this.m.multiplyLowerTo(this.q3, this.m.t + 1, this.r2);
  while (x.compareTo(this.r2) < 0) {
    x.dAddOffset(1, this.m.t + 1);
  }x.subTo(this.r2, x);
  while (x.compareTo(this.m) >= 0) {
    x.subTo(this.m, x);
  }
}

// r = x^2 mod m; x != r
function barrettSqrTo(x, r) {
  x.squareTo(r);this.reduce(r);
}

// r = x*y mod m; x,y != r
function barrettMulTo(x, y, r) {
  x.multiplyTo(y, r);this.reduce(r);
}

Barrett.prototype.convert = barrettConvert;
Barrett.prototype.revert = barrettRevert;
Barrett.prototype.reduce = barrettReduce;
Barrett.prototype.mulTo = barrettMulTo;
Barrett.prototype.sqrTo = barrettSqrTo;

// (public) this^e % m (HAC 14.85)
function bnModPow(e, m) {
  var i = e.bitLength(),
      k,
      r = nbv(1),
      z;
  if (i <= 0) return r;else if (i < 18) k = 1;else if (i < 48) k = 3;else if (i < 144) k = 4;else if (i < 768) k = 5;else k = 6;
  if (i < 8) z = new Classic(m);else if (m.isEven()) z = new Barrett(m);else z = new Montgomery(m);

  // precomputation
  var g = new Array(),
      n = 3,
      k1 = k - 1,
      km = (1 << k) - 1;
  g[1] = z.convert(this);
  if (k > 1) {
    var g2 = nbi();
    z.sqrTo(g[1], g2);
    while (n <= km) {
      g[n] = nbi();
      z.mulTo(g2, g[n - 2], g[n]);
      n += 2;
    }
  }

  var j = e.t - 1,
      w,
      is1 = true,
      r2 = nbi(),
      t;
  i = nbits(e[j]) - 1;
  while (j >= 0) {
    if (i >= k1) w = e[j] >> i - k1 & km;else {
      w = (e[j] & (1 << i + 1) - 1) << k1 - i;
      if (j > 0) w |= e[j - 1] >> this.DB + i - k1;
    }

    n = k;
    while ((w & 1) == 0) {
      w >>= 1;--n;
    }
    if ((i -= n) < 0) {
      i += this.DB;--j;
    }
    if (is1) {
      // ret == 1, don't bother squaring or multiplying it
      g[w].copyTo(r);
      is1 = false;
    } else {
      while (n > 1) {
        z.sqrTo(r, r2);z.sqrTo(r2, r);n -= 2;
      }
      if (n > 0) z.sqrTo(r, r2);else {
        t = r;r = r2;r2 = t;
      }
      z.mulTo(r2, g[w], r);
    }

    while (j >= 0 && (e[j] & 1 << i) == 0) {
      z.sqrTo(r, r2);t = r;r = r2;r2 = t;
      if (--i < 0) {
        i = this.DB - 1;--j;
      }
    }
  }
  return z.revert(r);
}

// (public) gcd(this,a) (HAC 14.54)
function bnGCD(a) {
  var x = this.s < 0 ? this.negate() : this.clone();
  var y = a.s < 0 ? a.negate() : a.clone();
  if (x.compareTo(y) < 0) {
    var t = x;x = y;y = t;
  }
  var i = x.getLowestSetBit(),
      g = y.getLowestSetBit();
  if (g < 0) return x;
  if (i < g) g = i;
  if (g > 0) {
    x.rShiftTo(g, x);
    y.rShiftTo(g, y);
  }
  while (x.signum() > 0) {
    if ((i = x.getLowestSetBit()) > 0) x.rShiftTo(i, x);
    if ((i = y.getLowestSetBit()) > 0) y.rShiftTo(i, y);
    if (x.compareTo(y) >= 0) {
      x.subTo(y, x);
      x.rShiftTo(1, x);
    } else {
      y.subTo(x, y);
      y.rShiftTo(1, y);
    }
  }
  if (g > 0) y.lShiftTo(g, y);
  return y;
}

// (protected) this % n, n < 2^26
function bnpModInt(n) {
  if (n <= 0) return 0;
  var d = this.DV % n,
      r = this.s < 0 ? n - 1 : 0;
  if (this.t > 0) if (d == 0) r = this[0] % n;else for (var i = this.t - 1; i >= 0; --i) {
    r = (d * r + this[i]) % n;
  }return r;
}

// (public) 1/this % m (HAC 14.61)
function bnModInverse(m) {
  var ac = m.isEven();
  if (this.isEven() && ac || m.signum() == 0) return BigInteger.ZERO;
  var u = m.clone(),
      v = this.clone();
  var a = nbv(1),
      b = nbv(0),
      c = nbv(0),
      d = nbv(1);
  while (u.signum() != 0) {
    while (u.isEven()) {
      u.rShiftTo(1, u);
      if (ac) {
        if (!a.isEven() || !b.isEven()) {
          a.addTo(this, a);b.subTo(m, b);
        }
        a.rShiftTo(1, a);
      } else if (!b.isEven()) b.subTo(m, b);
      b.rShiftTo(1, b);
    }
    while (v.isEven()) {
      v.rShiftTo(1, v);
      if (ac) {
        if (!c.isEven() || !d.isEven()) {
          c.addTo(this, c);d.subTo(m, d);
        }
        c.rShiftTo(1, c);
      } else if (!d.isEven()) d.subTo(m, d);
      d.rShiftTo(1, d);
    }
    if (u.compareTo(v) >= 0) {
      u.subTo(v, u);
      if (ac) a.subTo(c, a);
      b.subTo(d, b);
    } else {
      v.subTo(u, v);
      if (ac) c.subTo(a, c);
      d.subTo(b, d);
    }
  }
  if (v.compareTo(BigInteger.ONE) != 0) return BigInteger.ZERO;
  if (d.compareTo(m) >= 0) return d.subtract(m);
  if (d.signum() < 0) d.addTo(m, d);else return d;
  if (d.signum() < 0) return d.add(m);else return d;
}

var lowprimes = [2, 3, 5, 7, 11, 13, 17, 19, 23, 29, 31, 37, 41, 43, 47, 53, 59, 61, 67, 71, 73, 79, 83, 89, 97, 101, 103, 107, 109, 113, 127, 131, 137, 139, 149, 151, 157, 163, 167, 173, 179, 181, 191, 193, 197, 199, 211, 223, 227, 229, 233, 239, 241, 251, 257, 263, 269, 271, 277, 281, 283, 293, 307, 311, 313, 317, 331, 337, 347, 349, 353, 359, 367, 373, 379, 383, 389, 397, 401, 409, 419, 421, 431, 433, 439, 443, 449, 457, 461, 463, 467, 479, 487, 491, 499, 503, 509, 521, 523, 541, 547, 557, 563, 569, 571, 577, 587, 593, 599, 601, 607, 613, 617, 619, 631, 641, 643, 647, 653, 659, 661, 673, 677, 683, 691, 701, 709, 719, 727, 733, 739, 743, 751, 757, 761, 769, 773, 787, 797, 809, 811, 821, 823, 827, 829, 839, 853, 857, 859, 863, 877, 881, 883, 887, 907, 911, 919, 929, 937, 941, 947, 953, 967, 971, 977, 983, 991, 997];
var lplim = (1 << 26) / lowprimes[lowprimes.length - 1];

// (public) test primality with certainty >= 1-.5^t
function bnIsProbablePrime(t) {
  var i,
      x = this.abs();
  if (x.t == 1 && x[0] <= lowprimes[lowprimes.length - 1]) {
    for (i = 0; i < lowprimes.length; ++i) {
      if (x[0] == lowprimes[i]) return true;
    }return false;
  }
  if (x.isEven()) return false;
  i = 1;
  while (i < lowprimes.length) {
    var m = lowprimes[i],
        j = i + 1;
    while (j < lowprimes.length && m < lplim) {
      m *= lowprimes[j++];
    }m = x.modInt(m);
    while (i < j) {
      if (m % lowprimes[i++] == 0) return false;
    }
  }
  return x.millerRabin(t);
}

// (protected) true if probably prime (HAC 4.24, Miller-Rabin)
function bnpMillerRabin(t) {
  var n1 = this.subtract(BigInteger.ONE);
  var k = n1.getLowestSetBit();
  if (k <= 0) return false;
  var r = n1.shiftRight(k);
  t = t + 1 >> 1;
  if (t > lowprimes.length) t = lowprimes.length;
  var a = nbi();
  for (var i = 0; i < t; ++i) {
    //Pick bases at random, instead of starting at 2
    a.fromInt(lowprimes[Math.floor(Math.random() * lowprimes.length)]);
    var y = a.modPow(r, this);
    if (y.compareTo(BigInteger.ONE) != 0 && y.compareTo(n1) != 0) {
      var j = 1;
      while (j++ < k && y.compareTo(n1) != 0) {
        y = y.modPowInt(2, this);
        if (y.compareTo(BigInteger.ONE) == 0) return false;
      }
      if (y.compareTo(n1) != 0) return false;
    }
  }
  return true;
}

// protected
BigInteger.prototype.chunkSize = bnpChunkSize;
BigInteger.prototype.toRadix = bnpToRadix;
BigInteger.prototype.fromRadix = bnpFromRadix;
BigInteger.prototype.fromNumber = bnpFromNumber;
BigInteger.prototype.bitwiseTo = bnpBitwiseTo;
BigInteger.prototype.changeBit = bnpChangeBit;
BigInteger.prototype.addTo = bnpAddTo;
BigInteger.prototype.dMultiply = bnpDMultiply;
BigInteger.prototype.dAddOffset = bnpDAddOffset;
BigInteger.prototype.multiplyLowerTo = bnpMultiplyLowerTo;
BigInteger.prototype.multiplyUpperTo = bnpMultiplyUpperTo;
BigInteger.prototype.modInt = bnpModInt;
BigInteger.prototype.millerRabin = bnpMillerRabin;

// public
BigInteger.prototype.clone = bnClone;
BigInteger.prototype.intValue = bnIntValue;
BigInteger.prototype.byteValue = bnByteValue;
BigInteger.prototype.shortValue = bnShortValue;
BigInteger.prototype.signum = bnSigNum;
BigInteger.prototype.toByteArray = bnToByteArray;
BigInteger.prototype.equals = bnEquals;
BigInteger.prototype.min = bnMin;
BigInteger.prototype.max = bnMax;
BigInteger.prototype.and = bnAnd;
BigInteger.prototype.or = bnOr;
BigInteger.prototype.xor = bnXor;
BigInteger.prototype.andNot = bnAndNot;
BigInteger.prototype.not = bnNot;
BigInteger.prototype.shiftLeft = bnShiftLeft;
BigInteger.prototype.shiftRight = bnShiftRight;
BigInteger.prototype.getLowestSetBit = bnGetLowestSetBit;
BigInteger.prototype.bitCount = bnBitCount;
BigInteger.prototype.testBit = bnTestBit;
BigInteger.prototype.setBit = bnSetBit;
BigInteger.prototype.clearBit = bnClearBit;
BigInteger.prototype.flipBit = bnFlipBit;
BigInteger.prototype.add = bnAdd;
BigInteger.prototype.subtract = bnSubtract;
BigInteger.prototype.multiply = bnMultiply;
BigInteger.prototype.divide = bnDivide;
BigInteger.prototype.remainder = bnRemainder;
BigInteger.prototype.divideAndRemainder = bnDivideAndRemainder;
BigInteger.prototype.modPow = bnModPow;
BigInteger.prototype.modInverse = bnModInverse;
BigInteger.prototype.pow = bnPow;
BigInteger.prototype.gcd = bnGCD;
BigInteger.prototype.isProbablePrime = bnIsProbablePrime;

// JSBN-specific extension
BigInteger.prototype.square = bnSquare;

// BigInteger interfaces not implemented in jsbn:

// BigInteger(int signum, byte[] magnitude)
// double doubleValue()
// float floatValue()
// int hashCode()
// long longValue()
// static BigInteger valueOf(long val)


/* harmony default export */ __webpack_exports__["a"] = (BigInteger);

/***/ }),
/* 221 */
/***/ (function(module, exports) {

module.exports = require("url");

/***/ }),
/* 222 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return sha256; });
/* eslint-disable */
/*!
 *  Secure Hash Algorithm (SHA256)
 *  http://www.webtoolkit.info/
 *
 *  Original code by Angel Marin, Paul Johnston.
 */

function sha256(s) {

  var chrsz = 8;

  var hexcase = 0;

  function safe_add(x, y) {

    var lsw = (x & 0xFFFF) + (y & 0xFFFF);

    var msw = (x >> 16) + (y >> 16) + (lsw >> 16);

    return msw << 16 | lsw & 0xFFFF;
  }

  function S(X, n) {
    return X >>> n | X << 32 - n;
  }

  function R(X, n) {
    return X >>> n;
  }

  function Ch(x, y, z) {
    return x & y ^ ~x & z;
  }

  function Maj(x, y, z) {
    return x & y ^ x & z ^ y & z;
  }

  function Sigma0256(x) {
    return S(x, 2) ^ S(x, 13) ^ S(x, 22);
  }

  function Sigma1256(x) {
    return S(x, 6) ^ S(x, 11) ^ S(x, 25);
  }

  function Gamma0256(x) {
    return S(x, 7) ^ S(x, 18) ^ R(x, 3);
  }

  function Gamma1256(x) {
    return S(x, 17) ^ S(x, 19) ^ R(x, 10);
  }

  function core_sha256(m, l) {

    var K = new Array(0x428A2F98, 0x71374491, 0xB5C0FBCF, 0xE9B5DBA5, 0x3956C25B, 0x59F111F1, 0x923F82A4, 0xAB1C5ED5, 0xD807AA98, 0x12835B01, 0x243185BE, 0x550C7DC3, 0x72BE5D74, 0x80DEB1FE, 0x9BDC06A7, 0xC19BF174, 0xE49B69C1, 0xEFBE4786, 0xFC19DC6, 0x240CA1CC, 0x2DE92C6F, 0x4A7484AA, 0x5CB0A9DC, 0x76F988DA, 0x983E5152, 0xA831C66D, 0xB00327C8, 0xBF597FC7, 0xC6E00BF3, 0xD5A79147, 0x6CA6351, 0x14292967, 0x27B70A85, 0x2E1B2138, 0x4D2C6DFC, 0x53380D13, 0x650A7354, 0x766A0ABB, 0x81C2C92E, 0x92722C85, 0xA2BFE8A1, 0xA81A664B, 0xC24B8B70, 0xC76C51A3, 0xD192E819, 0xD6990624, 0xF40E3585, 0x106AA070, 0x19A4C116, 0x1E376C08, 0x2748774C, 0x34B0BCB5, 0x391C0CB3, 0x4ED8AA4A, 0x5B9CCA4F, 0x682E6FF3, 0x748F82EE, 0x78A5636F, 0x84C87814, 0x8CC70208, 0x90BEFFFA, 0xA4506CEB, 0xBEF9A3F7, 0xC67178F2);

    var HASH = new Array(0x6A09E667, 0xBB67AE85, 0x3C6EF372, 0xA54FF53A, 0x510E527F, 0x9B05688C, 0x1F83D9AB, 0x5BE0CD19);

    var W = new Array(64);

    var a, b, c, d, e, f, g, h, i, j;

    var T1, T2;

    m[l >> 5] |= 0x80 << 24 - l % 32;

    m[(l + 64 >> 9 << 4) + 15] = l;

    for (var i = 0; i < m.length; i += 16) {

      a = HASH[0];

      b = HASH[1];

      c = HASH[2];

      d = HASH[3];

      e = HASH[4];

      f = HASH[5];

      g = HASH[6];

      h = HASH[7];

      for (var j = 0; j < 64; j++) {

        if (j < 16) W[j] = m[j + i];else W[j] = safe_add(safe_add(safe_add(Gamma1256(W[j - 2]), W[j - 7]), Gamma0256(W[j - 15])), W[j - 16]);

        T1 = safe_add(safe_add(safe_add(safe_add(h, Sigma1256(e)), Ch(e, f, g)), K[j]), W[j]);

        T2 = safe_add(Sigma0256(a), Maj(a, b, c));

        h = g;

        g = f;

        f = e;

        e = safe_add(d, T1);

        d = c;

        c = b;

        b = a;

        a = safe_add(T1, T2);
      }

      HASH[0] = safe_add(a, HASH[0]);

      HASH[1] = safe_add(b, HASH[1]);

      HASH[2] = safe_add(c, HASH[2]);

      HASH[3] = safe_add(d, HASH[3]);

      HASH[4] = safe_add(e, HASH[4]);

      HASH[5] = safe_add(f, HASH[5]);

      HASH[6] = safe_add(g, HASH[6]);

      HASH[7] = safe_add(h, HASH[7]);
    }

    return HASH;
  }

  function str2binb(str) {

    var bin = Array();

    var mask = (1 << chrsz) - 1;

    for (var i = 0; i < str.length * chrsz; i += chrsz) {

      bin[i >> 5] |= (str.charCodeAt(i / chrsz) & mask) << 24 - i % 32;
    }

    return bin;
  }

  function Utf8Encode(string) {

    string = string.replace(/\r\n/g, "\n");

    var utftext = "";

    for (var n = 0; n < string.length; n++) {

      var c = string.charCodeAt(n);

      if (c < 128) {

        utftext += String.fromCharCode(c);
      } else if (c > 127 && c < 2048) {

        utftext += String.fromCharCode(c >> 6 | 192);

        utftext += String.fromCharCode(c & 63 | 128);
      } else {

        utftext += String.fromCharCode(c >> 12 | 224);

        utftext += String.fromCharCode(c >> 6 & 63 | 128);

        utftext += String.fromCharCode(c & 63 | 128);
      }
    }

    return utftext;
  }

  function binb2hex(binarray) {

    var hex_tab = hexcase ? "0123456789ABCDEF" : "0123456789abcdef";

    var str = "";

    for (var i = 0; i < binarray.length * 4; i++) {

      str += hex_tab.charAt(binarray[i >> 2] >> (3 - i % 4) * 8 + 4 & 0xF) + hex_tab.charAt(binarray[i >> 2] >> (3 - i % 4) * 8 & 0xF);
    }

    return str;
  }

  s = Utf8Encode(s);

  return binb2hex(core_sha256(str2binb(s), s.length * chrsz));
}



/***/ }),
/* 223 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "b", function() { return rAF; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return cAF; });
/*
 * http://paulirish.com/2011/requestanimationframe-for-smart-animating/
 * http://my.opera.com/emoller/blog/2011/12/20/requestanimationframe-for-smart-er-animating
 * requestAnimationFrame polyfill by Erik Mller. fixes from Paul Irish and Tino Zijdel
 * MIT license
 * @license
 */

/* eslint-disable standard/no-callback-literal */

var root = typeof window === 'undefined' ? global : window;
var rAF = root.requestAnimationFrame;
var cAF = root.cancelAnimationFrame;

var lastTime = 0;
var vendors = ['ms', 'moz', 'webkit', 'o'];
for (var x = 0; x < vendors.length && !rAF; ++x) {
  rAF = root[vendors[x] + 'RequestAnimationFrame'];
  cAF = root[vendors[x] + 'CancelAnimationFrame'] || root[vendors[x] + 'CancelRequestAnimationFrame'];
}

/* Bind to root is necessary as the context must be valid */
if (rAF) {
  rAF = rAF.bind(root);
}
if (cAF) {
  cAF = cAF.bind(root);
}

/* istanbul ignore next */
if (!rAF) {
  rAF = function rAF(callback, element) {
    var currTime = new Date().getTime();
    var timeToCall = Math.max(0, 16 - (currTime - lastTime));
    var id = setTimeout(function () {
      callback(currTime + timeToCall);
    }, timeToCall);
    lastTime = currTime + timeToCall;
    return id;
  };
}

/* istanbul ignore next */
if (!cAF) {
  cAF = function cAF(id) {
    clearTimeout(id);
  };
}



/***/ }),
/* 224 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);


var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */

/**
 * Represents a 3-dimensional vector while providing math functions to
 * modify / clone the vector. Fully chainable.
 * @class
 * @memberof PhotoEditorSDK.Math
 */
var Vector3 = function () {
  /**
   * Creates a Vector3
   * @param  {Number} x
   * @param  {Number} y
   * @param  {Number} z
   */
  function Vector3(x, y, z) {
    _classCallCheck(this, Vector3);

    this.x = x;
    this.y = y;
    this.z = z;

    if (typeof this.x === 'undefined') {
      this.x = 0;
    }
    if (typeof this.y === 'undefined') {
      this.y = 0;
    }
    if (typeof this.z === 'undefined') {
      this.z = 0;
    }
  }

  /**
   * Sets the given values
   * @param {Number} x
   * @param {Number} y
   * @param {Number} z
   * @return {PhotoEditorSDK.Math.Vectorz}
   */


  _createClass(Vector3, [{
    key: 'set',
    value: function set(x, y, z) {
      this.x = x;
      this.y = y;
      this.z = z;
      return this;
    }

    /**
     * Creates a clone of this vector
     * @return {PhotoEditorSDK.Math.Vector3}
     */

  }, {
    key: 'clone',
    value: function clone() {
      return new Vector3(this.x, this.y, this.z);
    }

    /**
     * Copies the values of the given vector
     * @param  {PhotoEditorSDK.Math.Vector3} other
     * @return {PhotoEditorSDK.Math.Vector3}
     */

  }, {
    key: 'copy',
    value: function copy(other) {
      this.x = other.x;
      this.y = other.y;
      this.z = other.z;
      return this;
    }

    /**
     * Clamps this vector with the given Vector3 / Number
     * @param  {(Number|PhotoEditorSDK.Math.Vector3)} minimum
     * @param  {(Number|PhotoEditorSDK.Math.Vector3)} maximum
     * @return {PhotoEditorSDK.Math.Vector3}
     */

  }, {
    key: 'clamp',
    value: function clamp(minimum, maximum) {
      var minimumSet = minimum !== null && typeof minimum !== 'undefined';
      var maximumSet = maximum !== null && typeof maximum !== 'undefined';

      /* istanbul ignore else  */
      if (!(minimum instanceof Vector3) && minimumSet) {
        minimum = new Vector3(minimum, minimum, minimum);
      }
      /* istanbul ignore else  */
      if (!(maximum instanceof Vector3) && maximumSet) {
        maximum = new Vector3(maximum, maximum, maximum);
      }

      if (minimumSet) {
        this.x = Math.max(minimum.x, this.x);
        this.y = Math.max(minimum.y, this.y);
        this.z = Math.max(minimum.z, this.z);
      }

      if (maximumSet) {
        this.x = Math.min(maximum.x, this.x);
        this.y = Math.min(maximum.y, this.y);
        this.z = Math.min(maximum.z, this.z);
      }
      return this;
    }

    /**
     * Divides this vector by the given Vector3 / Number
     * @param  {(Number|PhotoEditorSDK.Math.Vector3)} divisor
     * @return {PhotoEditorSDK.Math.Vector3}
     */

  }, {
    key: 'divide',
    value: function divide(divisor) {
      if (divisor instanceof Vector3) {
        this.x /= divisor.x;
        this.y /= divisor.y;
        this.z /= divisor.z;
      } else {
        this.x /= divisor;
        this.y /= divisor;
        this.z /= divisor;
      }
      return this;
    }

    /**
     * Subtracts the given Vector3 / Number from this vector
     * @param  {(Number|PhotoEditorSDK.Math.Vector3)} subtrahend
     * @return {PhotoEditorSDK.Math.Vector3}
     */

  }, {
    key: 'subtract',
    value: function subtract(subtrahend) {
      if (subtrahend instanceof Vector3) {
        this.x -= subtrahend.x;
        this.y -= subtrahend.y;
        this.z -= subtrahend.z;
      } else {
        this.x -= subtrahend;
        this.y -= subtrahend;
        this.z -= subtrahend;
      }
      return this;
    }

    /**
     * Multiplies the given Vector3 / Number with this vector
     * @param  {(Number|PhotoEditorSDK.Math.Vector3)} factor
     * @return {PhotoEditorSDK.Math.Vector3}
     */

  }, {
    key: 'multiply',
    value: function multiply(factor) {
      if (factor instanceof Vector3) {
        this.x *= factor.x;
        this.y *= factor.y;
        this.z *= factor.z;
      } else {
        this.x *= factor;
        this.y *= factor;
        this.z *= factor;
      }
      return this;
    }

    /**
     * Adds the given Vector3 / Numbers to this vector
     * @param {(Number|PhotoEditorSDK.Math.Vector3)} addend
     * @return {PhotoEditorSDK.Math.Vector3}
     */

  }, {
    key: 'add',
    value: function add(addend) {
      if (addend instanceof Vector3) {
        this.x += addend.x;
        this.y += addend.y;
        this.z += addend.z;
      } else {
        this.x += addend;
        this.y += addend;
        this.z += addend;
      }
      return this;
    }

    /**
     * Checks whether the x and y value are the same as the given ones
     * @param  {(Number|PhotoEditorSDK.Math.Vector3)} vec
     * @return {Boolean}
     */

  }, {
    key: 'equals',
    value: function equals(vec) {
      if (vec instanceof Vector3) {
        return vec.x === this.x && vec.y === this.y && vec.z === this.z;
      } else {
        return vec === this.x && vec === this.y && vec === this.z;
      }
    }

    /**
     * Rounds the values of this vector
     * @returns {PhotoEditorSDK.Math.Vector3}
     */

  }, {
    key: 'round',
    value: function round() {
      this.x = Math.round(this.x);
      this.y = Math.round(this.y);
      this.z = Math.round(this.z);
      return this;
    }

    /**
     * Rounds up the values of this vector
     * @returns {PhotoEditorSDK.Math.Vector3}
     */

  }, {
    key: 'ceil',
    value: function ceil() {
      this.x = Math.ceil(this.x);
      this.y = Math.ceil(this.y);
      this.z = Math.ceil(this.z);
      return this;
    }

    /**
     * Rounds down the values of this vector
     * @returns {PhotoEditorSDK.Math.Vector3}
     */

  }, {
    key: 'floor',
    value: function floor() {
      this.x = Math.floor(this.x);
      this.y = Math.floor(this.y);
      this.z = Math.floor(this.z);
      return this;
    }

    /**
     * Fractional part of  the values of this vector
     * @returns {PhotoEditorSDK.Math.Vector3}
     */

  }, {
    key: 'fract',
    value: function fract() {
      this.x = this.x % 1;
      this.y = this.y % 1;
      this.z = this.z % 1;
      return this;
    }

    /**
     * Convert the values of this vector to integer
     * @returns {PhotoEditorSDK.Math.Vector3}
     */

  }, {
    key: 'toInt',
    value: function toInt() {
      this.x = this.x | 0;
      this.y = this.y | 0;
      this.z = this.z | 0;
      return this;
    }

    /**
     * Makes both numbers of this vector positive
     * @returns {PhotoEditorSDK.Math.Vector3}
     */

  }, {
    key: 'abs',
    value: function abs() {
      this.x = Math.abs(this.x);
      this.y = Math.abs(this.y);
      this.z = Math.abs(this.z);
      return this;
    }

    /**
     * Returns the euclidean length of this vector
     * @return {Number}
     */

  }, {
    key: 'len',
    value: function len() {
      return Math.sqrt(this.x * this.x + this.y * this.y + this.z * this.z);
    }

    /**
     * Returns the smallest number in this vector
     * @return {Number}
     */

  }, {
    key: 'min',
    value: function min() {
      return Math.min(Math.min(this.x, this.y), this.z);
    }

    /**
     * Returns the largest number in this vector
     * @return {Number}
     */

  }, {
    key: 'max',
    value: function max() {
      return Math.max(Math.max(this.x, this.y), this.z);
    }

    /**
     * Returns a POJO of this Vector3
     * @return {Object}
     */

  }, {
    key: 'toObject',
    value: function toObject() {
      return { x: this.x, y: this.y, z: this.z };
    }

    /**
     * Returns a string representation of this vector
     * @return {String}
     */

  }, {
    key: 'toString',
    value: function toString() {
      return 'Vector3({ x: ' + this.x + ', y: ' + this.y + ', z: ' + this.z + ' })';
    }

    /**
     * Rounds this vector's values to the given number of decimals
     * @param  {Number} decimals
     * @return {Number}
     */

  }, {
    key: 'roundDecimal',
    value: function roundDecimal(decimals) {
      this.x = parseFloat(this.x.toFixed(decimals));
      this.y = parseFloat(this.y.toFixed(decimals));
      this.z = parseFloat(this.z.toFixed(decimals));
      return this;
    }

    /**
     * Creates a new Vector3 instance from the given Object
     * @param  {Object} object
     * @return {PhotoEditorSDK.Math.Vector3}
     */

  }], [{
    key: 'fromObject',
    value: function fromObject(object) {
      return new Vector3(object.x, object.y, object.z);
    }

    /**
     * Returns a null vector
     * @return {PhotoEditorSDK.Math.Vector3}
     */

  }, {
    key: 'NULL',
    get: function get() {
      return new Vector3(0, 0, 0);
    }
  }]);

  return Vector3;
}();

/* harmony default export */ __webpack_exports__["a"] = (Vector3);

/***/ }),
/* 225 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__globals__ = __webpack_require__(33);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__shared_vendor_promise__ = __webpack_require__(29);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__lib_math_vector2__ = __webpack_require__(34);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__operation__ = __webpack_require__(121);





var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */





var OptionType = __WEBPACK_IMPORTED_MODULE_4__globals__["Constants"].OptionType;

/**
 * An operation that can rotate and flip an image depending on the given EXIF information
 * @class
 * @extends PhotoEditorSDK.Operation
 * @memberof PhotoEditorSDK.Operations
 */

var ExifOrientationOperation = function (_Operation) {
  _inherits(ExifOrientationOperation, _Operation);

  function ExifOrientationOperation() {
    _classCallCheck(this, ExifOrientationOperation);

    return _possibleConstructorReturn(this, (ExifOrientationOperation.__proto__ || __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default()(ExifOrientationOperation)).apply(this, arguments));
  }

  _createClass(ExifOrientationOperation, [{
    key: '_getRotation',

    /**
     * Returns the rotation
     * @return {Number}
     * @private
     */
    value: function _getRotation() {
      var degrees = 0;
      switch (this.getTags().Orientation) {
        case 7:
        case 8:
          degrees = -90;
          break;
        case 3:
        case 4:
          degrees = -180;
          break;
        case 5:
        case 6:
          degrees = 90;
          break;
      }
      return degrees;
    }

    /**
     * Checks if the image needs to be flipped vertically
     * @return {Boolean}
     * @private
     */

  }, {
    key: '_getFlipVertically',
    value: function _getFlipVertically() {
      var _getTags = this.getTags(),
          Orientation = _getTags.Orientation;

      return [5, 7].indexOf(Orientation) !== -1;
    }

    /**
     * Checks if the image needs to be flipped horizontally
     * @return {Boolean}
     * @private
     */

  }, {
    key: '_getFlipHorizontally',
    value: function _getFlipHorizontally() {
      var _getTags2 = this.getTags(),
          Orientation = _getTags2.Orientation;

      return [2, 4].indexOf(Orientation) !== -1;
    }

    /**
     * Returns the options based on the EXIF orientation
     * @return {Object}
     * @private
     */

  }, {
    key: '_getFinalOptions',
    value: function _getFinalOptions() {
      return {
        rotation: this._getRotation(),
        flipVertically: this._getFlipVertically(),
        flipHorizontally: this._getFlipHorizontally()
      };
    }

    /**
     * Rotates and/or flips the image
     * @param  {PhotoEditorSDK} sdk
     * @returns {Promise}
     * @override
     * @private
     */

  }, {
    key: '_render',
    value: function _render(sdk) {
      var options = this._getFinalOptions();
      var actualDegrees = options.rotation % 360;
      var radians = actualDegrees * (Math.PI / 180);

      this._sprite.setScale(options.flipHorizontally ? -1 : 1, options.flipVertically ? -1 : 1);
      this._sprite.setRotation(radians);
      this._sprite.setAnchor(0.5, 0.5);
      this._sprite.updateTransform();

      var bounds = this._sprite.getBounds();
      this._renderTexture.resizeTo(new __WEBPACK_IMPORTED_MODULE_6__lib_math_vector2__["a" /* default */](bounds.width, bounds.height));

      // Make sure we're rendering to top left corner
      this._sprite.setPosition(this._renderTexture.getDimensions().divide(2));

      // Draw
      this._renderTexture.render(this._container);

      return __WEBPACK_IMPORTED_MODULE_5__shared_vendor_promise__["a" /* default */].resolve();
    }

    /**
     * Returns the dimensions the given dimensions will have after this operation
     * has been applied
     * @param {PhotoEditorSDK.Math.Vector2} dimensions
     * @return {PhotoEditorSDK.Math.Vector2}
     * @override
     */

  }, {
    key: 'getNewDimensions',
    value: function getNewDimensions(dimensions) {
      var options = this._getFinalOptions();
      dimensions = dimensions.clone();
      if (options.rotation % 180) {
        dimensions.flip();
      }
      return dimensions;
    }
  }]);

  return ExifOrientationOperation;
}(__WEBPACK_IMPORTED_MODULE_7__operation__["a" /* default */]);

/**
 * A unique string that identifies this operation. Can be used to select
 * operations.
 * @type {String}
 * @default
 */


ExifOrientationOperation.identifier = 'exif-orientation';

/**
 * Specifies the available options for this operation
 * @type {Object}
 * @ignore
 */
ExifOrientationOperation.prototype.availableOptions = {
  tags: { type: OptionType.OBJECT, default: {} }
};

/* harmony default export */ __webpack_exports__["a"] = (ExifOrientationOperation);

/***/ }),
/* 226 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__globals__ = __webpack_require__(33);


var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */



var VERSION_CHECK_FN = 'imglySDKVersionCallback';
var VERSION_CHECK_URL = 'https://www.photoeditorsdk.com/version.json?sdk=html5&jsoncallback=' + VERSION_CHECK_FN;

/**
 * Checks whether there is a new version of the SDK available
 * @class
 * @memberof PhotoEditorSDK
 * @ignore
 */
/* istanbul ignore next */

var VersionChecker = function () {
  /**
   * Creates a new VersionChecker
   * @param  {String} version
   */
  function VersionChecker(version) {
    _classCallCheck(this, VersionChecker);

    this._version = version;
    this._check();
  }

  /**
   * Checks if this version of the SDK is outdated
   * @private
   */


  _createClass(VersionChecker, [{
    key: '_check',
    value: function _check() {
      var _this = this;

      if (typeof document === 'undefined') {
        return __WEBPACK_IMPORTED_MODULE_1__globals__["Log"].info(this.constructor.name, 'Not in browser environment. Version check skipped.');
      }

      var self = this;
      window[VERSION_CHECK_FN] = function (response) {
        if (response.outdated) {
          __WEBPACK_IMPORTED_MODULE_1__globals__["Log"].warn(_this.constructor.name, 'Your Version ' + self._version + ' is outdated. Current version is ' + response.version + '.');
        }
      };

      var script = document.createElement('script');
      script.src = VERSION_CHECK_URL + '&version=' + this._version;
      script.async = true;
      document.getElementsByTagName('head')[0].appendChild(script);
    }
  }]);

  return VersionChecker;
}();

/* harmony default export */ __webpack_exports__["a"] = (VersionChecker);

/***/ }),
/* 227 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__array_stream__ = __webpack_require__(87);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__constants__ = __webpack_require__(88);


var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




var MARKERS = __WEBPACK_IMPORTED_MODULE_2__constants__["a" /* default */].MARKERS;

/**
 * JFIFData provides access to the JFIF Information inside the JPEG Header
 * @class
 * @memberof PhotoEditorSDK
 * @ignore
 */

var JFIFData = function () {
  /**
   * Creates an JFIFData instance
   * @param {Uint8Array} buf
   */
  function JFIFData(buf) {
    _classCallCheck(this, JFIFData);

    this._buf = buf;
    this._stream = new __WEBPACK_IMPORTED_MODULE_1__array_stream__["a" /* default */](this._buf);
    this._stream.setHead(0);
  }

  /**
   * Check if buf contains valid JFIF Segment
   * @returns {Boolean}
   */


  _createClass(JFIFData, [{
    key: 'isValid',
    value: function isValid() {
      this._stream.setHead(0);
      var marker = this._stream.readInt16();
      if (marker !== MARKERS.APP0) {
        return false;
      }
      // Skip length
      var length = this._stream.readInt16();
      if (!(length >= 16)) {
        return false;
      }
      var fileIdentifier = this._stream.readString(4);
      var fileIdentifierEndMarker = this._stream.readInt8();
      if (!(fileIdentifier === 'JFIF')) {
        return false;
      }
      if (!(fileIdentifierEndMarker === 0x00)) {
        return false;
      }
      return true;
    }

    /**
     * Set the unit density. Valid params are 0..
     * @param {Number} val
     */

  }, {
    key: 'setUnitDensity',
    value: function setUnitDensity(val) {
      this._stream.setHead(11);
      this._stream.writeInt8(val);
    }

    /**
     * Set the density x value
     * @param {Number} val
     */

  }, {
    key: 'setDensityX',
    value: function setDensityX(val) {
      this._stream.setHead(12);
      this._stream.writeInt16(val);
    }

    /**
     * Set the density y value
     * @param {Number} val
     */

  }, {
    key: 'setDensityY',
    value: function setDensityY(val) {
      this._stream.setHead(13);
      this._stream.writeInt16(val);
    }

    /**
     * Returns the xDensity
     * @returns {Number}
     */

  }, {
    key: 'getUnitDensity',
    value: function getUnitDensity() {
      this._stream.setHead(11);
      return this._stream.readInt8();
    }

    /**
     * Returns the xDensity
     * @returns {Number}
     */

  }, {
    key: 'getDensityX',
    value: function getDensityX() {
      this._stream.setHead(12);
      return this._stream.readInt16();
    }

    /**
     * Returns the y notDensity
     * @returns {Number}
     */

  }, {
    key: 'getDensityY',
    value: function getDensityY() {
      this._stream.setHead(14);
      return this._stream.readInt16();
    }
  }]);

  return JFIFData;
}();

/* harmony default export */ __webpack_exports__["a"] = (JFIFData);

/***/ }),
/* 228 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__array_stream__ = __webpack_require__(87);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__constants__ = __webpack_require__(88);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__utils__ = __webpack_require__(24);


var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */





var invariant = __WEBPACK_IMPORTED_MODULE_3__utils__["a" /* default */].invariant;
var MARKERS = __WEBPACK_IMPORTED_MODULE_2__constants__["a" /* default */].MARKERS,
    EXIF_TAGS = __WEBPACK_IMPORTED_MODULE_2__constants__["a" /* default */].EXIF_TAGS;

/**
 * EXIFData provides access to the Exif Information inside the JPEG Header
 * @class
 * @memberof PhotoEditorSDK
 * @ignore
 */

var EXIFData = function () {
  /**
   * Creates an ExifData instance
   * @param {Uint8Array} buf
   */
  function EXIFData(buf) {
    _classCallCheck(this, EXIFData);

    this._buf = buf;
    this._stream = new __WEBPACK_IMPORTED_MODULE_1__array_stream__["a" /* default */](this._buf);
    this._stream.setHead(0);
    this._parse();
  }

  /**
   * Check if buf contains valid EXIF Segment
   * @returns {Boolean}
   */


  _createClass(EXIFData, [{
    key: 'isValid',
    value: function isValid() {
      this._stream.setHead(0);
      // Skip marker
      var marker = this._stream.readInt16();
      if (marker !== MARKERS.EXIF) {
        return false;
      }
      // Skip length
      var length = this._stream.readInt16();
      if (!(length > 0)) {
        return false;
      }
      var header = this._stream.readString(4);
      if (header !== 'Exif') {
        return false;
      }
      return true;
    }
    /**
     * Parses the exif tags
     * @return {Object}
     * @private
     */

  }, {
    key: '_parse',
    value: function _parse() {
      if (!this.isValid()) {
        return;
      }

      this._stream.setHead(10);
      var tiffOffset = this._stream.getHead();

      // Find endian type
      var bigEndian = false;
      var endian = this._stream.readInt16();
      if (endian === 0x4949) {
        bigEndian = false;
      } else if (endian === 0x4d4d) {
        bigEndian = true;
      } else {
        invariant(false, 'Invalid TIFF data: No endian type found');
      }

      invariant(this._stream.readInt16(!bigEndian) === 0x002A, 'Invalid TIFF data: No 0x002A');

      var firstIFDOffset = this._stream.readInt32(!bigEndian);
      invariant(firstIFDOffset >= 8, 'Invalid TIFF data: First IFD offset < 8');

      var ifdOffset = tiffOffset + firstIFDOffset;
      var tags = this._readTags(this._stream, tiffOffset, ifdOffset, bigEndian);
      this._tags = tags.tags;
      this._tagData = tags.tagData;
    }

    /**
     * Returns the tags
     * @return {Object}
     */

  }, {
    key: 'getTags',
    value: function getTags() {
      return this._tags;
    }

    /**
     * Returns the tag data (key, value, byte position etc.)
     * @return {Object[]}
     */

  }, {
    key: 'getTagData',
    value: function getTagData() {
      return this._tagData;
    }
  }, {
    key: 'setOrientation',
    value: function setOrientation(orientation) {
      if (this._tagData.Orientation) {
        var entryOffset = this._tagData.Orientation.entryOffset;
        // Replace value in buffer

        this._stream.setHead(entryOffset + 8);
        this._stream.writeInt16(orientation);
      }
    }

    /**
     * Reads the TIFF tags from the stream
     * @param  {ArrayBuffer} stream
     * @param  {Number} tiffStart The position where tiff data starts
     * @param  {Number} ifdStart  The position where the IFD starts
     * @param  {Boolean} bigEndian
     * @return {Object}
     * @private
     */

  }, {
    key: '_readTags',
    value: function _readTags(stream, tiffStart, ifdStart, bigEndian) {
      stream.setHead(ifdStart);
      var entriesCount = stream.readInt16(!bigEndian);
      var tags = {};
      var tagData = [];

      for (var i = 0; i < entriesCount; i++) {
        var entryOffset = ifdStart + i * 12 + 2;
        stream.setHead(entryOffset);
        var tag = stream.readInt16(!bigEndian);
        var type = void 0;
        var numValues = void 0;
        var valueOffset = void 0;
        if (EXIF_TAGS[tag]) {
          tag = EXIF_TAGS[tag];
          type = stream.readInt16(!bigEndian);
          numValues = stream.readInt32(!bigEndian);
          valueOffset = stream.readInt32(!bigEndian) + tiffStart;
          var value = null;

          switch (type) {
            case 1: // byte, 8-bit unsigned int
            case 7:
              // undefined, 8-bit byte, value depending on field
              if (numValues === 1) {
                value = stream.readInt8(!bigEndian);
              } else {
                value = [];
                for (var _i = 0; _i < numValues; _i++) {
                  value.push(stream.readInt8(!bigEndian));
                }
              }
              break;
            case 2:
              // 8-bit ascii char
              stream.setHead(numValues > 4 ? valueOffset : entryOffset + 8);
              value = stream.readString(numValues);
              break;
            case 3:
              // short
              stream.setHead(numValues > 2 ? valueOffset : entryOffset + 8);
              if (numValues === 1) {
                value = stream.readInt16(!bigEndian);
              } else {
                value = [];
                for (var _i2 = 0; _i2 < numValues; _i2++) {
                  value.push(stream.readInt16(!bigEndian));
                }
              }
              break;
            case 4: // long
            case 9:
              // slong
              stream.setHead(numValues > 1 ? valueOffset : entryOffset + 8);
              if (numValues === 1) {
                value = stream.readInt32(!bigEndian);
              } else {
                value = [];
                for (var _i3 = 0; _i3 < numValues; _i3++) {
                  value.push(stream.readInt32(!bigEndian));
                }
              }
              break;
            case 5: // rational (two long values, first numerator, second denominator)
            case 10:
              // rational (two slongs)
              stream.setHead(valueOffset);
              if (numValues === 1) {
                var numerator = stream.readInt32(!bigEndian);
                var denominator = stream.readInt32(!bigEndian);
                value = numerator / denominator;
              } else {
                value = [];
                for (var _i4 = 0; _i4 < numValues; _i4++) {
                  var _numerator = stream.readInt32(!bigEndian);
                  var _denominator = stream.readInt32(!bigEndian);
                  var val = _numerator / _denominator;
                  value.push(val);
                }
              }
              break;
          }

          tags[tag] = value;
          tagData[tag] = {
            value: value,
            numValues: numValues,
            entryOffset: entryOffset,
            valueOffset: valueOffset,
            type: type
          };
        }
      }

      return { tags: tags, tagData: tagData };
    }

    /**
     * Returns internal buffer
     * @returns {Uint8Array}
     */

  }, {
    key: 'getBuffer',
    value: function getBuffer() {
      return this._buf;
    }
  }]);

  return EXIFData;
}();

/* harmony default export */ __webpack_exports__["a"] = (EXIFData);

/***/ }),
/* 229 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_promise__ = __webpack_require__(11);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_promise___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_promise__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__constants__ = __webpack_require__(28);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__engine__ = __webpack_require__(55);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__utils__ = __webpack_require__(24);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__exif__ = __webpack_require__(86);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9__configurable__ = __webpack_require__(46);






var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* global Image, WEBPACK */
/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */







/**
 * @class
 * @alias PhotoEditorSDK.ImageExporter
 * @private
 */

var ImageExporter = function (_Configurable) {
  _inherits(ImageExporter, _Configurable);

  function ImageExporter(sdk) {
    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};

    _classCallCheck(this, ImageExporter);

    var _this = _possibleConstructorReturn(this, (ImageExporter.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(ImageExporter)).call(this, options));

    _this._sdk = sdk;
    return _this;
  }

  /**
   * Exports the image from the given canvas with the given options
   * @return {Promise}
   */


  _createClass(ImageExporter, [{
    key: 'export',
    value: function _export() {
      var _this2 = this;

      var renderer = this._sdk.getRenderer();
      var _options = this._options,
          renderType = _options.renderType,
          imageFormat = _options.imageFormat,
          quality = _options.quality;


      return this.validateSettings().then(function () {
        return _this2._prepareSDK();
      }).then(function (texture) {
        var canvas = renderer.getCanvas();
        if (renderer.isOfType(__WEBPACK_IMPORTED_MODULE_5__constants__["RendererType"].WEBGL)) {
          canvas = _this2._createCanvasFromTexture(texture);
        }

        var result = void 0;
        if (renderType === __WEBPACK_IMPORTED_MODULE_5__constants__["RenderType"].IMAGE || renderType === __WEBPACK_IMPORTED_MODULE_5__constants__["RenderType"].DATAURL) {
          if (typeof window === 'undefined') {
            // Quality not supported in node environment / node-canvas
            result = canvas.toDataURL(imageFormat);
          } else {
            result = canvas.toDataURL(imageFormat, quality);
          }

          // When image's `src` attribute is a jpeg data url, we can restore
          // the exif information
          var image = _this2._sdk.getImage();
          var imageIsJPEG = __WEBPACK_IMPORTED_MODULE_8__exif__["a" /* default */].isJPEG(image.src);
          var resultIsJPEG = __WEBPACK_IMPORTED_MODULE_8__exif__["a" /* default */].isJPEG(result);
          if (imageIsJPEG && resultIsJPEG) {
            var exif = _this2._sdk.getExif(); // This is basically the JPEG Header
            if (exif) {
              result = exif.restoreSegments(result);
            }
          }
        }

        if (renderType === __WEBPACK_IMPORTED_MODULE_5__constants__["RenderType"].IMAGE) {
          var outputImage = void 0;

          // Not a browser environment
          var CanvasImage = __webpack_require__(19).Image;
          outputImage = new CanvasImage();

          outputImage.src = result;
          return outputImage;
        } else if (renderType === __WEBPACK_IMPORTED_MODULE_5__constants__["RenderType"].DATAURL) {
          return result;
        } else if (renderType === __WEBPACK_IMPORTED_MODULE_5__constants__["RenderType"].BUFFER) {
          // https://github.com/Automattic/node-canvas#canvastobuffer
          switch (imageFormat) {
            case __WEBPACK_IMPORTED_MODULE_5__constants__["ImageFormat"].JPEG:
              {
                var promise = new __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_promise___default.a(function (resolve, reject) {
                  var stream = canvas.createJPEGStream({ bufsize: 2048, quality: quality * 100 | 0 });
                  var chunks = [];
                  stream.on('data', function (chunk) {
                    return chunks.push(chunk);
                  });
                  stream.on('end', function () {
                    return resolve(Buffer.concat(chunks));
                  });
                });
                return promise;
              }
            case __WEBPACK_IMPORTED_MODULE_5__constants__["ImageFormat"].PNG:
              {
                return __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_promise___default.a.resolve(canvas.toBuffer());
              }
            default:
              {
                return __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_promise___default.a.reject(new Error('Invalid ImageFormat: ' + imageFormat));
              }
          }
        } else if (renderType === __WEBPACK_IMPORTED_MODULE_5__constants__["RenderType"].MSBLOB) {
          return canvas.msToBlob();
        } else if (renderType === __WEBPACK_IMPORTED_MODULE_5__constants__["RenderType"].BLOB) {
          return new __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_promise___default.a(function (resolve, reject) {
            canvas.toBlob(function (blob) {
              resolve(blob);
            }, imageFormat, quality);
          });
        }
      }).then(function (result) {
        return _this2._restoreSDK().then(function () {
          return result;
        });
      });
    }

    /**
     * Prepares the SDK for exporting
     * @private
     */

  }, {
    key: '_prepareSDK',
    value: function _prepareSDK() {
      var renderer = this._sdk.getRenderer();

      this._sdkSettings = {
        dimensions: renderer.getDimensions().clone(),
        textureQuality: this._sdk.getTextureQuality(),
        pixelRatio: this._sdk.getPixelRatio(),
        renderMode: this._sdk.getRenderMode()
      };

      this._sdk.setRenderMode('export');
      this._sdk.setTextureQuality(1);

      var resizeCanvas = renderer.isOfType(__WEBPACK_IMPORTED_MODULE_5__constants__["RendererType"].CANVAS);
      renderer.setPixelRatio(1);
      renderer.resizeTo(this._sdk.getFinalDimensions(), resizeCanvas);

      this._sdk.setAllOperationsToDirty(true);

      var stack = this._sdk.getOperationsStack();
      stack.forEach(function (operation) {
        operation.disposeRenderTextures();
      });
      stack.disableCache();

      return this._sdk.render();
    }

    /**
     * Restores the previous SDK options
     * @private
     */

  }, {
    key: '_restoreSDK',
    value: function _restoreSDK() {
      var stack = this._sdk.getOperationsStack();
      stack.enableCache();

      this._sdk.setRenderMode(this._sdkSettings.renderMode);
      var renderer = this._sdk.getRenderer();

      var resizeCanvas = renderer.isOfType(__WEBPACK_IMPORTED_MODULE_5__constants__["RendererType"].CANVAS);
      renderer.setPixelRatio(this._sdkSettings.pixelRatio);
      renderer.resizeTo(this._sdkSettings.dimensions, resizeCanvas);

      this._sdk.setTextureQuality(this._sdkSettings.textureQuality);
      this._sdk.setAllOperationsToDirty(true);
      return this._sdk.render();
    }

    /**
     * Creates a canvas from the given Texture by attaching it to an FBO and using
     * gl.readPixels() to read the pixels. It then writes the pixel data to a new
     * 2D (not hardware-accelerated) canvas and calls .toDataURL() on it.
     * @param  {PhotoEditorSDK.Engine.Texture} texture
     * @return {HTMLCanvasElement}
     * @private
     */

  }, {
    key: '_createCanvasFromTexture',
    value: function _createCanvasFromTexture(texture) {
      var renderer = this._sdk.getRenderer();
      var finalDimensions = this._sdk.getFinalDimensions();

      var gl = this._sdk.getRenderer().getContext();

      // Create temporary framebuffer
      var fbo = gl.createFramebuffer();
      gl.bindFramebuffer(gl.FRAMEBUFFER, fbo);

      // Attach output texture to FBO
      var glTexture = texture.getBaseTexture().getGLTextureForRenderer(renderer);
      gl.framebufferTexture2D(gl.FRAMEBUFFER, gl.COLOR_ATTACHMENT0, gl.TEXTURE_2D, glTexture, 0);

      // Read pixels from FBO
      var pixels = new Uint8Array(finalDimensions.x * finalDimensions.y * 4);
      gl.readPixels(0, 0, finalDimensions.x, finalDimensions.y, gl.RGBA, gl.UNSIGNED_BYTE, pixels);

      // Check if we have any semi-transparent pixels
      var hasTransparency = this._checkPixelsForTransparency(pixels);

      var renderTexture = void 0;
      if (hasTransparency) {
        // Since our textures have premultiplied RGB values, we need to un-premultiply the
        // values before reading them from the texture and passing them to a canvas
        var sprite = new __WEBPACK_IMPORTED_MODULE_6__engine__["a" /* default */].Sprite(texture);
        sprite.setFilters([new __WEBPACK_IMPORTED_MODULE_6__engine__["a" /* default */].Filters.UnpremultiplyFilter()]);
        var container = new __WEBPACK_IMPORTED_MODULE_6__engine__["a" /* default */].Container();
        container.addChild(sprite);
        renderTexture = new __WEBPACK_IMPORTED_MODULE_6__engine__["a" /* default */].RenderTexture(renderer, finalDimensions.x, finalDimensions.y);
        renderTexture.render(container);

        // Attach the new texture
        var _glTexture = renderTexture.getBaseTexture().getGLTextureForRenderer(renderer);
        gl.framebufferTexture2D(gl.FRAMEBUFFER, gl.COLOR_ATTACHMENT0, gl.TEXTURE_2D, _glTexture, 0);

        // Read pixels from FBO
        gl.readPixels(0, 0, finalDimensions.x, finalDimensions.y, gl.RGBA, gl.UNSIGNED_BYTE, pixels);

        // Switch back to default render target, dispose the texture
        renderer.setRenderTarget();
        renderTexture.dispose();
      }

      // Create canvas with dimensions of output texture
      var canvas = __WEBPACK_IMPORTED_MODULE_7__utils__["a" /* default */].createCanvas();
      canvas.width = finalDimensions.x;
      canvas.height = finalDimensions.y;

      // Copy pixel data over
      var context = canvas.getContext('2d');
      var imageData = context.createImageData(finalDimensions.x, finalDimensions.y);

      imageData.data.set(pixels);

      // Render to canvas
      context.putImageData(imageData, 0, 0);

      // Delete FBO
      gl.deleteFramebuffer(fbo);

      return canvas;
    }

    /**
     * Checks if any of the given RGBA pixels has transparency
     * @param  {Uint8Array} pixels
     * @return {Boolean}
     */

  }, {
    key: '_checkPixelsForTransparency',
    value: function _checkPixelsForTransparency(pixels) {
      var finalDimensions = this._sdk.getFinalDimensions();
      var maxIndex = finalDimensions.x * finalDimensions.y * 4;
      var value = void 0;
      for (var i = 3; i < maxIndex; i += 4) {
        value = pixels[i];
        if (value !== 255) {
          return true;
        }
      }
      return false;
    }
  }]);

  return ImageExporter;
}(__WEBPACK_IMPORTED_MODULE_9__configurable__["a" /* default */]);

ImageExporter.prototype.availableOptions = {
  renderType: { type: __WEBPACK_IMPORTED_MODULE_5__constants__["OptionType"].STRING, available: __WEBPACK_IMPORTED_MODULE_7__utils__["a" /* default */].values(__WEBPACK_IMPORTED_MODULE_5__constants__["RenderType"]), default: __WEBPACK_IMPORTED_MODULE_5__constants__["RenderType"].IMAGE },
  imageFormat: { type: __WEBPACK_IMPORTED_MODULE_5__constants__["OptionType"].STRING, available: __WEBPACK_IMPORTED_MODULE_7__utils__["a" /* default */].values(__WEBPACK_IMPORTED_MODULE_5__constants__["ImageFormat"]), default: __WEBPACK_IMPORTED_MODULE_5__constants__["ImageFormat"].PNG },
  quality: { type: __WEBPACK_IMPORTED_MODULE_5__constants__["OptionType"].NUMBER, default: 0.8 }
};

/* harmony default export */ __webpack_exports__["a"] = (ImageExporter);

/***/ }),
/* 230 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);


var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */

/**
 * Provides environment functions for internal use
 * @class
 * @memberof PhotoEditorSDK
 * @private
 */
var Env = function () {
  function Env() {
    _classCallCheck(this, Env);
  }

  _createClass(Env, null, [{
    key: 'current',

    /**
     * Return current environment
     * @returns {Boolean}
     */
    value: function current() {
      return ("production");
    }

    /**
     * Returns True if testing environment
     * @returns {Boolean}
     */

  }, {
    key: 'isTest',
    value: function isTest() {
      return ("production") === 'test';
    }

    /**
     * Returns True if development environment
     * @returns {Boolean}
     */

  }, {
    key: 'isDevelopment',
    value: function isDevelopment() {
      return ("production") === 'development';
    }

    /**
     * Returns True if production environment
     * @returns {Boolean}
     */

  }, {
    key: 'isProduction',
    value: function isProduction() {
      return ("production") === 'production' || !this.isTest() && !this.isDevelopment();
    }
  }]);

  return Env;
}();

/* harmony default export */ __webpack_exports__["a"] = (Env);

/***/ }),
/* 231 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
Object.defineProperty(__webpack_exports__, "__esModule", { value: true });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__image_loader__ = __webpack_require__(48);
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "ImageLoader", function() { return __WEBPACK_IMPORTED_MODULE_0__image_loader__["a"]; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__json_loader__ = __webpack_require__(47);
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "JSONLoader", function() { return __WEBPACK_IMPORTED_MODULE_1__json_loader__["a"]; });
// export { default as FileLoader } from './file-loader'



/***/ }),
/* 232 */
/***/ (function(module, exports) {

module.exports = require("fs");

/***/ }),
/* 233 */
/***/ (function(module, exports) {

module.exports = __WEBPACK_EXTERNAL_MODULE_233__;

/***/ }),
/* 234 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
Object.defineProperty(__webpack_exports__, "__esModule", { value: true });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__adjustments_operation__ = __webpack_require__(235);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__blur_operation__ = __webpack_require__(239);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__filter_operation__ = __webpack_require__(241);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__frame_operation__ = __webpack_require__(304);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__linear_focus_operation__ = __webpack_require__(305);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__mirrored_focus_operation__ = __webpack_require__(308);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__orientation_operation__ = __webpack_require__(311);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__overlay_operation__ = __webpack_require__(312);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9__radial_focus_operation__ = __webpack_require__(313);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10__selective_blur_operation__ = __webpack_require__(316);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_11__sprite_operation__ = __webpack_require__(322);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_12__transform_operation__ = __webpack_require__(327);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_13__watermark_operation__ = __webpack_require__(329);
/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */
















var Operations = [__WEBPACK_IMPORTED_MODULE_1__adjustments_operation__["a" /* default */], __WEBPACK_IMPORTED_MODULE_2__blur_operation__["a" /* default */], __WEBPACK_IMPORTED_MODULE_3__filter_operation__["a" /* default */], __WEBPACK_IMPORTED_MODULE_4__frame_operation__["a" /* default */], __WEBPACK_IMPORTED_MODULE_5__linear_focus_operation__["a" /* default */], __WEBPACK_IMPORTED_MODULE_6__mirrored_focus_operation__["a" /* default */], __WEBPACK_IMPORTED_MODULE_7__orientation_operation__["a" /* default */], __WEBPACK_IMPORTED_MODULE_8__overlay_operation__["a" /* default */], __WEBPACK_IMPORTED_MODULE_9__radial_focus_operation__["a" /* default */], __WEBPACK_IMPORTED_MODULE_10__selective_blur_operation__["a" /* default */], __WEBPACK_IMPORTED_MODULE_11__sprite_operation__["a" /* default */], __WEBPACK_IMPORTED_MODULE_12__transform_operation__["a" /* default */], __WEBPACK_IMPORTED_MODULE_13__watermark_operation__["a" /* default */]];

__WEBPACK_IMPORTED_MODULE_0_photoeditorsdk_core___default.a.AllOperations = Operations;

/* harmony default export */ __webpack_exports__["default"] = (Operations);

/***/ }),
/* 235 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor__ = __webpack_require__(7);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__shared_filters_adjustments_filter__ = __webpack_require__(125);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__clarity_filter__ = __webpack_require__(237);






var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor___default()(object, property); if (desc === undefined) { var parent = __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if ("value" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




var ColorMatrix = __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Math"].ColorMatrix;

/**
 * Applies adjustments (brightness, saturation, contrast) to the image
 * @class
 * @alias Operations.AdjustmentsOperation
 * @extends PhotoEditorSDK.Operation
 * @memberof PhotoEditorSDK
 */

var AdjustmentsOperation = function (_Operation) {
  _inherits(AdjustmentsOperation, _Operation);

  /**
   * Creates a new AdjustmentsOperation
   * @param  {PhotoEditorSDK} sdk
   * @param  {Object} [options]
   * @param  {Number} [options.brightness = 0]
   * @param  {Number} [options.saturation = 1]
   * @param  {Number} [options.exposure = 0]
   * @param  {Number} [options.contrast = 1]
   * @param  {Number} [options.shadows = 0]
   * @param  {Number} [options.highlights = 1]
   */
  function AdjustmentsOperation() {
    var _ref;

    _classCallCheck(this, AdjustmentsOperation);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this = _possibleConstructorReturn(this, (_ref = AdjustmentsOperation.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(AdjustmentsOperation)).call.apply(_ref, [this].concat(args)));

    _this._clarityFilter = new __WEBPACK_IMPORTED_MODULE_7__clarity_filter__["a" /* default */]();
    _this._filter = new __WEBPACK_IMPORTED_MODULE_6__shared_filters_adjustments_filter__["a" /* default */]();
    _this._sprite.setFilters([_this._clarityFilter, _this._filter]);
    return _this;
  }

  /**
   * Applies this operation
   * @param  {PhotoEditorSDK} sdk
   * @return {Promise} renderer
   * @private
   */


  _createClass(AdjustmentsOperation, [{
    key: '_render',
    value: function _render(sdk) {
      var dimensions = sdk.getDimensions();
      dimensions.x = 1.0 / dimensions.x;
      dimensions.y = 1.0 / dimensions.y;
      var clarityColorMatrix = new ColorMatrix();
      clarityColorMatrix.multiply(ColorMatrix.createSaturationMatrix(-0.3 * this._options.clarity + 1));
      clarityColorMatrix.multiply(ColorMatrix.createContrastMatrix(0.1 * this._options.clarity + 1));

      this._clarityFilter.set({
        clarity: this._options.clarity,
        pixelDimension: dimensions,
        colorMatrix: clarityColorMatrix,
        colorOffset: clarityColorMatrix.getOffsets()
      });

      var colorMatrix = new ColorMatrix();
      colorMatrix.multiply(ColorMatrix.createExposureMatrix(this._options.exposure));
      colorMatrix.multiply(ColorMatrix.createSaturationMatrix(this._options.saturation + 1));
      colorMatrix.multiply(ColorMatrix.createContrastMatrix((this._options.contrast > 0 ? this._options.contrast * 2 : this._options.contrast) + 1));
      colorMatrix.multiply(ColorMatrix.createBrightnessMatrix(this._options.brightness));

      this._filter.set({
        gamma: this._options.gamma,
        shadows: this._options.shadows,
        highlights: this._options.highlights,
        colorMatrix: colorMatrix,
        colorOffset: colorMatrix.getOffsets()
      });

      if (this._options.clarity !== 0) {
        this._sprite.setFilters([this._clarityFilter, this._filter]);
      } else {
        this._sprite.setFilters([this._filter]);
      }

      this._renderTexture.render(this._container);

      return __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Promise"].resolve();
    }

    /**
     * Disposes this operation
     */

  }, {
    key: 'dispose',
    value: function dispose() {
      _get(AdjustmentsOperation.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(AdjustmentsOperation.prototype), 'dispose', this).call(this);
      this._filter.dispose();
      this._clarityFilter.dispose();
    }
  }]);

  return AdjustmentsOperation;
}(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Operation"]);

/**
 * A unique string that identifies this operation. Can be used to select
 * operations.
 * @type {String}
 * @default
 */


AdjustmentsOperation.identifier = 'adjustments';

/**
 * Specifies the available options for this operation
 * @type {Object}
 * @ignore
 */
AdjustmentsOperation.prototype.availableOptions = {
  brightness: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].NUMBER, default: 0, minValue: -1, midValue: 0, maxValue: 1 },
  saturation: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].NUMBER, default: 0.0, minValue: -1, midValue: 0, maxValue: 1 },
  contrast: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].NUMBER, default: 0.0, minValue: -1, midValue: 0, maxValue: 1 },
  gamma: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].NUMBER, default: 1.0, minValue: 0.5, midValue: 1, maxValue: 2 },
  exposure: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].NUMBER, default: 0.0, minValue: -1, midValue: 0, maxValue: 1 },
  shadows: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].NUMBER, default: 0.0, minValue: -2, midValue: 0, maxValue: 2 },
  highlights: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].NUMBER, default: 0.0, minValue: -1, midValue: 0, maxValue: 1 },
  clarity: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].NUMBER, default: 0.0, minValue: -1, midValue: 0, maxValue: 1 }
};

__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core___default.a.Operations.AdjustmentsOperation = AdjustmentsOperation;

/* harmony default export */ __webpack_exports__["a"] = (AdjustmentsOperation);

/***/ }),
/* 236 */
/***/ (function(module, exports) {

module.exports = "precision highp float;\n\nvarying vec2 v_texCoord;\nuniform sampler2D u_image;\n\nuniform float u_gamma;\nuniform float u_shadows;\nuniform float u_highlights;\n\nuniform mat4 u_colorMatrix;\nuniform vec4 u_colorOffset;\n\nconst float EPSILON = 0.0000001;\n\nfloat calculateLuminance(vec3 rgb) {\n    // This is the luminance calculation part of the RGB to HSL formular.\n    vec4 p = mix(\n        vec4(rgb.gb, 0.0, -1.0 / 3.0),\n        vec4(rgb.bg, -1.0, 2.0 / 3.0),\n        vec4(rgb.g < rgb.b)\n    );\n\n    vec4 q = mix(\n        vec4(rgb.r, p.yzx),\n        vec4(p.xyw, rgb.r),\n        vec4(rgb.r < p.x)\n    );\n\n    float croma = q.x - min(q.w, q.y);\n    float luminance = q.x - croma * 0.5;\n    return luminance;\n}\n\nvoid main() {\n\n  vec4 color = clamp(texture2D(u_image, v_texCoord), 0.0, 1.0);\n  color.rgb /= max(color.a, EPSILON); // Revert premultiplied alpha\n\n  // Apply gamma\n  if (u_gamma != 1.0) {\n    color.rgb = pow(color.rgb, vec3(1.0 / max(u_gamma, EPSILON)));\n  }\n\n  // Apply shadows and highlights\n  float luminance = calculateLuminance(color.rgb);\n\n  float shadow = u_shadows >= 0.0\n    ? clamp(\n          pow(luminance, 1.0 / (u_shadows + 1.0))\n          + pow(luminance, 2.0 / (u_shadows + 1.0)) * -0.76\n          - luminance\n    , 0.0, max(u_shadows, 1.0))\n    : -clamp(\n          pow(luminance, 1.0 / (-u_shadows + 1.0))\n          + pow(luminance, 2.0 / (-u_shadows + 1.0)) * -0.76\n          - luminance\n    , 0.0, max(-u_shadows, 1.0));\n\n  float highlight = u_highlights < 0.0\n    ? clamp(\n          1.0\n          - pow(1.0 - luminance, 1.0 / (1.0 - u_highlights))\n          - pow(1.0 - luminance, 2.0 / (1.0 - u_highlights)) * -0.8\n          - luminance\n     , -1.0, 0.0)\n    : -clamp(\n          1.0\n          - pow(1.0 - luminance, 1.0 / (1.0 + u_highlights))\n          - pow(1.0 - luminance, 2.0 / (1.0 + u_highlights)) * -0.8\n          - luminance\n     , -1.0, 0.0);\n\n  // Bright color need more contrast and dark color need more brightness.\n  // This is to keep saturatation because the color information of a dark colors is lost.\n  float shadowContrast   = shadow * luminance * luminance;\n  float shadowBrightness = shadow - shadowContrast;\n  color.rgb = clamp((luminance + highlight + shadowContrast) * ((color.rgb + shadowBrightness) / max(luminance, EPSILON)), 0.0, 1.0);\n\n  // Apply Color Matrix\n  color = clamp(color * u_colorMatrix + u_colorOffset, 0.0, 1.0);\n\n  color.rgb *= color.a; // Do premultiplie alpha\n\n  gl_FragColor = color;\n}\n"

/***/ }),
/* 237 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__);





var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */


var Vector2 = __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Math"].Vector2,
    ColorMatrix = __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Math"].ColorMatrix;

var ClarityFilter = function (_Engine$Filter) {
  _inherits(ClarityFilter, _Engine$Filter);

  function ClarityFilter() {
    _classCallCheck(this, ClarityFilter);

    var _this = _possibleConstructorReturn(this, (ClarityFilter.__proto__ || __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default()(ClarityFilter)).call(this));

    _this._fragmentSource = __webpack_require__(238);
    return _this;
  }

  /**
   * Applies this filter to the given inputTarget and renders it to
   * the given outputTarget using the CanvasRenderer.
   * @param  {CanvasRenderer} renderer
   * @param  {RenderTarget} inputTarget
   * @param  {RenderTarget} outputTarget
   * @param  {Boolean} clear = false
   * @private
   */


  _createClass(ClarityFilter, [{
    key: '_applyCanvas',
    value: function _applyCanvas(renderer, inputTarget, outputTarget) {
      var clear = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;

      // const inputDimensions = inputTarget.getDimensions()
      var outputContext = outputTarget.getContext();
      var inputCanvas = inputTarget.getCanvas();
      var inputContext = inputTarget.getContext();

      var clarity = this._options.clarity;
      var colorMatrix = this._options.colorMatrix;
      var colorOffset = new __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Color"](this._options.colorOffset[0], this._options.colorOffset[1], this._options.colorOffset[2], this._options.colorOffset[3]);
      var width = inputCanvas.width;
      var height = inputCanvas.height;
      var inputImageData = inputContext.getImageData(0, 0, width, height);
      var outputImageData = outputContext.createImageData(width, height);

      this.canvasShader(inputImageData, outputImageData, clarity, colorMatrix, colorOffset);

      outputContext.putImageData(outputImageData, 0, 0);
    }

    /**
     *
     *
     * @param {ImageData} inputImageData
     * @param {ImageData} outputImageData
     * @param {Number} clarity
     * @param {ColorMatrix} colorMatrix
     * @param {Color} colorOffset
     * @memberof ClarityFilter
     */

  }, {
    key: 'canvasShader',
    value: function canvasShader(inputImageData, outputImageData, clarity, colorMatrix, colorOffset) {
      var clamp = function clamp(x, minVal, maxVal) {
        return Math.min(Math.max(x, minVal), maxVal);
      };
      var smoothstep = function smoothstep(edge0, edge1, x) {
        var t = clamp((x - edge0) / (edge1 - edge0), 0.0, 1.0);
        return t * t * (3.0 - 2.0 * t);
      };

      var stride = inputImageData.width * 4;
      var length = inputImageData.data.length;
      var maxIdx = length - 1;
      var minIdx = 0;
      var inData = inputImageData.data;
      var outData = outputImageData.data;

      var tmpColor = new __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Color"]();
      var divisor = 255 * 9;
      var sampleEdge = function sampleEdge(idx) {
        idx = idx < minIdx ? minIdx : idx;
        idx = idx > maxIdx ? maxIdx : idx;
        return inData[idx];
      };

      for (var idx = 0; idx < length; idx += 4) {
        var colorR = sampleEdge(idx + 0);
        var colorG = sampleEdge(idx + 1);
        var colorB = sampleEdge(idx + 2);
        var colorA = sampleEdge(idx + 3);

        var mergedR = (colorR + sampleEdge(idx - 4 - stride + 0) + sampleEdge(idx - 4 + 0) + sampleEdge(idx - 4 + stride + 0) + sampleEdge(idx - stride + 0) + sampleEdge(idx + stride + 0) + sampleEdge(idx + 4 - stride + 0) + sampleEdge(idx + 4 + 0) + sampleEdge(idx + 4 + stride)) / divisor;

        var mergedG = (colorG + sampleEdge(idx - 4 - stride + 1) + sampleEdge(idx - 4 + 1) + sampleEdge(idx - 4 + stride + 1) + sampleEdge(idx - stride + 1) + sampleEdge(idx + stride + 1) + sampleEdge(idx + 4 - stride + 1) + sampleEdge(idx + 4 + 1) + sampleEdge(idx + 4 + stride + 1)) / divisor;

        var mergedB = (colorB + sampleEdge(idx - 4 - stride + 2) + sampleEdge(idx - 4 + 2) + sampleEdge(idx - 4 + stride + 2) + sampleEdge(idx - stride + 2) + sampleEdge(idx + stride + 2) + sampleEdge(idx + 4 - stride + 2) + sampleEdge(idx + 4 + 2) + sampleEdge(idx + 4 + stride + 2)) / divisor;

        var mergedA = (colorA + sampleEdge(idx - 4 - stride + 3) + sampleEdge(idx - 4 + 3) + sampleEdge(idx - 4 + stride + 3) + sampleEdge(idx - stride + 3) + sampleEdge(idx + stride + 3) + sampleEdge(idx + 4 - stride + 3) + sampleEdge(idx + 4 + 3) + sampleEdge(idx + 4 + stride + 3)) / divisor;

        colorR /= 255;
        colorG /= 255;
        colorB /= 255;
        colorA /= 255;

        var grayValue = clamp(colorR * 0.3 + colorG * 0.59 + colorB * 0.1, 0.111111, 0.999999);

        var frequenceFactor = Math.min(smoothstep(1.0 - grayValue, 0.0, 0.11), smoothstep(grayValue, 0.0, 0.11));
        var scalar = clarity * 3.7 * frequenceFactor;
        var scale = Math.pow(2.0, clarity * 0.27 * frequenceFactor);
        var outR = clamp(colorR + clamp((colorR - mergedR) * scalar, 0.0, 10.0), 0.0, 1.0) * scale;
        var outG = clamp(colorG + clamp((colorG - mergedG) * scalar, 0.0, 10.0), 0.0, 1.0) * scale;
        var outB = clamp(colorB + clamp((colorB - mergedB) * scalar, 0.0, 10.0), 0.0, 1.0) * scale;
        var outA = clamp(colorA + clamp((colorA - mergedA) * scalar, 0.0, 10.0), 0.0, 1.0);

        tmpColor.set(outR, outG, outB, outA);

        var outColor = colorMatrix.apply(tmpColor).add(colorOffset);
        // .clamp(0.0, 1.0)

        outData[idx + 0] = outColor.r * 255;
        outData[idx + 1] = outColor.g * 255;
        outData[idx + 2] = outColor.b * 255;
        outData[idx + 3] = outColor.a * 255;
      }
    }
  }]);

  return ClarityFilter;
}(__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Engine"].Filter);

ClarityFilter.prototype.availableOptions = {
  clarity: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].NUMBER, default: 0, uniformType: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["UniformType"].FLOAT },
  pixelDimension: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].VECTOR2, default: new Vector2(100, 100), uniformType: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["UniformType"].FLOAT2 },
  colorMatrix: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].COLOR_MATRIX, default: new ColorMatrix(), uniformType: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["UniformType"].MAT4 },
  colorOffset: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].ARRAY, default: [], uniformType: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["UniformType"].FLOAT4 }
};

/* harmony default export */ __webpack_exports__["a"] = (ClarityFilter);

/***/ }),
/* 238 */
/***/ (function(module, exports) {

module.exports = "precision mediump float;\n\n// Input Image with config WRAP_S and WRAP_T: CLAMP_TO_EDGE\nuniform sampler2D u_image;\n\n// Size of one pixel == vec2(1.0 / u_image.width, 1.0 / u_image.height)\nuniform vec2 u_pixelDimension;\n\n// Range (-1.0 - 1.0)\nuniform float u_clarity;\n\nvarying vec2 v_texCoord;\n\nuniform mat4 u_colorMatrix;\nuniform vec4 u_colorOffset;\n\nconst float EPSILON = 0.000001;\n\nvoid main() {\n    vec4 color = texture2D(u_image, v_texCoord);\n\n    vec4 mergedColor = color;\n    mergedColor += texture2D(u_image, v_texCoord + vec2(-u_pixelDimension.x, -u_pixelDimension.y));\n    mergedColor += texture2D(u_image, v_texCoord + vec2(-u_pixelDimension.x,                 0.0));\n    mergedColor += texture2D(u_image, v_texCoord + vec2(-u_pixelDimension.x,  u_pixelDimension.y));\n\n    mergedColor += texture2D(u_image, v_texCoord + vec2(                0.0, -u_pixelDimension.y));\n    mergedColor += texture2D(u_image, v_texCoord + vec2(                0.0,  u_pixelDimension.y));\n\n    mergedColor += texture2D(u_image, v_texCoord + vec2( u_pixelDimension.x, -u_pixelDimension.y));\n    mergedColor += texture2D(u_image, v_texCoord + vec2( u_pixelDimension.x,                 0.0));\n    mergedColor += texture2D(u_image, v_texCoord + vec2( u_pixelDimension.x,  u_pixelDimension.y));\n\n    mergedColor /= 9.0;\n\n    color.rgb /= max(color.a, EPSILON);       // Revert premultiplied alpha\n    mergedColor.rgb /= max(mergedColor.a, EPSILON); // Revert premultiplied alpha\n\n    float grayValue = clamp(color.r * 0.3 + color.g * 0.59 + color.b * 0.1, 0.111111, 0.999999);\n    // 1.0 and 0.0 result in white not black, therefore we clamp\n\n    // Here we create a function that will map values below 0.1 to 0. Values above 0.2 will be mapped to 1,\n    // and for values between 0.1 and 0.2 it will produce a gradient.\n    // The funtion is mirror at 0.5, meaning values between 0.8 and 0.9 will result in a decending gradient.\n    // And values above 0.9 will be mapped to 0.\n    float frequenceFactor = min(smoothstep(1.0 - grayValue, 0.0, 0.11), smoothstep(grayValue, 0.0, 0.11));\n\n    // here we apply the high pass filter. Its strength is determined by the uniform ,\n    // and the frequence factor. That means the only the mid tones are affected by this filter.\n    // Clarity input is ranging from -1 to 1. But we want to strengthen the effect.\n    // Therefore we see this little magic number '3.7'.\n    color = clamp(color + clamp((color - mergedColor) * u_clarity * 3.7 * frequenceFactor, 0.0, 10.0), 0.0, 1.0);\n\n    // apply exposure but only to the mid tones.\n    color.rgb = color.rgb * pow(2.0, u_clarity * 0.27 * frequenceFactor);\n\n    // apply contrast and desaturation matrix\n\n\n    color = clamp(color * u_colorMatrix + u_colorOffset, 0.0, 1.0);\n\n    color.rgb *= color.a; // Do premultiplie alpha\n\n    gl_FragColor = clamp(color, 0.0, 1.0);\n}\n"

/***/ }),
/* 239 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor__ = __webpack_require__(7);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__shared_filters_blur_filter__ = __webpack_require__(126);






var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor___default()(object, property); if (desc === undefined) { var parent = __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if ("value" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */



var Vector2 = __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Math"].Vector2;

/**
 * An operation that can draw a radial focus
 * @class
 * @extends PhotoEditorSDK.Operation
 * @memberof PhotoEditorSDK.Operations
 */

var BlurOperation = function (_Operation) {
  _inherits(BlurOperation, _Operation);

  /**
   * Creates a new BlurOperation
   * @param  {PhotoEditorSDK} sdk
   * @param  {Object} [options]
   */
  function BlurOperation() {
    var _ref;

    _classCallCheck(this, BlurOperation);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this = _possibleConstructorReturn(this, (_ref = BlurOperation.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(BlurOperation)).call.apply(_ref, [this].concat(args)));

    _this._lastBlurRadius = _this._options.blurRadius;

    _this._horizontalFilter = new __WEBPACK_IMPORTED_MODULE_6__shared_filters_blur_filter__["a" /* default */]();
    _this._verticalFilter = new __WEBPACK_IMPORTED_MODULE_6__shared_filters_blur_filter__["a" /* default */]();
    _this._sprite.setFilters([_this._horizontalFilter, _this._verticalFilter]);

    _this._horizontalFilter.setDelta(new Vector2(0.5, 0.5));
    _this._verticalFilter.setDelta(new Vector2(-0.5, 0.5));

    _this._filter = new __WEBPACK_IMPORTED_MODULE_6__shared_filters_blur_filter__["a" /* default */]();
    return _this;
  }

  /**
   * Renders the radial blur using WebGL
   * @param  {PhotoEditorSDK.Engine.Texture} inputTexture
   * @private
   * @override
   */
  /* istanbul ignore next */


  _createClass(BlurOperation, [{
    key: '_renderWebGL',
    value: function _renderWebGL(inputTexture) {
      var inputDimensions = inputTexture.getDimensions();
      var shortestSide = inputDimensions.min();

      var blurRadius = this._options.blurRadius;


      var commonOptions = {
        blurRadius: blurRadius * shortestSide,
        texSize: inputDimensions
      };

      this._horizontalFilter.set(commonOptions);
      this._verticalFilter.set(commonOptions);

      this._renderTexture.render(this._container);

      return __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Promise"].resolve();
    }

    /**
     * Renders the radial blur using Canvas2D
     * @param  {PhotoEditorSDK.Engine.Texture} inputTexture
     * @private
     * @override
     */

  }, {
    key: '_renderCanvas',
    value: function _renderCanvas(inputTexture) {
      var blurRadius = this._options.blurRadius;

      var inputDimensions = inputTexture.getDimensions();

      this._filter.set({
        blurRadius: blurRadius,
        texSize: inputDimensions
      });

      this._sprite.setFilters([this._filter]);

      this._renderTexture.render(this._container);

      return __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Promise"].resolve();
    }

    /**
     * Applies the given transform change
     * @param  {PhotoEditorSDK.Operations.TransformOperation.TransformChange} transformChange
     * @private
     */

  }, {
    key: 'transform',
    value: function transform(transformChange) {
      var size = this.getBlurRadius();
      var blurRadius = transformChange.applyToRelativeSize(size);

      this.set({ blurRadius: blurRadius }, false);
    }

    /**
     * Disposes this operation
     */

  }, {
    key: 'dispose',
    value: function dispose() {
      _get(BlurOperation.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(BlurOperation.prototype), 'dispose', this).call(this);
      this._filter.dispose();
      this._verticalFilter.dispose();
      this._horizontalFilter.dispose();
    }

    /**
     * Checks if the operation has changes/modifications
     * @return {Boolean}
     */

  }, {
    key: 'hasChanges',
    value: function hasChanges() {
      return true;
    }
  }]);

  return BlurOperation;
}(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Operation"]);

/**
 * A unique string that identifies this operation. Can be used to select
 * operations.
 * @type {String}
 * @default
 */


BlurOperation.identifier = 'blur';

/**
 * Specifies the available options for this operation
 * @type {Object}
 * @ignore
 */
BlurOperation.prototype.availableOptions = {
  blurRadius: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].NUMBER, default: 0.025 }
};

__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core___default.a.Operations.BlurOperation = BlurOperation;

/* harmony default export */ __webpack_exports__["a"] = (BlurOperation);

/***/ }),
/* 240 */
/***/ (function(module, exports) {

module.exports = "/*\n * Based on evanw's glfx.js tilt shift shader:\n * https://github.com/evanw/glfx.js/blob/master/src/filters/blur/tiltshift.js\n * @license\n */\n\nuniform sampler2D u_image;\nuniform float u_blurRadius;\nuniform vec2 u_delta;\nuniform vec2 u_texSize;\nvarying vec2 v_texCoord;\n\nfloat random(vec2 co)\n{\n    highp float a = 12.9898;\n    highp float b = 78.233;\n    highp float c = 43758.5453;\n    highp float dt = dot(co.xy,vec2(a,b));\n    highp float sn = mod(dt, 3.14);\n    return fract(sin(sn) * c);\n}\n\nvoid main() {\n    vec4 color = vec4(0.0);\n    float total = 0.0;\n\n    float offset = random(gl_FragCoord.xy / u_texSize.xy);\n    float radius = u_blurRadius;\n\n    for (float t = -30.0; t <= 30.0; t++) {\n        float percent = (t + offset - 0.5) / 30.0;\n        float weight = 1.0 - abs(percent);\n\n        // Somehow `sample` is a keyword in headless-gl\n        vec4 _sample = texture2D(u_image, v_texCoord + u_delta * percent * radius / u_texSize);\n\n        _sample.rgb *= _sample.a;\n\n        color += _sample * weight;\n        total += weight;\n    }\n\n    gl_FragColor = color / total;\n    gl_FragColor.rgb /= gl_FragColor.a + 0.00001;\n}\n"

/***/ }),
/* 241 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign__ = __webpack_require__(79);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_own_property_descriptor__ = __webpack_require__(7);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_own_property_descriptor___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_own_property_descriptor__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__filters_identity_filter__ = __webpack_require__(127);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__filters_primitives__ = __webpack_require__(6);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9__filters__ = __webpack_require__(272);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10__filters_filter__ = __webpack_require__(5);







var _extends = __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign___default.a || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_own_property_descriptor___default()(object, property); if (desc === undefined) { var parent = __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default()(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if ("value" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */







/**
 * An operation that can apply a selected filter
 * @class
 * @extends PhotoEditorSDK.Operation
 * @memberof PhotoEditorSDK.Operations
 */

var FilterOperation = function (_Operation) {
  _inherits(FilterOperation, _Operation);

  function FilterOperation() {
    _classCallCheck(this, FilterOperation);

    return _possibleConstructorReturn(this, (FilterOperation.__proto__ || __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default()(FilterOperation)).apply(this, arguments));
  }

  _createClass(FilterOperation, [{
    key: '_render',

    /**
     * Renders this operation
     * @param {PhotoEditorSDK.Engine.Texture} inputTexture
     * @return {Promise}
     * @private
     */
    value: function _render(inputTexture) {
      return this._selectedFilter.render(this._sdk, inputTexture, this._renderTexture);
    }

    /**
     * Applies this operation
     * @param  {PhotoEditorSDK.Engine.Texture} inputTexture
     * @return {Promise}
     * @override
     */

  }, {
    key: 'render',
    value: function render(inputTexture) {
      if (this._selectedFilter.getDirty()) {
        this.setDirty(true);
      }

      if (!this.getEnabled() || this._selectedFilter.constructor.isIdentity) {
        return __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["Promise"].resolve(inputTexture);
      }

      return _get(FilterOperation.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default()(FilterOperation.prototype), 'render', this).call(this, inputTexture);
    }

    /**
     * Sets the dirtiness for the given renderer
     * @param {Boolean} dirty
     * @param {PhotoEditorSDK.Engine.BaseRenderer} renderer
     * @override
     */

  }, {
    key: 'setDirtyForRenderer',
    value: function setDirtyForRenderer(dirty, renderer) {
      _get(FilterOperation.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default()(FilterOperation.prototype), 'setDirtyForRenderer', this).call(this, dirty, renderer);
      this._selectedFilter.setDirtyForRenderer(dirty, renderer);
    }

    /**
     * Frees the memory
     */

  }, {
    key: 'disposeRenderTextures',
    value: function disposeRenderTextures() {
      _get(FilterOperation.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default()(FilterOperation.prototype), 'disposeRenderTextures', this).call(this);
      if (this._selectedFilter) {
        this._selectedFilter.disposeRenderTextures();
      }
    }

    /**
     * Disposes this operation
     */

  }, {
    key: 'dispose',
    value: function dispose() {
      _get(FilterOperation.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default()(FilterOperation.prototype), 'dispose', this).call(this);
      if (this._selectedFilter) {
        this._selectedFilter.dispose();
      }
    }
  }, {
    key: 'restoreSnapshot',
    value: function restoreSnapshot(serializedOptions) {
      var options = _extends({}, serializedOptions);
      delete options.filter;

      if (serializedOptions.filter) {
        var FilterConstructor = serializedOptions.filter.constructor;
        if (FilterConstructor.identifier === '3d-lut') {
          this.setFilter(new FilterConstructor({
            image: serializedOptions.filter.getImage(),
            resolution: serializedOptions.filter.getResolution(),
            horizontalTileCount: serializedOptions.filter.getHorizontalTileCount(),
            verticalTileCount: serializedOptions.filter.getVerticalTileCount()
          }));
        } else {
          this.setFilter(new FilterConstructor());
        }
      }
      this.set(options);
    }
  }]);

  return FilterOperation;
}(__WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["Operation"]);

/**
 * A unique string that identifies this operation. Can be used to select
 * operations.
 * @type {String}
 * @default
 */


FilterOperation.identifier = 'filter';

/**
 * Specifies the available options for this operation
 * @type {Object}
 * @ignore
 */
FilterOperation.prototype.availableOptions = {
  identifier: {
    type: __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["OptionType"].STRING,
    default: 'identity'
  },
  intensity: {
    type: __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["OptionType"].NUMBER,
    default: 1,
    setter: function setter(intensity) {
      this._selectedFilter && this._selectedFilter.setIntensity(intensity);
      return intensity;
    }
  },
  filter: {
    type: __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["OptionType"].OBJECT,
    default: new __WEBPACK_IMPORTED_MODULE_7__filters_identity_filter__["a" /* default */](),
    setter: function setter(Filter) {
      if (this._selectedFilter) {
        this._selectedFilter.dispose();
        this._selectedFilter = null;
      }

      this._selectedFilter = Filter;
      if (typeof this._options.intensity !== 'undefined') {
        this._selectedFilter.set({
          intensity: this._options.intensity
        });
      }
      return Filter;
    }
  }
};

FilterOperation.FilterPrimitives = __WEBPACK_IMPORTED_MODULE_8__filters_primitives__;
FilterOperation.Filters = __WEBPACK_IMPORTED_MODULE_9__filters__;
FilterOperation.Filter = __WEBPACK_IMPORTED_MODULE_10__filters_filter__["a" /* default */];
__WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core___default.a.Operations.FilterOperation = FilterOperation;

/* harmony default export */ __webpack_exports__["a"] = (FilterOperation);

/***/ }),
/* 242 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__);





var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */



var BlendFilter = function (_Engine$Filter) {
  _inherits(BlendFilter, _Engine$Filter);

  function BlendFilter() {
    _classCallCheck(this, BlendFilter);

    var _this = _possibleConstructorReturn(this, (BlendFilter.__proto__ || __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default()(BlendFilter)).call(this));

    _this._fragmentSource = __webpack_require__(243);
    return _this;
  }

  /**
   * Applies this filter to the given inputTarget and renders it to
   * the given outputTarget using the CanvasRenderer
   * @param  {PhotoEditorSDK.Engine.CanvasRenderer} renderer
   * @param  {PhotoEditorSDK.Engine.RenderTarget} inputTarget
   * @param  {PhotoEditorSDK.Engine.RenderTarget} outputTarget
   * @param  {Boolean} clear = false
   * @private
   */


  _createClass(BlendFilter, [{
    key: '_applyCanvas',
    value: function _applyCanvas(renderer, inputTarget, outputTarget) {
      var clear = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;

      var canvas = inputTarget.getCanvas();
      var outputContext = outputTarget.getContext();

      var filteredCanvas = this._options.filteredCanvas;


      outputContext.save();
      outputContext.drawImage(canvas, 0, 0);
      outputContext.globalAlpha = this._options.intensity;
      outputContext.drawImage(filteredCanvas, 0, 0);
      outputContext.restore();
    }
  }]);

  return BlendFilter;
}(__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Engine"].Filter);

BlendFilter.prototype.availableOptions = {
  filteredImage: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].NUMBER, default: 1, uniformType: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["UniformType"].INT },
  filteredCanvas: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].OBJECT, default: null },
  intensity: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].NUMBER, default: 1, uniformType: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["UniformType"].FLOAT }

  /**
   * A helper class that can collect {@link Primitive} instances and render
   * the stack
   * @class
   * @memberof PhotoEditorSDK.Filter
   */
};
var PrimitivesStack = function () {
  function PrimitivesStack() {
    var intensity = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 1;

    _classCallCheck(this, PrimitivesStack);

    this._intensity = intensity;

    this._stack = [];
    this._dirtiness = {};
    this._renderTextures = {};
    this._container = new __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Engine"].Container();
    this._sprite = new __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Engine"].Sprite();
    this._container.addChild(this._sprite);

    this._blendFilter = new BlendFilter();
  }

  /**
   * Adds the given primitive to the stack
   * @param {PhotoEditorSDK.Filter.Primitive} primitive
   */


  _createClass(PrimitivesStack, [{
    key: 'push',
    value: function push(primitive) {
      this._stack.push(primitive);
    }

    /**
     * Clears the stack
     */

  }, {
    key: 'clear',
    value: function clear() {
      this._stack = [];
    }

    /**
     * Renders this stack
     * @param  {PhotoEditorSDK} sdk
     * @param  {PhotoEditorSDK.Engine.Texture} inputTexture
     * @param  {PhotoEditorSDK.Engine.RenderTexture} outputTexture
     * @return {Promise}
     * @description This takes the output sprite's current texture and renders
     *              it to this stack's internal render texture. It then uses the
     *              internal texture as a uniform for a blend shader and renders
     *              the sprite with the original texture and the blend shader to
     *              the outputTexture
     */

  }, {
    key: 'render',
    value: function render(sdk, inputTexture, outputTexture) {
      if (this._stack.length === 0) {
        return __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Promise"].resolve();
      }
      var renderer = sdk.getRenderer();

      this._sprite.setTexture(inputTexture);

      // Make sure we have a RenderTexture we can render the filtered image to
      var filteredRenderTexture = this._renderTextures[renderer.id];
      if (!filteredRenderTexture) {
        var frame = sdk.getSprite().getTexture().getFrame();
        filteredRenderTexture = new __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Engine"].RenderTexture(sdk.getRenderer(), frame.width, frame.height);
        this._renderTextures[renderer.id] = filteredRenderTexture;
      }

      // Resize filtered render texture to output texture dimensions
      var textureDimensions = outputTexture.getDimensions();
      filteredRenderTexture.resizeTo(textureDimensions);

      var shouldRender = this.isDirtyForRenderer(renderer);
      if (shouldRender) {
        // Update primitives
        this._stack.forEach(function (p) {
          p.update(sdk);
        });

        // Set filters
        var filters = this._stack.map(function (p) {
          return p.getFilter();
        });
        this._sprite.setFilters(filters);

        // Render to RenderTexture
        filteredRenderTexture.render(this._container);
        this.setDirtyForRenderer(false, renderer);
      }

      // Use filteredRenderTexture as uniform for blend shader, blend the two
      // to achieve intensity
      this._blendFilter.setIntensity(this._intensity);
      if (renderer.isOfType(__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["RendererType"].CANVAS)) {
        this._blendFilter.setFilteredCanvas(filteredRenderTexture.getRenderTarget().getCanvas());
      } else if (renderer.isOfType(__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["RendererType"].WEBGL)) {
        var baseTexture = filteredRenderTexture.getBaseTexture();
        baseTexture.setGLUnit(this._blendFilter.getFilteredImage());
        renderer.updateTexture(baseTexture, false);
      }
      this._sprite.setFilters([this._blendFilter]);

      outputTexture.clear(__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Color"].TRANSPARENT);
      outputTexture.render(this._container);

      if (shouldRender) {
        this.disposeRenderTextures();
      }

      return __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Promise"].resolve(outputTexture);
    }
  }, {
    key: 'setIntensity',
    value: function setIntensity(intensity) {
      this._intensity = intensity;
    }

    /**
     * Checks if this operation is dirty for the given renderer
     * @param  {PhotoEditorSDK.Engine.BaseRenderer}  renderer
     * @return {Boolean}
     */

  }, {
    key: 'isDirtyForRenderer',
    value: function isDirtyForRenderer(renderer) {
      if (!(renderer.id in this._dirtiness)) {
        this._dirtiness[renderer.id] = true;
      }
      return this._dirtiness[renderer.id];
    }

    /**
     * Sets the dirtiness for the given renderer
     * @param {Boolean} dirty
     * @param {PhotoEditorSDK.Engine.BaseRenderer} renderer
     */

  }, {
    key: 'setDirtyForRenderer',
    value: function setDirtyForRenderer(dirty, renderer) {
      this._dirtiness[renderer.id] = dirty;
    }

    /**
     * Sets the dirtiness for all renderers
     * @param {Boolean} dirty
     */

  }, {
    key: 'setDirty',
    value: function setDirty(dirty) {
      for (var rendererId in this._dirtiness) {
        this._dirtiness[rendererId] = dirty;
      }
    }

    /**
     * Disposes the render textures, frees some memory
     */

  }, {
    key: 'disposeRenderTextures',
    value: function disposeRenderTextures() {
      for (var rendererId in this._renderTextures) {
        this._renderTextures[rendererId].dispose();
        delete this._renderTextures[rendererId];
      }
    }

    /**
     * Cleans up this instance
     */

  }, {
    key: 'dispose',
    value: function dispose() {
      this.disposeRenderTextures();
      this._stack.forEach(function (primitive) {
        return primitive.dispose();
      });
      this._stack = [];
      this._blendFilter.dispose();

      this._sprite.dispose();
    }
  }]);

  return PrimitivesStack;
}();

/* harmony default export */ __webpack_exports__["a"] = (PrimitivesStack);

/***/ }),
/* 243 */
/***/ (function(module, exports) {

module.exports = "varying vec2 v_texCoord;\nuniform sampler2D u_image;\nuniform sampler2D u_filteredImage;\nuniform float u_intensity;\n\nvoid main() {\n  vec4 color0 = texture2D(u_image, v_texCoord);\n  vec4 color1 = texture2D(u_filteredImage, v_texCoord);\n  gl_FragColor = mix(color0, color1, u_intensity);\n}\n"

/***/ }),
/* 244 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__primitive__ = __webpack_require__(13);





var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




var BrightnessFilter = function (_Engine$Filter) {
  _inherits(BrightnessFilter, _Engine$Filter);

  function BrightnessFilter() {
    _classCallCheck(this, BrightnessFilter);

    var _this = _possibleConstructorReturn(this, (BrightnessFilter.__proto__ || __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default()(BrightnessFilter)).call(this));

    _this._fragmentSource = __webpack_require__(245);
    return _this;
  }

  /**
   * Applies this filter to the given inputTarget and renders it to
   * the given outputTarget using the CanvasRenderer
   * @param  {CanvasRenderer} renderer
   * @param  {RenderTarget} inputTarget
   * @param  {RenderTarget} outputTarget
   * @param  {Boolean} clear = false
   * @private
   */


  _createClass(BrightnessFilter, [{
    key: '_applyCanvas',
    value: function _applyCanvas(renderer, inputTarget, outputTarget) {
      var clear = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;

      var canvas = inputTarget.getCanvas();
      var inputContext = inputTarget.getContext();
      var outputContext = outputTarget.getContext();

      var imageData = inputContext.getImageData(0, 0, canvas.width, canvas.height);

      var brightness = this._options.brightness;


      if (brightness === 0) {
        return;
      }
      brightness = brightness * 255;

      for (var i = 0; i < canvas.width * canvas.height; i++) {
        var index = i * 4;
        imageData.data[index] += brightness;
        imageData.data[index + 1] += brightness;
        imageData.data[index + 2] += brightness;
      }

      outputContext.putImageData(imageData, 0, 0);
    }
  }]);

  return BrightnessFilter;
}(__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Engine"].Filter);

/**
 * Specifies the available options for this filter
 * @type {Object}
 * @ignore
 */


BrightnessFilter.prototype.availableOptions = {
  brightness: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].NUMBER, default: 0, uniformType: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["UniformType"].FLOAT }

  /**
   * Brightness primitive
   * @class
   * @extends PhotoEditorSDK.Filters.Primitive
   * @memberof PhotoEditorSDK.FilterPrimitives
   */
};
var Brightness = function (_Primitive) {
  _inherits(Brightness, _Primitive);

  function Brightness() {
    var _ref;

    _classCallCheck(this, Brightness);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this2 = _possibleConstructorReturn(this, (_ref = Brightness.__proto__ || __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default()(Brightness)).call.apply(_ref, [this].concat(args)));

    _this2._filter = new BrightnessFilter();
    return _this2;
  }

  /**
   * Updates the filter's uniforms
   */


  _createClass(Brightness, [{
    key: 'update',
    value: function update() {
      this._filter.setBrightness(this._options.brightness);
    }
  }]);

  return Brightness;
}(__WEBPACK_IMPORTED_MODULE_5__primitive__["a" /* default */]);

/**
 * Specifies the available options for this primitive
 * @type {Object}
 * @ignore
 */


Brightness.prototype.availableOptions = BrightnessFilter.prototype.availableOptions;

/* harmony default export */ __webpack_exports__["a"] = (Brightness);

/***/ }),
/* 245 */
/***/ (function(module, exports) {

module.exports = "varying vec2 v_texCoord;\nuniform sampler2D u_image;\nuniform float u_brightness;\n\nvoid main() {\n  vec4 texColor = texture2D(u_image, v_texCoord);\n  gl_FragColor = vec4((texColor.rgb + vec3(u_brightness) * texColor.a), texColor.a);;\n}\n"

/***/ }),
/* 246 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__primitive__ = __webpack_require__(13);





var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




var ContrastFilter = function (_Engine$Filter) {
  _inherits(ContrastFilter, _Engine$Filter);

  function ContrastFilter() {
    _classCallCheck(this, ContrastFilter);

    var _this = _possibleConstructorReturn(this, (ContrastFilter.__proto__ || __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default()(ContrastFilter)).call(this));

    _this._fragmentSource = __webpack_require__(247);
    return _this;
  }

  /**
   * Applies this filter to the given inputTarget and renders it to
   * the given outputTarget using the CanvasRenderer
   * @param  {CanvasRenderer} renderer
   * @param  {RenderTarget} inputTarget
   * @param  {RenderTarget} outputTarget
   * @param  {Boolean} clear = false
   * @private
   */


  _createClass(ContrastFilter, [{
    key: '_applyCanvas',
    value: function _applyCanvas(renderer, inputTarget, outputTarget) {
      var clear = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;

      var canvas = inputTarget.getCanvas();
      var inputContext = inputTarget.getContext();
      var outputContext = outputTarget.getContext();

      var imageData = inputContext.getImageData(0, 0, canvas.width, canvas.height);

      var contrast = this._options.contrast;

      if (contrast === 1) {
        return;
      }

      for (var i = 0; i < canvas.width * canvas.height; i++) {
        var index = i * 4;
        imageData.data[index] = (imageData.data[index] - 127) * contrast + 127;
        imageData.data[index + 1] = (imageData.data[index + 1] - 127) * contrast + 127;
        imageData.data[index + 2] = (imageData.data[index + 2] - 127) * contrast + 127;
      }

      outputContext.putImageData(imageData, 0, 0);
    }
  }]);

  return ContrastFilter;
}(__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Engine"].Filter);

/**
 * Specifies the available options for this filter
 * @type {Object}
 * @ignore
 */


ContrastFilter.prototype.availableOptions = {
  contrast: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].NUMBER, default: 1, uniformType: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["UniformType"].FLOAT }

  /**
   * Contrast primitive
   * @class
   * @extends PhotoEditorSDK.Filters.Primitive
   * @memberof PhotoEditorSDK.FilterPrimitives
   */
};
var Contrast = function (_Primitive) {
  _inherits(Contrast, _Primitive);

  function Contrast() {
    var _ref;

    _classCallCheck(this, Contrast);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this2 = _possibleConstructorReturn(this, (_ref = Contrast.__proto__ || __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default()(Contrast)).call.apply(_ref, [this].concat(args)));

    _this2._filter = new ContrastFilter();
    return _this2;
  }

  /**
   * Updates the filter's uniforms
   */


  _createClass(Contrast, [{
    key: 'update',
    value: function update() {
      this._filter.setContrast(this._options.contrast);
    }
  }]);

  return Contrast;
}(__WEBPACK_IMPORTED_MODULE_5__primitive__["a" /* default */]);

/**
 * Specifies the available options for this primitive
 * @type {Object}
 * @ignore
 */


Contrast.prototype.availableOptions = ContrastFilter.prototype.availableOptions;

/* harmony default export */ __webpack_exports__["a"] = (Contrast);

/***/ }),
/* 247 */
/***/ (function(module, exports) {

module.exports = "varying vec2 v_texCoord;\nuniform sampler2D u_image;\nuniform float u_contrast;\n\nvoid main() {\n  vec4 texColor = texture2D(u_image, v_texCoord);\n  gl_FragColor = vec4(((texColor.rgb - vec3(0.5)) * u_contrast + vec3(0.5) * texColor.a), texColor.a);\n}\n"

/***/ }),
/* 248 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__primitive__ = __webpack_require__(13);





var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */



var ColorMatrix = __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Math"].ColorMatrix;

var ColorMatrixFilter = function (_Engine$Filter) {
  _inherits(ColorMatrixFilter, _Engine$Filter);

  function ColorMatrixFilter() {
    _classCallCheck(this, ColorMatrixFilter);

    var _this = _possibleConstructorReturn(this, (ColorMatrixFilter.__proto__ || __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default()(ColorMatrixFilter)).call(this));

    _this._fragmentSource = __webpack_require__(249);
    return _this;
  }

  /**
   * Applies this filter to the given inputTarget and renders it to
   * the given outputTarget using the CanvasRenderer
   * @param  {CanvasRenderer} renderer
   * @param  {RenderTarget} inputTarget
   * @param  {RenderTarget} outputTarget
   * @param  {Boolean} clear = false
   * @private
   */


  _createClass(ColorMatrixFilter, [{
    key: '_applyCanvas',
    value: function _applyCanvas(renderer, inputTarget, outputTarget) {
      var clear = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;

      var canvas = inputTarget.getCanvas();
      var inputContext = inputTarget.getContext();
      var outputContext = outputTarget.getContext();

      var imageData = inputContext.getImageData(0, 0, canvas.width, canvas.height);

      var colorMatrix = this._options.colorMatrix;

      var color = new __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Color"](0, 0, 0, 0);

      for (var i = 0; i < canvas.width * canvas.height; i++) {
        var index = i * 4;
        color.r = imageData.data[index] / 255;
        color.g = imageData.data[index + 1] / 255;
        color.b = imageData.data[index + 2] / 255;
        color = colorMatrix.apply(color);
        imageData.data[index] = color.r * 255;
        imageData.data[index + 1] = color.g * 255;
        imageData.data[index + 2] = color.b * 255;
      }

      outputContext.putImageData(imageData, 0, 0);
    }
  }]);

  return ColorMatrixFilter;
}(__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Engine"].Filter);

/**
 * Specifies the available options for this filter
 * @type {Object}
 * @ignore
 */


ColorMatrixFilter.prototype.availableOptions = {
  colorMatrix: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].COLOR_MATRIX, default: new ColorMatrix(), uniformType: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["UniformType"].MAT4 },
  colorMatrixOffset: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].ARRAY, default: [], uniformType: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["UniformType"].FLOAT4 }

  /**
   * ColorMatrix primitive
   * @class
   * @extends PhotoEditorSDK.Filters.Primitive
   * @memberof PhotoEditorSDK.FilterPrimitives
   */
};
var ColorMatrixPrimitive = function (_Primitive) {
  _inherits(ColorMatrixPrimitive, _Primitive);

  function ColorMatrixPrimitive() {
    var _ref;

    _classCallCheck(this, ColorMatrixPrimitive);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this2 = _possibleConstructorReturn(this, (_ref = ColorMatrixPrimitive.__proto__ || __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default()(ColorMatrixPrimitive)).call.apply(_ref, [this].concat(args)));

    _this2._filter = new ColorMatrixFilter();
    return _this2;
  }

  /**
   * Updates the filter's uniforms
   */


  _createClass(ColorMatrixPrimitive, [{
    key: 'update',
    value: function update() {
      this._filter.setColorMatrix(this._options.colorMatrix);
    }
  }]);

  return ColorMatrixPrimitive;
}(__WEBPACK_IMPORTED_MODULE_5__primitive__["a" /* default */]);

/**
 * Specifies the available options for this primitive
 * @type {Object}
 * @ignore
 */


ColorMatrixPrimitive.prototype.availableOptions = ColorMatrixFilter.prototype.availableOptions;

/* harmony default export */ __webpack_exports__["a"] = (ColorMatrixPrimitive);

/***/ }),
/* 249 */
/***/ (function(module, exports) {

module.exports = "varying vec2 v_texCoord;\nuniform sampler2D u_image;\nuniform mat4 u_colorMatrix;\nuniform vec4 u_colorMatrixOffset;\n\nvoid main() {\n  vec4 texColor = texture2D(u_image, v_texCoord);\n  gl_FragColor = texColor * u_colorMatrix + u_colorMatrixOffset;\n}\n"

/***/ }),
/* 250 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__primitive__ = __webpack_require__(13);





var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




var DesaturationFilter = function (_Engine$Filter) {
  _inherits(DesaturationFilter, _Engine$Filter);

  function DesaturationFilter() {
    _classCallCheck(this, DesaturationFilter);

    var _this = _possibleConstructorReturn(this, (DesaturationFilter.__proto__ || __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default()(DesaturationFilter)).call(this));

    _this._fragmentSource = __webpack_require__(251);
    return _this;
  }

  /**
   * Applies this filter to the given inputTarget and renders it to
   * the given outputTarget using the CanvasRenderer
   * @param  {CanvasRenderer} renderer
   * @param  {RenderTarget} inputTarget
   * @param  {RenderTarget} outputTarget
   * @param  {Boolean} clear = false
   * @private
   */


  _createClass(DesaturationFilter, [{
    key: '_applyCanvas',
    value: function _applyCanvas(renderer, inputTarget, outputTarget) {
      var clear = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;

      var canvas = inputTarget.getCanvas();
      var inputContext = inputTarget.getContext();
      var outputContext = outputTarget.getContext();

      var imageData = inputContext.getImageData(0, 0, canvas.width, canvas.height);

      var grayXfer = [0.3, 0.59, 0.11];
      var desaturation = this._options.desaturation;


      for (var i = 0; i < canvas.width * canvas.height; i++) {
        var index = i * 4;
        var gray = grayXfer[0] * imageData.data[index] / 255 + grayXfer[1] * imageData.data[index + 1] / 255 + grayXfer[2] * imageData.data[index + 2] / 255;

        imageData.data[index] += (gray * 255 - imageData.data[index]) * desaturation;
        imageData.data[index + 1] += (gray * 255 - imageData.data[index + 1]) * desaturation;
        imageData.data[index + 2] += (gray * 255 - imageData.data[index + 2]) * desaturation;
      }

      outputContext.putImageData(imageData, 0, 0);
    }
  }]);

  return DesaturationFilter;
}(__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Engine"].Filter);

/**
 * Specifies the available options for this filter
 * @type {Object}
 * @ignore
 */


DesaturationFilter.prototype.availableOptions = {
  desaturation: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].NUMBER, default: 1, uniformType: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["UniformType"].FLOAT }

  /**
   * Desaturation primitive
   * @class
   * @extends PhotoEditorSDK.Filters.Primitive
   * @memberof PhotoEditorSDK.FilterPrimitives
   */
};
var Desaturation = function (_Primitive) {
  _inherits(Desaturation, _Primitive);

  function Desaturation() {
    var _ref;

    _classCallCheck(this, Desaturation);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this2 = _possibleConstructorReturn(this, (_ref = Desaturation.__proto__ || __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default()(Desaturation)).call.apply(_ref, [this].concat(args)));

    _this2._filter = new DesaturationFilter();
    return _this2;
  }

  /**
   * Updates the filter's uniforms
   */


  _createClass(Desaturation, [{
    key: 'update',
    value: function update() {
      this._filter.setDesaturation(this._options.desaturation);
    }
  }]);

  return Desaturation;
}(__WEBPACK_IMPORTED_MODULE_5__primitive__["a" /* default */]);

/**
 * Specifies the available options for this primitive
 * @type {Object}
 * @ignore
 */


Desaturation.prototype.availableOptions = DesaturationFilter.prototype.availableOptions;

/* harmony default export */ __webpack_exports__["a"] = (Desaturation);

/***/ }),
/* 251 */
/***/ (function(module, exports) {

module.exports = "varying vec2 v_texCoord;\nuniform sampler2D u_image;\nuniform float u_desaturation;\n\nvoid main() {\n  vec4 texColor = texture2D(u_image, v_texCoord);\n  vec3 grayXfer = vec3(0.3, 0.59, 0.11);\n  vec3 gray = vec3(dot(grayXfer, texColor.xyz));\n  gl_FragColor = vec4(mix(texColor.xyz, gray, u_desaturation) * texColor.a, texColor.a);\n}\n"

/***/ }),
/* 252 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__primitive__ = __webpack_require__(13);





var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/*
* This file is part of PhotoEditorSDK.
*
* Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
* All rights reserved.
*
* Redistribution and use in source and binary forms, without
* modification, are permitted provided that the following license agreement
* is approved and a legal/financial contract was signed by the user.
* The license agreement can be found under following link:
*
* https://www.photoeditorsdk.com/LICENSE.txt
*/




var GammaFilter = function (_Engine$Filter) {
  _inherits(GammaFilter, _Engine$Filter);

  function GammaFilter() {
    _classCallCheck(this, GammaFilter);

    var _this = _possibleConstructorReturn(this, (GammaFilter.__proto__ || __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default()(GammaFilter)).call(this));

    _this._fragmentSource = __webpack_require__(253);
    return _this;
  }

  /**
  * Applies this filter to the given inputTarget and renders it to
  * the given outputTarget using the CanvasRenderer
  * @param  {CanvasRenderer} renderer
  * @param  {RenderTarget} inputTarget
  * @param  {RenderTarget} outputTarget
  * @param  {Boolean} clear = false
  * @private
  */


  _createClass(GammaFilter, [{
    key: '_applyCanvas',
    value: function _applyCanvas(renderer, inputTarget, outputTarget) {
      var clear = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;

      var canvas = inputTarget.getCanvas();
      var inputContext = inputTarget.getContext();
      var outputContext = outputTarget.getContext();

      var imageData = inputContext.getImageData(0, 0, canvas.width, canvas.height);

      var gamma = this._options.gamma;
      // pre calculate lookup tables for each channel

      var gammaArrayRed = new Float32Array(256);
      for (var i = 0; i < 256; i++) {
        gammaArrayRed[i] = 255.0 * Math.pow(i / 255.0, gamma.r);
      }

      var gammaArrayGreen = new Float32Array(256);
      for (var _i = 0; _i < 256; _i++) {
        gammaArrayGreen[_i] = 255.0 * Math.pow(_i / 255.0, gamma.g);
      }

      var gammaArrayBlue = new Float32Array(256);
      for (var _i2 = 0; _i2 < 256; _i2++) {
        gammaArrayBlue[_i2] = 255.0 * Math.pow(_i2 / 255.0, gamma.b);
      }

      for (var _i3 = 0; _i3 < canvas.width * canvas.height; _i3++) {
        var index = _i3 * 4;
        imageData.data[index] = gammaArrayRed[imageData.data[index]];
        imageData.data[index + 1] = gammaArrayGreen[imageData.data[index + 1]];
        imageData.data[index + 2] = gammaArrayBlue[imageData.data[index + 2]];
      }

      outputContext.putImageData(imageData, 0, 0);
    }
  }]);

  return GammaFilter;
}(__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Engine"].Filter);

/**
* Specifies the available options for this filter
* @type {Object}
* @ignore
*/


GammaFilter.prototype.availableOptions = {
  gamma: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].COLOR, default: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Color"].WHITE, uniformType: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["UniformType"].FLOAT3 }

  /**
  * Gamma primitive
  * @class
  * @extends PhotoEditorSDK.Filters.Primitive
  * @memberof PhotoEditorSDK.FilterPrimitives
  */
};
var Gamma = function (_Primitive) {
  _inherits(Gamma, _Primitive);

  function Gamma() {
    var _ref;

    _classCallCheck(this, Gamma);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this2 = _possibleConstructorReturn(this, (_ref = Gamma.__proto__ || __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default()(Gamma)).call.apply(_ref, [this].concat(args)));

    _this2._filter = new GammaFilter();
    return _this2;
  }

  /**
  * Updates the filter's uniforms
  */


  _createClass(Gamma, [{
    key: 'update',
    value: function update() {
      this._filter.setGamma(this._options.gamma);
    }
  }]);

  return Gamma;
}(__WEBPACK_IMPORTED_MODULE_5__primitive__["a" /* default */]);

/**
* Specifies the available options for this primitive
* @type {Object}
* @ignore
*/


Gamma.prototype.availableOptions = GammaFilter.prototype.availableOptions;

/* harmony default export */ __webpack_exports__["a"] = (Gamma);

/***/ }),
/* 253 */
/***/ (function(module, exports) {

module.exports = "varying vec2 v_texCoord;\nuniform sampler2D u_image;\nuniform vec3 u_gamma;\n\nvoid main() {\n  vec4 texColor = texture2D(u_image, v_texCoord);\n  vec3 rgb = vec3(texColor.r, texColor.g, texColor.b);\n  rgb = pow(rgb, u_gamma);\n  gl_FragColor = vec4(rgb * texColor.a, texColor.a);;\n}\n"

/***/ }),
/* 254 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__primitive__ = __webpack_require__(13);





var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




var GlowFilter = function (_Engine$Filter) {
  _inherits(GlowFilter, _Engine$Filter);

  function GlowFilter() {
    _classCallCheck(this, GlowFilter);

    var _this = _possibleConstructorReturn(this, (GlowFilter.__proto__ || __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default()(GlowFilter)).call(this));

    _this._fragmentSource = __webpack_require__(255);
    return _this;
  }

  /**
   * Applies this filter to the given inputTarget and renders it to
   * the given outputTarget using the CanvasRenderer
   * @param  {CanvasRenderer} renderer
   * @param  {RenderTarget} inputTarget
   * @param  {RenderTarget} outputTarget
   * @param  {Boolean} clear = false
   * @private
   */


  _createClass(GlowFilter, [{
    key: '_applyCanvas',
    value: function _applyCanvas(renderer, inputTarget, outputTarget) {
      var clear = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;

      var canvas = inputTarget.getCanvas();
      var inputContext = inputTarget.getContext();
      var outputContext = outputTarget.getContext();

      var imageData = inputContext.getImageData(0, 0, canvas.width, canvas.height);

      var color = this._options.color;


      var d;
      for (var x = 0; x < canvas.width; x++) {
        for (var y = 0; y < canvas.height; y++) {
          var index = (canvas.width * y + x) * 4;

          var x01 = x / canvas.width;
          var y01 = y / canvas.height;

          var nx = (x01 - 0.5) / 0.75;
          var ny = (y01 - 0.5) / 0.75;

          var scalarX = nx * nx;
          var scalarY = ny * ny;
          d = 1 - (scalarX + scalarY);
          d = Math.min(Math.max(d, 0.1), 1.0);

          imageData.data[index] = imageData.data[index] * (d * color.r);
          imageData.data[index + 1] = imageData.data[index + 1] * (d * color.g);
          imageData.data[index + 2] = imageData.data[index + 2] * (d * color.b);
          imageData.data[index + 3] = 255;
        }
      }

      outputContext.putImageData(imageData, 0, 0);
    }
  }]);

  return GlowFilter;
}(__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Engine"].Filter);

/**
 * Specifies the available options for this filter
 * @type {Object}
 * @ignore
 */


GlowFilter.prototype.availableOptions = {
  color: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].COLOR, default: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Color"].WHITE, uniformType: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["UniformType"].FLOAT3 }

  /**
   * Glow primitive
   * @class
   * @extends PhotoEditorSDK.Filters.Primitive
   * @memberof PhotoEditorSDK.FilterPrimitives
   */
};
var Glow = function (_Primitive) {
  _inherits(Glow, _Primitive);

  function Glow() {
    var _ref;

    _classCallCheck(this, Glow);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this2 = _possibleConstructorReturn(this, (_ref = Glow.__proto__ || __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default()(Glow)).call.apply(_ref, [this].concat(args)));

    _this2._filter = new GlowFilter();
    return _this2;
  }

  /**
   * Updates the filter's uniforms
   */


  _createClass(Glow, [{
    key: 'update',
    value: function update() {
      this._filter.setColor(this._options.color);
    }
  }]);

  return Glow;
}(__WEBPACK_IMPORTED_MODULE_5__primitive__["a" /* default */]);

/**
 * Specifies the available options for this primitive
 * @type {Object}
 * @ignore
 */


Glow.prototype.availableOptions = GlowFilter.prototype.availableOptions;

/* harmony default export */ __webpack_exports__["a"] = (Glow);

/***/ }),
/* 255 */
/***/ (function(module, exports) {

module.exports = "varying vec2 v_texCoord;\nuniform sampler2D u_image;\n\nuniform vec3 u_color;\n\nvoid main() {\n  vec4 texColor = texture2D(u_image, v_texCoord);\n\n  vec2 textureCoord = v_texCoord - vec2(0.5, 0.5);\n  textureCoord /= 0.75;\n\n  float d = 1.0 - dot(textureCoord, textureCoord);\n  d = clamp(d, 0.2, 1.0);\n  vec3 newColor = texColor.rgb * d * u_color.rgb;\n  gl_FragColor = vec4(vec3(newColor) * texColor.a, texColor.a);\n}\n"

/***/ }),
/* 256 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__primitive__ = __webpack_require__(13);





var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




var GobblinFilter = function (_Engine$Filter) {
  _inherits(GobblinFilter, _Engine$Filter);

  function GobblinFilter() {
    _classCallCheck(this, GobblinFilter);

    var _this = _possibleConstructorReturn(this, (GobblinFilter.__proto__ || __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default()(GobblinFilter)).call(this));

    _this._fragmentSource = __webpack_require__(257);
    return _this;
  }

  /**
   * Applies this filter to the given inputTarget and renders it to
   * the given outputTarget using the CanvasRenderer
   * @param  {CanvasRenderer} renderer
   * @param  {RenderTarget} inputTarget
   * @param  {RenderTarget} outputTarget
   * @param  {Boolean} clear = false
   * @private
   */


  _createClass(GobblinFilter, [{
    key: '_applyCanvas',
    value: function _applyCanvas(renderer, inputTarget, outputTarget) {
      var clear = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;

      var canvas = inputTarget.getCanvas();
      var inputContext = inputTarget.getContext();
      var outputContext = outputTarget.getContext();

      var imageData = inputContext.getImageData(0, 0, canvas.width, canvas.height);

      for (var x = 0; x < canvas.width; x++) {
        for (var y = 0; y < canvas.height; y++) {
          var index = (canvas.width * y + x) * 4;

          imageData.data[index + 2] = imageData.data[index + 1] * 0.33;
          imageData.data[index] = imageData.data[index] * 0.6;
          imageData.data[index + 2] += imageData.data[index] * 0.33;
          imageData.data[index + 1] = imageData.data[index + 1] * 0.7;
          imageData.data[index + 3] = 255;
        }
      }

      outputContext.putImageData(imageData, 0, 0);
    }
  }]);

  return GobblinFilter;
}(__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Engine"].Filter);

/**
 * Gobblin primitive
 * @class
 * @extends PhotoEditorSDK.Filters.Primitive
 * @memberof PhotoEditorSDK.FilterPrimitives
 */


var Gobblin = function (_Primitive) {
  _inherits(Gobblin, _Primitive);

  function Gobblin() {
    var _ref;

    _classCallCheck(this, Gobblin);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this2 = _possibleConstructorReturn(this, (_ref = Gobblin.__proto__ || __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default()(Gobblin)).call.apply(_ref, [this].concat(args)));

    _this2._filter = new GobblinFilter();
    return _this2;
  }

  return Gobblin;
}(__WEBPACK_IMPORTED_MODULE_5__primitive__["a" /* default */]);

/* harmony default export */ __webpack_exports__["a"] = (Gobblin);

/***/ }),
/* 257 */
/***/ (function(module, exports) {

module.exports = "varying vec2 v_texCoord;\nuniform sampler2D u_image;\n\nvoid main() {\n  vec4 texColor = texture2D(u_image, v_texCoord);\n  texColor.b = texColor.g * 0.33;\n  texColor.r = texColor.r * 0.6;\n  texColor.b += texColor.r * 0.33;\n  texColor.g = texColor.g * 0.7;\n  gl_FragColor = texColor;\n}\n"

/***/ }),
/* 258 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__primitive__ = __webpack_require__(13);





var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




var GrayscaleFilter = function (_Engine$Filter) {
  _inherits(GrayscaleFilter, _Engine$Filter);

  function GrayscaleFilter() {
    _classCallCheck(this, GrayscaleFilter);

    var _this = _possibleConstructorReturn(this, (GrayscaleFilter.__proto__ || __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default()(GrayscaleFilter)).call(this));

    _this._fragmentSource = __webpack_require__(259);
    return _this;
  }

  /**
   * Applies this filter to the given inputTarget and renders it to
   * the given outputTarget using the CanvasRenderer
   * @param  {CanvasRenderer} renderer
   * @param  {RenderTarget} inputTarget
   * @param  {RenderTarget} outputTarget
   * @param  {Boolean} clear = false
   * @private
   */


  _createClass(GrayscaleFilter, [{
    key: '_applyCanvas',
    value: function _applyCanvas(renderer, inputTarget, outputTarget) {
      var clear = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;

      var canvas = inputTarget.getCanvas();
      var inputContext = inputTarget.getContext();
      var outputContext = outputTarget.getContext();

      var imageData = inputContext.getImageData(0, 0, canvas.width, canvas.height);

      for (var x = 0; x < canvas.width; x++) {
        for (var y = 0; y < canvas.height; y++) {
          var index = (canvas.width * y + x) * 4;

          var luminance = imageData.data[index] * 0.2125 + imageData.data[index + 1] * 0.7154 + imageData.data[index + 2] * 0.0721;

          imageData.data[index] = luminance;
          imageData.data[index + 1] = luminance;
          imageData.data[index + 2] = luminance;
        }
      }

      outputContext.putImageData(imageData, 0, 0);
    }
  }]);

  return GrayscaleFilter;
}(__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Engine"].Filter);

/**
 * Grayscale primitive
 * @class
 * @extends PhotoEditorSDK.Filters.Primitive
 * @memberof PhotoEditorSDK.FilterPrimitives
 */


var Grayscale = function (_Primitive) {
  _inherits(Grayscale, _Primitive);

  function Grayscale() {
    var _ref;

    _classCallCheck(this, Grayscale);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this2 = _possibleConstructorReturn(this, (_ref = Grayscale.__proto__ || __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default()(Grayscale)).call.apply(_ref, [this].concat(args)));

    _this2._filter = new GrayscaleFilter();
    return _this2;
  }

  return Grayscale;
}(__WEBPACK_IMPORTED_MODULE_5__primitive__["a" /* default */]);

/* harmony default export */ __webpack_exports__["a"] = (Grayscale);

/***/ }),
/* 259 */
/***/ (function(module, exports) {

module.exports = "varying vec2 v_texCoord;\nuniform sampler2D u_image;\nvec3 W = vec3(0.2125, 0.7154, 0.0721);\n\nvoid main() {\n  vec4 texColor = texture2D(u_image, v_texCoord);\n  float luminance = dot(texColor.rgb, W);\n  gl_FragColor = vec4(vec3(luminance) * texColor.a, texColor.a);\n}\n"

/***/ }),
/* 260 */
/***/ (function(module, exports) {

module.exports = "varying vec2 v_texCoord;\nuniform sampler2D u_image;\nuniform sampler2D u_lookupTable;\n\nvoid main() {\n  vec4 texColor = texture2D(u_image, v_texCoord);\n  float r = texture2D(u_lookupTable, vec2(texColor.r, 0.0)).r;\n  float g = texture2D(u_lookupTable, vec2(texColor.g, 0.0)).g;\n  float b = texture2D(u_lookupTable, vec2(texColor.b, 0.0)).b;\n\n  gl_FragColor = vec4(vec3(r, g, b) * texColor.a, texColor.a);\n}\n"

/***/ }),
/* 261 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_get_own_property_descriptor__ = __webpack_require__(7);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_get_own_property_descriptor___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_get_own_property_descriptor__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__primitive__ = __webpack_require__(13);






var _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_get_own_property_descriptor___default()(object, property); if (desc === undefined) { var parent = __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if ("value" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */



var Vector2 = __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Math"].Vector2;


var TEXTURE_GL_UNIT = 3;

var LookupTableImageFilter = function (_Engine$Filter) {
  _inherits(LookupTableImageFilter, _Engine$Filter);

  function LookupTableImageFilter() {
    _classCallCheck(this, LookupTableImageFilter);

    var _this = _possibleConstructorReturn(this, (LookupTableImageFilter.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(LookupTableImageFilter)).call(this));

    _this._precomputeQuads();
    _this._fragmentSource = __webpack_require__(262);
    return _this;
  }

  /**
   * This function pre-calculates an array that holds quads for each
   * of the 256 possible values of the blue channel
   * @private
   */


  _createClass(LookupTableImageFilter, [{
    key: '_precomputeQuads',
    value: function _precomputeQuads() {
      this._quads = [];
      for (var i = 0; i < 256; i++) {
        var blueColor = i / 255 * 63;
        var quad = new Vector2();

        quad.y = (blueColor | 0) * 0.125 | 0;
        quad.x = (blueColor | 0) - quad.y * 8;
        this._quads.push(quad);
      }
    }

    /**
     * Applies this filter to the given inputTarget and renders it to
     * the given outputTarget using the CanvasRenderer
     * @param  {CanvasRenderer} renderer
     * @param  {RenderTarget} inputTarget
     * @param  {RenderTarget} outputTarget
     * @param  {Boolean} clear = false
     * @private
     */

  }, {
    key: '_applyCanvas',
    value: function _applyCanvas(renderer, inputTarget, outputTarget) {
      var clear = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;

      var canvas = inputTarget.getCanvas();
      var inputContext = inputTarget.getContext();
      var outputContext = outputTarget.getContext();

      var lutImage = this._options.lookupTableImage;
      var lutCanvas = this._createImageCanvas(lutImage);
      var lutContext = lutCanvas.getContext('2d');

      var inputImageData = inputContext.getImageData(0, 0, canvas.width, canvas.height);
      var filterImageData = lutContext.getImageData(0, 0, lutImage.width, lutImage.height);

      var texCoord = new Vector2();
      for (var index = 0; index < canvas.width * canvas.height * 4; index += 4) {
        var r = inputImageData.data[index];
        var g = inputImageData.data[index + 1];
        var b = inputImageData.data[index + 2];
        var a = inputImageData.data[index + 3] / 255;
        var quad = this._quads[b];

        // 64 since we have 8x8 tiles on a 512x512 texture.
        var tileSideLength = 64;

        // calculate pixel position of the coordinate origin.
        texCoord.x = quad.x * tileSideLength;
        texCoord.y = quad.y * tileSideLength;

        // now lookup the correct color within the tile.
        // the position of the pixel is indicated by the vector,
        // induced by the combination of the red and green vector.
        texCoord.x += Math.floor(r / 4); // r / 256 * 64 = r / 4
        texCoord.y += Math.floor(g / 4); // g / 256 * 64 = r / 4

        var texCoordIndex = (lutImage.width * texCoord.y + texCoord.x) * 4 | 0;
        var newR = filterImageData.data[texCoordIndex];
        newR = r * (1 - a) + newR * a;
        var newG = filterImageData.data[texCoordIndex + 1];
        newG = g * (1 - a) + newG * a;
        var newB = filterImageData.data[texCoordIndex + 2];
        newB = b * (1 - a) + newB * a;
        inputImageData.data[index] = newR;
        inputImageData.data[index + 1] = newG;
        inputImageData.data[index + 2] = newB;
      }
      outputContext.putImageData(inputImageData, 0, 0);
    }

    /**
     * Creates a canvas with the given image
     * @param  {Image} image
     * @return {HTMLCanvasElement}
     * @private
     */

  }, {
    key: '_createImageCanvas',
    value: function _createImageCanvas(image) {
      var canvas = __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Utils"].createCanvas();
      canvas.width = image.width;
      canvas.height = image.height;

      var context = canvas.getContext('2d');
      context.drawImage(image, 0, 0);

      return canvas;
    }
  }]);

  return LookupTableImageFilter;
}(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Engine"].Filter);

/**
 * Specifies the available options for this filter
 * @type {Object}
 * @ignore
 */


LookupTableImageFilter.prototype.availableOptions = {
  lookupTable: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].NUMBER, default: TEXTURE_GL_UNIT, uniformType: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["UniformType"].INT },
  lookupTableImage: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].IMAGE, uniformType: null }

  /**
   * Stores a 256 byte long lookup table in a 2d texture which will be
   * used to look up the corresponding value for each channel.
   * @class
   * @extends PhotoEditorSDK.Filters.Primitive
   * @memberof PhotoEditorSDK.FilterPrimitives
   */
};
var LookupTableImage = function (_Primitive) {
  _inherits(LookupTableImage, _Primitive);

  function LookupTableImage() {
    var _ref;

    _classCallCheck(this, LookupTableImage);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this2 = _possibleConstructorReturn(this, (_ref = LookupTableImage.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(LookupTableImage)).call.apply(_ref, [this].concat(args)));

    _this2._filter = new LookupTableImageFilter();
    _this2._textures = {};
    return _this2;
  }

  /**
   * Gets called before this primitive's filter is being applied
   * @param {PhotoEditorSDK} sdk
   */


  _createClass(LookupTableImage, [{
    key: 'update',
    value: function update(sdk) {
      var renderer = sdk.getRenderer();
      /* istanbul ignore if */
      if (renderer.isOfType(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["RendererType"].WEBGL)) {
        this._updateWebGLTexture(sdk);
      } else if (renderer.isOfType(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["RendererType"].CANVAS)) {
        this._filter.setLookupTableImage(this._options.image);
      }
    }

    /**
     * Updates the lookup table texture (WebGL only)
     * @param {PhotoEditorSDK} sdk
     * @private
     */
    /* istanbul ignore next */

  }, {
    key: '_updateWebGLTexture',
    value: function _updateWebGLTexture(sdk) {
      var renderer = sdk.getRenderer();
      var id = renderer.id;

      if (!this._textures[id]) {
        this._textures[id] = new __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Engine"].BaseTexture();
      }

      var texture = this._textures[id];
      texture.setSource(this._options.image);
      texture.setGLUnit(TEXTURE_GL_UNIT);

      renderer.updateTexture(texture);
    }

    /**
     * Cleans up this primitive
     */

  }, {
    key: 'dispose',
    value: function dispose() {
      _get(LookupTableImage.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(LookupTableImage.prototype), 'dispose', this).call(this);
      for (var id in this._textures) {
        delete this._textures[id];
      }
    }
  }]);

  return LookupTableImage;
}(__WEBPACK_IMPORTED_MODULE_6__primitive__["a" /* default */]);

LookupTableImage.prototype.availableOptions = {
  image: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].IMAGE }
};

/* harmony default export */ __webpack_exports__["a"] = (LookupTableImage);

/***/ }),
/* 262 */
/***/ (function(module, exports) {

module.exports = "/**\n * Based off of GPUImage's LookupFilter:\n * https://github.com/BradLarson/GPUImage/blob/master/framework/Source/GPUImageLookupFilter.m\n */\n\nvarying vec2 v_texCoord;\nuniform sampler2D u_image;\nuniform sampler2D u_lookupTable;\n\nvoid main() {\n  vec4 texColor = texture2D(u_image, v_texCoord);\n  float blueColor = texColor.b * 63.0;\n\n  vec2 quad1;\n  quad1.y = floor(floor(blueColor) / 8.0);\n  quad1.x = floor(blueColor) - (quad1.y * 8.0);\n\n  vec2 quad2;\n  quad2.y = floor(ceil(blueColor) / 8.0);\n  quad2.x = ceil(blueColor) - (quad2.y * 8.0);\n\n  vec2 texCoord1;\n  texCoord1.x = (quad1.x * 0.125) + 0.5/512.0 + ((0.125 - 1.0/512.0) * texColor.r);\n  texCoord1.y = (quad1.y * 0.125) + 0.5/512.0 + ((0.125 - 1.0/512.0) * texColor.g);\n\n  vec2 texCoord2;\n  texCoord2.x = (quad2.x * 0.125) + 0.5/512.0 + ((0.125 - 1.0/512.0) * texColor.r);\n  texCoord2.y = (quad2.y * 0.125) + 0.5/512.0 + ((0.125 - 1.0/512.0) * texColor.g);\n\n  vec4 newColor1 = texture2D(u_lookupTable, texCoord1);\n  vec4 newColor2 = texture2D(u_lookupTable, texCoord2);\n\n  vec4 newColor = mix(newColor1, newColor2, fract(blueColor));\n  gl_FragColor = mix(texColor, vec4(newColor.rgb, texColor.w), texColor.a);\n}\n"

/***/ }),
/* 263 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__primitive__ = __webpack_require__(13);





var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




var SaturationFilter = function (_Engine$Filter) {
  _inherits(SaturationFilter, _Engine$Filter);

  function SaturationFilter() {
    _classCallCheck(this, SaturationFilter);

    var _this = _possibleConstructorReturn(this, (SaturationFilter.__proto__ || __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default()(SaturationFilter)).call(this));

    _this._fragmentSource = __webpack_require__(264);
    return _this;
  }

  /**
   * Applies this filter to the given inputTarget and renders it to
   * the given outputTarget using the CanvasRenderer
   * @param  {CanvasRenderer} renderer
   * @param  {RenderTarget} inputTarget
   * @param  {RenderTarget} outputTarget
   * @param  {Boolean} clear = false
   * @private
   */


  _createClass(SaturationFilter, [{
    key: '_applyCanvas',
    value: function _applyCanvas(renderer, inputTarget, outputTarget) {
      var clear = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;

      var canvas = inputTarget.getCanvas();
      var inputContext = inputTarget.getContext();
      var outputContext = outputTarget.getContext();

      var imageData = inputContext.getImageData(0, 0, canvas.width, canvas.height);
      var saturation = this._options.saturation;


      for (var x = 0; x < canvas.width; x++) {
        for (var y = 0; y < canvas.height; y++) {
          var index = (canvas.width * y + x) * 4;

          var luminance = imageData.data[index] * 0.2125 + imageData.data[index + 1] * 0.7154 + imageData.data[index + 2] * 0.0721;
          imageData.data[index] = luminance * (1 - saturation) + imageData.data[index] * saturation;
          imageData.data[index + 1] = luminance * (1 - saturation) + imageData.data[index + 1] * saturation;
          imageData.data[index + 2] = luminance * (1 - saturation) + imageData.data[index + 2] * saturation;
        }
      }

      outputContext.putImageData(imageData, 0, 0);
    }
  }]);

  return SaturationFilter;
}(__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Engine"].Filter);

/**
 * Specifies the available options for this filter
 * @type {Object}
 * @ignore
 */


SaturationFilter.prototype.availableOptions = {
  saturation: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].NUMBER, default: 0, uniformType: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["UniformType"].FLOAT }

  /**
   * Saturation primitive
   * @class
   * @extends PhotoEditorSDK.Filters.Primitive
   * @memberof PhotoEditorSDK.FilterPrimitives
   */
};
var Saturation = function (_Primitive) {
  _inherits(Saturation, _Primitive);

  function Saturation() {
    var _ref;

    _classCallCheck(this, Saturation);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this2 = _possibleConstructorReturn(this, (_ref = Saturation.__proto__ || __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default()(Saturation)).call.apply(_ref, [this].concat(args)));

    _this2._filter = new SaturationFilter();
    return _this2;
  }

  /**
   * Updates the filter's uniforms
   */


  _createClass(Saturation, [{
    key: 'update',
    value: function update() {
      this._filter.setSaturation(this._options.saturation);
    }
  }]);

  return Saturation;
}(__WEBPACK_IMPORTED_MODULE_5__primitive__["a" /* default */]);

/**
 * Specifies the available options for this primitive
 * @type {Object}
 * @ignore
 */


Saturation.prototype.availableOptions = SaturationFilter.prototype.availableOptions;

/* harmony default export */ __webpack_exports__["a"] = (Saturation);

/***/ }),
/* 264 */
/***/ (function(module, exports) {

module.exports = "varying vec2 v_texCoord;\nuniform sampler2D u_image;\nuniform float u_saturation;\n\nconst vec3 luminanceWeighting = vec3(0.2125, 0.7154, 0.0721);\n\nvoid main() {\n  vec4 texColor = texture2D(u_image, v_texCoord);\n  float luminance = dot(texColor.rgb, luminanceWeighting);\n\n  vec3 greyScaleColor = vec3(luminance);\n\n  gl_FragColor = vec4(mix(greyScaleColor, texColor.rgb, u_saturation) * texColor.a, texColor.a);\n}\n"

/***/ }),
/* 265 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__primitive__ = __webpack_require__(13);





var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




var SoftColorOverlayFilter = function (_Engine$Filter) {
  _inherits(SoftColorOverlayFilter, _Engine$Filter);

  function SoftColorOverlayFilter() {
    _classCallCheck(this, SoftColorOverlayFilter);

    var _this = _possibleConstructorReturn(this, (SoftColorOverlayFilter.__proto__ || __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default()(SoftColorOverlayFilter)).call(this));

    _this._fragmentSource = __webpack_require__(266);
    return _this;
  }

  /**
   * Applies this filter to the given inputTarget and renders it to
   * the given outputTarget using the CanvasRenderer
   * @param  {CanvasRenderer} renderer
   * @param  {RenderTarget} inputTarget
   * @param  {RenderTarget} outputTarget
   * @param  {Boolean} clear = false
   * @private
   */


  _createClass(SoftColorOverlayFilter, [{
    key: '_applyCanvas',
    value: function _applyCanvas(renderer, inputTarget, outputTarget) {
      var clear = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;

      var canvas = inputTarget.getCanvas();
      var inputContext = inputTarget.getContext();
      var outputContext = outputTarget.getContext();

      var imageData = inputContext.getImageData(0, 0, canvas.width, canvas.height);

      for (var x = 0; x < canvas.width; x++) {
        for (var y = 0; y < canvas.height; y++) {
          var index = (canvas.width * y + x) * 4;

          imageData.data[index] = Math.max(this._options.color.r * 255, imageData.data[index]);
          imageData.data[index + 1] = Math.max(this._options.color.g * 255, imageData.data[index + 1]);
          imageData.data[index + 2] = Math.max(this._options.color.b * 255, imageData.data[index + 2]);
        }
      }

      outputContext.putImageData(imageData, 0, 0);
    }
  }]);

  return SoftColorOverlayFilter;
}(__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Engine"].Filter);

/**
 * Specifies the available options for this filter
 * @type {Object}
 * @ignore
 */


SoftColorOverlayFilter.prototype.availableOptions = {
  color: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].COLOR, default: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Color"].WHITE, uniformType: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["UniformType"].FLOAT3 }

  /**
   * SoftColorOverlay primitive
   * @class
   * @extends PhotoEditorSDK.Filters.Primitive
   * @memberof PhotoEditorSDK.FilterPrimitives
   */
};
var SoftColorOverlay = function (_Primitive) {
  _inherits(SoftColorOverlay, _Primitive);

  function SoftColorOverlay() {
    var _ref;

    _classCallCheck(this, SoftColorOverlay);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this2 = _possibleConstructorReturn(this, (_ref = SoftColorOverlay.__proto__ || __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default()(SoftColorOverlay)).call.apply(_ref, [this].concat(args)));

    _this2._filter = new SoftColorOverlayFilter();
    return _this2;
  }

  /**
   * Updates the filter's uniforms
   */


  _createClass(SoftColorOverlay, [{
    key: 'update',
    value: function update() {
      this._filter.setColor(this._options.color);
    }
  }]);

  return SoftColorOverlay;
}(__WEBPACK_IMPORTED_MODULE_5__primitive__["a" /* default */]);

/**
 * Specifies the available options for this primitive
 * @type {Object}
 * @ignore
 */


SoftColorOverlay.prototype.availableOptions = SoftColorOverlayFilter.prototype.availableOptions;

/* harmony default export */ __webpack_exports__["a"] = (SoftColorOverlay);

/***/ }),
/* 266 */
/***/ (function(module, exports) {

module.exports = "varying vec2 v_texCoord;\nuniform sampler2D u_image;\nuniform vec3 u_color;\n\nvoid main() {\n  vec4 texColor = texture2D(u_image, v_texCoord);\n  vec4 overlayVec4 = vec4(u_color, texColor.a);\n  gl_FragColor = max(overlayVec4 * texColor.a, texColor);\n}\n"

/***/ }),
/* 267 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__lookup_table__ = __webpack_require__(128);





var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




/**
 * Tone curve primitive
 * @class
 * @extends PhotoEditorSDK.Filters.Primitives.LookupTable
 * @memberof PhotoEditorSDK.FilterPrimitives
 */

var ToneCurve = function (_LookupTable) {
  _inherits(ToneCurve, _LookupTable);

  function ToneCurve() {
    var _ref;

    _classCallCheck(this, ToneCurve);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this = _possibleConstructorReturn(this, (_ref = ToneCurve.__proto__ || __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default()(ToneCurve)).call.apply(_ref, [this].concat(args)));

    if (!_this._options.rgbControlPoints) {
      _this._options.rgbControlPoints = {
        red: _this._options.controlPoints,
        green: _this._options.controlPoints,
        blue: _this._options.controlPoints
      };
    }

    _this._updateLookupTable();
    return _this;
  }

  /**
   * Calculates the lookup table
   * @private
   */


  _createClass(ToneCurve, [{
    key: '_updateLookupTable',
    value: function _updateLookupTable() {
      var r = this._calculateSplineCurve(this._options.rgbControlPoints.red);
      var g = this._calculateSplineCurve(this._options.rgbControlPoints.green);
      var b = this._calculateSplineCurve(this._options.rgbControlPoints.blue);

      this._options.data = this._buildLookupTable(r, g, b);
    }

    /**
     * Builds the lookup table
     * @param  {Array} r
     * @param  {Array} g
     * @param  {Array} b
     * @return {Array}
     * @private
     */

  }, {
    key: '_buildLookupTable',
    value: function _buildLookupTable(r, g, b) {
      var data = [];

      for (var i = 0; i < 256; i++) {
        data.push(Math.min(Math.max(i + r[i], 0), 255));
        data.push(Math.min(Math.max(i + g[i], 0), 255));
        data.push(Math.min(Math.max(i + b[i], 0), 255));
        data.push(255);
      }

      return data;
    }

    /**
     * Calculates the spline curve data for the given points
     * @param  {Array.<Array.<Number>>} points
     * @return {Array.<Number>}
     */

  }, {
    key: '_calculateSplineCurve',
    value: function _calculateSplineCurve(points) {
      points = points.sort(function (a, b) {
        return a[0] > b[0];
      });

      var splinePoints = this._getSplineCurve(points);
      var firstSplinePoint = splinePoints[0];
      var i;

      if (firstSplinePoint[0] > 0) {
        for (i = 0; i < firstSplinePoint[0]; i++) {
          splinePoints.unshift([0, 0]);
        }
      }

      var preparedPoints = [];
      for (i = 0; i < splinePoints.length; i++) {
        var newPoint = splinePoints[i];
        var origPoint = [newPoint[0], newPoint[0]];

        var distance = Math.sqrt(Math.pow(origPoint[0] - newPoint[0], 2) + Math.pow(origPoint[1] - newPoint[1], 2));

        if (origPoint[1] > newPoint[1]) {
          distance = -distance;
        }

        preparedPoints.push(distance);
      }

      return preparedPoints;
    }
  }, {
    key: '_getSplineCurve',
    value: function _getSplineCurve(points) {
      var sdA = this._secondDerivative(points);

      var n = sdA.length;
      var sd = [];
      var i;

      for (i = 0; i < n; i++) {
        sd[i] = sdA[i];
      }

      var output = [];

      for (i = 0; i < n - 1; i++) {
        var cur = points[i];
        var next = points[i + 1];

        for (var x = cur[0]; x < next[0]; x++) {
          var t = (x - cur[0]) / (next[0] - cur[0]);

          var a = 1 - t;
          var b = t;
          var h = next[0] - cur[0];

          var y = a * cur[1] + b * next[1] + h * h / 6 * ((a * a * a - a) * sd[i] + (b * b * b - b) * sd[i + 1]);

          if (y > 255) {
            y = 255;
          } else if (y < 0) {
            y = 0;
          }

          output.push([x, y]);
        }
      }

      if (output.length === 255) {
        output.push(points[points.length - 1]);
      }

      return output;
    }
  }, {
    key: '_secondDerivative',
    value: function _secondDerivative(points) {
      var n = points.length;
      if (n <= 0 || n === 1) {
        return null;
      }

      var matrix = [];
      var result = [];
      var i, k;

      matrix[0] = [0, 1, 0];

      for (i = 1; i < n - 1; i++) {
        var P1 = points[i - 1];
        var P2 = points[i];
        var P3 = points[i + 1];

        matrix[i] = matrix[i] || [];
        matrix[i][0] = (P2[0] - P1[0]) / 6;
        matrix[i][1] = (P3[0] - P1[0]) / 3;
        matrix[i][2] = (P3[0] - P2[0]) / 6;
        result[i] = (P3[1] - P2[1]) / (P3[0] - P2[0]) - (P2[1] - P1[1]) / (P2[0] - P1[0]);
      }

      result[0] = 0;
      result[n - 1] = 0;

      matrix[n - 1] = [0, 1, 0];

      // Pass 1
      for (i = 1; i < n; i++) {
        k = matrix[1][0] / matrix[i - 1][1];
        matrix[i][1] -= k * matrix[i - 1][2];
        matrix[i][0] = 0;
        result[i] -= k * result[i - 1];
      }

      // Pass 2
      for (i = n - 2; i > 0; i--) {
        k = matrix[i][2] / matrix[i + 1][1];
        matrix[i][1] -= k * matrix[i + 1][0];
        matrix[i][2] = 0;
        result[i] -= k * result[i + 1];
      }

      var y2 = [];
      for (i = 0; i < n; i++) {
        y2[i] = result[i] / matrix[i][1];
      }

      return y2;
    }
  }]);

  return ToneCurve;
}(__WEBPACK_IMPORTED_MODULE_5__lookup_table__["a" /* default */]);

/**
 * Specifies the available options for this primitive
 * @type {Object}
 * @ignore
 */


ToneCurve.prototype.availableOptions = {
  rgbControlPoints: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].OBJECT },
  controlPoints: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].ARRAY, default: [] },
  textureGLUnit: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].NUMBER, default: 1 }
};

/* harmony default export */ __webpack_exports__["a"] = (ToneCurve);

/***/ }),
/* 268 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__primitive__ = __webpack_require__(13);





var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




var X400Filter = function (_Engine$Filter) {
  _inherits(X400Filter, _Engine$Filter);

  function X400Filter() {
    _classCallCheck(this, X400Filter);

    var _this = _possibleConstructorReturn(this, (X400Filter.__proto__ || __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default()(X400Filter)).call(this));

    _this._fragmentSource = __webpack_require__(269);
    return _this;
  }

  /**
   * Applies this filter to the given inputTarget and renders it to
   * the given outputTarget using the CanvasRenderer
   * @param  {CanvasRenderer} renderer
   * @param  {RenderTarget} inputTarget
   * @param  {RenderTarget} outputTarget
   * @param  {Boolean} clear = false
   * @private
   */


  _createClass(X400Filter, [{
    key: '_applyCanvas',
    value: function _applyCanvas(renderer, inputTarget, outputTarget) {
      var clear = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;

      var canvas = inputTarget.getCanvas();
      var inputContext = inputTarget.getContext();
      var outputContext = outputTarget.getContext();

      var imageData = inputContext.getImageData(0, 0, canvas.width, canvas.height);

      for (var x = 0; x < canvas.width; x++) {
        for (var y = 0; y < canvas.height; y++) {
          var index = (canvas.width * y + x) * 4;

          var gray = imageData.data[index] / 255 * 0.3 + imageData.data[index + 1] / 255 * 0.3 + imageData.data[index + 2] / 255 * 0.3;
          gray -= 0.2;
          gray = Math.max(0.0, Math.min(1.0, gray));
          gray += 0.15;
          gray *= 1.4;

          gray *= 255;
          imageData.data[index] = gray;
          imageData.data[index + 1] = gray;
          imageData.data[index + 2] = gray;
        }
      }

      outputContext.putImageData(imageData, 0, 0);
    }
  }]);

  return X400Filter;
}(__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Engine"].Filter);

/**
 * X400 primitive
 * @class
 * @extends PhotoEditorSDK.Filters.Primitive
 * @memberof PhotoEditorSDK.FilterPrimitives
 */


var X400 = function (_Primitive) {
  _inherits(X400, _Primitive);

  function X400() {
    var _ref;

    _classCallCheck(this, X400);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this2 = _possibleConstructorReturn(this, (_ref = X400.__proto__ || __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default()(X400)).call.apply(_ref, [this].concat(args)));

    _this2._filter = new X400Filter();
    return _this2;
  }

  return X400;
}(__WEBPACK_IMPORTED_MODULE_5__primitive__["a" /* default */]);

/* harmony default export */ __webpack_exports__["a"] = (X400);

/***/ }),
/* 269 */
/***/ (function(module, exports) {

module.exports = "varying vec2 v_texCoord;\nuniform sampler2D u_image;\n\nvoid main() {\n  vec4 texColor = texture2D(u_image, v_texCoord);\n  float gray = texColor.r * 0.3 + texColor.g * 0.3 + texColor.b * 0.3;\n  gray -= 0.2;\n  gray = clamp(gray, 0.0, 1.0);\n  gray += 0.15;\n  gray *= 1.4;\n  gl_FragColor = vec4(vec3(gray) * texColor.a, texColor.a);\n}\n"

/***/ }),
/* 270 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_get_own_property_descriptor__ = __webpack_require__(7);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_get_own_property_descriptor___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_get_own_property_descriptor__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__primitive__ = __webpack_require__(13);






var _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_get_own_property_descriptor___default()(object, property); if (desc === undefined) { var parent = __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if ("value" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */



var Vector2 = __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Math"].Vector2,
    Vector3 = __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Math"].Vector3;


var TEXTURE_GL_UNIT = 3;

var ThreeDLookupTableImageFilter = function (_Engine$Filter) {
  _inherits(ThreeDLookupTableImageFilter, _Engine$Filter);

  function ThreeDLookupTableImageFilter() {
    _classCallCheck(this, ThreeDLookupTableImageFilter);

    var _this = _possibleConstructorReturn(this, (ThreeDLookupTableImageFilter.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(ThreeDLookupTableImageFilter)).call(this));

    _this._precomputeQuads();
    _this._fragmentSource = __webpack_require__(271);
    return _this;
  }

  /**
   * This function pre-calculates an array that holds quads for each
   * of the 256 possible values of the blue channel
   * @private
   */


  _createClass(ThreeDLookupTableImageFilter, [{
    key: '_precomputeQuads',
    value: function _precomputeQuads() {
      this._quads = [];
      for (var i = 0; i < 256; i++) {
        var blueColor = i / 255 * 63;
        var quad = new Vector2();

        quad.y = (blueColor | 0) * 0.125 | 0;
        quad.x = (blueColor | 0) - quad.y * 8;
        this._quads.push(quad);
      }
    }

    /**
     * Applies this filter to the given inputTarget and renders it to
     * the given outputTarget using the CanvasRenderer
     * @param  {CanvasRenderer} renderer
     * @param  {RenderTarget} inputTarget
     * @param  {RenderTarget} outputTarget
     * @param  {Boolean} clear = false
     * @private
     */

  }, {
    key: '_applyCanvas',
    value: function _applyCanvas(renderer, inputTarget, outputTarget) {
      var clear = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;
      var _options = this._options,
          resolution = _options.resolution,
          horizontalTileCount = _options.horizontalTileCount,
          verticalTileCount = _options.verticalTileCount;


      var canvas = inputTarget.getCanvas();
      var inputContext = inputTarget.getContext();
      var outputContext = outputTarget.getContext();

      var lutImage = this._options.lookupTableImage;
      var lutCanvas = this._createImageCanvas(lutImage);
      var lutContext = lutCanvas.getContext('2d');

      var inputImageData = inputContext.getImageData(0, 0, canvas.width, canvas.height);
      var lutImageData = lutContext.getImageData(0, 0, lutImage.width, lutImage.height);

      // const rRange = Math.floor(resolution / horizontalTileCount - 1)
      // const gRange = Math.floor(resolution / verticalTileCount - 1)
      // const bRange = Math.floor(horizontalTileCount * verticalTileCount - 1)

      var ranges = new Vector3(resolution / horizontalTileCount - 1 | 0, resolution / verticalTileCount - 1 | 0, horizontalTileCount * verticalTileCount - 1 | 0);

      var inputColor = new __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Color"]();
      var outputColor = new __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Color"]();
      var lutColorFB = new __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Color"]();
      var lutColorCB = new __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Color"]();

      var cRfGf = new __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Color"]();
      var cRfGc = new __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Color"]();
      var cRcGf = new __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Color"]();
      var cRcGc = new __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Color"]();

      var tileFloor = new Vector2();
      var tileCeil = new Vector2();

      var mix = function mix(target, x, y, a) {
        target.r = x.r * (1 - a) + y.r * a;
        target.g = x.g * (1 - a) + y.g * a;
        target.b = x.b * (1 - a) + y.b * a;
      };

      var lookup = function lookup(target, x, y) {
        x = 0.5 + x | 0;
        y = 0.5 + y | 0;
        var index = (y * resolution + x) * 4;
        target.r = lutImageData.data[index] / 255;
        target.g = lutImageData.data[index + 1] / 255;
        target.b = lutImageData.data[index + 2] / 255;
        target.a = lutImageData.data[index + 3] / 255;
      };

      var interpolateTempA = new __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Color"]();
      var interpolateTempB = new __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Color"]();
      var bilinearInterpolate = function bilinearInterpolate(target, cRfGf, cRfGc, cRcGf, cRcGc, redFract, greenFract) {
        mix(interpolateTempA, cRfGf, cRcGf, redFract);
        mix(interpolateTempB, cRfGc, cRcGc, redFract);
        mix(target, interpolateTempA, interpolateTempB, greenFract);
      };

      var pixelsPerTile = new Vector2(resolution, resolution).divide(horizontalTileCount, verticalTileCount).floor();
      for (var index = 0; index < canvas.width * canvas.height * 4; index += 4) {
        inputColor.set(inputImageData.data[index] / 255, inputImageData.data[index + 1] / 255, inputImageData.data[index + 2] / 255, inputImageData.data[index + 3] / 255);

        var tmp = new Vector3(inputColor.r * ranges.x, inputColor.g * ranges.y, inputColor.b * ranges.z);

        var floors = tmp.clone().floor().toInt();
        var ceils = tmp.clone().ceil().toInt();
        var fracts = tmp.clone().fract();

        tileFloor.y = floors.z / horizontalTileCount | 0;
        tileFloor.x = floors.z - tileFloor.y * horizontalTileCount | 0;

        tileCeil.y = ceils.z / horizontalTileCount | 0;
        tileCeil.x = ceils.z - tileCeil.y * horizontalTileCount | 0;

        tileFloor.multiply(pixelsPerTile);
        tileCeil.multiply(pixelsPerTile);

        lookup(cRfGf, tileFloor.x + floors.x, tileFloor.y + floors.y);
        lookup(cRfGc, tileFloor.x + floors.x, tileFloor.y + ceils.y);
        lookup(cRcGf, tileFloor.x + ceils.x, tileFloor.y + floors.y);
        lookup(cRcGc, tileFloor.x + ceils.x, tileFloor.y + ceils.y);

        bilinearInterpolate(lutColorFB, cRfGf, cRfGc, cRcGf, cRcGc, fracts.x, fracts.y);

        lookup(cRfGf, tileCeil.x + floors.x, tileCeil.y + floors.y);
        lookup(cRfGc, tileCeil.x + floors.x, tileCeil.y + ceils.y);
        lookup(cRcGf, tileCeil.x + ceils.x, tileCeil.y + floors.y);
        lookup(cRcGc, tileCeil.x + ceils.x, tileCeil.y + ceils.y);

        bilinearInterpolate(lutColorCB, cRfGf, cRfGc, cRcGf, cRcGc, fracts.x, fracts.y);

        mix(outputColor, lutColorFB, lutColorCB, fracts.z);

        // interpolation = clamp(Math.floor(outputColor * 255. + .5) / 255., 0.0, 1.0);

        inputImageData.data[index] = Math.ceil(outputColor.r * 255);
        inputImageData.data[index + 1] = Math.ceil(outputColor.g * 255);
        inputImageData.data[index + 2] = Math.ceil(outputColor.b * 255);
      }
      outputContext.putImageData(inputImageData, 0, 0);
    }

    /**
     * Creates a canvas with the given image
     * @param  {Image} image
     * @return {HTMLCanvasElement}
     * @private
     */

  }, {
    key: '_createImageCanvas',
    value: function _createImageCanvas(image) {
      var canvas = __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Utils"].createCanvas();
      canvas.width = image.width;
      canvas.height = image.height;

      var context = canvas.getContext('2d');
      context.drawImage(image, 0, 0);

      return canvas;
    }
  }]);

  return ThreeDLookupTableImageFilter;
}(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Engine"].Filter);

/**
 * Specifies the available options for this filter
 * @type {Object}
 * @ignore
 */


ThreeDLookupTableImageFilter.prototype.availableOptions = {
  lookupTable: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].NUMBER, default: TEXTURE_GL_UNIT, uniformType: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["UniformType"].INT },
  lookupTableImage: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].IMAGE, uniformType: null },
  resolution: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].NUMBER, default: 128, uniformType: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["UniformType"].FLOAT },
  horizontalTileCount: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].NUMBER, default: 5, uniformType: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["UniformType"].FLOAT },
  verticalTileCount: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].NUMBER, default: 5, uniformType: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["UniformType"].FLOAT }

  /**
   * Stores a 256 byte long lookup table in a 2d texture which will be
   * used to look up the corresponding value for each channel.
   * @class
   * @extends PhotoEditorSDK.Filters.Primitive
   * @memberof PhotoEditorSDK.FilterPrimitives
   */
};
var LookupTableImage = function (_Primitive) {
  _inherits(LookupTableImage, _Primitive);

  function LookupTableImage() {
    var _ref;

    _classCallCheck(this, LookupTableImage);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this2 = _possibleConstructorReturn(this, (_ref = LookupTableImage.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(LookupTableImage)).call.apply(_ref, [this].concat(args)));

    _this2._filter = new ThreeDLookupTableImageFilter();
    _this2._textures = {};
    return _this2;
  }

  /**
   * Gets called before this primitive's filter is being applied
   * @param {PhotoEditorSDK} sdk
   */


  _createClass(LookupTableImage, [{
    key: 'update',
    value: function update(sdk) {
      var renderer = sdk.getRenderer();
      /* istanbul ignore if */
      if (renderer.isOfType(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["RendererType"].WEBGL)) {
        this._updateWebGLTexture(sdk);
      } else if (renderer.isOfType(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["RendererType"].CANVAS)) {
        this._filter.setLookupTableImage(this._options.image);
      }

      var _options2 = this._options,
          resolution = _options2.resolution,
          verticalTileCount = _options2.verticalTileCount,
          horizontalTileCount = _options2.horizontalTileCount;

      this._filter.set({
        resolution: resolution, verticalTileCount: verticalTileCount, horizontalTileCount: horizontalTileCount
      });
    }

    /**
     * Updates the lookup table texture (WebGL only)
     * @param {PhotoEditorSDK} sdk
     * @private
     */
    /* istanbul ignore next */

  }, {
    key: '_updateWebGLTexture',
    value: function _updateWebGLTexture(sdk) {
      var renderer = sdk.getRenderer();
      var id = renderer.id;

      if (!this._textures[id]) {
        this._textures[id] = new __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Engine"].BaseTexture();
      }

      var texture = this._textures[id];
      texture.setSource(this._options.image);
      texture.setGLUnit(TEXTURE_GL_UNIT);
      texture.setMinFilter(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Engine"].BaseTexture.NearestFilter);

      renderer.updateTexture(texture);
    }

    /**
     * Cleans up this primitive
     */

  }, {
    key: 'dispose',
    value: function dispose() {
      _get(LookupTableImage.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(LookupTableImage.prototype), 'dispose', this).call(this);
      for (var id in this._textures) {
        delete this._textures[id];
      }
    }
  }]);

  return LookupTableImage;
}(__WEBPACK_IMPORTED_MODULE_6__primitive__["a" /* default */]);

LookupTableImage.prototype.availableOptions = {
  image: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].IMAGE },
  resolution: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].NUMBER, default: 128 },
  horizontalTileCount: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].NUMBER, default: 5 },
  verticalTileCount: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].NUMBER, default: 5 }
};

/* harmony default export */ __webpack_exports__["a"] = (LookupTableImage);

/***/ }),
/* 271 */
/***/ (function(module, exports) {

module.exports = "precision highp float;\n\nuniform sampler2D u_image;\n\nuniform sampler2D u_lookupTable;\n\nuniform float u_resolution;     // Texture-Resolution, must be power of 2: 64, 128, 256, 512, 1024, 2048, 4096\nuniform float u_horizontalTileCount; // Horizontal Blue Tiles\nuniform float u_verticalTileCount; // Vertical Blue Tiles\n\nvarying vec2 v_texCoord;\n\nconst float EPSILON = 0.000001;\n\n// Try to get the exact pixel of the lut map image\nvec3 lutColor(int texPosX, int texPosY) {\n    return texture2D(u_lookupTable, (0.5 / u_resolution) + vec2(float(texPosX), float(texPosY)) / u_resolution).rgb;\n}\n\nvec3 bilinearInterpolate(vec3 cRfGf, vec3 cRfGc, vec3 cRcGf, vec3 cRcGc, float redFract, float greenFract) {\n    return mix(mix(cRfGf, cRcGf, redFract), mix(cRfGc, cRcGc, redFract), greenFract);\n}\n\nvoid main() {\n    vec4 inputColor = clamp(texture2D(u_image, v_texCoord.xy), 0.0, 1.0);\n\n    vec3 sourceColor = vec3(inputColor.rgb / max(inputColor.a, EPSILON)); \n\n    vec3 ranges = vec3(\n        floor(u_resolution / u_horizontalTileCount - 1.0),\n        floor(u_resolution / u_verticalTileCount - 1.0),\n        floor(u_horizontalTileCount * u_horizontalTileCount - 1.0)\n    );\n    \n    vec3 tmp = sourceColor * ranges;\n    ivec3 floors = ivec3(tmp);\n    ivec3 ceils = ivec3(ceil(tmp));\n    vec3 fracts = fract(tmp);\n\n    // Map tile index to tile pixel pos.\n    ivec2 pixelsPerTile = ivec2(\n        u_resolution / u_horizontalTileCount, \n        u_resolution / u_verticalTileCount\n      );\n\n    ivec2 tileFloor; // Blue tile index\n    tileFloor.y = floors.z / int(u_horizontalTileCount);\n    tileFloor.x = (floors.z - (tileFloor.y * int(u_horizontalTileCount)));\n\n    ivec2 tileCeil; // Blue tile index\n    tileCeil.y = ceils.z / int(u_horizontalTileCount);\n    tileCeil.x = (ceils.z - (tileCeil.y * int(u_horizontalTileCount)));\n    \n    tileFloor *= pixelsPerTile;\n    tileCeil *= pixelsPerTile; \n    \n    \n    // Interpolate between red and green\n    vec3 lutColorFB = bilinearInterpolate(\n        lutColor(tileFloor.x + floors.x, tileFloor.y + floors.y),\n        lutColor(tileFloor.x + floors.x, tileFloor.y + ceils.y),\n        lutColor(tileFloor.x + ceils.x,  tileFloor.y + floors.y),\n        lutColor(tileFloor.x + ceils.x,  tileFloor.y + ceils.y),\n        fracts.x, fracts.y\n    );\n    vec3 lutColorCB = bilinearInterpolate(\n        lutColor(tileCeil.x + floors.x, tileCeil.y + floors.y),\n        lutColor(tileCeil.x + floors.x, tileCeil.y + ceils.y),\n        lutColor(tileCeil.x + ceils.x,  tileCeil.y + floors.y),\n        lutColor(tileCeil.x + ceils.x,  tileCeil.y + ceils.y),\n        fracts.x, fracts.y\n    );\n\n    // Interpolate between the blue values\n    vec3 interpolation = mix(lutColorFB, lutColorCB, fracts.z);\n\n    // Round Color Values to prevent that for ex. 254.999999 is cutting to 254 instead of 255;\n    interpolation = clamp(floor(interpolation * 255. + .5) / 255., 0.0, 1.0);\n\n    gl_FragColor = vec4(interpolation.rgb * inputColor.a, inputColor.a);\n}\n"

/***/ }),
/* 272 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
Object.defineProperty(__webpack_exports__, "__esModule", { value: true });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__identity_filter__ = __webpack_require__(127);
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "IdentityFilter", function() { return __WEBPACK_IMPORTED_MODULE_0__identity_filter__["a"]; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__a15_filter__ = __webpack_require__(273);
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "A15Filter", function() { return __WEBPACK_IMPORTED_MODULE_1__a15_filter__["a"]; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__breeze_filter__ = __webpack_require__(274);
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "BreezeFilter", function() { return __WEBPACK_IMPORTED_MODULE_2__breeze_filter__["a"]; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__bw_filter__ = __webpack_require__(275);
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "BWFilter", function() { return __WEBPACK_IMPORTED_MODULE_3__bw_filter__["a"]; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__bwhard_filter__ = __webpack_require__(276);
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "BWHardFilter", function() { return __WEBPACK_IMPORTED_MODULE_4__bwhard_filter__["a"]; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__celsius_filter__ = __webpack_require__(277);
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "CelsiusFilter", function() { return __WEBPACK_IMPORTED_MODULE_5__celsius_filter__["a"]; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__chest_filter__ = __webpack_require__(278);
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "ChestFilter", function() { return __WEBPACK_IMPORTED_MODULE_6__chest_filter__["a"]; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__fixie_filter__ = __webpack_require__(279);
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "FixieFilter", function() { return __WEBPACK_IMPORTED_MODULE_7__fixie_filter__["a"]; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__food_filter__ = __webpack_require__(280);
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "FoodFilter", function() { return __WEBPACK_IMPORTED_MODULE_8__food_filter__["a"]; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9__fridge_filter__ = __webpack_require__(281);
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "FridgeFilter", function() { return __WEBPACK_IMPORTED_MODULE_9__fridge_filter__["a"]; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10__front_filter__ = __webpack_require__(282);
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "FrontFilter", function() { return __WEBPACK_IMPORTED_MODULE_10__front_filter__["a"]; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_11__glam_filter__ = __webpack_require__(283);
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "GlamFilter", function() { return __WEBPACK_IMPORTED_MODULE_11__glam_filter__["a"]; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_12__gobblin_filter__ = __webpack_require__(284);
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "GobblinFilter", function() { return __WEBPACK_IMPORTED_MODULE_12__gobblin_filter__["a"]; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_13__k1_filter__ = __webpack_require__(285);
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "K1Filter", function() { return __WEBPACK_IMPORTED_MODULE_13__k1_filter__["a"]; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_14__k2_filter__ = __webpack_require__(286);
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "K2Filter", function() { return __WEBPACK_IMPORTED_MODULE_14__k2_filter__["a"]; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_15__k6_filter__ = __webpack_require__(287);
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "K6Filter", function() { return __WEBPACK_IMPORTED_MODULE_15__k6_filter__["a"]; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_16__kdynamic_filter__ = __webpack_require__(288);
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "KDynamicFilter", function() { return __WEBPACK_IMPORTED_MODULE_16__kdynamic_filter__["a"]; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_17__lenin_filter__ = __webpack_require__(289);
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "LeninFilter", function() { return __WEBPACK_IMPORTED_MODULE_17__lenin_filter__["a"]; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_18__lomo_filter__ = __webpack_require__(290);
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "LomoFilter", function() { return __WEBPACK_IMPORTED_MODULE_18__lomo_filter__["a"]; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_19__mellow_filter__ = __webpack_require__(291);
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "MellowFilter", function() { return __WEBPACK_IMPORTED_MODULE_19__mellow_filter__["a"]; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_20__metal_filter__ = __webpack_require__(292);
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "MetalFilter", function() { return __WEBPACK_IMPORTED_MODULE_20__metal_filter__["a"]; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_21__morning_filter__ = __webpack_require__(293);
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "MorningFilter", function() { return __WEBPACK_IMPORTED_MODULE_21__morning_filter__["a"]; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_22__orchid_filter__ = __webpack_require__(294);
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "OrchidFilter", function() { return __WEBPACK_IMPORTED_MODULE_22__orchid_filter__["a"]; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_23__pola_filter__ = __webpack_require__(295);
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "PolaFilter", function() { return __WEBPACK_IMPORTED_MODULE_23__pola_filter__["a"]; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_24__pola669_filter__ = __webpack_require__(296);
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "Pola669Filter", function() { return __WEBPACK_IMPORTED_MODULE_24__pola669_filter__["a"]; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_25__quozi_filter__ = __webpack_require__(297);
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "QuoziFilter", function() { return __WEBPACK_IMPORTED_MODULE_25__quozi_filter__["a"]; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_26__semired_filter__ = __webpack_require__(298);
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "SemiredFilter", function() { return __WEBPACK_IMPORTED_MODULE_26__semired_filter__["a"]; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_27__sunny_filter__ = __webpack_require__(299);
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "SunnyFilter", function() { return __WEBPACK_IMPORTED_MODULE_27__sunny_filter__["a"]; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_28__texas_filter__ = __webpack_require__(300);
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "TexasFilter", function() { return __WEBPACK_IMPORTED_MODULE_28__texas_filter__["a"]; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_29__x400_filter__ = __webpack_require__(301);
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "X400Filter", function() { return __WEBPACK_IMPORTED_MODULE_29__x400_filter__["a"]; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_30__lut_filter__ = __webpack_require__(302);
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "LUTFilter", function() { return __WEBPACK_IMPORTED_MODULE_30__lut_filter__["a"]; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_31__3d_lut_filter__ = __webpack_require__(303);
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "ThreeDLUTFilter", function() { return __WEBPACK_IMPORTED_MODULE_31__3d_lut_filter__["a"]; });
/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */

/**
 * @namespace PhotoEditorSDK.Filters
 */































// Special lookup table filter



/***/ }),
/* 273 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__filter__ = __webpack_require__(5);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__primitives__ = __webpack_require__(6);




function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




/**
 * A15 Filter
 * @class
 * @extends PhotoEditorSDK.Filter
 * @memberof PhotoEditorSDK.Filters
 */

var A15Filter = function (_Filter) {
  _inherits(A15Filter, _Filter);

  function A15Filter() {
    var _ref;

    _classCallCheck(this, A15Filter);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this = _possibleConstructorReturn(this, (_ref = A15Filter.__proto__ || __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default()(A15Filter)).call.apply(_ref, [this].concat(args)));

    _this._stack.push(new __WEBPACK_IMPORTED_MODULE_4__primitives__["Contrast"]({
      contrast: 0.63
    }));

    _this._stack.push(new __WEBPACK_IMPORTED_MODULE_4__primitives__["Brightness"]({
      brightness: 0.12
    }));

    _this._stack.push(new __WEBPACK_IMPORTED_MODULE_4__primitives__["ToneCurve"]({
      rgbControlPoints: {
        red: [[0, 38], [94, 94], [148, 142], [175, 187], [255, 255]],
        green: [[0, 0], [77, 53], [171, 190], [255, 255]],
        blue: [[0, 10], [48, 85], [174, 228], [255, 255]]
      }
    }));
    return _this;
  }

  return A15Filter;
}(__WEBPACK_IMPORTED_MODULE_3__filter__["a" /* default */]);

/**
 * This filter's identifier
 * @type {String}
 * @default
 */


A15Filter.identifier = 'a15';

/* harmony default export */ __webpack_exports__["a"] = (A15Filter);

/***/ }),
/* 274 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__filter__ = __webpack_require__(5);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__primitives__ = __webpack_require__(6);




function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




/**
 * Breeze Filter
 * @class
 * @extends PhotoEditorSDK.Filter
 * @memberof PhotoEditorSDK.Filters
 */

var BreezeFilter = function (_Filter) {
  _inherits(BreezeFilter, _Filter);

  function BreezeFilter() {
    var _ref;

    _classCallCheck(this, BreezeFilter);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    // Desaturation
    var _this = _possibleConstructorReturn(this, (_ref = BreezeFilter.__proto__ || __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default()(BreezeFilter)).call.apply(_ref, [this].concat(args)));

    _this._stack.push(new __WEBPACK_IMPORTED_MODULE_4__primitives__["Desaturation"]({
      desaturation: 0.5
    }));

    // Tone curve
    _this._stack.push(new __WEBPACK_IMPORTED_MODULE_4__primitives__["ToneCurve"]({
      rgbControlPoints: {
        red: [[0, 0], [170, 170], [212, 219], [234, 242], [255, 255]],
        green: [[0, 0], [170, 168], [234, 231], [255, 255]],
        blue: [[0, 0], [170, 170], [212, 208], [255, 255]]
      }
    }));
    return _this;
  }

  return BreezeFilter;
}(__WEBPACK_IMPORTED_MODULE_3__filter__["a" /* default */]);

/**
 * This filter's identifier
 * @type {String}
 * @default
 */


BreezeFilter.identifier = 'breeze';

/* harmony default export */ __webpack_exports__["a"] = (BreezeFilter);

/***/ }),
/* 275 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__filter__ = __webpack_require__(5);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__primitives__ = __webpack_require__(6);




function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




/**
 * BW Filter
 * @class
 * @extends PhotoEditorSDK.Filter
 * @memberof PhotoEditorSDK.Filters
 */

var BWFilter = function (_Filter) {
  _inherits(BWFilter, _Filter);

  function BWFilter() {
    var _ref;

    _classCallCheck(this, BWFilter);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this = _possibleConstructorReturn(this, (_ref = BWFilter.__proto__ || __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default()(BWFilter)).call.apply(_ref, [this].concat(args)));

    _this._stack.push(new __WEBPACK_IMPORTED_MODULE_4__primitives__["Grayscale"]());
    return _this;
  }

  return BWFilter;
}(__WEBPACK_IMPORTED_MODULE_3__filter__["a" /* default */]);

/**
 * This filter's identifier
 * @type {String}
 * @default
 */


BWFilter.identifier = 'bw';

/* harmony default export */ __webpack_exports__["a"] = (BWFilter);

/***/ }),
/* 276 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__filter__ = __webpack_require__(5);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__primitives__ = __webpack_require__(6);




function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




/**
 * BWHard Filter
 * @class
 * @extends PhotoEditorSDK.Filter
 * @memberof PhotoEditorSDK.Filters
 */

var BWHardFilter = function (_Filter) {
  _inherits(BWHardFilter, _Filter);

  function BWHardFilter() {
    var _ref;

    _classCallCheck(this, BWHardFilter);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this = _possibleConstructorReturn(this, (_ref = BWHardFilter.__proto__ || __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default()(BWHardFilter)).call.apply(_ref, [this].concat(args)));

    _this._stack.push(new __WEBPACK_IMPORTED_MODULE_4__primitives__["Grayscale"]());
    _this._stack.push(new __WEBPACK_IMPORTED_MODULE_4__primitives__["Contrast"]({
      contrast: 1.5
    }));
    return _this;
  }

  return BWHardFilter;
}(__WEBPACK_IMPORTED_MODULE_3__filter__["a" /* default */]);

/**
 * This filter's identifier
 * @type {String}
 * @default
 */


BWHardFilter.identifier = 'bwhard';

/* harmony default export */ __webpack_exports__["a"] = (BWHardFilter);

/***/ }),
/* 277 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__filter__ = __webpack_require__(5);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__primitives__ = __webpack_require__(6);




function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




/**
 * Celsius Filter
 * @class
 * @extends PhotoEditorSDK.Filter
 * @memberof PhotoEditorSDK.Filters
 */

var CelsiusFilter = function (_Filter) {
  _inherits(CelsiusFilter, _Filter);

  function CelsiusFilter() {
    var _ref;

    _classCallCheck(this, CelsiusFilter);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this = _possibleConstructorReturn(this, (_ref = CelsiusFilter.__proto__ || __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default()(CelsiusFilter)).call.apply(_ref, [this].concat(args)));

    _this._stack.push(new __WEBPACK_IMPORTED_MODULE_4__primitives__["ToneCurve"]({
      rgbControlPoints: {
        red: [[0, 69], [55, 110], [202, 230], [255, 255]],
        green: [[0, 44], [89, 93], [185, 141], [255, 189]],
        blue: [[0, 76], [39, 82], [218, 138], [255, 171]]
      }
    }));
    return _this;
  }

  return CelsiusFilter;
}(__WEBPACK_IMPORTED_MODULE_3__filter__["a" /* default */]);

/**
 * This filter's identifier
 * @type {String}
 * @default
 */


CelsiusFilter.identifier = 'celsius';

/* harmony default export */ __webpack_exports__["a"] = (CelsiusFilter);

/***/ }),
/* 278 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__filter__ = __webpack_require__(5);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__primitives__ = __webpack_require__(6);




function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




/**
 * Chest Filter
 * @class
 * @extends PhotoEditorSDK.Filter
 * @memberof PhotoEditorSDK.Filters
 */

var ChestFilter = function (_Filter) {
  _inherits(ChestFilter, _Filter);

  function ChestFilter() {
    var _ref;

    _classCallCheck(this, ChestFilter);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    // Tone curve
    var _this = _possibleConstructorReturn(this, (_ref = ChestFilter.__proto__ || __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default()(ChestFilter)).call.apply(_ref, [this].concat(args)));

    _this._stack.push(new __WEBPACK_IMPORTED_MODULE_4__primitives__["ToneCurve"]({
      rgbControlPoints: {
        red: [[0, 0], [44, 44], [124, 143], [221, 204], [255, 255]],
        green: [[0, 0], [130, 127], [213, 199], [255, 255]],
        blue: [[0, 0], [51, 52], [219, 204], [255, 255]]
      }
    }));
    return _this;
  }

  return ChestFilter;
}(__WEBPACK_IMPORTED_MODULE_3__filter__["a" /* default */]);

/**
 * This filter's identifier
 * @type {String}
 * @default
 */


ChestFilter.identifier = 'chest';

/* harmony default export */ __webpack_exports__["a"] = (ChestFilter);

/***/ }),
/* 279 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__filter__ = __webpack_require__(5);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__primitives__ = __webpack_require__(6);




function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




/**
 * Fixie Filter
 * @class
 * @extends PhotoEditorSDK.Filter
 * @memberof PhotoEditorSDK.Filters
 */

var FixieFilter = function (_Filter) {
  _inherits(FixieFilter, _Filter);

  function FixieFilter() {
    var _ref;

    _classCallCheck(this, FixieFilter);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    // Tone curve
    var _this = _possibleConstructorReturn(this, (_ref = FixieFilter.__proto__ || __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default()(FixieFilter)).call.apply(_ref, [this].concat(args)));

    _this._stack.push(new __WEBPACK_IMPORTED_MODULE_4__primitives__["ToneCurve"]({
      rgbControlPoints: {
        red: [[0, 0], [44, 28], [63, 48], [128, 132], [235, 248], [255, 255]],
        green: [[0, 0], [20, 10], [60, 45], [190, 209], [211, 231], [255, 255]],
        blue: [[0, 31], [41, 62], [150, 142], [234, 212], [255, 224]]
      }
    }));
    return _this;
  }

  return FixieFilter;
}(__WEBPACK_IMPORTED_MODULE_3__filter__["a" /* default */]);

/**
 * This filter's identifier
 * @type {String}
 * @default
 */


FixieFilter.identifier = 'fixie';

/* harmony default export */ __webpack_exports__["a"] = (FixieFilter);

/***/ }),
/* 280 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__filter__ = __webpack_require__(5);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__primitives__ = __webpack_require__(6);




function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




/**
 * Food Filter
 * @class
 * @extends PhotoEditorSDK.Filter
 * @memberof PhotoEditorSDK.Filters
 */

var FoodFilter = function (_Filter) {
  _inherits(FoodFilter, _Filter);

  function FoodFilter() {
    var _ref;

    _classCallCheck(this, FoodFilter);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this = _possibleConstructorReturn(this, (_ref = FoodFilter.__proto__ || __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default()(FoodFilter)).call.apply(_ref, [this].concat(args)));

    _this._stack.push(new __WEBPACK_IMPORTED_MODULE_4__primitives__["Saturation"]({
      saturation: 1.35
    }));

    _this._stack.push(new __WEBPACK_IMPORTED_MODULE_4__primitives__["Contrast"]({
      contrast: 1.1
    }));
    return _this;
  }

  return FoodFilter;
}(__WEBPACK_IMPORTED_MODULE_3__filter__["a" /* default */]);

/**
 * This filter's identifier
 * @type {String}
 * @default
 */


FoodFilter.identifier = 'food';

/* harmony default export */ __webpack_exports__["a"] = (FoodFilter);

/***/ }),
/* 281 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__filter__ = __webpack_require__(5);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__primitives__ = __webpack_require__(6);




function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




/**
 * Fridge Filter
 * @class
 * @extends PhotoEditorSDK.Filter
 * @memberof PhotoEditorSDK.Filters
 */

var FridgeFilter = function (_Filter) {
  _inherits(FridgeFilter, _Filter);

  function FridgeFilter() {
    var _ref;

    _classCallCheck(this, FridgeFilter);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    // Tone curve
    var _this = _possibleConstructorReturn(this, (_ref = FridgeFilter.__proto__ || __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default()(FridgeFilter)).call.apply(_ref, [this].concat(args)));

    _this._stack.push(new __WEBPACK_IMPORTED_MODULE_4__primitives__["ToneCurve"]({
      rgbControlPoints: {
        red: [[0, 9], [21, 11], [45, 24], [255, 220]],
        green: [[0, 12], [21, 21], [42, 42], [150, 150], [170, 173], [255, 210]],
        blue: [[0, 28], [43, 72], [128, 185], [255, 220]]
      }
    }));
    return _this;
  }

  return FridgeFilter;
}(__WEBPACK_IMPORTED_MODULE_3__filter__["a" /* default */]);

/**
 * This filter's identifier
 * @type {String}
 * @default
 */


FridgeFilter.identifier = 'fridge';

/* harmony default export */ __webpack_exports__["a"] = (FridgeFilter);

/***/ }),
/* 282 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__filter__ = __webpack_require__(5);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__primitives__ = __webpack_require__(6);




function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




/**
 * Front Filter
 * @class
 * @extends PhotoEditorSDK.Filter
 * @memberof PhotoEditorSDK.Filters
 */

var FrontFilter = function (_Filter) {
  _inherits(FrontFilter, _Filter);

  function FrontFilter() {
    var _ref;

    _classCallCheck(this, FrontFilter);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    // Tone curve
    var _this = _possibleConstructorReturn(this, (_ref = FrontFilter.__proto__ || __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default()(FrontFilter)).call.apply(_ref, [this].concat(args)));

    _this._stack.push(new __WEBPACK_IMPORTED_MODULE_4__primitives__["ToneCurve"]({
      rgbControlPoints: {
        red: [[0, 65], [28, 67], [67, 113], [125, 183], [187, 217], [255, 229]],
        green: [[0, 52], [42, 59], [104, 134], [169, 209], [255, 240]],
        blue: [[0, 52], [65, 68], [93, 104], [150, 153], [255, 198]]
      }
    }));
    return _this;
  }

  return FrontFilter;
}(__WEBPACK_IMPORTED_MODULE_3__filter__["a" /* default */]);

/**
 * This filter's identifier
 * @type {String}
 * @default
 */


FrontFilter.identifier = 'front';

/* harmony default export */ __webpack_exports__["a"] = (FrontFilter);

/***/ }),
/* 283 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__filter__ = __webpack_require__(5);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__primitives__ = __webpack_require__(6);




function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




/**
 * Glam Filter
 * @class
 * @extends PhotoEditorSDK.Filter
 * @memberof PhotoEditorSDK.Filters
 */

var GlamFilter = function (_Filter) {
  _inherits(GlamFilter, _Filter);

  function GlamFilter() {
    var _ref;

    _classCallCheck(this, GlamFilter);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this = _possibleConstructorReturn(this, (_ref = GlamFilter.__proto__ || __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default()(GlamFilter)).call.apply(_ref, [this].concat(args)));

    _this._stack.push(new __WEBPACK_IMPORTED_MODULE_4__primitives__["Contrast"]({
      contrast: 1.1
    }));

    _this._stack.push(new __WEBPACK_IMPORTED_MODULE_4__primitives__["ToneCurve"]({
      rgbControlPoints: {
        red: [[0, 0], [94, 74], [181, 205], [255, 255]],
        green: [[0, 0], [127, 127], [255, 255]],
        blue: [[0, 0], [102, 73], [227, 213], [255, 255]]
      }
    }));
    return _this;
  }

  return GlamFilter;
}(__WEBPACK_IMPORTED_MODULE_3__filter__["a" /* default */]);

/**
 * This filter's identifier
 * @type {String}
 * @default
 */


GlamFilter.identifier = 'glam';

/* harmony default export */ __webpack_exports__["a"] = (GlamFilter);

/***/ }),
/* 284 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__filter__ = __webpack_require__(5);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__primitives__ = __webpack_require__(6);




function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




/**
 * Gobblin Filter
 * @class
 * @extends PhotoEditorSDK.Filter
 * @memberof PhotoEditorSDK.Filters
 */

var GobblinFilter = function (_Filter) {
  _inherits(GobblinFilter, _Filter);

  function GobblinFilter() {
    var _ref;

    _classCallCheck(this, GobblinFilter);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this = _possibleConstructorReturn(this, (_ref = GobblinFilter.__proto__ || __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default()(GobblinFilter)).call.apply(_ref, [this].concat(args)));

    _this._stack.push(new __WEBPACK_IMPORTED_MODULE_4__primitives__["Gobblin"]());
    return _this;
  }

  return GobblinFilter;
}(__WEBPACK_IMPORTED_MODULE_3__filter__["a" /* default */]);

/**
 * This filter's identifier
 * @type {String}
 * @default
 */


GobblinFilter.identifier = 'gobblin';

/* harmony default export */ __webpack_exports__["a"] = (GobblinFilter);

/***/ }),
/* 285 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__filter__ = __webpack_require__(5);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__primitives__ = __webpack_require__(6);




function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




/**
 * K1 Filter
 * @class
 * @extends PhotoEditorSDK.Filter
 * @memberof PhotoEditorSDK.Filters
 */

var K1Filter = function (_Filter) {
  _inherits(K1Filter, _Filter);

  function K1Filter() {
    var _ref;

    _classCallCheck(this, K1Filter);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    // Tone curve
    var _this = _possibleConstructorReturn(this, (_ref = K1Filter.__proto__ || __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default()(K1Filter)).call.apply(_ref, [this].concat(args)));

    _this._stack.push(new __WEBPACK_IMPORTED_MODULE_4__primitives__["ToneCurve"]({
      controlPoints: [[0, 0], [53, 32], [91, 80], [176, 205], [255, 255]]
    }));

    // Saturation
    _this._stack.push(new __WEBPACK_IMPORTED_MODULE_4__primitives__["Saturation"]({
      saturation: 0.9
    }));
    return _this;
  }

  return K1Filter;
}(__WEBPACK_IMPORTED_MODULE_3__filter__["a" /* default */]);

/**
 * This filter's identifier
 * @type {String}
 * @default
 */


K1Filter.identifier = 'k1';

/* harmony default export */ __webpack_exports__["a"] = (K1Filter);

/***/ }),
/* 286 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__filter__ = __webpack_require__(5);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__primitives__ = __webpack_require__(6);




function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */





/**
 * K2 Filter
 * @class
 * @extends PhotoEditorSDK.Filter
 * @memberof PhotoEditorSDK.Filters
 */

var K2Filter = function (_Filter) {
  _inherits(K2Filter, _Filter);

  function K2Filter() {
    var _ref;

    _classCallCheck(this, K2Filter);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    // Tone curve
    var _this = _possibleConstructorReturn(this, (_ref = K2Filter.__proto__ || __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default()(K2Filter)).call.apply(_ref, [this].concat(args)));

    _this._stack.push(new __WEBPACK_IMPORTED_MODULE_5__primitives__["ToneCurve"]({
      controlPoints: [[0, 0], [54, 33], [77, 82], [94, 103], [122, 126], [177, 193], [229, 232], [255, 255]]
    }));

    // Soft color overlay
    _this._stack.push(new __WEBPACK_IMPORTED_MODULE_5__primitives__["SoftColorOverlay"]({
      color: new __WEBPACK_IMPORTED_MODULE_3_photoeditorsdk_core__["Color"](40 / 255, 40 / 255, 40 / 255)
    }));
    return _this;
  }

  return K2Filter;
}(__WEBPACK_IMPORTED_MODULE_4__filter__["a" /* default */]);

/**
 * This filter's identifier
 * @type {String}
 * @default
 */


K2Filter.identifier = 'k2';

/* harmony default export */ __webpack_exports__["a"] = (K2Filter);

/***/ }),
/* 287 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__filter__ = __webpack_require__(5);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__primitives__ = __webpack_require__(6);




function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




/**
 * K6 Filter
 * @class
 * @extends PhotoEditorSDK.Filter
 * @memberof PhotoEditorSDK.Filters
 */

var K6Filter = function (_Filter) {
  _inherits(K6Filter, _Filter);

  function K6Filter() {
    var _ref;

    _classCallCheck(this, K6Filter);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    // Saturation
    var _this = _possibleConstructorReturn(this, (_ref = K6Filter.__proto__ || __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default()(K6Filter)).call.apply(_ref, [this].concat(args)));

    _this._stack.push(new __WEBPACK_IMPORTED_MODULE_4__primitives__["Saturation"]({
      saturation: 0.5
    }));
    return _this;
  }

  return K6Filter;
}(__WEBPACK_IMPORTED_MODULE_3__filter__["a" /* default */]);

/**
 * This filter's identifier
 * @type {String}
 * @default
 */


K6Filter.identifier = 'k6';

/* harmony default export */ __webpack_exports__["a"] = (K6Filter);

/***/ }),
/* 288 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__filter__ = __webpack_require__(5);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__primitives__ = __webpack_require__(6);




function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




/**
 * KDynamic Filter
 * @class
 * @extends PhotoEditorSDK.Filter
 * @memberof PhotoEditorSDK.Filters
 */

var KDynamicFilter = function (_Filter) {
  _inherits(KDynamicFilter, _Filter);

  function KDynamicFilter() {
    var _ref;

    _classCallCheck(this, KDynamicFilter);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    // Tone curve
    var _this = _possibleConstructorReturn(this, (_ref = KDynamicFilter.__proto__ || __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default()(KDynamicFilter)).call.apply(_ref, [this].concat(args)));

    _this._stack.push(new __WEBPACK_IMPORTED_MODULE_4__primitives__["ToneCurve"]({
      controlPoints: [[0, 0], [17, 27], [46, 69], [90, 112], [156, 200], [203, 243], [255, 255]]
    }));

    // Saturation
    _this._stack.push(new __WEBPACK_IMPORTED_MODULE_4__primitives__["Saturation"]({
      saturation: 0.7
    }));
    return _this;
  }

  return KDynamicFilter;
}(__WEBPACK_IMPORTED_MODULE_3__filter__["a" /* default */]);

/**
 * This filter's identifier
 * @type {String}
 * @default
 */


KDynamicFilter.identifier = 'kdynamic';

/* harmony default export */ __webpack_exports__["a"] = (KDynamicFilter);

/***/ }),
/* 289 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__filter__ = __webpack_require__(5);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__primitives__ = __webpack_require__(6);




function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




/**
 * Lenin Filter
 * @class
 * @extends PhotoEditorSDK.Filter
 * @memberof PhotoEditorSDK.Filters
 */

var LeninFilter = function (_Filter) {
  _inherits(LeninFilter, _Filter);

  function LeninFilter() {
    var _ref;

    _classCallCheck(this, LeninFilter);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    // Desaturation
    var _this = _possibleConstructorReturn(this, (_ref = LeninFilter.__proto__ || __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default()(LeninFilter)).call.apply(_ref, [this].concat(args)));

    _this._stack.push(new __WEBPACK_IMPORTED_MODULE_4__primitives__["Desaturation"]({
      desaturation: 0.4
    }));

    // Tone curve
    _this._stack.push(new __WEBPACK_IMPORTED_MODULE_4__primitives__["ToneCurve"]({
      rgbControlPoints: {
        red: [[0, 20], [40, 20], [106, 111], [129, 153], [190, 223], [255, 255]],
        green: [[0, 20], [40, 20], [62, 41], [106, 108], [132, 159], [203, 237], [255, 255]],
        blue: [[0, 40], [40, 40], [73, 60], [133, 160], [191, 297], [203, 237], [237, 239], [255, 255]]
      }
    }));
    return _this;
  }

  return LeninFilter;
}(__WEBPACK_IMPORTED_MODULE_3__filter__["a" /* default */]);

/**
 * This filter's identifier
 * @type {String}
 * @default
 */


LeninFilter.identifier = 'lenin';

/* harmony default export */ __webpack_exports__["a"] = (LeninFilter);

/***/ }),
/* 290 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__filter__ = __webpack_require__(5);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__primitives__ = __webpack_require__(6);




function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




/**
 * Lomo Filter
 * @class
 * @extends PhotoEditorSDK.Filter
 * @memberof PhotoEditorSDK.Filters
 */

var LomoFilter = function (_Filter) {
  _inherits(LomoFilter, _Filter);

  function LomoFilter() {
    var _ref;

    _classCallCheck(this, LomoFilter);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this = _possibleConstructorReturn(this, (_ref = LomoFilter.__proto__ || __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default()(LomoFilter)).call.apply(_ref, [this].concat(args)));

    _this._stack.push(new __WEBPACK_IMPORTED_MODULE_4__primitives__["ToneCurve"]({
      controlPoints: [[0, 0], [87, 20], [131, 156], [183, 205], [255, 200]]
    }));
    return _this;
  }

  return LomoFilter;
}(__WEBPACK_IMPORTED_MODULE_3__filter__["a" /* default */]);

/**
 * This filter's identifier
 * @type {String}
 * @default
 */


LomoFilter.identifier = 'lomo';

/* harmony default export */ __webpack_exports__["a"] = (LomoFilter);

/***/ }),
/* 291 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__filter__ = __webpack_require__(5);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__primitives__ = __webpack_require__(6);




function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




/**
 * Mellow Filter
 * @class
 * @extends PhotoEditorSDK.Filter
 * @memberof PhotoEditorSDK.Filters
 */

var MellowFilter = function (_Filter) {
  _inherits(MellowFilter, _Filter);

  function MellowFilter() {
    var _ref;

    _classCallCheck(this, MellowFilter);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this = _possibleConstructorReturn(this, (_ref = MellowFilter.__proto__ || __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default()(MellowFilter)).call.apply(_ref, [this].concat(args)));

    _this._stack.push(new __WEBPACK_IMPORTED_MODULE_4__primitives__["ToneCurve"]({
      rgbControlPoints: {
        red: [[0, 0], [41, 84], [87, 134], [255, 255]],
        green: [[0, 0], [255, 216]],
        blue: [[0, 0], [255, 131]]
      }
    }));
    return _this;
  }

  return MellowFilter;
}(__WEBPACK_IMPORTED_MODULE_3__filter__["a" /* default */]);

/**
 * This filter's identifier
 * @type {String}
 * @default
 */


MellowFilter.identifier = 'mellow';

/* harmony default export */ __webpack_exports__["a"] = (MellowFilter);

/***/ }),
/* 292 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__filter__ = __webpack_require__(5);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__primitives__ = __webpack_require__(6);




function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




var ColorMatrix = __WEBPACK_IMPORTED_MODULE_3_photoeditorsdk_core__["Math"].ColorMatrix;

/**
 * Metal Filter
 * @class
 * @extends PhotoEditorSDK.Filter
 * @memberof PhotoEditorSDK.Filters
 */

var MetalFilter = function (_Filter) {
  _inherits(MetalFilter, _Filter);

  function MetalFilter() {
    var _ref;

    _classCallCheck(this, MetalFilter);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this = _possibleConstructorReturn(this, (_ref = MetalFilter.__proto__ || __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default()(MetalFilter)).call.apply(_ref, [this].concat(args)));

    var matrix1 = new ColorMatrix(0.8158218291630716, 0, 0, 0, -0.01779810181190647, 0, 0.8098360655737704, 0, 0, 0.0916393442622953, 0, 0, 0.4596336773932402, 0, 0.12760574782432707, 0, 0, 0, 1, 0);
    _this._stack.push(new __WEBPACK_IMPORTED_MODULE_5__primitives__["ColorMatrixPrimitive"]({
      colorMatrix: matrix1
    }));
    var gammaColor = new __WEBPACK_IMPORTED_MODULE_3_photoeditorsdk_core__["Color"](0.8, 0.6, 0.9);
    _this._stack.push(new __WEBPACK_IMPORTED_MODULE_5__primitives__["Gamma"]({
      gamma: gammaColor
    }));
    return _this;
  }

  return MetalFilter;
}(__WEBPACK_IMPORTED_MODULE_4__filter__["a" /* default */]);

/**
 * This filter's identifier
 * @type {String}
 * @default
 */


MetalFilter.identifier = 'metal';

/* harmony default export */ __webpack_exports__["a"] = (MetalFilter);

/***/ }),
/* 293 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__filter__ = __webpack_require__(5);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__primitives__ = __webpack_require__(6);




function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




/**
 * Morning Filter
 * @class
 * @extends PhotoEditorSDK.Filter
 * @memberof PhotoEditorSDK.Filters
 */

var MorningFilter = function (_Filter) {
  _inherits(MorningFilter, _Filter);

  function MorningFilter() {
    var _ref;

    _classCallCheck(this, MorningFilter);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this = _possibleConstructorReturn(this, (_ref = MorningFilter.__proto__ || __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default()(MorningFilter)).call.apply(_ref, [this].concat(args)));

    _this._stack.push(new __WEBPACK_IMPORTED_MODULE_4__primitives__["ToneCurve"]({
      rgbControlPoints: {
        red: [[0, 40], [255, 230]],
        green: [[0, 10], [255, 225]],
        blue: [[0, 20], [255, 181]]
      }
    }));

    _this._stack.push(new __WEBPACK_IMPORTED_MODULE_4__primitives__["Glow"]());
    return _this;
  }

  return MorningFilter;
}(__WEBPACK_IMPORTED_MODULE_3__filter__["a" /* default */]);

/**
 * This filter's identifier
 * @type {String}
 * @default
 */


MorningFilter.identifier = 'morning';

/* harmony default export */ __webpack_exports__["a"] = (MorningFilter);

/***/ }),
/* 294 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__filter__ = __webpack_require__(5);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__primitives__ = __webpack_require__(6);




function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




/**
 * Orchid Filter
 * @class
 * @extends PhotoEditorSDK.Filter
 * @memberof PhotoEditorSDK.Filters
 */

var OrchidFilter = function (_Filter) {
  _inherits(OrchidFilter, _Filter);

  function OrchidFilter() {
    var _ref;

    _classCallCheck(this, OrchidFilter);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    // Tone curve
    var _this = _possibleConstructorReturn(this, (_ref = OrchidFilter.__proto__ || __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default()(OrchidFilter)).call.apply(_ref, [this].concat(args)));

    _this._stack.push(new __WEBPACK_IMPORTED_MODULE_4__primitives__["ToneCurve"]({
      rgbControlPoints: {
        red: [[0, 0], [115, 130], [195, 215], [255, 255]],
        green: [[0, 0], [148, 153], [172, 215], [255, 255]],
        blue: [[0, 46], [58, 75], [178, 205], [255, 255]]
      },
      textureGLUnit: 2
    }));

    // Tone curve
    _this._stack.push(new __WEBPACK_IMPORTED_MODULE_4__primitives__["ToneCurve"]({
      controlPoints: [[0, 0], [117, 151], [189, 217], [255, 255]],
      textureGLUnit: 3
    }));

    // Desaturation
    _this._stack.push(new __WEBPACK_IMPORTED_MODULE_4__primitives__["Desaturation"]({
      desaturation: 0.65
    }));
    return _this;
  }

  return OrchidFilter;
}(__WEBPACK_IMPORTED_MODULE_3__filter__["a" /* default */]);

/**
 * This filter's identifier
 * @type {String}
 * @default
 */


OrchidFilter.identifier = 'orchid';

/* harmony default export */ __webpack_exports__["a"] = (OrchidFilter);

/***/ }),
/* 295 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__filter__ = __webpack_require__(5);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__primitives__ = __webpack_require__(6);




function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




/**
 * Pola Filter
 * @class
 * @extends PhotoEditorSDK.Filter
 * @memberof PhotoEditorSDK.Filters
 */

var PolaFilter = function (_Filter) {
  _inherits(PolaFilter, _Filter);

  function PolaFilter() {
    var _ref;

    _classCallCheck(this, PolaFilter);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this = _possibleConstructorReturn(this, (_ref = PolaFilter.__proto__ || __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default()(PolaFilter)).call.apply(_ref, [this].concat(args)));

    _this._stack.push(new __WEBPACK_IMPORTED_MODULE_4__primitives__["ToneCurve"]({
      rgbControlPoints: {
        red: [[0, 0], [94, 74], [181, 205], [255, 255]],
        green: [[0, 0], [34, 34], [99, 76], [176, 190], [255, 255]],
        blue: [[0, 0], [102, 73], [227, 213], [255, 255]]
      }
    }));

    _this._stack.push(new __WEBPACK_IMPORTED_MODULE_4__primitives__["Saturation"]({
      saturation: 0.8
    }));

    _this._stack.push(new __WEBPACK_IMPORTED_MODULE_4__primitives__["Contrast"]({
      contrast: 1.5
    }));
    return _this;
  }

  return PolaFilter;
}(__WEBPACK_IMPORTED_MODULE_3__filter__["a" /* default */]);

/**
 * This filter's identifier
 * @type {String}
 * @default
 */


PolaFilter.identifier = 'pola';

/* harmony default export */ __webpack_exports__["a"] = (PolaFilter);

/***/ }),
/* 296 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__filter__ = __webpack_require__(5);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__primitives__ = __webpack_require__(6);




function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




/**
 * Pola669 Filter
 * @class
 * @extends PhotoEditorSDK.Filter
 * @memberof PhotoEditorSDK.Filters
 */

var Pola669Filter = function (_Filter) {
  _inherits(Pola669Filter, _Filter);

  function Pola669Filter() {
    var _ref;

    _classCallCheck(this, Pola669Filter);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this = _possibleConstructorReturn(this, (_ref = Pola669Filter.__proto__ || __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default()(Pola669Filter)).call.apply(_ref, [this].concat(args)));

    _this._stack.push(new __WEBPACK_IMPORTED_MODULE_4__primitives__["ToneCurve"]({
      rgbControlPoints: {
        red: [[0, 0], [56, 18], [196, 209], [255, 255]],
        green: [[0, 38], [71, 84], [255, 255]],
        blue: [[0, 0], [131, 133], [204, 211], [255, 255]]
      }
    }));

    _this._stack.push(new __WEBPACK_IMPORTED_MODULE_4__primitives__["Saturation"]({
      saturation: 0.8
    }));

    _this._stack.push(new __WEBPACK_IMPORTED_MODULE_4__primitives__["Contrast"]({
      contrast: 1.5
    }));
    return _this;
  }

  return Pola669Filter;
}(__WEBPACK_IMPORTED_MODULE_3__filter__["a" /* default */]);

/**
 * This filter's identifier
 * @type {String}
 * @default
 */


Pola669Filter.identifier = 'pola669';

/* harmony default export */ __webpack_exports__["a"] = (Pola669Filter);

/***/ }),
/* 297 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__filter__ = __webpack_require__(5);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__primitives__ = __webpack_require__(6);




function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




/**
 * Quozi Filter
 * @class
 * @extends PhotoEditorSDK.Filter
 * @memberof PhotoEditorSDK.Filters
 */

var QuoziFilter = function (_Filter) {
  _inherits(QuoziFilter, _Filter);

  function QuoziFilter() {
    var _ref;

    _classCallCheck(this, QuoziFilter);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    // Desaturation
    var _this = _possibleConstructorReturn(this, (_ref = QuoziFilter.__proto__ || __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default()(QuoziFilter)).call.apply(_ref, [this].concat(args)));

    _this._stack.push(new __WEBPACK_IMPORTED_MODULE_4__primitives__["Desaturation"]({
      desaturation: 0.65
    }));

    // Tone curve
    _this._stack.push(new __WEBPACK_IMPORTED_MODULE_4__primitives__["ToneCurve"]({
      rgbControlPoints: {
        red: [[0, 50], [40, 78], [118, 170], [181, 211], [255, 255]],
        green: [[0, 27], [28, 45], [109, 157], [157, 195], [179, 208], [206, 212], [255, 240]],
        blue: [[0, 50], [12, 55], [46, 103], [103, 162], [194, 182], [241, 201], [255, 219]]
      }
    }));
    return _this;
  }

  return QuoziFilter;
}(__WEBPACK_IMPORTED_MODULE_3__filter__["a" /* default */]);

/**
 * This filter's identifier
 * @type {String}
 * @default
 */


QuoziFilter.identifier = 'quozi';

/* harmony default export */ __webpack_exports__["a"] = (QuoziFilter);

/***/ }),
/* 298 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__filter__ = __webpack_require__(5);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__primitives__ = __webpack_require__(6);




function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




/**
 * Semired Filter
 * @class
 * @extends PhotoEditorSDK.Filter
 * @memberof PhotoEditorSDK.Filters
 */

var SemiredFilter = function (_Filter) {
  _inherits(SemiredFilter, _Filter);

  function SemiredFilter() {
    var _ref;

    _classCallCheck(this, SemiredFilter);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this = _possibleConstructorReturn(this, (_ref = SemiredFilter.__proto__ || __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default()(SemiredFilter)).call.apply(_ref, [this].concat(args)));

    _this._stack.push(new __WEBPACK_IMPORTED_MODULE_4__primitives__["ToneCurve"]({
      rgbControlPoints: {
        red: [[0, 129], [75, 153], [181, 227], [255, 255]],
        green: [[0, 8], [111, 85], [212, 158], [255, 226]],
        blue: [[0, 5], [75, 22], [193, 90], [255, 229]]
      }
    }));

    _this._stack.push(new __WEBPACK_IMPORTED_MODULE_4__primitives__["Glow"]());
    return _this;
  }

  return SemiredFilter;
}(__WEBPACK_IMPORTED_MODULE_3__filter__["a" /* default */]);

/**
 * This filter's identifier
 * @type {String}
 * @default
 */


SemiredFilter.identifier = 'semired';

/* harmony default export */ __webpack_exports__["a"] = (SemiredFilter);

/***/ }),
/* 299 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__filter__ = __webpack_require__(5);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__primitives__ = __webpack_require__(6);




function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




/**
 * Sunny Filter
 * @class
 * @extends PhotoEditorSDK.Filter
 * @memberof PhotoEditorSDK.Filters
 */

var SunnyFilter = function (_Filter) {
  _inherits(SunnyFilter, _Filter);

  function SunnyFilter() {
    var _ref;

    _classCallCheck(this, SunnyFilter);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this = _possibleConstructorReturn(this, (_ref = SunnyFilter.__proto__ || __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default()(SunnyFilter)).call.apply(_ref, [this].concat(args)));

    _this._stack.push(new __WEBPACK_IMPORTED_MODULE_4__primitives__["ToneCurve"]({
      rgbControlPoints: {
        red: [[0, 0], [62, 82], [141, 154], [255, 255]],
        green: [[0, 39], [56, 96], [192, 176], [255, 255]],
        blue: [[0, 0], [174, 99], [255, 235]]
      },
      textureGLUnit: 2
    }));

    _this._stack.push(new __WEBPACK_IMPORTED_MODULE_4__primitives__["ToneCurve"]({
      controlPoints: [[0, 0], [55, 20], [158, 191], [255, 255]],
      textureGLUnit: 3
    }));
    return _this;
  }

  return SunnyFilter;
}(__WEBPACK_IMPORTED_MODULE_3__filter__["a" /* default */]);

/**
 * This filter's identifier
 * @type {String}
 * @default
 */


SunnyFilter.identifier = 'sunny';

/* harmony default export */ __webpack_exports__["a"] = (SunnyFilter);

/***/ }),
/* 300 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__filter__ = __webpack_require__(5);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__primitives__ = __webpack_require__(6);




function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




/**
 * Texas Filter
 * @class
 * @extends PhotoEditorSDK.Filter
 * @memberof PhotoEditorSDK.Filters
 */

var TexasFilter = function (_Filter) {
  _inherits(TexasFilter, _Filter);

  function TexasFilter() {
    var _ref;

    _classCallCheck(this, TexasFilter);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this = _possibleConstructorReturn(this, (_ref = TexasFilter.__proto__ || __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default()(TexasFilter)).call.apply(_ref, [this].concat(args)));

    _this._stack.push(new __WEBPACK_IMPORTED_MODULE_4__primitives__["ToneCurve"]({
      rgbControlPoints: {
        red: [[0, 72], [89, 99], [176, 212], [255, 237]],
        green: [[0, 49], [255, 192]],
        blue: [[0, 72], [255, 151]]
      }
    }));
    return _this;
  }

  return TexasFilter;
}(__WEBPACK_IMPORTED_MODULE_3__filter__["a" /* default */]);

/**
 * This filter's identifier
 * @type {String}
 * @default
 */


TexasFilter.identifier = 'texas';

/* harmony default export */ __webpack_exports__["a"] = (TexasFilter);

/***/ }),
/* 301 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__filter__ = __webpack_require__(5);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__primitives__ = __webpack_require__(6);




function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




/**
 * X400 Filter
 * @class
 * @extends PhotoEditorSDK.Filter
 * @memberof PhotoEditorSDK.Filters
 */

var X400Filter = function (_Filter) {
  _inherits(X400Filter, _Filter);

  function X400Filter() {
    var _ref;

    _classCallCheck(this, X400Filter);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this = _possibleConstructorReturn(this, (_ref = X400Filter.__proto__ || __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default()(X400Filter)).call.apply(_ref, [this].concat(args)));

    _this._stack.push(new __WEBPACK_IMPORTED_MODULE_4__primitives__["X400"]());
    return _this;
  }

  return X400Filter;
}(__WEBPACK_IMPORTED_MODULE_3__filter__["a" /* default */]);

/**
 * This filter's identifier
 * @type {String}
 * @default
 */


X400Filter.identifier = 'x400';

/* harmony default export */ __webpack_exports__["a"] = (X400Filter);

/***/ }),
/* 302 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__filter__ = __webpack_require__(5);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__primitives__ = __webpack_require__(6);




function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */





/**
 * Lomo Filter
 * @class
 * @extends PhotoEditorSDK.Filter
 * @memberof PhotoEditorSDK.Filters
 */

var LUTFilter = function (_Filter) {
  _inherits(LUTFilter, _Filter);

  function LUTFilter() {
    var _ref;

    _classCallCheck(this, LUTFilter);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this = _possibleConstructorReturn(this, (_ref = LUTFilter.__proto__ || __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default()(LUTFilter)).call.apply(_ref, [this].concat(args)));

    _this._lutPrimitive = new __WEBPACK_IMPORTED_MODULE_5__primitives__["LookupTableImage"]({
      image: _this._options.image
    });
    _this._stack.push(_this._lutPrimitive);
    return _this;
  }

  return LUTFilter;
}(__WEBPACK_IMPORTED_MODULE_4__filter__["a" /* default */]);

/**
 * Specifies the available options for this filter
 * @type {Object}
 * @ignore
 */


LUTFilter.prototype.availableOptions = {
  image: {
    type: __WEBPACK_IMPORTED_MODULE_3_photoeditorsdk_core__["OptionType"].IMAGE,
    required: true,
    setter: function setter(image) {
      if (this._lutPrimitive) {
        this._lutPrimitive.setImage(image);
      }
      this.setDirty(true);
      return image;
    }
  }

  /**
   * This filter's identifier
   * @type {String}
   * @default
   */
};LUTFilter.identifier = 'lut';

/* harmony default export */ __webpack_exports__["a"] = (LUTFilter);

/***/ }),
/* 303 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__filter__ = __webpack_require__(5);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__primitives__ = __webpack_require__(6);




function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */





/**
 * 3D LUT Filter
 * @class
 * @extends PhotoEditorSDK.Filter
 * @memberof PhotoEditorSDK.Filters
 */

var ThreeDLUTFilter = function (_Filter) {
  _inherits(ThreeDLUTFilter, _Filter);

  function ThreeDLUTFilter() {
    var _ref;

    _classCallCheck(this, ThreeDLUTFilter);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this = _possibleConstructorReturn(this, (_ref = ThreeDLUTFilter.__proto__ || __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default()(ThreeDLUTFilter)).call.apply(_ref, [this].concat(args)));

    var _this$_options = _this._options,
        image = _this$_options.image,
        resolution = _this$_options.resolution,
        verticalTileCount = _this$_options.verticalTileCount,
        horizontalTileCount = _this$_options.horizontalTileCount;

    _this._lutPrimitive = new __WEBPACK_IMPORTED_MODULE_5__primitives__["ThreeDLookupTableImage"]({
      image: image, resolution: resolution, verticalTileCount: verticalTileCount, horizontalTileCount: horizontalTileCount
    });
    _this._stack.push(_this._lutPrimitive);
    return _this;
  }

  return ThreeDLUTFilter;
}(__WEBPACK_IMPORTED_MODULE_4__filter__["a" /* default */]);

/**
 * Specifies the available options for this filter
 * @type {Object}
 * @ignore
 */


ThreeDLUTFilter.prototype.availableOptions = {
  image: {
    type: __WEBPACK_IMPORTED_MODULE_3_photoeditorsdk_core__["OptionType"].IMAGE,
    required: true,
    setter: function setter(image) {
      if (this._lutPrimitive) {
        this._lutPrimitive.setImage(image);
      }
      this.setDirty(true);
      return image;
    }
  },
  resolution: { type: __WEBPACK_IMPORTED_MODULE_3_photoeditorsdk_core__["OptionType"].NUMBER, default: 128 },
  horizontalTileCount: { type: __WEBPACK_IMPORTED_MODULE_3_photoeditorsdk_core__["OptionType"].NUMBER, default: 5 },
  verticalTileCount: { type: __WEBPACK_IMPORTED_MODULE_3_photoeditorsdk_core__["OptionType"].NUMBER, default: 5 }

  /**
   * This filter's identifier
   * @type {String}
   * @default
   */
};ThreeDLUTFilter.identifier = '3d-lut';

/* harmony default export */ __webpack_exports__["a"] = (ThreeDLUTFilter);

/***/ }),
/* 304 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_symbol_iterator__ = __webpack_require__(22);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_symbol_iterator___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_symbol_iterator__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_symbol__ = __webpack_require__(23);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_symbol___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_symbol__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_own_property_descriptor__ = __webpack_require__(7);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_own_property_descriptor___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_own_property_descriptor__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_6_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_7_photoeditorsdk_core__);








var _typeof = typeof __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_symbol___default.a === "function" && typeof __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_symbol_iterator___default.a === "symbol" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_symbol___default.a === "function" && obj.constructor === __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_symbol___default.a && obj !== __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_symbol___default.a.prototype ? "symbol" : typeof obj; };

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_own_property_descriptor___default()(object, property); if (desc === undefined) { var parent = __WEBPACK_IMPORTED_MODULE_6_babel_runtime_core_js_object_get_prototype_of___default()(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if ("value" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* global HTMLImageElement */
/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */


var Vector2 = __WEBPACK_IMPORTED_MODULE_7_photoeditorsdk_core__["Math"].Vector2;


var Image = void 0;
Image = __webpack_require__(19).Image;

/**
 * An operation that can draw a frame around the image
 * @class
 * @extends PhotoEditorSDK.Operation
 * @memberof PhotoEditorSDK.Operations
 */

var FrameOperation = function (_Operation) {
  _inherits(FrameOperation, _Operation);

  /**
   * Creates a new FrameOperation
   * @param  {PhotoEditorSDK} sdk
   * @param  {Object} [options]
   */
  function FrameOperation() {
    var _ref;

    _classCallCheck(this, FrameOperation);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this = _possibleConstructorReturn(this, (_ref = FrameOperation.__proto__ || __WEBPACK_IMPORTED_MODULE_6_babel_runtime_core_js_object_get_prototype_of___default()(FrameOperation)).call.apply(_ref, [this].concat(args)));

    _this._colorOverlayFilter = new __WEBPACK_IMPORTED_MODULE_7_photoeditorsdk_core__["Engine"].Filters.ColorOverlayFilter({
      color: _this.getTintColor()
    });

    _this._frameContainer = new __WEBPACK_IMPORTED_MODULE_7_photoeditorsdk_core__["Engine"].Container();

    _this._resetSprites();
    if (_this._options.frame) {
      _this._createSpritesForFrame(_this._options.frame);
    }
    return _this;
  }

  /**
   * Resets the spriteGroups and sprites attributes
   * @private
   */


  _createClass(FrameOperation, [{
    key: '_resetSprites',
    value: function _resetSprites() {
      this._spriteGroups = {
        top: {},
        left: {},
        right: {},
        bottom: {}
      };
      this._sprites = [];
      this._repeatSprites = {
        top: [],
        left: [],
        right: [],
        bottom: []
      };
    }

    /**
     * Creates the sprites and image groups for the given frame object
     * @param  {Object} frame
     * @private
     */

  }, {
    key: '_createSpritesForFrame',
    value: function _createSpritesForFrame(frame) {
      var _this2 = this;

      if (!frame) return this._disposeSprites();

      var imageGroups = frame.imageGroups,
          layoutMode = frame.layoutMode;

      this._layoutMode = layoutMode || 'horizontal-inside';

      this._disposeSprites();

      ['top', 'left', 'right', 'bottom'].forEach(function (group) {
        if (typeof imageGroups[group] === 'undefined') return;

        ['start', 'mid', 'end'].forEach(function (part) {
          if (typeof imageGroups[group][part] === 'undefined') return;

          // In case object is passed, pick attributes
          var image = imageGroups[group][part];
          if ('image' in image) {
            image = image.image;
          }

          // Create texture and sprites
          var texture = __WEBPACK_IMPORTED_MODULE_7_photoeditorsdk_core__["Engine"].Texture.fromImage(image);
          var sprite = new __WEBPACK_IMPORTED_MODULE_7_photoeditorsdk_core__["Engine"].Sprite(texture);
          _this2._spriteGroups[group][part] = sprite;
          _this2._sprites.push(sprite);
          _this2._frameContainer.addChild(sprite);
        });
      });
    }

    /**
     * Renders the frame operation
     * @param  {PhotoEditorSDK.Engine.Texture} inputTexture
     * @private
     */

  }, {
    key: '_render',
    value: function _render(inputTexture) {
      var dimensions = this._renderTexture.getDimensions();

      // Create and position sprites
      if (this._options.frame) {
        this._colorOverlayFilter.setColor(this.getTintColor());
        this._updateSprites(inputTexture);
      }

      // Prepare render texture for frame
      if (!this._frameRenderTexture) {
        this._frameRenderTexture = new __WEBPACK_IMPORTED_MODULE_7_photoeditorsdk_core__["Engine"].RenderTexture(this._sdk.getRenderer(), dimensions.x, dimensions.y);
        this._frameSprite = new __WEBPACK_IMPORTED_MODULE_7_photoeditorsdk_core__["Engine"].Sprite(this._frameRenderTexture);
        this._container.addChild(this._frameSprite);
      } else {
        this._frameRenderTexture.resizeTo(dimensions);
      }

      this._frameSprite.setAlpha(this._options.alpha);

      // Handle tinting
      if (this._options.frame && this._options.frame.tintable) {
        this._frameSprite.setFilters([this._colorOverlayFilter]);
      } else {
        this._frameSprite.setFilters([]);
      }

      // Render frame
      this._frameRenderTexture.clear();
      this._frameRenderTexture.render(this._frameContainer);

      // Render everything
      this._renderTexture.render(this._container);
      return __WEBPACK_IMPORTED_MODULE_7_photoeditorsdk_core__["Promise"].resolve(this._renderTexture);
    }

    /**
     * Updates the sprite positions and scalings
     * @param {PhotoEditorSDK.Engine.Texture} inputTexture
     * @private
     */

  }, {
    key: '_updateSprites',
    value: function _updateSprites(inputTexture) {
      var dimensions = inputTexture.getDimensions();
      this._frameWidth = Math.ceil(inputTexture.getDimensions().min() * this._options.scale);

      this._updateHorizontalSpriteGroup(inputTexture, 'top', 0);
      this._updateHorizontalSpriteGroup(inputTexture, 'bottom', dimensions.y - this._frameWidth);
      this._updateVerticalSpriteGroup(inputTexture, 'left', 0);
      this._updateVerticalSpriteGroup(inputTexture, 'right', dimensions.x - this._frameWidth);
    }

    /**
     * Updates the sprite positions and scale for the given horizontal sprite group
     * @param {PhotoEditorSDK.Engine.Texture} inputTexture
     * @param {String} group
     * @param {Number} offset = 0
     * @private
     */

  }, {
    key: '_updateHorizontalSpriteGroup',
    value: function _updateHorizontalSpriteGroup(inputTexture, group) {
      var offset = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;

      var dimensions = inputTexture.getDimensions();
      var verticalInside = this._layoutMode === 'vertical-inside';

      var startSprite = this._spriteGroups[group].start;
      var midSprite = this._spriteGroups[group].mid;
      var endSprite = this._spriteGroups[group].end;

      var startWidth = 0;
      var endWidth = 0;

      var textureDimensions = void 0,
          textureRatio = void 0;
      if (startSprite) {
        textureDimensions = startSprite.getTexture().getDimensions();
        textureRatio = textureDimensions.y / textureDimensions.x;

        startWidth = Math.floor(this._frameWidth / textureRatio);

        var startPosition = new Vector2(0, offset);
        startPosition.x = verticalInside ? this._frameWidth : 0;

        startSprite.setPosition(startPosition);
        startSprite.setHeight(this._frameWidth);
        startSprite.setWidth(startWidth);
      }

      if (endSprite) {
        textureDimensions = endSprite.getTexture().getDimensions();
        textureRatio = textureDimensions.y / textureDimensions.x;

        endWidth = Math.floor(this._frameWidth * textureRatio);

        var endPosition = new Vector2(dimensions.x - endWidth, offset);
        endPosition.x -= verticalInside ? this._frameWidth : 0;

        endSprite.setPosition(endPosition);
        endSprite.setHeight(this._frameWidth);
        endSprite.setWidth(endWidth);
      }

      if (midSprite) {
        textureDimensions = midSprite.getTexture().getDimensions();
        textureRatio = textureDimensions.y / textureDimensions.x;

        var midPosition = new Vector2(startWidth, offset);
        var midWidth = dimensions.x - startWidth - endWidth;

        if (verticalInside) {
          midPosition.x += this._frameWidth;
          midWidth -= this._frameWidth * 2;
        }

        midSprite.setPosition(midPosition);
        midSprite.setWidth(midWidth);
        midSprite.setHeight(this._frameWidth);

        // Handle repeat
        if (this._options.frame.imageGroups[group].mid.mode === 'repeat') {
          // Make sure we have exactly the right amount of sprites we need
          var defaultSpriteWidth = this._frameWidth / textureRatio;
          var requiredRepeatSprites = Math.ceil(midWidth / defaultSpriteWidth);
          var consumedWidth = 0;

          if (requiredRepeatSprites !== -1) {
            var spriteWidth = Math.round(midWidth / requiredRepeatSprites);
            midSprite.setWidth(spriteWidth);
            consumedWidth += spriteWidth;

            this._ensureRepeatSpritesExist(requiredRepeatSprites - 1, group, midSprite);

            // Reposition all repeat sprites
            for (var i = 0; i < requiredRepeatSprites - 1; i++) {
              // Divide the remaining height by the remaining amount of sprites to be placed
              spriteWidth = Math.round((midWidth - consumedWidth) / (requiredRepeatSprites - i - 1));

              var sprite = this._repeatSprites[group][i];
              var spritePosition = midPosition.clone().add(consumedWidth, 0).floor();
              sprite.setPosition(spritePosition);
              sprite.setWidth(spriteWidth);
              sprite.setHeight(this._frameWidth);

              consumedWidth += spriteWidth;
            }
          }
        }
      }
    }
  }, {
    key: '_ensureRepeatSpritesExist',
    value: function _ensureRepeatSpritesExist(requiredSpritesCount, group, sourceSprite) {
      var _this3 = this;

      // Make sure we don't get an EventEmitter warning
      sourceSprite.getTexture().setMaxListeners(requiredSpritesCount + 1);

      var existingSpritesCount = this._repeatSprites[group].length;
      if (requiredSpritesCount > existingSpritesCount) {
        // We need more sprites
        var missingRepeatSprites = requiredSpritesCount - existingSpritesCount;
        for (var i = 0; i < missingRepeatSprites; i++) {
          var sprite = new __WEBPACK_IMPORTED_MODULE_7_photoeditorsdk_core__["Engine"].Sprite(sourceSprite.getTexture());
          this._repeatSprites[group].push(sprite);
          this._frameContainer.addChild(sprite);
          this._sprites.push(sprite);
        }
      } else if (requiredSpritesCount < existingSpritesCount) {
        // We need less sprites
        var spareRepeatSprites = this._repeatSprites[group].splice(requiredSpritesCount);
        spareRepeatSprites.forEach(function (sprite) {
          var index = _this3._sprites.indexOf(sprite);
          if (index === -1) return;

          _this3._sprites.splice(index, 1);
          _this3._frameContainer.removeChild(sprite);
          sprite.dispose();
        });
      }
    }

    /**
     * Updates the sprite positions and scale for given vertical column
     * @param {PhotoEditorSDK.Engine.Texture} inputTexture
     * @param {String} group
     * @param {Number} offset = 0
     * @private
     */

  }, {
    key: '_updateVerticalSpriteGroup',
    value: function _updateVerticalSpriteGroup(inputTexture, group) {
      var offset = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;

      var dimensions = inputTexture.getDimensions();
      var horizontalInside = this._layoutMode === 'horizontal-inside';

      var startSprite = this._spriteGroups[group].start;
      var midSprite = this._spriteGroups[group].mid;
      var endSprite = this._spriteGroups[group].end;

      var startHeight = 0;
      var endHeight = 0;

      var textureDimensions = void 0,
          textureRatio = void 0;
      if (startSprite) {
        textureDimensions = startSprite.getTexture().getDimensions();
        textureRatio = textureDimensions.y / textureDimensions.x;

        startHeight = Math.floor(this._frameWidth * textureRatio);

        var startPosition = new Vector2(offset, 0);
        startPosition.y = horizontalInside ? this._frameWidth : 0;

        startSprite.setPosition(startPosition);
        startSprite.setWidth(this._frameWidth);
        startSprite.setHeight(startHeight);
      }

      if (endSprite) {
        textureDimensions = endSprite.getTexture().getDimensions();
        textureRatio = textureDimensions.y / textureDimensions.x;

        endHeight = Math.floor(this._frameWidth * textureRatio);

        var endPosition = new Vector2(offset, dimensions.y - endHeight);
        endPosition.y -= horizontalInside ? this._frameWidth : 0;

        endSprite.setPosition(endPosition);
        endSprite.setWidth(this._frameWidth);
        endSprite.setHeight(endHeight);
      }

      if (midSprite) {
        textureDimensions = midSprite.getTexture().getDimensions();
        textureRatio = textureDimensions.y / textureDimensions.x;

        var midPosition = new Vector2(offset, startHeight);
        var midHeight = dimensions.y - startHeight - endHeight;

        if (horizontalInside) {
          midPosition.y += this._frameWidth;
          midHeight -= this._frameWidth * 2;
        }

        midSprite.setPosition(midPosition);
        midSprite.setHeight(midHeight);
        midSprite.setWidth(this._frameWidth);

        // Handle repeat
        if (this._options.frame.imageGroups[group].mid.mode === 'repeat') {
          // Make sure we have exactly the right amount of sprites we need
          var defaultSpriteHeight = this._frameWidth * textureRatio;
          var requiredRepeatSprites = Math.ceil(midHeight / defaultSpriteHeight);
          var consumedHeight = 0;

          if (requiredRepeatSprites !== -1) {
            var spriteHeight = Math.round(midHeight / requiredRepeatSprites);
            midSprite.setHeight(spriteHeight);
            consumedHeight += spriteHeight;

            this._ensureRepeatSpritesExist(requiredRepeatSprites - 1, group, midSprite);

            // Reposition all repeat sprites
            for (var i = 0; i < requiredRepeatSprites - 1; i++) {
              // Divide the remaining height by the remaining amount of sprites to be placed
              spriteHeight = Math.round((midHeight - consumedHeight) / (requiredRepeatSprites - i - 1));

              var sprite = this._repeatSprites[group][i];
              var spritePosition = midPosition.clone().add(0, consumedHeight).floor();
              sprite.setPosition(spritePosition);
              sprite.setHeight(spriteHeight);
              sprite.setWidth(this._frameWidth);

              consumedHeight += spriteHeight;
            }
          }
        }
      }
    }

    /**
     * Disposes all sprites
     * @private
     */

  }, {
    key: '_disposeSprites',
    value: function _disposeSprites() {
      var _this4 = this;

      this._sprites.forEach(function (sprite) {
        _this4._frameContainer.removeChild(sprite);
        var baseTexture = sprite.getTexture().getBaseTexture();
        baseTexture.dispose();

        sprite.dispose();
      });
      this._resetSprites();
    }

    /**
     * Disposes this operation
     */

  }, {
    key: 'dispose',
    value: function dispose() {
      _get(FrameOperation.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_6_babel_runtime_core_js_object_get_prototype_of___default()(FrameOperation.prototype), 'dispose', this).call(this);
      this._disposeSprites();
    }

    /**
     * Validates the given frame object
     * @param  {Object} frame
     */

  }], [{
    key: 'validateFrame',
    value: function validateFrame(frame) {
      if (!frame) return;
      var imageGroups = frame.imageGroups,
          layoutMode = frame.layoutMode;


      if (typeof frame.identifier !== 'string') {
        throw new Error('Frame needs a property `identifier` of type String.');
      }

      if (_typeof(frame.imageGroups) !== 'object') {
        throw new Error('Frame needs a property `imageGroups` of type Object.');
      }

      var validateImageGroup = function validateImageGroup(group) {
        var _imageGroups$group = imageGroups[group],
            start = _imageGroups$group.start,
            end = _imageGroups$group.end,
            mid = _imageGroups$group.mid;


        if (typeof imageGroups[group] === 'undefined') return;
        if (_typeof(imageGroups[group]) !== 'object') {
          throw new Error('Frame: `imageGroups.' + group + '` needs to be of type Object.');
        }

        if (typeof start !== 'undefined' && !(start instanceof Image || typeof HTMLImageElement !== 'undefined' && start instanceof HTMLImageElement)) {
          throw new Error('Frame: `imageGroups.' + group + '.start` needs to be of type Image.');
        }

        if (typeof mid !== 'undefined' && !(start instanceof Image || typeof HTMLImageElement !== 'undefined' && start instanceof HTMLImageElement) && (typeof mid === 'undefined' ? 'undefined' : _typeof(mid)) !== 'object') {
          throw new Error('Frame: `imageGroups.' + group + '.mid` needs to be of type Image or Object.');
        }

        if (typeof end !== 'undefined' && !(end instanceof Image || typeof HTMLImageElement !== 'undefined' && end instanceof HTMLImageElement)) {
          throw new Error('Frame: `imageGroups.' + group + '.end` needs to be of type Image.');
        }
      };

      if (typeof layoutMode !== 'undefined' && ['vertical-inside', 'horizontal-inside'].indexOf(layoutMode) === -1) {
        throw new Error('Frame: `layoutMode` must be one of vertical-inside, horizontal-inside');
      }

      if (typeof tintable !== 'undefined' && typeof tintable !== 'boolean') {
        throw new Error('Frame: `tintable` needs to be of type Boolean.');
      }

      validateImageGroup('top');
      validateImageGroup('left');
      validateImageGroup('right');
      validateImageGroup('bottom');
    }
  }]);

  return FrameOperation;
}(__WEBPACK_IMPORTED_MODULE_7_photoeditorsdk_core__["Operation"]);

/**
 * A unique string that identifies this operation. Can be used to select
 * operations.
 * @type {String}
 * @default
 */


FrameOperation.identifier = 'frame';

/**
 * Specifies the available options for this operation
 * @type {Object}
 * @ignore
 */
FrameOperation.prototype.availableOptions = {
  frame: {
    type: __WEBPACK_IMPORTED_MODULE_7_photoeditorsdk_core__["OptionType"].OBJECT,
    validation: FrameOperation.validateFrame,
    setter: function setter(frame, initial) {
      if (!initial) {
        this._createSpritesForFrame(frame);
      }
      return frame;
    }
  },
  alpha: { type: __WEBPACK_IMPORTED_MODULE_7_photoeditorsdk_core__["OptionType"].NUMBER, default: 1 },
  tintColor: { type: __WEBPACK_IMPORTED_MODULE_7_photoeditorsdk_core__["OptionType"].COLOR, default: new __WEBPACK_IMPORTED_MODULE_7_photoeditorsdk_core__["Color"](1, 1, 1, 0) },
  scale: { type: __WEBPACK_IMPORTED_MODULE_7_photoeditorsdk_core__["OptionType"].NUMBER, default: 0.1 }
};

__WEBPACK_IMPORTED_MODULE_7_photoeditorsdk_core___default.a.Operations.FrameOperation = FrameOperation;

/* harmony default export */ __webpack_exports__["a"] = (FrameOperation);

/***/ }),
/* 305 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor__ = __webpack_require__(7);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__linear_focus_filter__ = __webpack_require__(306);






var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor___default()(object, property); if (desc === undefined) { var parent = __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if ("value" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */



var Vector2 = __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Math"].Vector2;

/**
 * An operation that can draw a linear focus
 * @class
 * @extends PhotoEditorSDK.Operation
 * @memberof PhotoEditorSDK.Operations
 */

var LinearFocusOperation = function (_Operation) {
  _inherits(LinearFocusOperation, _Operation);

  /**
   * Creates a new LinearFocusOperation
   * @param  {PhotoEditorSDK} sdk
   * @param  {Object} [options]
   */
  function LinearFocusOperation() {
    var _ref;

    _classCallCheck(this, LinearFocusOperation);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this = _possibleConstructorReturn(this, (_ref = LinearFocusOperation.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(LinearFocusOperation)).call.apply(_ref, [this].concat(args)));

    _this._lastBlurRadius = _this._options.blurRadius;
    _this._lastControlPoint1 = _this._options.controlPoint1.clone();
    _this._lastControlPoint2 = _this._options.controlPoint2.clone();

    _this._horizontalFilter = new __WEBPACK_IMPORTED_MODULE_6__linear_focus_filter__["a" /* default */]();
    _this._verticalFilter = new __WEBPACK_IMPORTED_MODULE_6__linear_focus_filter__["a" /* default */]();
    _this._sprite.setFilters([_this._horizontalFilter, _this._verticalFilter]);

    _this._horizontalFilter.setDelta(new Vector2(0.5, 0.5));
    _this._verticalFilter.setDelta(new Vector2(-0.5, 0.5));

    _this._filter = new __WEBPACK_IMPORTED_MODULE_6__linear_focus_filter__["a" /* default */]();
    return _this;
  }

  /**
   * Applies the given rotation change
   * @param  {PhotoEditorSDK.Operations.RotationOperation} operation
   * @param  {Number} degrees
   */


  _createClass(LinearFocusOperation, [{
    key: 'rotate',
    value: function rotate(degrees) {
      var controlPoint1 = this._options.controlPoint1;
      var controlPoint2 = this._options.controlPoint2;

      if (degrees === 90) {
        controlPoint1.flip();
        controlPoint1.x = 1 - controlPoint1.x;
        controlPoint2.flip();
        controlPoint2.x = 1 - controlPoint2.x;
      } else if (degrees === -90) {
        controlPoint1.flip();
        controlPoint1.y = 1 - controlPoint1.y;
        controlPoint2.flip();
        controlPoint2.y = 1 - controlPoint2.y;
      }

      this.set({ controlPoint1: controlPoint1, controlPoint2: controlPoint2 });
    }

    /**
     * Applies a flip with the given direction
     * @param  {String} direction
     */

  }, {
    key: 'flip',
    value: function flip(direction) {
      var controlPoint1 = this._options.controlPoint1;
      var controlPoint2 = this._options.controlPoint2;

      switch (direction) {
        case 'horizontal':
          controlPoint1.x = 1 - controlPoint1.x;
          controlPoint2.x = 1 - controlPoint2.x;
          break;
        case 'vertical':
          controlPoint1.y = 1 - controlPoint1.y;
          controlPoint2.y = 1 - controlPoint2.y;
          break;
      }

      this.set({ controlPoint1: controlPoint1, controlPoint2: controlPoint2 });
    }

    /**
     * Applies the given transform change
     * @param  {PhotoEditorSDK.Operations.TransformOperation.TransformChange} transformChange
     * @private
     */

  }, {
    key: 'transform',
    value: function transform(transformChange) {
      var _this2 = this;

      var newOptions = {};

      ['controlPoint1', 'controlPoint2'].forEach(function (optionName) {
        var vector = _this2.getOption(optionName);
        newOptions[optionName] = transformChange.applyToRelativePoint(vector);
      });

      ['blurRadius'].forEach(function (optionName) {
        var size = _this2.getOption(optionName);
        newOptions[optionName] = transformChange.applyToRelativeSize(size);
      });

      this.set(newOptions, false);
    }

    /**
     * Renders the linear focus using WebGL
     * @param  {PhotoEditorSDK.Engine.Texture} inputTexture
     * @override
     * @private
     */
    /* istanbul ignore next */

  }, {
    key: '_renderWebGL',
    value: function _renderWebGL(inputTexture) {
      var inputDimensions = inputTexture.getDimensions();
      var shortestSide = inputDimensions.min();

      var _options = this._options,
          blurRadius = _options.blurRadius,
          controlPoint1 = _options.controlPoint1,
          controlPoint2 = _options.controlPoint2;

      var commonOptions = {
        blurRadius: blurRadius * shortestSide,

        controlPoint1: controlPoint1,
        controlPoint2: controlPoint2,
        texSize: inputDimensions
      };

      this._horizontalFilter.set(commonOptions);
      this._verticalFilter.set(commonOptions);

      this._renderTexture.render(this._container);

      return __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Promise"].resolve();
    }

    /**
     * Renders the linear blur using Canvas2D
     * @param  {PhotoEditorSDK.Engine.Texture} inputTexture
     * @override
     * @private
     */

  }, {
    key: '_renderCanvas',
    value: function _renderCanvas(inputTexture) {
      var inputDimensions = inputTexture.getDimensions();

      var _options2 = this._options,
          blurRadius = _options2.blurRadius,
          controlPoint1 = _options2.controlPoint1,
          controlPoint2 = _options2.controlPoint2;

      this._filter.set({
        blurRadius: blurRadius,
        controlPoint1: controlPoint1.clone(),
        controlPoint2: controlPoint2.clone(),
        texSize: inputDimensions
      });

      this._sprite.setFilters([this._filter]);

      this._renderTexture.render(this._container);

      return __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Promise"].resolve();
    }

    /**
     * Disposes this operation
     */

  }, {
    key: 'dispose',
    value: function dispose() {
      _get(LinearFocusOperation.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(LinearFocusOperation.prototype), 'dispose', this).call(this);
      this._filter.dispose();
      this._verticalFilter.dispose();
      this._horizontalFilter.dispose();
    }

    /**
     * Checks if the operation has changes/modifications
     * @return {Boolean}
     */

  }, {
    key: 'hasChanges',
    value: function hasChanges() {
      return true;
    }
  }]);

  return LinearFocusOperation;
}(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Operation"]);

/**
 * A unique string that identifies this operation. Can be used to select
 * operations.
 * @type {String}
 * @default
 */


LinearFocusOperation.identifier = 'linear-focus';

/**
 * Specifies the available options for this operation
 * @type {Object}
 * @ignore
 */
LinearFocusOperation.prototype.availableOptions = {
  controlPoint1: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].VECTOR2, default: new Vector2(0.0, 0.5) },
  controlPoint2: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].VECTOR2, default: new Vector2(1.0, 0.5) },
  blurRadius: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].NUMBER, default: 0.025 }
};

__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core___default.a.Operations.LinearFocusOperation = LinearFocusOperation;

/* harmony default export */ __webpack_exports__["a"] = (LinearFocusOperation);

/***/ }),
/* 306 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__shared_vendor_stack_blur__ = __webpack_require__(59);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__shared_vendor_stack_blur___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5__shared_vendor_stack_blur__);





var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */



var Vector2 = __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Math"].Vector2;

var LinearFocusFilter = function (_Engine$Filter) {
  _inherits(LinearFocusFilter, _Engine$Filter);

  function LinearFocusFilter() {
    var _ref;

    _classCallCheck(this, LinearFocusFilter);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this = _possibleConstructorReturn(this, (_ref = LinearFocusFilter.__proto__ || __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default()(LinearFocusFilter)).call.apply(_ref, [this].concat(args)));

    _this._fragmentSource = __webpack_require__(307);

    _this._lastBlurRadius = null;
    _this._lastControlPoint1 = new Vector2();
    _this._lastControlPoint2 = new Vector2();

    _this._blurredRenderTarget = new __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Engine"].CanvasRenderTarget(100, 100, 1);

    _this._maskRenderTarget = new __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Engine"].CanvasRenderTarget(100, 100, 1);
    return _this;
  }

  /**
   * Applies this filter to the given inputTarget and renders it to
   * the given outputTarget using the CanvasRenderer
   * @param  {CanvasRenderer} renderer
   * @param  {RenderTarget} inputTarget
   * @param  {RenderTarget} outputTarget
   * @param  {Boolean} clear = false
   * @private
   */


  _createClass(LinearFocusFilter, [{
    key: '_applyCanvas',
    value: function _applyCanvas(renderer, inputTarget, outputTarget) {
      var clear = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;

      var inputDimensions = inputTarget.getDimensions();
      var dimensionsChanged = !this._blurredRenderTarget.getDimensions().equals(inputDimensions);

      this._blurredRenderTarget.setPixelRatio(inputTarget.getPixelRatio());
      this._blurredRenderTarget.resizeTo(inputTarget.getDimensions());

      this._maskRenderTarget.setPixelRatio(inputTarget.getPixelRatio());
      this._maskRenderTarget.resizeTo(inputTarget.getDimensions());

      if (!this._lastControlPoint1.equals(this._options.controlPoint1) || !this._lastControlPoint2.equals(this._options.controlPoint2) || dimensionsChanged) {
        this._renderMask();

        this._lastControlPoint1 = this._options.controlPoint1.clone();
        this._lastControlPoint2 = this._options.controlPoint2.clone();
      }

      if (this._lastBlurRadius !== this._options.blurRadius || dimensionsChanged) {
        this._blurImage(inputTarget);
        this._lastBlurRadius = this._options.blurRadius;
      }

      this._applyMask(inputTarget, outputTarget);
    }

    /**
     * Creates a blurred copy of the image
     * @param  {CanvasRenderTarget} inputTarget
     * @return {Canvas}
     * @private
     */

  }, {
    key: '_blurImage',
    value: function _blurImage(inputTarget) {
      var inputCanvas = inputTarget.getCanvas();
      var inputContext = inputTarget.getContext();

      var inputDimensions = new Vector2(inputCanvas.width, inputCanvas.height);
      var blurryImageData = inputContext.getImageData(0, 0, inputCanvas.width, inputCanvas.height);
      __WEBPACK_IMPORTED_MODULE_5__shared_vendor_stack_blur___default.a.stackBlurCanvasRGBA(blurryImageData, 0, 0, inputCanvas.width, inputCanvas.height, this._options.blurRadius * inputDimensions.min());

      var blurryContext = this._blurredRenderTarget.getContext();
      blurryContext.putImageData(blurryImageData, 0, 0);
    }

    /**
     * Renders the mask canvas
     * @private
     */

  }, {
    key: '_renderMask',
    value: function _renderMask() {
      var canvas = this._maskRenderTarget.getCanvas();
      var context = this._maskRenderTarget.getContext();

      var canvasDimensions = new Vector2(canvas.width, canvas.height);

      var controlPoint1 = this._options.controlPoint1.clone().multiply(canvasDimensions);
      var controlPoint2 = this._options.controlPoint2.clone().multiply(canvasDimensions);

      // Build gradient
      var gradient = context.createLinearGradient(controlPoint1.x, controlPoint1.y, controlPoint2.x, controlPoint2.y);
      gradient.addColorStop(0, '#FFFFFF');
      gradient.addColorStop(1, '#000000');

      // Draw gradient
      context.fillStyle = gradient;
      context.fillRect(0, 0, canvas.width, canvas.height);
    }

    /**
     * Applies the blur and mask to the input canvas
     * @param {CanvasRenderTarget} inputTarget
     * @param {CanvasRenderTarget} outputTarget
     * @private
     */

  }, {
    key: '_applyMask',
    value: function _applyMask(inputTarget, outputTarget) {
      var outputContext = outputTarget.getContext();
      var inputCanvas = inputTarget.getCanvas();
      var inputContext = inputTarget.getContext();
      var blurredContext = this._blurredRenderTarget.getContext();
      var maskContext = this._maskRenderTarget.getContext();

      var inputImageData = inputContext.getImageData(0, 0, inputCanvas.width, inputCanvas.height);
      var pixels = inputImageData.data;
      var blurredPixels = blurredContext.getImageData(0, 0, inputCanvas.width, inputCanvas.height).data;
      var maskPixels = maskContext.getImageData(0, 0, inputCanvas.width, inputCanvas.height).data;

      var alpha = void 0;
      for (var i = 0; i < inputCanvas.width * inputCanvas.height * 4; i += 4) {
        alpha = maskPixels[i] / 255;

        pixels[i] = alpha * pixels[i] + (1 - alpha) * blurredPixels[i];
        pixels[i + 1] = alpha * pixels[i + 1] + (1 - alpha) * blurredPixels[i + 1];
        pixels[i + 2] = alpha * pixels[i + 2] + (1 - alpha) * blurredPixels[i + 2];
      }

      outputContext.putImageData(inputImageData, 0, 0);
    }
  }]);

  return LinearFocusFilter;
}(__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Engine"].Filter);

LinearFocusFilter.prototype.availableOptions = {
  blurRadius: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].NUMBER, default: 30, uniformType: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["UniformType"].FLOAT },
  controlPoint1: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].VECTOR2, default: new Vector2(0, 0.5), uniformType: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["UniformType"].FLOAT2 },
  controlPoint2: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].VECTOR2, default: new Vector2(1, 0.5), uniformType: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["UniformType"].FLOAT2 },
  delta: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].VECTOR2, default: new Vector2(1, 1), uniformType: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["UniformType"].FLOAT2 },
  texSize: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].VECTOR2, default: new Vector2(100, 100), uniformType: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["UniformType"].FLOAT2 }
};

/* harmony default export */ __webpack_exports__["a"] = (LinearFocusFilter);

/***/ }),
/* 307 */
/***/ (function(module, exports) {

module.exports = "/*!\n * Based on evanw's glfx.js tilt shift shader:\n * https://github.com/evanw/glfx.js/blob/master/src/filters/blur/tiltshift.js\n */\n\nuniform sampler2D u_image;\nuniform float u_blurRadius;\nuniform vec2 u_controlPoint1;\nuniform vec2 u_controlPoint2;\nuniform vec2 u_delta;\nuniform vec2 u_texSize;\nvarying vec2 v_texCoord;\n\nfloat random(vec2 co)\n{\n    highp float a = 12.9898;\n    highp float b = 78.233;\n    highp float c = 43758.5453;\n    highp float dt = dot(co.xy,vec2(a,b));\n    highp float sn = mod(dt, 3.14);\n    return fract(sin(sn) * c);\n}\n\nvoid main() {\n    vec4 color = vec4(0.0);\n    float total = 0.0;\n\n    vec2 vector = u_controlPoint2 - u_controlPoint1;\n    float offset = random(gl_FragCoord.xy / u_texSize.xy);\n\n    float radius = smoothstep(0.0, 1.0,\n      abs(\n        clamp(dot(v_texCoord - u_controlPoint1, vector) / dot(vector, vector), 0.0, 1.0)\n      )\n    ) * u_blurRadius;\n\n    for (float t = -30.0; t <= 30.0; t++) {\n      float percent = (t + offset - 0.5) / 30.0;\n      float weight = 1.0 - abs(percent);\n      vec4 _sample = texture2D(u_image, v_texCoord + u_delta * percent * radius / u_texSize);\n\n      _sample.rgb *= _sample.a;\n\n      color += _sample * weight;\n      total += weight;\n    }\n\n    gl_FragColor = color / total;\n    gl_FragColor.rgb /= gl_FragColor.a + 0.00001;\n}\n"

/***/ }),
/* 308 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor__ = __webpack_require__(7);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__mirrored_focus_filter__ = __webpack_require__(309);






var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor___default()(object, property); if (desc === undefined) { var parent = __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if ("value" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */



var Vector2 = __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Math"].Vector2;

/**
 * An operation that can draw a mirrored focus
 * @class
 * @extends PhotoEditorSDK.Operation
 * @memberof PhotoEditorSDK.Operations
 */

var MirroredFocusOperation = function (_Operation) {
  _inherits(MirroredFocusOperation, _Operation);

  /**
   * Creates a new MirroredFocusOperation
   * @param  {PhotoEditorSDK} sdk
   * @param  {Object} [options]
   */
  function MirroredFocusOperation() {
    var _ref;

    _classCallCheck(this, MirroredFocusOperation);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this = _possibleConstructorReturn(this, (_ref = MirroredFocusOperation.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(MirroredFocusOperation)).call.apply(_ref, [this].concat(args)));

    _this._lastBlurRadius = _this._options.blurRadius;
    _this._lastSize = _this._options.size;
    _this._lastGradientSize = _this._options.gradientSize;

    _this._horizontalFilter = new __WEBPACK_IMPORTED_MODULE_6__mirrored_focus_filter__["a" /* default */]();
    _this._verticalFilter = new __WEBPACK_IMPORTED_MODULE_6__mirrored_focus_filter__["a" /* default */]();
    _this._sprite.setFilters([_this._horizontalFilter, _this._verticalFilter]);

    _this._horizontalFilter.setDelta(new Vector2(0.5, 0.5));
    _this._verticalFilter.setDelta(new Vector2(-0.5, 0.5));

    _this._filter = new __WEBPACK_IMPORTED_MODULE_6__mirrored_focus_filter__["a" /* default */]();
    return _this;
  }

  /**
   * Applies the given rotation change
   * @param  {PhotoEditorSDK.Operations.RotationOperation} operation
   * @param  {Number} degrees
   */


  _createClass(MirroredFocusOperation, [{
    key: 'rotate',
    value: function rotate(degrees) {
      var start = this._options.start;
      var end = this._options.end;

      if (degrees === 90) {
        start.flip();
        start.x = 1 - start.x;
        end.flip();
        end.x = 1 - end.x;
      } else if (degrees === -90) {
        start.flip();
        start.y = 1 - start.y;
        end.flip();
        end.y = 1 - end.y;
      }

      this.set({ start: start, end: end });
    }

    /**
     * Applies a flip with the given direction
     * @param  {String} direction
     */

  }, {
    key: 'flip',
    value: function flip(direction) {
      var start = this._options.start;
      var end = this._options.end;

      switch (direction) {
        case 'horizontal':
          start.x = 1 - start.x;
          end.x = 1 - end.x;
          break;
        case 'vertical':
          start.y = 1 - start.y;
          end.y = 1 - end.y;
          break;
      }

      this.set({ start: start, end: end });
    }

    /**
     * Applies the given transform change
     * @param  {PhotoEditorSDK.Operations.TransformOperation.TransformChange} transformChange
     * @private
     */

  }, {
    key: 'transform',
    value: function transform(transformChange) {
      var _this2 = this;

      var newOptions = {};

      ['start', 'end'].forEach(function (optionName) {
        var vector = _this2.getOption(optionName);
        newOptions[optionName] = transformChange.applyToRelativePoint(vector);
      });

      ['blurRadius', 'size', 'gradientSize'].forEach(function (optionName) {
        var size = _this2.getOption(optionName);
        newOptions[optionName] = transformChange.applyToRelativeSize(size);
      });

      this.set(newOptions, false);
    }

    /**
     * Transforms this image using WebGL
     * @param  {PhotoEditorSDK.Engine.Texture} inputTexture
     * @override
     * @private
     */
    /* istanbul ignore next */

  }, {
    key: '_renderWebGL',
    value: function _renderWebGL(inputTexture) {
      var inputDimensions = inputTexture.getDimensions();
      var shortestSide = inputDimensions.min();

      var start = this._options.start.clone();
      var end = this._options.end.clone();

      var _options = this._options,
          blurRadius = _options.blurRadius,
          size = _options.size,
          gradientSize = _options.gradientSize;

      var commonOptions = {
        blurRadius: blurRadius * shortestSide,
        size: size * shortestSide,
        gradientSize: gradientSize * shortestSide,

        start: start.clone().multiply(inputDimensions),
        end: end.clone().multiply(inputDimensions),
        texSize: inputDimensions
      };

      this._horizontalFilter.set(commonOptions);
      this._verticalFilter.set(commonOptions);

      this._renderTexture.render(this._container);

      return __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Promise"].resolve();
    }

    /**
     * Renders the radial blur using Canvas2D
     * @param  {PhotoEditorSDK.Engine.Texture} inputTexture
     * @override
     * @private
     */

  }, {
    key: '_renderCanvas',
    value: function _renderCanvas(inputTexture) {
      var inputDimensions = inputTexture.getDimensions();

      var _options2 = this._options,
          blurRadius = _options2.blurRadius,
          size = _options2.size,
          gradientSize = _options2.gradientSize,
          start = _options2.start,
          end = _options2.end;

      this._filter.set({
        blurRadius: blurRadius,
        gradientSize: gradientSize,
        size: size,
        start: start.clone(),
        end: end.clone(),
        texSize: inputDimensions
      });

      this._sprite.setFilters([this._filter]);

      this._renderTexture.render(this._container);

      return __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Promise"].resolve();
    }

    /**
     * Disposes this operation
     */

  }, {
    key: 'dispose',
    value: function dispose() {
      _get(MirroredFocusOperation.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(MirroredFocusOperation.prototype), 'dispose', this).call(this);
      this._filter.dispose();
      this._verticalFilter.dispose();
      this._horizontalFilter.dispose();
    }

    /**
     * Checks if the operation has changes/modifications
     * @return {Boolean}
     */

  }, {
    key: 'hasChanges',
    value: function hasChanges() {
      return true;
    }
  }]);

  return MirroredFocusOperation;
}(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Operation"]);

/**
 * A unique string that identifies this operation. Can be used to select
 * operations.
 * @type {String}
 * @default
 */


MirroredFocusOperation.identifier = 'mirrored-focus';

/**
 * Specifies the available options for this operation
 * @type {Object}
 * @ignore
 */
MirroredFocusOperation.prototype.availableOptions = {
  start: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].VECTOR2, default: new Vector2(0.0, 0.5) },
  end: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].VECTOR2, default: new Vector2(1.0, 0.5) },
  blurRadius: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].NUMBER, default: 0.025 },
  size: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].NUMBER, default: 0.1 },
  gradientSize: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].NUMBER, default: 0.1 }
};

__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core___default.a.Operations.MirroredFocusOperation = MirroredFocusOperation;

/* harmony default export */ __webpack_exports__["a"] = (MirroredFocusOperation);

/***/ }),
/* 309 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__shared_vendor_stack_blur__ = __webpack_require__(59);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__shared_vendor_stack_blur___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5__shared_vendor_stack_blur__);





var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */



var Vector2 = __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Math"].Vector2;

var MirroredFocusFilter = function (_Engine$Filter) {
  _inherits(MirroredFocusFilter, _Engine$Filter);

  function MirroredFocusFilter() {
    var _ref;

    _classCallCheck(this, MirroredFocusFilter);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this = _possibleConstructorReturn(this, (_ref = MirroredFocusFilter.__proto__ || __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default()(MirroredFocusFilter)).call.apply(_ref, [this].concat(args)));

    _this._fragmentSource = __webpack_require__(310);

    _this._lastBlurRadius = null;
    _this._lastGradientRadius = null;
    _this._lastStart = new Vector2();
    _this._lastEnd = new Vector2();

    _this._blurredRenderTarget = new __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Engine"].CanvasRenderTarget(100, 100, 1);

    _this._maskRenderTarget = new __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Engine"].CanvasRenderTarget(100, 100, 1);
    return _this;
  }

  /**
   * Applies this filter to the given inputTarget and renders it to
   * the given outputTarget using the CanvasRenderer
   * @param  {CanvasRenderer} renderer
   * @param  {RenderTarget} inputTarget
   * @param  {RenderTarget} outputTarget
   * @param  {Boolean} clear = false
   * @private
   */


  _createClass(MirroredFocusFilter, [{
    key: '_applyCanvas',
    value: function _applyCanvas(renderer, inputTarget, outputTarget) {
      var clear = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;

      var inputDimensions = inputTarget.getDimensions();
      var dimensionsChanged = !this._blurredRenderTarget.getDimensions().equals(inputDimensions);

      this._blurredRenderTarget.setPixelRatio(inputTarget.getPixelRatio());
      this._blurredRenderTarget.resizeTo(inputTarget.getDimensions());

      this._maskRenderTarget.setPixelRatio(inputTarget.getPixelRatio());
      this._maskRenderTarget.resizeTo(inputTarget.getDimensions());

      if (!this._lastStart.equals(this._options.start) || !this._lastEnd.equals(this._options.end) || this._lastGradientRadius !== this._options.size || dimensionsChanged) {
        this._renderMask();

        this._lastStart = this._options.start.clone();
        this._lastEnd = this._options.end.clone();
        this._lastGradientRadius = this._options.size;
      }

      if (this._lastBlurRadius !== this._options.blurRadius || dimensionsChanged) {
        this._blurImage(inputTarget);
        this._lastBlurRadius = this._options.blurRadius;
      }

      this._applyMask(inputTarget, outputTarget);
    }

    /**
     * Creates a blurred copy of the image
     * @param  {CanvasRenderTarget} inputTarget
     * @return {Canvas}
     * @private
     */

  }, {
    key: '_blurImage',
    value: function _blurImage(inputTarget) {
      var inputCanvas = inputTarget.getCanvas();
      var inputContext = inputTarget.getContext();

      var inputDimensions = new Vector2(inputCanvas.width, inputCanvas.height);
      var blurryImageData = inputContext.getImageData(0, 0, inputCanvas.width, inputCanvas.height);
      __WEBPACK_IMPORTED_MODULE_5__shared_vendor_stack_blur___default.a.stackBlurCanvasRGBA(blurryImageData, 0, 0, inputCanvas.width, inputCanvas.height, this._options.blurRadius * inputDimensions.min());

      var blurryContext = this._blurredRenderTarget.getContext();
      blurryContext.putImageData(blurryImageData, 0, 0);
    }

    /**
     * Renders the mask canvas
     * @private
     */

  }, {
    key: '_renderMask',
    value: function _renderMask() {
      var canvas = this._maskRenderTarget.getCanvas();
      var context = this._maskRenderTarget.getContext();
      var pixelRatio = this._maskRenderTarget.getPixelRatio();

      var canvasDimensions = new Vector2(canvas.width, canvas.height);

      var size = this._options.size * canvasDimensions.min() * pixelRatio;
      var gradientSize = this._options.gradientSize * canvasDimensions.min() * pixelRatio;
      var start = this._options.start.clone().multiply(canvasDimensions);
      var end = this._options.end.clone().multiply(canvasDimensions);
      var dist = end.clone().subtract(start);
      var middle = start.clone().add(dist.clone().divide(2));

      var totalDist = dist.len();
      var factor = dist.clone().divide(totalDist);

      var gradientStart = middle.clone().add((size + gradientSize) * factor.y, -(size + gradientSize) * factor.x);
      var gradientEnd = middle.clone().add(-(size + gradientSize) * factor.y, (size + gradientSize) * factor.x);

      // Build gradient
      var gradient = context.createLinearGradient(gradientStart.x, gradientStart.y, gradientEnd.x, gradientEnd.y);
      var fullGradientSize = gradientEnd.clone().subtract(gradientStart).len();
      gradient.addColorStop(0, '#000000');
      gradient.addColorStop(gradientSize / 2 / fullGradientSize, '#FFFFFF');
      gradient.addColorStop(1.0 - gradientSize / 2 / fullGradientSize, '#FFFFFF');
      gradient.addColorStop(1, '#000000');

      // Draw gradient
      context.fillStyle = gradient;
      context.fillRect(0, 0, canvas.width, canvas.height);
    }

    /**
     * Applies the blur and mask to the input canvas
     * @param {CanvasRenderTarget} inputTarget
     * @param {CanvasRenderTarget} outputTarget
     * @private
     */

  }, {
    key: '_applyMask',
    value: function _applyMask(inputTarget, outputTarget) {
      var outputContext = outputTarget.getContext();
      var inputCanvas = inputTarget.getCanvas();
      var inputContext = inputTarget.getContext();
      var blurredContext = this._blurredRenderTarget.getContext();
      var maskContext = this._maskRenderTarget.getContext();

      var inputImageData = inputContext.getImageData(0, 0, inputCanvas.width, inputCanvas.height);
      var pixels = inputImageData.data;
      var blurredPixels = blurredContext.getImageData(0, 0, inputCanvas.width, inputCanvas.height).data;
      var maskPixels = maskContext.getImageData(0, 0, inputCanvas.width, inputCanvas.height).data;

      var alpha = void 0;
      for (var i = 0; i < inputCanvas.width * inputCanvas.height * 4; i += 4) {
        alpha = maskPixels[i] / 255;

        pixels[i] = alpha * pixels[i] + (1 - alpha) * blurredPixels[i];
        pixels[i + 1] = alpha * pixels[i + 1] + (1 - alpha) * blurredPixels[i + 1];
        pixels[i + 2] = alpha * pixels[i + 2] + (1 - alpha) * blurredPixels[i + 2];
      }

      outputContext.putImageData(inputImageData, 0, 0);
    }
  }]);

  return MirroredFocusFilter;
}(__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Engine"].Filter);

MirroredFocusFilter.prototype.availableOptions = {
  blurRadius: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].NUMBER, default: 30, uniformType: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["UniformType"].FLOAT },
  size: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].NUMBER, default: 50, uniformType: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["UniformType"].FLOAT },
  gradientSize: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].NUMBER, default: 50, uniformType: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["UniformType"].FLOAT },
  start: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].VECTOR2, default: new Vector2(0, 0.5), uniformType: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["UniformType"].FLOAT2 },
  end: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].VECTOR2, default: new Vector2(1, 0.5), uniformType: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["UniformType"].FLOAT2 },
  delta: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].VECTOR2, default: new Vector2(1, 1), uniformType: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["UniformType"].FLOAT2 },
  texSize: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].VECTOR2, default: new Vector2(100, 100), uniformType: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["UniformType"].FLOAT2 }
};

/* harmony default export */ __webpack_exports__["a"] = (MirroredFocusFilter);

/***/ }),
/* 310 */
/***/ (function(module, exports) {

module.exports = "/*\n * Based on evanw's glfx.js tilt shift shader:\n * https://github.com/evanw/glfx.js/blob/master/src/filters/blur/tiltshift.js\n * @license\n */\n\nuniform sampler2D u_image;\nuniform float u_blurRadius;\nuniform float u_gradientSize;\nuniform float u_size;\nuniform vec2 u_start;\nuniform vec2 u_end;\nuniform vec2 u_delta;\nuniform vec2 u_texSize;\nvarying vec2 v_texCoord;\n\nfloat random(vec2 co)\n{\n    highp float a = 12.9898;\n    highp float b = 78.233;\n    highp float c = 43758.5453;\n    highp float dt = dot(co.xy,vec2(a,b));\n    highp float sn = mod(dt, 3.14);\n    return fract(sin(sn) * c);\n}\n\nvoid main() {\n    vec4 color = vec4(0.0);\n    float total = 0.0;\n\n    float offset = random(gl_FragCoord.xy / u_texSize.xy);\n\n    vec2 normal = normalize(vec2(u_start.y - u_end.y, u_end.x - u_start.x));\n    float radius = smoothstep(0.0, 1.0,\n      (abs(\n        dot(v_texCoord * u_texSize - u_start, normal)\n      ) - u_size) / u_gradientSize\n    ) * u_blurRadius;\n\n    for (float t = -30.0; t <= 30.0; t++) {\n        float percent = (t + offset - 0.5) / 30.0;\n        float weight = 1.0 - abs(percent);\n        vec4 _sample = texture2D(u_image, v_texCoord + u_delta * percent * radius / u_texSize);\n\n        _sample.rgb *= _sample.a;\n\n        color += _sample * weight;\n        total += weight;\n    }\n\n    gl_FragColor = color / total;\n    gl_FragColor.rgb /= gl_FragColor.a + 0.00001;\n}\n"

/***/ }),
/* 311 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__);





var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */


var Vector2 = __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Math"].Vector2;

/**
 * An operation that can rotate and flip an image
 * @class
 * @extends PhotoEditorSDK.Operation
 * @memberof PhotoEditorSDK.Operations
 */

var OrientationOperation = function (_Operation) {
  _inherits(OrientationOperation, _Operation);

  function OrientationOperation() {
    _classCallCheck(this, OrientationOperation);

    return _possibleConstructorReturn(this, (OrientationOperation.__proto__ || __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default()(OrientationOperation)).apply(this, arguments));
  }

  _createClass(OrientationOperation, [{
    key: '_render',

    /**
     * Rotates and/or flips the image
     * @param  {PhotoEditorSDK} sdk
     * @returns {Promise}
     * @override
     * @private
     */
    value: function _render(sdk) {
      var actualDegrees = this._options.rotation % 360;
      var radians = actualDegrees * (Math.PI / 180);

      this._sprite.setScale(this._options.flipHorizontally ? -1 : 1, this._options.flipVertically ? -1 : 1);
      this._sprite.setRotation(radians);
      this._sprite.setAnchor(0.5, 0.5);
      this._sprite.updateTransform();

      var bounds = this._sprite.getBounds();
      this._renderTexture.resizeTo(new Vector2(bounds.width, bounds.height));

      // Make sure we're rendering to top left corner
      this._sprite.setPosition(this._renderTexture.getDimensions().divide(2).round());

      // Draw
      this._renderTexture.render(this._container);

      return __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Promise"].resolve();
    }

    /**
     * Returns the dimensions the given dimensions will have after this operation
     * has been applied
     * @param {PhotoEditorSDK.Math.Vector2} dimensions
     * @return {PhotoEditorSDK.Math.Vector2}
     * @override
     */

  }, {
    key: 'getNewDimensions',
    value: function getNewDimensions(dimensions) {
      dimensions = dimensions.clone();
      if (this._options.rotation % 180) {
        dimensions.flip();
      }
      return dimensions;
    }

    /**
     * Flips the image while incorporating the current rotation
     * @param {String} direction
     */

  }, {
    key: 'flip',
    value: function flip(direction) {
      var rotation = this._options.rotation;

      if (rotation === 90 || rotation === 270) {
        if (direction === 'vertical') {
          direction = 'horizontal';
        } else {
          direction = 'vertical';
        }
      }

      switch (direction) {
        case 'vertical':
          this.setFlipVertically(!this.getFlipVertically());
          break;
        case 'horizontal':
          this.setFlipHorizontally(!this.getFlipHorizontally());
          break;
      }
    }
  }]);

  return OrientationOperation;
}(__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Operation"]);

/**
 * A unique string that identifies this operation. Can be used to select
 * operations.
 * @type {String}
 * @default
 */


OrientationOperation.identifier = 'orientation';

/**
 * Specifies the available options for this operation
 * @type {Object}
 * @ignore
 */
OrientationOperation.prototype.availableOptions = {
  rotation: {
    type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].NUMBER,
    default: 0,
    validation: function validation(value) {
      if (value % 90 !== 0) {
        throw new Error('OrientationOperation: `rotation` has to be a multiple of 90.');
      }
    },
    setter: function setter(value) {
      return (value + 360) % 360;
    }
  },
  flipVertically: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].BOOLEAN, default: false },
  flipHorizontally: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].BOOLEAN, default: false }
};

__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core___default.a.Operations.OrientationOperation = OrientationOperation;

/* harmony default export */ __webpack_exports__["a"] = (OrientationOperation);

/***/ }),
/* 312 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_keys__ = __webpack_require__(56);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_keys___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_keys__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_own_property_descriptor__ = __webpack_require__(7);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_own_property_descriptor___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_own_property_descriptor__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__);







var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_own_property_descriptor___default()(object, property); if (desc === undefined) { var parent = __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default()(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if ("value" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */


var OverlayFilter = __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["Engine"].Filters.OverlayFilter;
var Vector2 = __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["Math"].Vector2;

var GL_UNIT = 4;

/**
 * An operation that can draw a watermark on top of the image
 * @class
 * @extends PhotoEditorSDK.Operation
 * @memberof PhotoEditorSDK.Operations
 */

var OverlayOperation = function (_Operation) {
  _inherits(OverlayOperation, _Operation);

  /**
   * Creates a new OverlayOperation
   * @param  {PhotoEditorSDK} sdk
   * @param  {Object} [options]
   */
  function OverlayOperation() {
    var _ref;

    _classCallCheck(this, OverlayOperation);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this = _possibleConstructorReturn(this, (_ref = OverlayOperation.__proto__ || __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default()(OverlayOperation)).call.apply(_ref, [this].concat(args)));

    _this._overlayTexture = __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["Engine"].Texture.fromImage(_this._options.image);
    _this._overlayContainer = new __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["Engine"].Container();
    _this._overlaySprite = new __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["Engine"].Sprite();
    _this._overlaySprite.setTexture(_this._overlayTexture);
    _this._overlaySprite.setAnchor(0, 0);
    _this._overlayContainer.addChild(_this._overlaySprite);

    _this._overlayFilter = new __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["Engine"].Filters.OverlayFilter({
      overlayImage: _this._overlayTexture.getBaseTexture().getGLUnit(),
      overlayTexture: _this._overlayTexture
    });
    _this._sprite.setFilters([_this._overlayFilter]);

    _this._renderedOverlaySprite = new __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["Engine"].Sprite();
    _this._renderedOverlayContainer = new __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["Engine"].Container();
    _this._renderedOverlayContainer.addChild(_this._renderedOverlaySprite);

    _this._overlayRendered = false;
    _this._lastInputDimensions = new Vector2(0, 0);
    return _this;
  }

  _createClass(OverlayOperation, [{
    key: 'setOption',
    value: function setOption(name, value) {
      _get(OverlayOperation.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default()(OverlayOperation.prototype), 'setOption', this).call(this, name, value);

      if (name === 'image' && value && this._sdk) {
        var renderer = this._sdk.getRenderer();
        var baseTexture = this._overlayTexture.getBaseTexture();
        baseTexture.setSource(value);

        if (renderer.isOfType(__WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["RendererType"].WEBGL)) {
          renderer.updateTexture(baseTexture);
        }

        this._overlayRendered = false;
      }
    }

    /**
     * Renders the watermark
     * @param  {PhotoEditorSDK.Engine.Texture} inputTexture
     * @private
     * @override
     */

  }, {
    key: '_render',
    value: function _render(inputTexture) {
      var inputDimensions = inputTexture.getDimensions();
      var _options = this._options,
          image = _options.image,
          alpha = _options.alpha,
          blendMode = _options.blendMode;

      if (!image) {
        this._sprite.setFilters([]);
        this._renderTexture.render(this._container);
        return __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["Promise"].resolve();
      }

      if (!this._overlayRendered || !this._lastInputDimensions.equals(inputDimensions)) {
        this._renderOverlayToRenderTexture(inputTexture);
        this._overlayRendered = true;
        this._lastInputDimensions.copy(inputDimensions);
      }

      this._overlayFilter.set({
        blendMode: blendMode,
        overlayImage: this._overlayRenderTexture.getBaseTexture().getGLUnit(),
        overlayTexture: this._overlayRenderTexture,
        alpha: alpha
      });
      this._sprite.setFilters([this._overlayFilter]);

      this._renderTexture.render(this._container);

      return __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["Promise"].resolve(this._renderTexture);
    }

    /**
     * Renders the overlay to a render texture that has the same dimensions as the input texture
     * @param  {PhotoEditorSDK.Engine.Texture} inputTexture
     * @private
     */

  }, {
    key: '_renderOverlayToRenderTexture',
    value: function _renderOverlayToRenderTexture(inputTexture) {
      var renderer = this._sdk.getRenderer();
      var textureDimensions = inputTexture.getDimensions();

      if (!this._overlayRenderTexture) {
        this._overlayRenderTexture = new __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["Engine"].RenderTexture(renderer, textureDimensions.x, textureDimensions.y);
        this._renderedOverlaySprite.setTexture(this._overlayRenderTexture);
      }

      var _options$image = this._options.image,
          width = _options$image.width,
          height = _options$image.height;

      var dimensions = __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["Utils"].resizeVectorToFill(new Vector2(width, height), textureDimensions);
      this._overlaySprite.setWidth(dimensions.x);
      this._overlaySprite.setHeight(dimensions.y);

      var baseTexture = this._overlayRenderTexture.getBaseTexture();

      if (renderer.isOfType(__WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["RendererType"].WEBGL)) {
        baseTexture.setGLUnit(GL_UNIT);
        renderer.updateTexture(baseTexture, false);
      }
      this._overlayRenderTexture.resizeTo(textureDimensions);
      this._overlayRenderTexture.render(this._overlayContainer);
    }

    /**
     * Disposes this operation
     */

  }, {
    key: 'dispose',
    value: function dispose() {
      _get(OverlayOperation.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default()(OverlayOperation.prototype), 'dispose', this).call(this);
      this._overlaySprite.dispose();
    }
  }]);

  return OverlayOperation;
}(__WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["Operation"]);

/**
 * A unique string that identifies this operation. Can be used to select
 * operations.
 * @type {String}
 * @default
 */


OverlayOperation.identifier = 'overlay';

/**
 * The available blend modes
 * @type {Object}
 */
OverlayOperation.BLEND_MODES = OverlayFilter.BLEND_MODES;

/**
 * Specifies the available options for this operation
 * @type {Object}
 * @ignore
 */
OverlayOperation.prototype.availableOptions = {
  identifier: { type: __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["OptionType"].STRING },
  image: { type: __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["OptionType"].IMAGE },
  blendMode: {
    type: __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["OptionType"].NUMBER,
    default: OverlayFilter.BLEND_MODES.MULTIPLY,
    available: __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_keys___default()(OverlayFilter.BLEND_MODES).map(function (o) {
      return OverlayFilter.BLEND_MODES[o];
    })
  },
  alpha: { type: __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["OptionType"].NUMBER, default: 1 }
};

__WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core___default.a.Operations.OverlayOperation = OverlayOperation;

/* harmony default export */ __webpack_exports__["a"] = (OverlayOperation);

/***/ }),
/* 313 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor__ = __webpack_require__(7);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__radial_focus_filter__ = __webpack_require__(314);






var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor___default()(object, property); if (desc === undefined) { var parent = __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if ("value" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */



var Vector2 = __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Math"].Vector2;

/**
 * An operation that can draw a radial focus
 * @class
 * @extends PhotoEditorSDK.Operation
 * @memberof PhotoEditorSDK.Operations
 */

var RadialFocusOperation = function (_Operation) {
  _inherits(RadialFocusOperation, _Operation);

  /**
   * Creates a new RadialFocusOperation
   * @param  {PhotoEditorSDK} sdk
   * @param  {Object} [options]
   */
  function RadialFocusOperation() {
    var _ref;

    _classCallCheck(this, RadialFocusOperation);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this = _possibleConstructorReturn(this, (_ref = RadialFocusOperation.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(RadialFocusOperation)).call.apply(_ref, [this].concat(args)));

    _this._lastBlurRadius = _this._options.blurRadius;
    _this._lastGradientRadius = _this._options.gradientRadius;

    _this._horizontalFilter = new __WEBPACK_IMPORTED_MODULE_6__radial_focus_filter__["a" /* default */]();
    _this._verticalFilter = new __WEBPACK_IMPORTED_MODULE_6__radial_focus_filter__["a" /* default */]();
    _this._sprite.setFilters([_this._horizontalFilter, _this._verticalFilter]);

    _this._horizontalFilter.setDelta(new Vector2(0.5, 0.5));
    _this._verticalFilter.setDelta(new Vector2(-0.5, 0.5));

    _this._filter = new __WEBPACK_IMPORTED_MODULE_6__radial_focus_filter__["a" /* default */]();
    return _this;
  }

  /**
   * Applies the given rotation change
   * @param  {Number} degrees
   */


  _createClass(RadialFocusOperation, [{
    key: 'rotate',
    value: function rotate(degrees) {
      var position = this._options.position;

      if (degrees === 90) {
        position.flip();
        position.x = 1 - position.x;
      } else if (degrees === -90) {
        position.flip();
        position.y = 1 - position.y;
      }

      this.set({ position: position });
    }

    /**
     * Applies a flip with the given direction
     * @param  {String} direction
     */

  }, {
    key: 'flip',
    value: function flip(direction) {
      var position = this._options.position;

      switch (direction) {
        case 'horizontal':
          position.x = 1 - position.x;
          break;
        case 'vertical':
          position.y = 1 - position.y;
          break;
      }

      this.set({ position: position });
    }

    /**
     * Applies the given transform change
     * @param  {PhotoEditorSDK.Operations.TransformOperation.TransformChange} transformChange
     * @private
     */

  }, {
    key: 'transform',
    value: function transform(transformChange) {
      var _this2 = this;

      var newOptions = {};

      var vector = this.getPosition();
      newOptions.position = transformChange.applyToRelativePoint(vector);

      ['radius', 'blurRadius', 'gradientRadius'].forEach(function (optionName) {
        var size = _this2.getOption(optionName);
        newOptions[optionName] = transformChange.applyToRelativeSize(size);
      });

      this.set(newOptions, false);
    }

    /**
     * Renders the radial blur using WebGL
     * @param  {PhotoEditorSDK.Engine.Texture} inputTexture
     * @private
     * @override
     */
    /* istanbul ignore next */

  }, {
    key: '_renderWebGL',
    value: function _renderWebGL(inputTexture) {
      var inputDimensions = inputTexture.getDimensions();
      var shortestSide = inputDimensions.min();

      var _options = this._options,
          position = _options.position,
          blurRadius = _options.blurRadius,
          radius = _options.radius,
          gradientRadius = _options.gradientRadius;


      var commonOptions = {
        blurRadius: blurRadius * shortestSide,
        radius: radius * shortestSide,
        gradientRadius: gradientRadius * shortestSide,
        position: position.clone().multiply(inputDimensions),
        texSize: inputDimensions
      };

      this._horizontalFilter.set(commonOptions);
      this._verticalFilter.set(commonOptions);

      this._renderTexture.render(this._container);

      return __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Promise"].resolve();
    }

    /**
     * Renders the radial blur using Canvas2D
     * @param  {PhotoEditorSDK.Engine.Texture} inputTexture
     * @private
     * @override
     */

  }, {
    key: '_renderCanvas',
    value: function _renderCanvas(inputTexture) {
      var _options2 = this._options,
          blurRadius = _options2.blurRadius,
          radius = _options2.radius,
          gradientRadius = _options2.gradientRadius,
          position = _options2.position;

      var inputDimensions = inputTexture.getDimensions();

      this._filter.set({
        blurRadius: blurRadius,
        radius: radius,
        gradientRadius: gradientRadius,
        position: position,
        texSize: inputDimensions
      });

      this._sprite.setFilters([this._filter]);

      this._renderTexture.render(this._container);

      return __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Promise"].resolve();
    }

    /**
     * Disposes this operation
     */

  }, {
    key: 'dispose',
    value: function dispose() {
      _get(RadialFocusOperation.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(RadialFocusOperation.prototype), 'dispose', this).call(this);
      this._filter.dispose();
      this._verticalFilter.dispose();
      this._horizontalFilter.dispose();
    }

    /**
     * Checks if the operation has changes/modifications
     * @return {Boolean}
     */

  }, {
    key: 'hasChanges',
    value: function hasChanges() {
      return true;
    }
  }]);

  return RadialFocusOperation;
}(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Operation"]);

/**
 * A unique string that identifies this operation. Can be used to select
 * operations.
 * @type {String}
 * @default
 */


RadialFocusOperation.identifier = 'radial-focus';

/**
 * Specifies the available options for this operation
 * @type {Object}
 * @ignore
 */
RadialFocusOperation.prototype.availableOptions = {
  position: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].VECTOR2, default: new Vector2(0.5, 0.5) },
  radius: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].NUMBER, default: 0.25 },
  gradientRadius: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].NUMBER, default: 0.125 },
  blurRadius: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].NUMBER, default: 0.025 }
};

__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core___default.a.Operations.RadialFocusOperation = RadialFocusOperation;

/* harmony default export */ __webpack_exports__["a"] = (RadialFocusOperation);

/***/ }),
/* 314 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__shared_vendor_stack_blur__ = __webpack_require__(59);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__shared_vendor_stack_blur___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5__shared_vendor_stack_blur__);





var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */



var Vector2 = __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Math"].Vector2;

var RadialFocusFilter = function (_Engine$Filter) {
  _inherits(RadialFocusFilter, _Engine$Filter);

  function RadialFocusFilter() {
    var _ref;

    _classCallCheck(this, RadialFocusFilter);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this = _possibleConstructorReturn(this, (_ref = RadialFocusFilter.__proto__ || __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default()(RadialFocusFilter)).call.apply(_ref, [this].concat(args)));

    _this._fragmentSource = __webpack_require__(315);

    _this._lastBlurRadius = null;
    _this._lastGradientRadius = null;
    _this._lastPosition = new Vector2();

    _this._blurredRenderTarget = new __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Engine"].CanvasRenderTarget(100, 100, 1);

    _this._maskRenderTarget = new __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Engine"].CanvasRenderTarget(100, 100, 1);
    return _this;
  }

  /**
   * Applies this filter to the given inputTarget and renders it to
   * the given outputTarget using the CanvasRenderer
   * @param  {CanvasRenderer} renderer
   * @param  {RenderTarget} inputTarget
   * @param  {RenderTarget} outputTarget
   * @param  {Boolean} clear = false
   * @private
   */


  _createClass(RadialFocusFilter, [{
    key: '_applyCanvas',
    value: function _applyCanvas(renderer, inputTarget, outputTarget) {
      var clear = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;

      var inputDimensions = inputTarget.getDimensions();
      var dimensionsChanged = !this._blurredRenderTarget.getDimensions().equals(inputDimensions);

      this._blurredRenderTarget.setPixelRatio(inputTarget.getPixelRatio());
      this._blurredRenderTarget.resizeTo(inputTarget.getDimensions());

      this._maskRenderTarget.setPixelRatio(inputTarget.getPixelRatio());
      this._maskRenderTarget.resizeTo(inputTarget.getDimensions());

      if (!this._lastPosition.equals(this._options.position) || this._lastGradientRadius !== this._options.gradientRadius || dimensionsChanged) {
        this._renderMask();

        this._lastPosition = this._options.position.clone();
        this._lastGradientRadius = this._options.gradientRadius;
      }

      if (this._lastBlurRadius !== this._options.blurRadius || dimensionsChanged) {
        this._blurImage(inputTarget);
        this._lastBlurRadius = this._options.blurRadius;
      }

      this._applyMask(inputTarget, outputTarget);
    }

    /**
     * Creates a blurred copy of the image
     * @param  {CanvasRenderTarget} inputTarget
     * @return {Canvas}
     * @private
     */

  }, {
    key: '_blurImage',
    value: function _blurImage(inputTarget) {
      var inputCanvas = inputTarget.getCanvas();
      var inputContext = inputTarget.getContext();

      var inputDimensions = new Vector2(inputCanvas.width, inputCanvas.height);
      var blurryImageData = inputContext.getImageData(0, 0, inputCanvas.width, inputCanvas.height);
      __WEBPACK_IMPORTED_MODULE_5__shared_vendor_stack_blur___default.a.stackBlurCanvasRGBA(blurryImageData, 0, 0, inputCanvas.width, inputCanvas.height, this._options.blurRadius * inputDimensions.min());

      var blurryContext = this._blurredRenderTarget.getContext();
      blurryContext.putImageData(blurryImageData, 0, 0);
    }

    /**
     * Renders the mask canvas
     * @private
     */

  }, {
    key: '_renderMask',
    value: function _renderMask() {
      var canvas = this._maskRenderTarget.getCanvas();
      var context = this._maskRenderTarget.getContext();

      var canvasDimensions = new Vector2(canvas.width, canvas.height);
      var pixelRatio = this._maskRenderTarget.getPixelRatio();
      var position = this._options.position.clone().multiply(canvasDimensions);

      var _options = this._options,
          radius = _options.radius,
          gradientRadius = _options.gradientRadius;

      radius *= canvas.height;
      gradientRadius *= canvas.height;

      // Build gradient
      var gradient = context.createRadialGradient(position.x, position.y, 0, position.x, position.y, (radius + gradientRadius) * pixelRatio);
      gradient.addColorStop(0, '#FFFFFF');
      gradient.addColorStop(radius / (radius + gradientRadius), '#FFFFFF');
      gradient.addColorStop(1, '#000000');

      // Draw gradient
      context.fillStyle = gradient;
      context.fillRect(0, 0, canvasDimensions.x, canvasDimensions.y);
    }

    /**
     * Applies the blur and mask to the input canvas
     * @param {CanvasRenderTarget} inputTarget
     * @param {CanvasRenderTarget} outputTarget
     * @private
     */

  }, {
    key: '_applyMask',
    value: function _applyMask(inputTarget, outputTarget) {
      var outputContext = outputTarget.getContext();
      var inputCanvas = inputTarget.getCanvas();
      var inputContext = inputTarget.getContext();
      var blurredContext = this._blurredRenderTarget.getContext();
      var maskContext = this._maskRenderTarget.getContext();

      var inputImageData = inputContext.getImageData(0, 0, inputCanvas.width, inputCanvas.height);
      var pixels = inputImageData.data;
      var blurredPixels = blurredContext.getImageData(0, 0, inputCanvas.width, inputCanvas.height).data;
      var maskPixels = maskContext.getImageData(0, 0, inputCanvas.width, inputCanvas.height).data;

      var alpha = void 0;
      for (var i = 0; i < inputCanvas.width * inputCanvas.height * 4; i += 4) {
        alpha = maskPixels[i] / 255;

        pixels[i] = alpha * pixels[i] + (1 - alpha) * blurredPixels[i];
        pixels[i + 1] = alpha * pixels[i + 1] + (1 - alpha) * blurredPixels[i + 1];
        pixels[i + 2] = alpha * pixels[i + 2] + (1 - alpha) * blurredPixels[i + 2];
      }

      outputContext.putImageData(inputImageData, 0, 0);
    }
  }]);

  return RadialFocusFilter;
}(__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Engine"].Filter);

RadialFocusFilter.prototype.availableOptions = {
  blurRadius: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].NUMBER, default: 30, uniformType: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["UniformType"].FLOAT },
  radius: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].NUMBER, default: 50, uniformType: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["UniformType"].FLOAT },
  gradientRadius: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].NUMBER, default: 25, uniformType: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["UniformType"].FLOAT },
  position: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].VECTOR2, default: new Vector2(0.5, 0.5), uniformType: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["UniformType"].FLOAT2 },
  delta: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].VECTOR2, default: new Vector2(1, 1), uniformType: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["UniformType"].FLOAT2 },
  texSize: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].VECTOR2, default: new Vector2(100, 100), uniformType: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["UniformType"].FLOAT2 }
};

/* harmony default export */ __webpack_exports__["a"] = (RadialFocusFilter);

/***/ }),
/* 315 */
/***/ (function(module, exports) {

module.exports = "/*\n * Based on evanw's glfx.js tilt shift shader:\n * https://github.com/evanw/glfx.js/blob/master/src/filters/blur/tiltshift.js\n * @license\n */\n\nuniform sampler2D u_image;\nuniform float u_radius;\nuniform float u_blurRadius;\nuniform float u_gradientRadius;\nuniform vec2 u_position;\nuniform vec2 u_delta;\nuniform vec2 u_texSize;\nvarying vec2 v_texCoord;\n\nfloat random(vec2 co)\n{\n    highp float a = 12.9898;\n    highp float b = 78.233;\n    highp float c = 43758.5453;\n    highp float dt = dot(co.xy,vec2(a,b));\n    highp float sn = mod(dt, 3.14);\n    return fract(sin(sn) * c);\n}\n\nvoid main() {\n    vec4 color = vec4(0.0);\n    float total = 0.0;\n\n    float offset = random(gl_FragCoord.xy / u_texSize.xy);\n    float radius = smoothstep(\n      0.0, 1.0,\n      (abs(\n        distance(v_texCoord * u_texSize, u_position)\n      ) - u_radius) / (u_gradientRadius * 2.0)\n    ) * u_blurRadius;\n    for (float t = -30.0; t <= 30.0; t++) {\n        float percent = (t + offset - 0.5) / 30.0;\n        float weight = 1.0 - abs(percent);\n        vec4 _sample = texture2D(u_image, v_texCoord + u_delta * percent * radius / u_texSize);\n\n        _sample.rgb *= _sample.a;\n\n        color += _sample * weight;\n        total += weight;\n    }\n\n    gl_FragColor = color / total;\n    gl_FragColor.rgb /= gl_FragColor.a + 0.00001;\n}\n"

/***/ }),
/* 316 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor__ = __webpack_require__(7);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__shared_sprites_brush_sprite__ = __webpack_require__(129);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__shared_filters_blur_filter__ = __webpack_require__(126);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__shared_filters_mask_filter__ = __webpack_require__(320);






var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor___default()(object, property); if (desc === undefined) { var parent = __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if ("value" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */






var Vector2 = __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Math"].Vector2;

/**
 * An operation that can draw a selective blur using brushes
 * @class
 * @extends PhotoEditorSDK.Operation
 * @memberof PhotoEditorSDK.Operations
 */

var SelectiveBlurOperation = function (_Operation) {
  _inherits(SelectiveBlurOperation, _Operation);

  /**
   * Creates a new SelectiveBlurOperation
   * @param  {PhotoEditorSDK} sdk
   * @param  {Object} [options]
   */
  function SelectiveBlurOperation() {
    var _ref;

    _classCallCheck(this, SelectiveBlurOperation);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this = _possibleConstructorReturn(this, (_ref = SelectiveBlurOperation.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(SelectiveBlurOperation)).call.apply(_ref, [this].concat(args)));

    var renderer = _this._sdk.getRenderer();

    _this._lastBlurRadius = null;
    _this._blurredRenderTexture = new __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Engine"].RenderTexture(renderer, 100, 100, 1);
    _this._maskRenderTexture = new __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Engine"].RenderTexture(renderer, 100, 100, 1);

    _this._brushSprite = new __WEBPACK_IMPORTED_MODULE_6__shared_sprites_brush_sprite__["a" /* default */](_this);
    _this._brushSpriteContainer = new __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Engine"].Container();
    var brushSprite = _this._brushSprite.getDisplayObject();
    _this._brushSpriteContainer.addChild(brushSprite);

    _this._outputSprite = new __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Engine"].Sprite();
    _this._outputContainer = new __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Engine"].Container();
    _this._outputContainer.addChild(_this._outputSprite);

    _this._maskFilter = new __WEBPACK_IMPORTED_MODULE_8__shared_filters_mask_filter__["a" /* default */]();
    if (renderer.isOfType(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["RendererType"].WEBGL)) {
      _this._horizontalFilter = new __WEBPACK_IMPORTED_MODULE_7__shared_filters_blur_filter__["a" /* default */]();
      _this._verticalFilter = new __WEBPACK_IMPORTED_MODULE_7__shared_filters_blur_filter__["a" /* default */]();
      _this._sprite.setFilters([_this._horizontalFilter, _this._verticalFilter]);

      _this._horizontalFilter.setDelta(new Vector2(1, 1));
      _this._verticalFilter.setDelta(new Vector2(-1, 1));

      var baseTexture = _this._maskRenderTexture.getBaseTexture();
      baseTexture.setGLUnit(_this._maskFilter.getMaskImage());
      renderer.updateTexture(baseTexture, false);

      baseTexture = _this._blurredRenderTexture.getBaseTexture();
      baseTexture.setGLUnit(_this._maskFilter.getFilterImage());
      renderer.updateTexture(baseTexture, false);
    } else if (renderer.isOfType(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["RendererType"].CANVAS)) {
      _this._blurFilter = new __WEBPACK_IMPORTED_MODULE_7__shared_filters_blur_filter__["a" /* default */]();

      _this._sprite.setFilters([_this._blurFilter]);

      _this._maskFilter.setMaskCanvas(_this._maskRenderTexture.getRenderTarget().getCanvas());
      _this._maskFilter.setFilterCanvas(_this._blurredRenderTexture.getRenderTarget().getCanvas());
    }

    _this._outputSprite.setFilters([_this._maskFilter]);
    return _this;
  }

  /**
   * Applies a flip to this operation
   * @param  {String} direction
   */


  _createClass(SelectiveBlurOperation, [{
    key: 'flip',
    value: function flip(direction) {
      this._brushSprite.applyFlip(direction);
      this.setDirty(true, true);
      this._lastBlurRadius = null;
    }

    /**
     * Applies a rotation to this operation
     * @param  {Number} degrees
     */

  }, {
    key: 'rotate',
    value: function rotate(degrees) {
      this._brushSprite.applyRotation(degrees);
      this.setDirty(true, true);
      this._lastBlurRadius = null;
    }

    /**
     * Applies a transform to this operation
     * @param  {PhotoEditorSDK.Operation} transformOperation
     * @param  {Object} options
     */

  }, {
    key: 'transform',
    value: function transform(transformOperation, options) {
      this._brushSprite.applyTransform(transformOperation, options);
      this.setDirty(true, true);
      this._lastBlurRadius = null;
    }

    /**
     * Renders this operation
     * @param  {PhotoEditorSDK.Engine.Texture} inputTexture
     * @override
     * @private
     */

  }, {
    key: '_render',
    value: function _render(inputTexture) {
      this._renderBlur(inputTexture);
      this._renderMask(inputTexture);

      this._outputSprite.setTexture(inputTexture);
      this._renderTexture.render(this._outputContainer);

      return __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Promise"].resolve();
    }

    /**
     * Renders the mask
     * @param  {PhotoEditorSDK.Engine.Texture} inputTexture
     * @private
     */

  }, {
    key: '_renderMask',
    value: function _renderMask(inputTexture) {
      var inputDimensions = inputTexture.getDimensions();

      var maskDimensions = this._maskRenderTexture.getDimensions();
      if (!maskDimensions.equals(inputDimensions)) {
        this._maskRenderTexture.resizeTo(inputDimensions);
      }

      this._brushSprite.update(this._sdk, inputDimensions);
      this._maskRenderTexture.clear(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Color"].BLACK);
      this._maskRenderTexture.render(this._brushSpriteContainer);

      var renderer = this._sdk.getRenderer();
      if (renderer.isOfType(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["RendererType"].WEBGL)) {
        renderer.updateTexture(this._maskRenderTexture.getBaseTexture(), false);
      }
    }

    /**
     * Blurs the input image
     * @param  {PhotoEditorSDK.Engine.Texture} inputTexture
     * @private
     */

  }, {
    key: '_renderBlur',
    value: function _renderBlur(inputTexture) {
      var inputDimensions = inputTexture.getDimensions();

      var blurredDimensions = this._blurredRenderTexture.getDimensions();
      if (!blurredDimensions.equals(inputDimensions)) {
        this._blurredRenderTexture.resizeTo(inputDimensions);
      }

      var blurRadius = this._options.blurRadius;

      if (this._lastBlurRadius !== blurRadius || !blurredDimensions.equals(inputDimensions)) {
        var renderer = this._sdk.getRenderer();

        var blurOptions = void 0;
        if (renderer.isOfType(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["RendererType"].WEBGL)) {
          var shortestSide = inputDimensions.min();
          blurOptions = {
            blurRadius: blurRadius * shortestSide,
            texSize: inputDimensions
          };

          this._horizontalFilter.set(blurOptions);
          this._verticalFilter.set(blurOptions);
        } else if (renderer.isOfType(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["RendererType"].CANVAS)) {
          blurOptions = { blurRadius: blurRadius };
          this._blurFilter.set(blurOptions);
        }

        this._blurredRenderTexture.render(this._container);
        this._lastBlurRadius = blurRadius;
      }
    }

    /**
     * Returns this operation's brush
     * @return {PhotoEditorSDK.Operations.SpriteOperation.BrushSprite}
     */

  }, {
    key: 'getBrush',
    value: function getBrush() {
      return this._brushSprite;
    }

    /**
     * Creates and adds a new path
     * @param {Number} size
     * @param {Number} hardness = 1
     * @return {PhotoEditorSDK.Operations.SpriteOperation.BrushSprite.Path}
     */

  }, {
    key: 'createPath',
    value: function createPath(size) {
      var hardness = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1;

      var brush = new __WEBPACK_IMPORTED_MODULE_6__shared_sprites_brush_sprite__["a" /* default */].Brushes.RadialBrush({ size: size, hardness: hardness, color: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Color"].WHITE });
      var path = this._brushSprite.createPath(brush);
      this._options.paths.push(path);
      this.setDirty(true);
      return path;
    }

    /**
     * Sets the dirtiness for the given renderer
     * @param {Boolean} dirty
     * @param {PhotoEditorSDK.Engine.BaseRenderer} renderer
     * @param {Boolean} dimensionsChanged = false
     */

  }, {
    key: 'setDirtyForRenderer',
    value: function setDirtyForRenderer(dirty, renderer, dimensionsChanged) {
      _get(SelectiveBlurOperation.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(SelectiveBlurOperation.prototype), 'setDirtyForRenderer', this).call(this, dirty, renderer, dimensionsChanged);
      this._brushSprite.setDirtyForRenderer(dirty, renderer, dimensionsChanged);
    }

    /**
     * Disposes this operation
     */

  }, {
    key: 'dispose',
    value: function dispose() {
      _get(SelectiveBlurOperation.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(SelectiveBlurOperation.prototype), 'dispose', this).call(this);

      var renderer = this._sdk.getRenderer();
      if (renderer.isOfType(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["RendererType"].WEBGL)) {
        this._verticalFilter.dispose();
        this._horizontalFilter.dispose();
      } else {
        this._blurFilter.dispose();
      }

      this._brushSprite.dispose();
      this._maskFilter.dispose();
      this._blurredRenderTexture.dispose();
      this._maskRenderTexture.dispose();
    }

    /**
     * Checks if the operation has changes/modifications
     * @return {Boolean}
     */

  }, {
    key: 'hasChanges',
    value: function hasChanges() {
      return true;
    }
  }]);

  return SelectiveBlurOperation;
}(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Operation"]);

/**
 * A unique string that identifies this operation. Can be used to select
 * operations.
 * @type {String}
 * @default
 */


SelectiveBlurOperation.identifier = 'selective-blur';

/**
 * Specifies the available options for this operation
 * @type {Object}
 * @ignore
 */
SelectiveBlurOperation.prototype.availableOptions = {
  blurRadius: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].NUMBER, default: 0.05 },
  paths: {
    type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].ARRAY,
    default: [],
    setter: function setter(paths) {
      if (this._brushSprite) {
        this._brushSprite.setPaths(paths);
      }
      return paths;
    }
  }
};

__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core___default.a.Operations.SelectiveBlurOperation = SelectiveBlurOperation;

/* harmony default export */ __webpack_exports__["a"] = (SelectiveBlurOperation);

/***/ }),
/* 317 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor__ = __webpack_require__(7);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__control_point__ = __webpack_require__(318);






var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor___default()(object, property); if (desc === undefined) { var parent = __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if ("value" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




/**
 * A path that can be drawn on a {@link PhotoEditorSDK.Operations.SpriteOperation.BrushSprite}. Should only be
 * created using {@link PhotoEditorSDK.Operations.SpriteOperation.BrushSprite#createPath}
 * @class
 * @extends PhotoEditorSDK.EventEmitter
 * @memberof PhotoEditorSDK.Operations.SpriteOperation.BrushSprite
 */

var Path = function (_Configurable) {
  _inherits(Path, _Configurable);

  /**
   * Creates a Path
   * @param  {PhotoEditorSDK.Operations.SpriteOperation.BrushSprite} operation
   * @param  {Object} options
   * @param  {HTMLCanvasElement} canvas
   */
  function Path(operation, options, canvas) {
    _classCallCheck(this, Path);

    var _this = _possibleConstructorReturn(this, (Path.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(Path)).call(this, options));

    _this._operation = operation;

    _this._canvas = canvas || __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Utils"].createCanvas();
    _this._context = _this._canvas.getContext('2d');
    return _this;
  }

  /**
   * Returns a serialized version of the given option
   * @param {String} optionName
   * @param {Boolean} toObject = false
   * @return {*}
   */


  _createClass(Path, [{
    key: 'serializeOption',
    value: function serializeOption(optionName) {
      var toObject = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;

      if (optionName === 'controlPoints') {
        return this._options.controlPoints.map(function (controlPoint) {
          var position = controlPoint.getPosition();
          return toObject ? position.toObject() : position.clone();
        });
      }

      return _get(Path.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(Path.prototype), 'serializeOption', this).call(this, optionName, toObject);
    }

    /**
     * Checks if the given option has the given value
     * @param  {String} optionName
     * @param  {*} value
     * @return {Boolean}
     * @private
     */

  }, {
    key: '_optionEquals',
    value: function _optionEquals(optionName, value) {
      if (optionName === 'controlPoints') {
        var controlPoints = this._options.controlPoints;
        for (var i = 0, l = controlPoints.length; i < l; i++) {
          if (!controlPoints[i].getPosition().equals(value[i])) {
            return false;
          }
        }
        return true;
      }

      return _get(Path.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(Path.prototype), '_optionEquals', this).call(this, optionName, value);
    }

    /**
     * Draws this path onto its canvas
     * @param {PhotoEditorSDK.Math.Vector2} inputDimensions
     */

  }, {
    key: 'render',
    value: function render(inputDimensions) {
      var _options = this._options,
          controlPoints = _options.controlPoints,
          size = _options.size;

      if (controlPoints.length < 2) {
        return;
      }

      __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Utils"].ensureCanvasDimensions(this._canvas, inputDimensions);

      if (!this._brush || this._lastBrushSize !== size || !inputDimensions.equals(this._brushInputDimensions)) {
        this._brushInputDimensions = inputDimensions.clone();
        this._lastBrushSize = size;
      }

      var lastControlPoint = controlPoints[0];
      var controlPoint = lastControlPoint;
      for (var i = 1; i < controlPoints.length; i++) {
        controlPoint = controlPoints[i];
        controlPoint.renderToCanvas(this._options.brush.getBrushImage(inputDimensions), this._canvas, lastControlPoint);
        lastControlPoint = controlPoint;
      }
    }

    /**
     * Creates a brush from the given size, hardness and color
     * @param  {PhotoEditorSDK.Math.Vector2} inputDimensions
     * @return {HTMLCanvasElement}
     * @private
     */

  }, {
    key: '_createBrush',
    value: function _createBrush(inputDimensions) {
      var _options2 = this._options,
          size = _options2.size,
          hardness = _options2.hardness,
          color = _options2.color;

      var canvas = __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Utils"].createCanvas();
      canvas.width = canvas.height = Math.ceil(size * inputDimensions.min());

      var context = canvas.getContext('2d');

      // Brush always has 100% opacity
      color = color.clone();
      color.a = 1;

      if (canvas.width === 1) {
        context.fillStyle = color.toRGBA();
        context.fillRect(0, 0, 1, 1);
      } else {
        var gradient = context.createRadialGradient(canvas.width / 2, canvas.height / 2, Math.min(canvas.width / 2 - 1, canvas.width / 2 * hardness), canvas.width / 2, canvas.height / 2, canvas.width / 2);

        gradient.addColorStop(0, color.toRGBA());
        var transparentColor = color.clone();
        transparentColor.a = 0;
        gradient.addColorStop(1, transparentColor.toRGBA());

        context.fillStyle = gradient;
        context.fillRect(0, 0, canvas.width, canvas.height);
      }

      return canvas;
    }

    /**
     * Adds a control point at the given position to this path
     * @param {PhotoEditorSDK.Math.Vector2} position
     */

  }, {
    key: 'addControlPoint',
    value: function addControlPoint(position) {
      var controlPoint = new __WEBPACK_IMPORTED_MODULE_6__control_point__["a" /* default */](this, position);
      this._options.controlPoints.push(controlPoint);
      this.emit('update', this);
    }

    /**
     * Returns this path's canvas
     * @return {Canvas}
     */

  }, {
    key: 'getCanvas',
    value: function getCanvas() {
      return this._canvas;
    }

    /**
     * Sets the given canvas
     * @param {HTMLCanvasElement} canvas
     */

  }, {
    key: 'setCanvas',
    value: function setCanvas(canvas) {
      this._canvas = canvas;
      this._context = canvas.getContext('2d');
    }

    /**
     * Sets this path to dirty
     */

  }, {
    key: 'setDirty',
    value: function setDirty() {
      this._context.clearRect(0, 0, this._canvas.width, this._canvas.height);

      this._options.controlPoints.forEach(function (point) {
        point.setDirty();
      });
    }

    /**
     * Calls `iterator` for each control point
     * @param  {Function} iterator
     */

  }, {
    key: 'forEachControlPoint',
    value: function forEachControlPoint(iterator) {
      this._options.controlPoints.forEach(iterator);
    }

    /**
     * Renders this path to the given canvas with the right opacity
     * @param  {Canvas} canvas
     */

  }, {
    key: 'renderToCanvas',
    value: function renderToCanvas(canvas) {
      var context = canvas.getContext('2d');
      context.save();
      context.globalAlpha = this._options.brush.getColor().a;
      context.drawImage(this._canvas, 0, 0);
      context.restore();
    }

    /**
     * Returns the canvas dimension for this path
     * @return {PhotoEditorSDK.Math.Vector2}
     */

  }, {
    key: 'getCanvasDimensions',
    value: function getCanvasDimensions() {
      return this._canvasDimensions;
    }
  }]);

  return Path;
}(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Configurable"]);

Path.prototype.availableOptions = {
  id: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].STRING, default: function _default() {
      return __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Utils"].getUUID();
    } },
  brush: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].OBJECT, required: true },
  controlPoints: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].ARRAY, default: [] },
  closed: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].BOOLEAN, default: false }
};

/* harmony default export */ __webpack_exports__["a"] = (Path);

/***/ }),
/* 318 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_photoeditorsdk_core__);


var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */


var Vector2 = __WEBPACK_IMPORTED_MODULE_1_photoeditorsdk_core__["Math"].Vector2;

/**
 * A ControlPoint is a part of a {@link PhotoEditorSDK.Operations.SpriteOperation.BrushSprite.Path}, so a Path
 * consists of multiple ControlPoints. Should only be created using {@link PhotoEditorSDK.Operations.SpriteOperation.BrushSprite.Path#addControlPoint}
 * @class
 * @memberof PhotoEditorSDK.Operations.SpriteOperation.BrushSprite
 */

var ControlPoint = function () {
  /**
   * Creates a ControlPoint
   * @param  {PhotoEditorSDK.Operations.SpriteOperation.BrushSprite.Path} path
   * @param  {PhotoEditorSDK.Math.Vector2} position
   */
  function ControlPoint(path, position) {
    _classCallCheck(this, ControlPoint);

    this._path = path;
    this._drawnCanvases = [];
    this._position = position;
  }

  /**
   * Renders this ControlPoint to the given canvas
   * @param  {HTMLCanvasElement} brush
   * @param  {HTMLCanvasElement} canvas
   * @param  {PhotoEditorSDK.Operations.SpriteOperation.BrushSprite.ControlPoint} lastControlPoint
   */


  _createClass(ControlPoint, [{
    key: 'renderToCanvas',
    value: function renderToCanvas(brush, canvas, lastControlPoint) {
      if (this._drawnCanvases.indexOf(canvas) !== -1) {
        // This control point has already been drawn on this canvas. Ignore.
        return;
      }

      var canvasDimensions = new Vector2(canvas.width, canvas.height);

      var context = canvas.getContext('2d');
      var position = this._position.clone().multiply(canvasDimensions); // x2
      var lastPosition = lastControlPoint.getPosition().clone().multiply(canvasDimensions); // x1
      var distance = position.clone().subtract(lastPosition).len();
      var step = brush.width / 10;

      var i = 0;
      while (i <= distance) {
        var t = Math.max(0, Math.min(1, i / distance));
        var x = lastPosition.x + (position.x - lastPosition.x) * t;
        var y = lastPosition.y + (position.y - lastPosition.y) * t;

        context.drawImage(brush, x - brush.width / 2, y - brush.height / 2, brush.width, brush.height);
        i += step;
      }

      this._drawnCanvases.push(canvas);
    }

    /**
     * Sets the position
     * @param {PhotoEditorSDK.Math.Vector2} position
     */

  }, {
    key: 'setPosition',
    value: function setPosition(position) {
      this._position = position;
    }

    /**
     * Returns the position
     * @return {PhotoEditorSDK.Math.Vector2}
     */

  }, {
    key: 'getPosition',
    value: function getPosition() {
      return this._position.clone();
    }

    /**
     * Sets this ControlPoint to dirty
     */

  }, {
    key: 'setDirty',
    value: function setDirty() {
      this._drawnCanvases = [];
    }
  }]);

  return ControlPoint;
}();

/* harmony default export */ __webpack_exports__["a"] = (ControlPoint);

/***/ }),
/* 319 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__brush__ = __webpack_require__(130);





var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




var RadialBrush = function (_Brush) {
  _inherits(RadialBrush, _Brush);

  function RadialBrush() {
    _classCallCheck(this, RadialBrush);

    return _possibleConstructorReturn(this, (RadialBrush.__proto__ || __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default()(RadialBrush)).apply(this, arguments));
  }

  _createClass(RadialBrush, [{
    key: 'getBrushImage',

    /**
     * Returns the prepared brush image (colored and resized)
     * @param  {PhotoEditorSDK.Math.Vector2} inputDimensions
     * @return {HTMLImageElement|HTMLCanvasElement}
     */
    value: function getBrushImage(inputDimensions) {
      if (this._brush && this.optionsEqual(this._lastOptions) && inputDimensions.equals(this._lastInputDimensions)) {
        return this._brush;
      }

      var _options = this._options,
          size = _options.size,
          hardness = _options.hardness,
          color = _options.color;


      var canvas = __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Utils"].createCanvas();
      canvas.width = canvas.height = Math.ceil(size * inputDimensions.min());

      var context = canvas.getContext('2d');

      // Brush always has 100% opacity
      color = color.clone();
      color.a = 1;

      if (canvas.width === 1) {
        context.fillStyle = color.toRGBA();
        context.fillRect(0, 0, 1, 1);
      } else {
        var gradient = context.createRadialGradient(canvas.width / 2, canvas.height / 2, Math.min(canvas.width / 2 - 1, canvas.width / 2 * hardness), canvas.width / 2, canvas.height / 2, canvas.width / 2);

        gradient.addColorStop(0, color.toRGBA());
        var transparentColor = color.clone();
        transparentColor.a = 0;
        gradient.addColorStop(1, transparentColor.toRGBA());

        context.fillStyle = gradient;
        context.fillRect(0, 0, canvas.width, canvas.height);
      }

      this._lastOptions = this.serializeOptions(['size', 'color', 'hardness']);
      this._brush = canvas;
      this._lastInputDimensions = inputDimensions.clone();

      return canvas;
    }
  }]);

  return RadialBrush;
}(__WEBPACK_IMPORTED_MODULE_5__brush__["a" /* default */]);

/* harmony default export */ __webpack_exports__["a"] = (RadialBrush);


RadialBrush.identifier = 'imgly_brush_radial';

RadialBrush.prototype.availableOptions = __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Utils"].extend(__WEBPACK_IMPORTED_MODULE_5__brush__["a" /* default */].prototype.availableOptions, {
  hardness: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].NUMBER, default: 1 }
});

/***/ }),
/* 320 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__);





var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016 9elements GbmH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */



var MaskFilter = function (_Engine$Filter) {
  _inherits(MaskFilter, _Engine$Filter);

  function MaskFilter() {
    _classCallCheck(this, MaskFilter);

    var _this = _possibleConstructorReturn(this, (MaskFilter.__proto__ || __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default()(MaskFilter)).call(this));

    _this._fragmentSource = __webpack_require__(321);
    return _this;
  }

  /**
   * Applies this filter to the given inputTarget and renders it to
   * the given outputTarget using the CanvasRenderer
   * @param  {PhotoEditorSDK.Engine.CanvasRenderer} renderer
   * @param  {PhotoEditorSDK.Engine.RenderTarget} inputTarget
   * @param  {PhotoEditorSDK.Engine.RenderTarget} outputTarget
   * @param  {Boolean} clear = false
   * @private
   */


  _createClass(MaskFilter, [{
    key: '_applyCanvas',
    value: function _applyCanvas(renderer, inputTarget, outputTarget) {
      var clear = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;

      var inputCanvas = inputTarget.getCanvas();

      var inputContext = inputTarget.getContext();
      var outputContext = outputTarget.getContext();

      var _options = this._options,
          maskCanvas = _options.maskCanvas,
          filterCanvas = _options.filterCanvas;

      var maskContext = maskCanvas.getContext('2d');
      var filterContext = filterCanvas.getContext('2d');

      var maskPixels = maskContext.getImageData(0, 0, inputCanvas.width, inputCanvas.height).data;
      var existingImageData = inputContext.getImageData(0, 0, inputCanvas.width, inputCanvas.height);
      var existingPixels = existingImageData.data;
      var newPixels = filterContext.getImageData(0, 0, inputCanvas.width, inputCanvas.height).data;

      var alpha = void 0;
      for (var i = 0; i < inputCanvas.width * inputCanvas.height * 4; i += 4) {
        alpha = maskPixels[i] / 255;

        existingPixels[i] = alpha * newPixels[i] + (1 - alpha) * existingPixels[i];
        existingPixels[i + 1] = alpha * newPixels[i + 1] + (1 - alpha) * existingPixels[i + 1];
        existingPixels[i + 2] = alpha * newPixels[i + 2] + (1 - alpha) * existingPixels[i + 2];
      }

      outputContext.putImageData(existingImageData, 0, 0);
    }
  }]);

  return MaskFilter;
}(__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Engine"].Filter);

MaskFilter.prototype.availableOptions = {
  maskImage: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].NUMBER, default: 1, uniformType: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["UniformType"].INT },
  maskCanvas: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].OBJECT, default: null },
  filterImage: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].NUMBER, default: 2, uniformType: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["UniformType"].INT },
  filterCanvas: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].OBJECT, default: null }
};

/* harmony default export */ __webpack_exports__["a"] = (MaskFilter);

/***/ }),
/* 321 */
/***/ (function(module, exports) {

module.exports = "varying vec2 v_texCoord;\nuniform sampler2D u_image;\nuniform sampler2D u_filterImage;\nuniform sampler2D u_maskImage;\n\nvoid main() {\n  vec4 color0 = texture2D(u_image, v_texCoord);\n  vec4 color1 = texture2D(u_filterImage, v_texCoord);\n  vec4 mask = texture2D(u_maskImage, v_texCoord);\n  gl_FragColor = mix(color0, color1, mask);\n}\n"

/***/ }),
/* 322 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign__ = __webpack_require__(79);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_own_property_descriptor__ = __webpack_require__(7);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_own_property_descriptor___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_own_property_descriptor__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__shared_sprite__ = __webpack_require__(60);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__sprites_sticker_sprite__ = __webpack_require__(323);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9__sprites_text_sprite__ = __webpack_require__(324);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10__shared_sprites_brush_sprite__ = __webpack_require__(129);







var _extends = __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign___default.a || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_own_property_descriptor___default()(object, property); if (desc === undefined) { var parent = __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default()(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if ("value" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */








/**
 * An operation that can draw sprites (text and stickers) on the canvas
 * @class
 * @extends PhotoEditorSDK.Operation
 * @memberof PhotoEditorSDK.Operations
 */

var SpriteOperation = function (_Operation) {
  _inherits(SpriteOperation, _Operation);

  /**
   * Creates a new SpriteOperation
   * @param  {PhotoEditorSDK} sdk
   * @param  {Object} [options]
   */
  function SpriteOperation() {
    var _ref;

    _classCallCheck(this, SpriteOperation);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this = _possibleConstructorReturn(this, (_ref = SpriteOperation.__proto__ || __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default()(SpriteOperation)).call.apply(_ref, [this].concat(args)));

    _this.setSmoothDownscaling(_this._sdk.getOptions().smoothDownscaling);

    _this._onSpriteUpdate = _this._onSpriteUpdate.bind(_this);

    var sprites = _this._options.sprites.slice();
    sprites.forEach(function (sprite) {
      _this.removeSprite(sprite);
      _this.addSprite(sprite);
    });
    return _this;
  }

  /**
   * Returns the sprites that are instances of the given class
   * @param  {Class} Klass
   * @return {PhotoEditorSDK.Sprite[]}
   */


  _createClass(SpriteOperation, [{
    key: 'getSpritesOfType',
    value: function getSpritesOfType(Klass) {
      return this._options.sprites.filter(function (sprite) {
        return sprite instanceof Klass;
      });
    }

    /**
     * Applies a rotation with the given degrees
     * @param  {Number} degrees
     * @private
     */

  }, {
    key: 'rotate',
    value: function rotate(degrees) {
      this._options.sprites.forEach(function (sprite) {
        sprite.applyRotation(degrees);
      });
    }

    /**
     * Applies a flip with the given direction
     * @param  {String} direction
     * @private
     */

  }, {
    key: 'flip',
    value: function flip(direction) {
      this._options.sprites.forEach(function (sprite) {
        sprite.applyFlip(direction);
      });
    }

    /**
     * Gets called when a sprite is flagged as dirty / its options changed
     * @param  {PhotoEditorSDK.Sprite} sprite
     * @param  {Object} options
     * @private
     */

  }, {
    key: '_onSpriteUpdate',
    value: function _onSpriteUpdate(sprite, options) {
      this.emit('update', this);
      this.setDirty(true);
    }

    /**
     * Applies the given rotation change
     * @param  {PhotoEditorSDK.Operations.RotationOperation} operation
     * @param  {Object} options
     * @private
     */

  }, {
    key: '_applyRotation',
    value: function _applyRotation(operation, options) {
      this._options.sprites.forEach(function (sprite) {
        return sprite.applyRotation(operation, options);
      });
    }

    /**
     * Applies the given transform change
     * @param  {PhotoEditorSDK.Operations.TransformOperation.TransformChange} transformChange
     * @private
     */

  }, {
    key: 'transform',
    value: function transform(transformChange) {
      this._options.sprites.forEach(function (sprite) {
        return sprite.applyTransform(transformChange);
      });
    }

    /**
     * Applies the given scale to all sprites
     * @param  {PhotoEditorSDK.Math.Vector2} scale
     */

  }, {
    key: 'scale',
    value: function scale(_scale) {
      this._options.sprites.forEach(function (sprite) {
        return sprite.applyScale(_scale);
      });
    }

    /**
     * Returns a serialized version of the given option
     * @param {String} optionName
     * @param {Boolean} toObject = false
     * @return {*} optionName
     * @private
     * @override
     */

  }, {
    key: 'serializeOption',
    value: function serializeOption(optionName) {
      var toObject = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;

      // Since `sprites` is an array of configurables, we need
      // to serialize them as well
      if (optionName === 'sprites') {
        return this._options.sprites.map(function (sprite) {
          return sprite.serializeOptions(undefined, toObject);
        });
      }
      return _get(SpriteOperation.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default()(SpriteOperation.prototype), 'serializeOption', this).call(this, optionName, toObject);
    }

    /**
     * Creates a new sticker object and returns it
     * @param  {Object} options
     * @return {PhotoEditorSDK.Operations.SpriteOperation.StickerSprite}
     */

  }, {
    key: 'createSticker',
    value: function createSticker(options) {
      return new __WEBPACK_IMPORTED_MODULE_8__sprites_sticker_sprite__["a" /* default */](this, options);
    }

    /**
     * Creates a new sticker object and returns it
     * @param  {Object} options
     * @return {PhotoEditorSDK.Operations.SpriteOperation.TextSprite}
     */

  }, {
    key: 'createText',
    value: function createText(options) {
      return new __WEBPACK_IMPORTED_MODULE_9__sprites_text_sprite__["a" /* default */](this, options);
    }

    /**
     * Creates a brush object and returns it
     * @param  {Object} options
     * @return {PhotoEditorSDK.Operations.SpriteOperation.BrushSprite}
     */

  }, {
    key: 'createBrush',
    value: function createBrush(options) {
      return new __WEBPACK_IMPORTED_MODULE_10__shared_sprites_brush_sprite__["a" /* default */](this, options);
    }

    /**
     * Gets called when a sprite has been added
     * @param {PhotoEditorSDK.Sprite} sprite
     */

  }, {
    key: 'addSprite',
    value: function addSprite(sprite) {
      this._options.sprites.push(sprite);

      var smoothDownscaling = this.getSmoothDownscaling();
      sprite.setSmoothDownscaling && sprite.setSmoothDownscaling(smoothDownscaling);

      this._container.addChild(sprite.getDisplayObject());

      // This operation needs to be rerendered
      this.setDirty(true);

      sprite.on('update', this._onSpriteUpdate);
      this.emit('update', this, this._options.sprites);
    }

    /**
     * Removes the given sprite from the list of sprites
     * @param  {PhotoEditorSDK.Sprite} sprite
     * @return {Boolean}
     */

  }, {
    key: 'removeSprite',
    value: function removeSprite(sprite) {
      var sprites = this._options.sprites;
      var index = sprites.indexOf(sprite);
      if (index !== -1) {
        sprite.off('update', this._onSpriteUpdate);
        this._container.removeChild(sprite.getDisplayObject());
        sprites.splice(index, 1);

        // This operation needs to be rerendered
        this.setDirty(true);

        return true;
      }
      return false;
    }

    /**
     * Renders this operation
     * @param {PhotoEditorSDK.Engine.Texture} inputTexture
     * @returns {Promise}
     * @override
     * @private
     */

  }, {
    key: '_render',
    value: function _render(inputTexture) {
      var _this2 = this;

      var container = this._container;
      var sprites = this._options.sprites;

      var inputDimensions = inputTexture.getDimensions().clone().floor();
      return __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["Promise"].all(sprites.map(function (s) {
        return s.validateSettings();
      })).then(function () {
        sprites.forEach(function (sprite) {
          return sprite.update(_this2._sdk, inputDimensions);
        });
      }).then(function () {
        _this2._renderTexture.clear();
        _this2._renderTexture.render(container);
      });
    }

    /**
     * Takes the given Sprite to front
     * @param  {PhotoEditorSDK.Operations.SpriteOperation.Sprite} sprite
     */

  }, {
    key: 'takeSpriteToFront',
    value: function takeSpriteToFront(sprite) {
      var sprites = this._options.sprites;

      var spriteIndex = sprites.indexOf(sprite);
      if (spriteIndex === -1) return;

      __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["Utils"].moveArrayItem(sprites, spriteIndex, sprites.length - 1);

      var displayObject = sprite.getDisplayObject();
      this._container.removeChild(displayObject);
      this._container.addChild(displayObject);

      this.setDirty(true);
    }

    /**
     * Returns the sprites at the given position on the canvas
     * @param  {PhotoEditorSDK.Math.Vector2} position
     * @param  {PhotoEditorSDK.Math.Vector2} inputDimensions
     * @return {PhotoEditorSDK.Sprite[]}
     */

  }, {
    key: 'getSpritesAtPosition',
    value: function getSpritesAtPosition(position, inputDimensions) {
      var _this3 = this;

      var intersectingSprites = [];

      this._options.sprites.forEach(function (s) {
        return s.update(_this3._sdk, inputDimensions);
      });

      // Translate canvas position to relative position on sprite by
      // applying the inverse of our outputSprite's world transform matrix
      var outputSprite = this._sdk.getSprite();
      var actualPosition = outputSprite.getWorldTransform().applyInverseToVector(position);

      // Apply anchor

      var _outputSprite$getText = outputSprite.getTexture().getFrame(),
          width = _outputSprite$getText.width,
          height = _outputSprite$getText.height;

      var anchorOffset = outputSprite.getAnchor().clone().multiply(-width, -height);
      actualPosition.subtract(anchorOffset);

      // Note: `actualPosition` is now the pixel position on the output sprite, NOT
      // on the sticker / text / brush

      // Find intersecting sprite
      var sprites = this._options.sprites.slice(0).reverse();
      for (var i = 0, c = sprites.length; i < c; i++) {
        var sprite = sprites[i];
        if (sprite.getHitTestDisplayObject().isAtPosition(actualPosition)) {
          intersectingSprites.push(sprite);
        }
      }

      return intersectingSprites;
    }

    /**
     * Sets the dirtiness for the given renderer
     * @param {Boolean} dirty
     * @param {PhotoEditorSDK.Engine.BaseRenderer} renderer
     * @param {Boolean} dimensionsChanged = false
     */

  }, {
    key: 'setDirtyForRenderer',
    value: function setDirtyForRenderer(dirty, renderer, dimensionsChanged) {
      _get(SpriteOperation.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default()(SpriteOperation.prototype), 'setDirtyForRenderer', this).call(this, dirty, renderer, dimensionsChanged);
      this._options.sprites.forEach(function (sprite) {
        sprite.setDirtyForRenderer(dirty, renderer, dimensionsChanged);
      });
    }

    /**
     * Disposes this operation
     */

  }, {
    key: 'dispose',
    value: function dispose() {
      _get(SpriteOperation.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default()(SpriteOperation.prototype), 'dispose', this).call(this);
      this._options.sprites.forEach(function (sprite) {
        sprite.dispose();
      });
    }
  }]);

  return SpriteOperation;
}(__WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["Operation"]);

SpriteOperation.StickerSprite = __WEBPACK_IMPORTED_MODULE_8__sprites_sticker_sprite__["a" /* default */];
SpriteOperation.TextSprite = __WEBPACK_IMPORTED_MODULE_9__sprites_text_sprite__["a" /* default */];
SpriteOperation.BrushSprite = __WEBPACK_IMPORTED_MODULE_10__shared_sprites_brush_sprite__["a" /* default */];

/**
 * A unique string that identifies this operation. Can be used to select
 * operations.
 * @type {String}
 * @default
 */
SpriteOperation.identifier = 'sprite';

/**
 * Specifies the available options for this operation
 * @type {Object}
 * @ignore
 */
SpriteOperation.prototype.availableOptions = {
  sprites: {
    type: __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["OptionType"].ARRAY,
    default: [],
    setter: function setter(sprites, initial) {
      var _this4 = this;

      sprites = sprites.map(function (sprite, i) {
        if (sprite instanceof __WEBPACK_IMPORTED_MODULE_7__shared_sprite__["a" /* default */]) {
          return sprite;
        }

        var spriteData = _extends({}, sprite);
        delete spriteData.type;

        // Create sprite from the given options
        switch (sprite.type) {
          case 'text':
            return new __WEBPACK_IMPORTED_MODULE_9__sprites_text_sprite__["a" /* default */](_this4, spriteData);
          case 'sticker':
            return new __WEBPACK_IMPORTED_MODULE_8__sprites_sticker_sprite__["a" /* default */](_this4, spriteData);
          case 'brush':
            return new __WEBPACK_IMPORTED_MODULE_10__shared_sprites_brush_sprite__["a" /* default */](_this4, spriteData);
          default:
            __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["Log"].error(_this4.constructor.name, 'Invalid sprite type: ' + sprite.type);
        }
      });

      // Remove all sprites
      if (!initial) {
        if (this._options.sprites) {
          var spritesToRemove = this._options.sprites.slice();
          spritesToRemove.forEach(function (sprite) {
            sprite.dispose();
            _this4.removeSprite(sprite);
          });
        }

        // Add all sprites
        sprites.forEach(function (sprite) {
          _this4.addSprite(sprite);
        });
      }

      return sprites;
    }
  },
  smoothDownscaling: { type: __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["OptionType"].BOOLEAN, default: false }
};

__WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core___default.a.Operations.SpriteOperation = SpriteOperation;

/* harmony default export */ __webpack_exports__["a"] = (SpriteOperation);

/***/ }),
/* 323 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor__ = __webpack_require__(7);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__shared_sprite__ = __webpack_require__(60);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__shared_filters_adjustments_filter__ = __webpack_require__(125);






var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor___default()(object, property); if (desc === undefined) { var parent = __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if ("value" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




var Vector2 = __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Math"].Vector2,
    ColorMatrix = __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Math"].ColorMatrix;

/**
 * A sticker that can be drawn by SpriteOperation. Should only be created via {@link PhotoEditorSDK.Operations.SpriteOperation#createSticker}
 * @class
 * @memberof PhotoEditorSDK.Operations.SpriteOperation
 */

var StickerSprite = function (_Sprite) {
  _inherits(StickerSprite, _Sprite);

  /**
   * Creates a new Sticker
   * @param  {PhotoEditorSDK.Operations.SpriteOperation} operation
   * @param  {Object} [options]
   */
  function StickerSprite() {
    var _ref;

    _classCallCheck(this, StickerSprite);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this = _possibleConstructorReturn(this, (_ref = StickerSprite.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(StickerSprite)).call.apply(_ref, [this].concat(args)));

    var image = _this._options.image;


    var src = image.src || image.filePath;
    _this._isSVG = src && !!src.match(/\w+\.svg(?=\?|$)/i);
    if (_this._isSVG) {
      _this._canvas = __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Utils"].createCanvas();
      _this._context = _this._canvas.getContext('2d');
      _this._options.smoothDownscaling = false;
    }

    if (image) {
      _this._onImageUpdate();
    }

    _this._tintFilter = new __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Engine"].Filters.TintFilter();
    _this._adjustmentsFilter = new __WEBPACK_IMPORTED_MODULE_7__shared_filters_adjustments_filter__["a" /* default */]();
    _this._lastRenderedDimensions = Vector2.NULL;
    _this._lastRenderedInputDimensions = Vector2.NULL;

    _this._onOptionsChange = _this._onOptionsChange.bind(_this);
    _this._options.adjustments.on('update', _this._onOptionsChange);
    return _this;
  }

  /**
   * Applies the given scale to this sprite
   * @param  {PhotoEditorSDK.Math.Vector2} scale
   */


  _createClass(StickerSprite, [{
    key: 'applyScale',
    value: function applyScale(scale) {
      this.setDimensions(this.getDimensions().multiply(scale));
    }

    /**
     * Returns a serialized version of this configurable
     * @param {String[]} keys
     * @param {Boolean} toObject = false
     * @return {Object}
     */

  }, {
    key: 'serializeOptions',
    value: function serializeOptions(keys) {
      var toObject = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;

      var options = _get(StickerSprite.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(StickerSprite.prototype), 'serializeOptions', this).call(this, keys, toObject);
      if (!keys) options.type = 'sticker';
      return options;
    }

    /**
     * Checks if this sprite should be rendered to a render texture
     * @param  {PhotoEditorSDK} sdk
     * @return {Boolean}
     * @private
     */

  }, {
    key: '_rendersToRenderTexture',
    value: function _rendersToRenderTexture(sdk) {
      var smoothDownscaling = this._options.smoothDownscaling && !this._isSVG && sdk.getRenderer().isOfType(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["RendererType"].WEBGL);
      return smoothDownscaling || this._hasAdjustments() || this._options.tintMode !== 'none';
    }

    /**
     * Returns the texture for the sprite that should be rendered
     * @return {PhotoEditorSDK.Engine.Texture}
     * @private
     * @abstract
     */

  }, {
    key: '_getTexture',
    value: function _getTexture() {
      return this._inputTexture;
    }

    /**
     * Updates this sprite
     * @param  {PhotoEditorSDK} sdk
     * @param  {PhotoEditorSDK.Math.Vector2} inputDimensions
     */

  }, {
    key: 'update',
    value: function update(sdk, inputDimensions) {
      var _options = this._options,
          dimensions = _options.dimensions,
          image = _options.image;

      if (dimensions.equals(Vector2.NULL)) {
        dimensions.set(image.width, image.height);
      }

      this._sprite.setSmoothDownscaling(this._isSVG ? false : this.getSmoothDownscaling());

      var isDirty = !this._lastRenderedInputDimensions.equals(inputDimensions) || !this._lastRenderedDimensions.equals(dimensions) || this._lastRenderedImage !== image;

      if (isDirty && this._isSVG && sdk.getRenderer().isOfType(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["RendererType"].WEBGL)) {
        image.width = dimensions.x;
        image.height = dimensions.y;

        // Workaround for Chromium Bug, still present in Safari
        // https://bugs.chromium.org/p/chromium/issues/detail?id=500180
        this._canvas.width = image.width;
        this._canvas.height = image.height;
        this._context.clearRect(0, 0, image.width, image.height);
        this._context.drawImage(image, 0, 0, image.width, image.height);

        this._inputTexture.getBaseTexture().update();
      }

      if (this._rendersToRenderTexture(sdk)) {
        this._prepareRenderTexture(sdk);
      }

      var filters = [];

      // @todo: Don't update the filters every tick, instead update them when options change.
      //        This will shorten this method and clean up the code
      if (this._rendersToRenderTexture(sdk)) {
        // Stickers with adjustments are rendered to a render texture that
        // can be re-used
        if (this._hasAdjustments()) {
          // Apply adjustments
          filters.push(this._adjustmentsFilter);

          var adjustments = this._options.adjustments;

          var colorMatrix = new ColorMatrix();
          colorMatrix.multiply(ColorMatrix.createBrightnessMatrix(adjustments.getBrightness()));
          colorMatrix.multiply(ColorMatrix.createSaturationMatrix(adjustments.getSaturation()));
          colorMatrix.multiply(ColorMatrix.createContrastMatrix(adjustments.getContrast()));

          this._adjustmentsFilter.set({
            colorMatrix: colorMatrix
          });
        }

        if (this._options.tintMode && this._options.tintMode !== 'none') {
          filters.push(this._tintFilter);
          this._tintFilter.set({
            mode: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Engine"].Filters.TintFilter.MODES[this._options.tintMode.toUpperCase()],
            color: this._options.tintColor
          });
        }
        this._renderTextureSprite.setFilters(filters);
      }

      if (this._rendersToRenderTexture(sdk)) {
        this._renderToRenderTexture(sdk);
      } else {
        this._sprite.setTexture(this._inputTexture);
      }
      this._updateSprite(inputDimensions);
      this._applyFlip();

      this._lastRenderedDimensions.copy(dimensions);
      this._lastRenderedInputDimensions.copy(inputDimensions);
      this._lastRenderedImage = image;
    }

    /**
     * If flip is enabled, this flips the sprite
     * @private
     */

  }, {
    key: '_applyFlip',
    value: function _applyFlip() {
      var scale = this._sprite.getScale();
      if (this._options.flipVertically) {
        scale.y *= -1;
      }
      if (this._options.flipHorizontally) {
        scale.x *= -1;
      }
      this._sprite.setScale(scale);
    }

    /**
     * Applies a flip in the given direction
     * @param  {String} direction
     */

  }, {
    key: 'applyFlip',
    value: function applyFlip(direction) {
      _get(StickerSprite.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(StickerSprite.prototype), 'applyFlip', this).call(this, direction);

      var options = {
        rotation: this._options.rotation
      };

      var degrees = options.rotation / Math.PI * 180;
      var newDegrees = degrees * -1;
      options.rotation = newDegrees * Math.PI / 180;

      switch (direction) {
        case 'horizontal':
          options.flipHorizontally = !this._options.flipHorizontally;
          this.set(options);
          break;
        case 'vertical':
          options.flipVertically = !this._options.flipVertically;
          this.set(options);
          break;
      }
    }

    /**
     * Checks if this sticker has any adjustments and a filter is needed
     * @return {Boolean}
     * @private
     */

  }, {
    key: '_hasAdjustments',
    value: function _hasAdjustments() {
      var adjustments = this._options.adjustments;
      return adjustments.getBrightness() !== 0 || adjustments.getSaturation() !== 1 || adjustments.getContrast() !== 1;
    }

    /**
     * Gets called when this sticker's image is updated
     * @private
     */

  }, {
    key: '_onImageUpdate',
    value: function _onImageUpdate() {
      var textureImage = this._options.image;
      var renderer = this._operation.getSDK().getRenderer();
      if (this._isSVG && renderer.isOfType(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["RendererType"].WEBGL)) {
        textureImage = this._canvas;
      }
      this._inputTexture = __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Engine"].Texture.fromImage(textureImage);
      this._identitySprite.setTexture(this._inputTexture);
      this._sprite.setTexture(this._inputTexture);

      if (this._renderTexture) {
        this._renderTextureSprite.setTexture(this._inputTexture);
        this._renderTexture.resizeTo(this._inputTexture.getDimensions());
      }
      this.setDirty(true);
    }

    /**
     * Sets the value for the given option, validates it
     * @param {String} optionName
     * @param {*} value
     * @param {Boolean} update = true
     * @override
     */

  }, {
    key: 'setOption',
    value: function setOption(optionName, value) {
      var update = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;

      _get(StickerSprite.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(StickerSprite.prototype), 'setOption', this).call(this, optionName, value, update);

      if (optionName === 'image' && this._identitySprite) {
        this._onImageUpdate();
      }
    }

    /**
     * Gets called when options have been changed. Sets this sprite to dirty.
     * @private
     */

  }, {
    key: '_onOptionsChange',
    value: function _onOptionsChange() {
      var dirtiness = this._dirtiness;
      for (var id in dirtiness) {
        dirtiness[id] = true;
      }
    }

    /**
     * Disposes this sprite
     */

  }, {
    key: 'dispose',
    value: function dispose() {
      _get(StickerSprite.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(StickerSprite.prototype), 'dispose', this).call(this);
      this._inputTexture.getBaseTexture().dispose();
      this._inputTexture = null;
      this._options.adjustments.off('updated', this._onOptionsChange);
    }
  }]);

  return StickerSprite;
}(__WEBPACK_IMPORTED_MODULE_6__shared_sprite__["a" /* default */]);

StickerSprite.prototype.availableOptions = {
  id: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].STRING, default: function _default() {
      return __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Utils"].getUUID();
    } },
  identifier: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].STRING, default: '' },
  image: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].IMAGE, required: true },
  position: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].VECTOR2, default: Vector2.NULL },
  dimensions: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].VECTOR2, default: Vector2.NULL },
  anchor: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].VECTOR2, default: new Vector2(0.0, 0.0) },
  pivot: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].VECTOR2, default: new Vector2(0.5, 0.5) },
  rotation: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].NUMBER, default: 0 },
  flipHorizontally: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].BOOLEAN, default: false },
  flipVertically: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].BOOLEAN, default: false },
  smoothDownscaling: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].BOOLEAN, default: false },
  tintColor: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].COLOR, default: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Color"].WHITE },
  tintMode: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].STRING, default: 'none', available: ['none', 'solid', 'colorized'] },
  alpha: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].NUMBER, default: 1 },
  adjustments: {
    type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].CONFIGURABLE,
    structure: {
      brightness: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].NUMBER, default: 0 },
      saturation: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].NUMBER, default: 1 },
      contrast: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].NUMBER, default: 1 }
    }
  }
};

StickerSprite.type = 'sticker';

/* harmony default export */ __webpack_exports__["a"] = (StickerSprite);

/***/ }),
/* 324 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor__ = __webpack_require__(7);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__shared_sprite__ = __webpack_require__(60);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__text_text_renderer__ = __webpack_require__(325);






var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor___default()(object, property); if (desc === undefined) { var parent = __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if ("value" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




var Vector2 = __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Math"].Vector2;

/**
 * A text that can be drawn by SpriteOperation. Should only be created via {@link PhotoEditorSDK.Operations.SpriteOperation#createText}
 * @class
 * @memberof PhotoEditorSDK.Operations.SpriteOperation
 */

var TextSprite = function (_Sprite) {
  _inherits(TextSprite, _Sprite);

  /**
   * Creates a new Text
   * @param  {PhotoEditorSDK.Operations.SpriteOperation} operation
   * @param  {Object} [options]
   */
  function TextSprite() {
    var _ref;

    _classCallCheck(this, TextSprite);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this = _possibleConstructorReturn(this, (_ref = TextSprite.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(TextSprite)).call.apply(_ref, [this].concat(args)));

    _this._textRenderer = new __WEBPACK_IMPORTED_MODULE_7__text_text_renderer__["a" /* default */](_this, _this._operation);
    _this._textRenderer.rotation = _this.getRotation();
    _this._sprite.setTexture(_this._textRenderer.getFinalTexture());
    _this._hitTestSprite.setTexture(_this._textRenderer.getTexture());
    return _this;
  }

  /**
   * Returns a serialized version of this configurable
   * @param {String[]} keys
   * @param {Boolean} toObject = false
   * @return {Object}
   */


  _createClass(TextSprite, [{
    key: 'serializeOptions',
    value: function serializeOptions(keys) {
      var toObject = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;

      var options = _get(TextSprite.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(TextSprite.prototype), 'serializeOptions', this).call(this, keys, toObject);
      if (!keys) options.type = 'text';
      return options;
    }

    /**
     * Returns a style object for this text
     * @param {PhotoEditorSDK} SDK
     * @param {PhotoEditorSDK.Math.Vector2} inputDimensions
     * @return {Object}
     */
    /* istanbul ignore next */

  }, {
    key: 'getDOMStyle',
    value: function getDOMStyle(sdk, inputDimensions) {
      var actualFontSize = this.getFontSize() * inputDimensions.y;

      return {
        fontWeight: this._options.fontWeight,
        fontSize: actualFontSize + 'px',
        fontStyle: this._options.fontStyle,
        fontFamily: this._options.fontFamily,
        lineHeight: this.getAbsoluteTextHeight(inputDimensions) * this.getLineHeight() + 'px',
        color: this._options.color.toRGBA(),
        backgroundColor: this._options.backgroundColor.toRGBA(),
        textAlign: this._options.alignment
      };
    }

    /**
     * Returns the absolute text height in pixels. The value is calculated
     * using the current fonts metrics, the font size and the given input dimensions.
     * If no font metrics are available, a fallback algorithm is used to determine
     * the absolute text height.
     * @param {PhotoEditorSDK.Math.Vector2} inputDimensions
     * @return {Float} Absolute text height in pixels
     */

  }, {
    key: 'getAbsoluteTextHeight',
    value: function getAbsoluteTextHeight(inputDimensions) {
      var actualFontSize = this.getFontSize() * inputDimensions.y;
      var textMetrics = this.getTextMetrics();

      if (textMetrics) {
        // The text height for the current font size is calculated
        // using the given font metrics.
        var scale = 1 / textMetrics.unitsPerEm * actualFontSize;
        var ascent = textMetrics.ascender * scale;
        var descent = textMetrics.descender * scale;
        return ascent + Math.abs(descent);
      } else {
        return actualFontSize * this.getLineHeight() * 1.1;
      }
    }

    /**
     * Returns the dimensions for this text
     * @param  {PhotoEditorSDK} sdk
     * @param  {PhotoEditorSDK.Math.Vector2} inputDimensions
     * @return {PhotoEditorSDK.Math.Vector2}
     */
    /* istanbul ignore next */

  }, {
    key: 'getDimensions',
    value: function getDimensions(sdk, inputDimensions) {
      return this._textRenderer.getDimensions(sdk, inputDimensions);
    }

    /**
     * Applies a flip in the given direction
     * @param  {String} direction
     */

  }, {
    key: 'applyFlip',
    value: function applyFlip(direction) {
      _get(TextSprite.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(TextSprite.prototype), 'applyFlip', this).call(this, direction);

      var rotation = this._options.rotation;
      switch (direction) {
        case 'horizontal':
          rotation += (Math.PI - rotation) * 2;
          this.setRotation(rotation);
          break;
        case 'vertical':
          rotation += (Math.PI / 2 - rotation) * 2;
          this.setRotation(rotation);
          break;
      }
    }

    /**
     * Applies a transform with the given options
     * @param  {PhotoEditorSDK.Operations.TransformOperation.TransformChange} transformChange
     */

  }, {
    key: 'applyTransform',
    value: function applyTransform(transformChange) {
      _get(TextSprite.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(TextSprite.prototype), 'applyTransform', this).call(this, transformChange);
      this.set({
        fontSize: transformChange.scaleSize(this.getFontSize(), 'y'),
        maxWidth: transformChange.scaleSize(this.getMaxWidth(), 'x')
      }, false);
    }

    /**
     * Applies a rotation with the given degrees
     * @param  {Number} degrees
     */

  }, {
    key: 'applyRotation',
    value: function applyRotation(degrees) {
      _get(TextSprite.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(TextSprite.prototype), 'applyRotation', this).call(this, degrees);

      var actualDegrees = (degrees + 360) % 360;
      var inputDimensions = this._operation.getInputDimensions();
      if (actualDegrees === 90 || actualDegrees === 270) {
        this.setMaxWidth(this.getMaxWidth() / inputDimensions.x * inputDimensions.y);
        this.setFontSize(this.getFontSize() / inputDimensions.y * inputDimensions.x);
      }
    }
  }, {
    key: 'setOption',
    value: function setOption(key, value) {
      if (key === 'rotation') {
        this._options.rotation = value;
        if (this._textRenderer) {
          this._textRenderer.rotation = value;
        }
        this._rotation = value;
        this.emit('update');
        return;
      }

      _get(TextSprite.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(TextSprite.prototype), 'setOption', this).call(this, key, value);
    }
  }, {
    key: 'getOption',
    value: function getOption(key) {
      if (key === 'rotation') {
        return this._rotation;
      }
      return _get(TextSprite.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(TextSprite.prototype), 'getOption', this).call(this, key);
    }
  }, {
    key: 'getHitTestDisplayObject',
    value: function getHitTestDisplayObject() {
      return this._hitTestSprite;
    }

    /**
     * Updates this sprite
     * @param  {PhotoEditorSDK} sdk
     * @param  {PhotoEditorSDK.Math.Vector2} inputDimensions
     */

  }, {
    key: 'update',
    value: function update(sdk, inputDimensions) {
      this._sprite.setVisible(this._options.visible);
      if (!this._options.visible) return;

      // Re-render text
      this._textRenderer.update(sdk, inputDimensions);

      var textTexture = this._textRenderer.getFinalTexture();
      var baseTexture = textTexture.getBaseTexture();
      baseTexture.update();

      // Upload texture
      var renderer = sdk.getRenderer();

      /* istanbul ignore next */
      if (renderer.isOfType(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["RendererType"].WEBGL)) {
        renderer.updateTexture(textTexture.getBaseTexture());
      }
      _get(TextSprite.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(TextSprite.prototype), 'update', this).call(this, sdk, inputDimensions);

      this._sprite.setRotation(0);

      this._textRenderer.getTexture().getBaseTexture().update();
      this._hitTestSprite.setRotation(this._rotation);
      this._hitTestSprite.updateTransform();
    }

    /**
     * Returns the texture for the sprite that should be rendered
     * @return {PhotoEditorSDK.Engine.Texture}
     * @private
     * @abstract
     */

  }, {
    key: '_getTexture',
    value: function _getTexture() {
      return this._textRenderer.getFinalTexture();
    }

    /**
     * Cleans up this Sprite
     */

  }, {
    key: 'dispose',
    value: function dispose() {
      _get(TextSprite.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(TextSprite.prototype), 'dispose', this).call(this);
      this._textRenderer.dispose();
    }
  }]);

  return TextSprite;
}(__WEBPACK_IMPORTED_MODULE_6__shared_sprite__["a" /* default */]);

TextSprite.prototype.availableOptions = {
  id: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].STRING, default: function _default() {
      return __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Utils"].getUUID();
    } },
  fontSize: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].NUMBER, default: 0.1 },
  characterSpacing: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].NUMBER, default: 0 },
  lineHeight: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].NUMBER, default: 1.1 },
  fontIdentifier: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].STRING },
  fontFamily: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].STRING, default: 'Times New Roman' },
  fontWeight: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].ALL, default: 'normal' },
  fontStyle: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].STRING, default: 'normal' },
  textMetrics: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].OBJECT, default: null },
  outlineWidth: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].NUMBER, default: 0 },
  outlineColor: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].COLOR, default: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Color"].BLACK },
  alignment: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].STRING, default: 'left', available: ['left', 'center', 'right'] },
  verticalAlignment: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].STRING, default: 'top', available: ['top', 'center', 'bottom'] },
  color: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].COLOR, default: new __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Color"](1, 0, 0, 1) },
  backgroundColor: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].COLOR, default: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Color"].TRANSPARENT },
  position: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].VECTOR2, default: new Vector2(0.5, 0.5) },
  anchor: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].VECTOR2, default: new Vector2(0, 0) },
  pivot: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].VECTOR2, default: new Vector2(0.5, 0.5) },
  rotation: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].NUMBER, default: 0 },
  text: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].STRING, required: true },
  maxWidth: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].NUMBER, default: 0.5 },
  maxHeight: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].NUMBER, default: 0 },
  visible: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].BOOLEAN, default: true }
};

TextSprite.type = 'text';

/* harmony default export */ __webpack_exports__["a"] = (TextSprite);

/***/ }),
/* 325 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__text_splitter__ = __webpack_require__(326);


var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */



var Vector2 = __WEBPACK_IMPORTED_MODULE_1_photoeditorsdk_core__["Math"].Vector2;

var TextRenderer = function () {
  function TextRenderer(text, operation) {
    _classCallCheck(this, TextRenderer);

    this._text = text;
    this._operation = operation;
    this._textOptions = {};

    this.rotation = 0;

    this._createCanvas();
    this._createTexture();
  }

  /**
   * Creates the canvas and initializes the text splitter
   * @private
   */


  _createClass(TextRenderer, [{
    key: '_createCanvas',
    value: function _createCanvas() {
      this._canvas = __WEBPACK_IMPORTED_MODULE_1_photoeditorsdk_core__["Utils"].createCanvas();
      this._context = this._canvas.getContext('2d');
      this._textSplitter = new __WEBPACK_IMPORTED_MODULE_2__text_splitter__["a" /* default */](this._context);

      this._finalCanvas = __WEBPACK_IMPORTED_MODULE_1_photoeditorsdk_core__["Utils"].createCanvas();
      this._finalContext = this._finalCanvas.getContext('2d');
    }

    /**
     * Creates the texture
     * @private
     */

  }, {
    key: '_createTexture',
    value: function _createTexture() {
      this._texture = __WEBPACK_IMPORTED_MODULE_1_photoeditorsdk_core__["Engine"].Texture.fromCanvas(this._canvas);
      this._finalTexture = __WEBPACK_IMPORTED_MODULE_1_photoeditorsdk_core__["Engine"].Texture.fromCanvas(this._finalCanvas);
    }

    /**
     * Applies the text options on the given context
     * @param  {Object} textOptions
     * @param  {CanvasRenderingContext2D} context
     * @private
     */

  }, {
    key: '_applyTextOptions',
    value: function _applyTextOptions(textOptions, context) {
      context.font = this._text.getFontStyle() + ' ' + this._text.getFontWeight() + ' ' + textOptions.fontSize + 'px ' + '"' + this._text.getFontFamily() + '"';

      context.textBaseline = 'top';
      context.textAlign = this._text.getAlignment();
      context.fillStyle = this._text.getColor().toRGBA();

      context.strokeStyle = this._text.getOutlineColor().toRGBA();
      var outlineWidth = this._text.getOutlineWidth();
      if (outlineWidth > 0) {
        context.lineWidth = outlineWidth;
      }
    }

    /**
     * Iterate over all lines and split them into multiple lines, depending
     * on the width they need
     * @param {Number} maxWidth
     * @return {Array.<string>}
     * @private
     */

  }, {
    key: '_buildOutputLines',
    value: function _buildOutputLines(maxWidth) {
      this._textSplitter.setText(this._text.getText());
      this._textSplitter.setMaxWidth(maxWidth);
      return this._textSplitter.getLines();
    }

    /**
     * Draws the given line onto context at the given Y position
     * @param  {String} text
     * @param  {Number} y
     * @private
     */

  }, {
    key: '_renderTextLine',
    value: function _renderTextLine(text, y) {
      var textAlignment = this._text.getAlignment();
      var drawPosition = new Vector2(0, y); // Left alignment

      switch (textAlignment) {
        case 'center':
          drawPosition.x = this._canvas.width / 2;
          break;
        case 'right':
          drawPosition.x = this._canvas.width;
          break;
      }

      this._context.fillText(text, drawPosition.x, drawPosition.y);
      var outlineWidth = this._text.getOutlineWidth();
      if (outlineWidth > 0) {
        this._context.miterLimit = 2;
        this._context.strokeText(text, drawPosition.x, drawPosition.y);
      }
    }

    /**
     * Renders this sprite
     * @param  {PhotoEditorSDK} sdk
     * @param  {PhotoEditorSDK.Math.Vector2} inputDimensions
     */

  }, {
    key: 'update',
    value: function update(sdk, inputDimensions) {
      var textOptions = this.calculateFontStyles(sdk, inputDimensions);
      if (textOptions) {
        var _calculateText2 = this._calculateText(sdk, textOptions, inputDimensions),
            dimensions = _calculateText2.dimensions,
            lines = _calculateText2.lines;

        this._renderText(sdk, dimensions, lines, textOptions, inputDimensions);
        this._updateFinalTexture();
      }
    }

    /**
     * Renders the rotated text on the final texture
     * @private
     */

  }, {
    key: '_updateFinalTexture',
    value: function _updateFinalTexture() {
      var _canvas = this._canvas,
          width = _canvas.width,
          height = _canvas.height;

      var rotation = this.rotation;
      var cos = Math.cos(rotation);
      var sin = Math.sin(rotation);

      var finalDimensions = new Vector2(Math.abs(width * cos) + Math.abs(height * sin), Math.abs(width * sin) + Math.abs(height * cos));

      this._finalCanvas.width = finalDimensions.x;
      this._finalCanvas.height = finalDimensions.y;

      this._finalContext.save();
      this._finalContext.translate(this._finalCanvas.width / 2, this._finalCanvas.height / 2);
      this._finalContext.rotate(rotation);
      this._finalContext.drawImage(this._canvas, -width / 2, -height / 2);
      this._finalContext.restore();
    }

    /**
     * Renders the text
     * @param  {PhotoEditorSDK} sdk
     * @param  {Vector2} dimensions
     * @param  {Array.<String>} lines
     * @param  {Object} textOptions
     * @param  {PhotoEditorSDK.Math.Vector2} inputDimensions
     * @private
     */

  }, {
    key: '_renderText',
    value: function _renderText(sdk, dimensions, lines, textOptions, inputDimensions) {
      // Resize the canvas
      this._canvas.width = dimensions.x;
      this._canvas.height = dimensions.y;

      if (this._text.getMaxHeight()) {
        this._canvas.height = Math.min(this._text.getMaxHeight() * inputDimensions.y, this._canvas.height);
      }

      // Update the context
      this._context = this._canvas.getContext('2d');

      // Render background color
      this._context.fillStyle = this._text.getBackgroundColor().toRGBA();
      this._context.fillRect(0, 0, dimensions.x, dimensions.y);

      // Apply text options
      this._applyTextOptions(textOptions, this._context);

      // Draw lines
      for (var lineNum = 0; lineNum < lines.length; lineNum++) {
        var line = lines[lineNum];
        this._renderTextLine(line, textOptions.topPadding + textOptions.lineHeight * lineNum);
      }
    }

    /**
     * Calculates the actual font size and line height
     * @param  {PhotoEditorSDK} sdk
     * @param  {PhotoEditorSDK.Math.Vector2} inputDimensions
     */

  }, {
    key: 'calculateFontStyles',
    value: function calculateFontStyles(sdk, inputDimensions) {
      var fontFamily = this._text.getFontFamily();
      var fontSize = this._text.getFontSize() * inputDimensions.y;
      var textHeight = this._text.getAbsoluteTextHeight(inputDimensions);
      var lineHeight = textHeight * this._text.getLineHeight();
      var topPadding = textHeight * (this._text.getLineHeight() - 1.0) / 2.0;

      var textOptions = { fontFamily: fontFamily, fontSize: fontSize, lineHeight: lineHeight, topPadding: topPadding };
      if (this._textOptions.fontFamily !== fontFamily || this._textOptions.fontSize !== fontSize || this._textOptions.lineHeight !== lineHeight) {
        this._textOptions = textOptions;
      }

      return textOptions;
    }

    /**
     * Calculates the dimensions and new lines according to max width
     * @param  {PhotoEditorSDK} sdk
     * @param  {Object} textOptions
     * @param  {PhotoEditorSDK.Math.Vector2} inputDimensions
     * @return {Object}
     * @private
     */

  }, {
    key: '_calculateText',
    value: function _calculateText(sdk, textOptions, inputDimensions) {
      // Calculate max width
      var maxWidth = this._text.getMaxWidth() * inputDimensions.x;

      // Apply text options
      this._applyTextOptions(textOptions, this._context);

      // Calculate bounding box
      var dimensions = new Vector2();
      var lines = this._text.getText().split('\n');
      if (typeof maxWidth !== 'undefined') {
        // Calculate the bounding box
        dimensions.x = maxWidth;
        lines = this._buildOutputLines(maxWidth);
      } else {
        for (var lineNum = 0; lineNum < lines.length; lineNum++) {
          var line = lines[lineNum];
          dimensions.x = Math.max(dimensions.x, this._context.measureText(line).width);
        }
      }

      // Calculate boundingbox height
      var lineHeight = textOptions.lineHeight;

      dimensions.y = lines.length * lineHeight;

      return { dimensions: dimensions, lines: lines };
    }

    /**
     * Returns this renderer's texture
     * @return {Engine.Texture}
     */

  }, {
    key: 'getTexture',
    value: function getTexture() {
      return this._texture;
    }

    /**
     * Returns this renderer's final texture containing the rotated text
     * @return {Engine.Texture}
     */

  }, {
    key: 'getFinalTexture',
    value: function getFinalTexture() {
      return this._finalTexture;
    }

    /**
     * Returns the dimensions for this text
     * @param  {PhotoEditorSDK} sdk
     * @param  {PhotoEditorSDK.Math.Vector2} inputDimensions
     * @return {Vector2}
     */

  }, {
    key: 'getDimensions',
    value: function getDimensions(sdk, inputDimensions) {
      var textOptions = this.calculateFontStyles(sdk, inputDimensions);

      var _calculateText3 = this._calculateText(sdk, textOptions, inputDimensions),
          dimensions = _calculateText3.dimensions;

      return dimensions;
    }

    /**
     * Disposes this text renderer
     */

  }, {
    key: 'dispose',
    value: function dispose() {
      if (this._measurementElement) {
        document.body.removeChild(this._measurementElement);
      }
      this._texture.getBaseTexture().dispose();
      this._texture = null;
      this._finalTexture.getBaseTexture().dispose();
      this._finalTexture = null;
    }
  }]);

  return TextRenderer;
}();

/* harmony default export */ __webpack_exports__["a"] = (TextRenderer);

/***/ }),
/* 326 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);


var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */

var TextSplitter = function () {
  function TextSplitter(context) {
    _classCallCheck(this, TextSplitter);

    this._context = context;
    this._lastFontStyle = {};
  }

  /**
   * Returns the lines that fit the maxWidth
   * @return {Array.<String>}
   */


  _createClass(TextSplitter, [{
    key: 'getLines',
    value: function getLines() {
      var _this = this;

      var lines = [];
      var newLineWords = [];

      // Iterate over lines
      var linesCount = this._lines.length;
      for (var l = 0; l < linesCount; l++) {
        var line = this._lines[l];

        // Iterate over words
        var words = this._buildWords(line);
        var wordsCount = words.length;
        for (var w = 0; w < wordsCount; w++) {
          var word = words[w];

          // Check if line is too wide for the maxwidth
          var currentLine = newLineWords.concat(word).join('').replace(/\s+$/i, '');
          var width = this._getWidth(currentLine);
          if (width > this._maxWidth) {
            // If there have been words before this one, start
            // a new line
            if (newLineWords.length > 0) {
              // Line too long -> line ended
              lines.push(newLineWords.join(''));

              // Start a new line with the word
              newLineWords = [word];
            }

            // If the next word is too long (without trailing spaces), split it up
            var _word = word.replace(/\s+$/i, '');
            if (this._getWidth(_word) > this._maxWidth) {
              var splitWord = this._splitWord(word);
              lines = lines.concat(splitWord.lines);
              if (splitWord.rest) {
                newLineWords = [splitWord.rest];
              }
            }
          } else {
            newLineWords.push(word);
          }
        }

        lines.push(newLineWords.join(''));

        newLineWords = [];
      }

      return lines.map(function (line) {
        return _this._trimLine(line, _this._context.textAlign);
      });
    }

    /**
     * Removes whitespaces based on alignment.
     * If the newline ends or begins with one or more whitespaces than remove the first/last depending on the aligment.
     * @param {String} line
     * @param {String} alignment
     * @return {String} line
     */

  }, {
    key: '_trimLine',
    value: function _trimLine(line, alignment) {
      return line; // FIXME: not supported by textarea yet. Enable later
      // switch (alignment) {
      //   case 'right':
      //     return line.replace(/\s{1}$/, '')
      //   case 'left':
      //     return line.replace(/^\s{1}/, '')
      //   case 'center':
      //   default:
      //     return line
      // }
    }

    /**
     * Builds an array of words from the given line
     * @param  {String} line
     * @return {Array.<String>}
     * @private
     */

  }, {
    key: '_buildWords',
    value: function _buildWords(line) {
      var words = [];
      var word = '';

      var len = line.length;
      for (var i = 0; i < len; i++) {
        var char = line[i];
        word += char;
        if (char === ' ' || char === '-' || i === len - 1) {
          words.push(word);
          word = '';
        }
      }

      return words;
    }

    /**
     * Splits up the given word to fit the max width
     * @param  {String} word
     * @return {Object}
     * @private
     */

  }, {
    key: '_splitWord',
    value: function _splitWord(word) {
      var response = {
        lines: [],
        rest: null
      };

      var wordLength = word.length;
      var chars = [];
      for (var c = 0; c < wordLength; c++) {
        var char = word[c];
        if (this._getWidth(chars.concat(char).join('')) > this._maxWidth) {
          if (chars.length > 0) {
            response.lines.push(chars.join(''));
          }
          chars = [char];
        } else {
          chars.push(char);
        }

        if (c === wordLength - 1 && chars.length > 0) {
          response.rest = chars.join('');
        }
      }

      return response;
    }

    /**
     * Checks if the font style changed from the last call
     * @return {Boolean}
     * @private
     */

  }, {
    key: '_fontStyleChanged',
    value: function _fontStyleChanged() {
      if (this._context.font !== this._lastFontStyle) {
        this._lastFontStyle = this._context.font;
        return true;
      }
      return false;
    }

    /**
     * Returns the measured width for the given string
     * @param  {String} string
     * @return {Number}
     * @private
     */

  }, {
    key: '_getWidth',
    value: function _getWidth(string) {
      return this._context.measureText(string).width;
    }

    /**
     * Sets the text
     * @param {String} text
     */

  }, {
    key: 'setText',
    value: function setText(text) {
      this._text = text;
      this._lines = text.split('\n');
    }

    /**
     * Sets the max width
     * @param {Number} maxWidth
     */

  }, {
    key: 'setMaxWidth',
    value: function setMaxWidth(maxWidth) {
      this._maxWidth = maxWidth;
    }
  }]);

  return TextSplitter;
}();

/* harmony default export */ __webpack_exports__["a"] = (TextSplitter);

/***/ }),
/* 327 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__transform_change__ = __webpack_require__(328);





var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */



var Vector2 = __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Math"].Vector2;

/**
 * An operation that can transform out a part of the image
 * @class
 * @extends PhotoEditorSDK.Operation
 * @memberof PhotoEditorSDK.Operations
 */

var TransformOperation = function (_Operation) {
  _inherits(TransformOperation, _Operation);

  function TransformOperation() {
    _classCallCheck(this, TransformOperation);

    return _possibleConstructorReturn(this, (TransformOperation.__proto__ || __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default()(TransformOperation)).apply(this, arguments));
  }

  _createClass(TransformOperation, [{
    key: '_render',

    // -------------------------------------------------------------------------- RENDERING

    /**
     * Transforms the image
     * @param {PhotoEditorSDK.Engine.RenderTexture} inputTexture
     * @returns {Promise}
     * @override
     * @private
     */
    value: function _render(inputTexture) {
      this._sprite.setRotation(0);

      var inputDimensions = inputTexture.getDimensions();
      var _options = this._options,
          start = _options.start,
          end = _options.end,
          rotation = _options.rotation,
          textureScale = _options.textureScale;


      var middle = start.clone().add(end.clone().subtract(start).divide(2));

      var scale = this.calculateScale();
      var finalScale = scale * textureScale;
      var outputDimensions = this.getNewDimensions(inputDimensions);
      this._sprite.setAnchor(middle);
      this._sprite.setRotation(rotation);
      this._sprite.setScale(finalScale, finalScale);
      this._sprite.setPosition(outputDimensions.clone().multiply(0.5));

      // Render the container to this Operation's RenderTexture
      this._renderTexture.render(this._container);

      return __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Promise"].resolve();
    }
  }, {
    key: 'calculateScale',
    value: function calculateScale() {
      var rotation = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this._options.rotation;

      var inputDimensions = this.getInputDimensions(false);

      var rotatedDimensions = new Vector2(Math.abs(inputDimensions.x * Math.cos(rotation)) + Math.abs(inputDimensions.y * Math.sin(rotation)), Math.abs(inputDimensions.x * Math.sin(rotation)) + Math.abs(inputDimensions.y * Math.cos(rotation)));

      var distanceToCorner = inputDimensions.clone().multiply(0.5);
      distanceToCorner.subtract(rotatedDimensions.clone().divide(2));
      distanceToCorner.abs();

      var scale = 1;
      if (distanceToCorner.y > distanceToCorner.x) {
        scale = distanceToCorner.y * 2 / inputDimensions.y + 1;
      } else {
        scale = distanceToCorner.x * 2 / inputDimensions.x + 1;
      }
      return scale;
    }

    /**
     * Returns the dimensions the given dimensions will have after this operation
     * has been applied
     * @param {PhotoEditorSDK.Math.Vector2} inputDimensions
     * @return {PhotoEditorSDK.Math.Vector2}
     * @override
     */

  }, {
    key: 'getNewDimensions',
    value: function getNewDimensions(inputDimensions) {
      var _options2 = this._options,
          start = _options2.start,
          end = _options2.end,
          textureScale = _options2.textureScale;

      var scale = this.calculateScale();
      return inputDimensions.clone().multiply(textureScale * scale).multiply(end.clone().subtract(start)).round();
    }

    /**
     * Flips this operation into the given direction
     * @param  {String} direction
     */

  }, {
    key: 'flip',
    value: function flip(direction) {
      var _options3 = this._options,
          start = _options3.start,
          end = _options3.end;

      var tmpStart = start.clone();

      if (direction === 'horizontal') {
        start.set(1.0 - end.x, start.y);
        end.set(1.0 - tmpStart.x, end.y);
      } else if (direction === 'vertical') {
        start.set(start.x, 1.0 - end.y);
        end.set(end.x, 1.0 - tmpStart.y);
      }
    }

    /**
     * Rotates this operation with the given degrees
     * @param {Number} degrees
     */

  }, {
    key: 'rotate',
    value: function rotate(degrees) {
      var _options4 = this._options,
          start = _options4.start,
          end = _options4.end;

      var degreesDifference = (degrees + 360) % 360;

      var steps = Math.floor(degreesDifference / 90);
      for (var i = 0; i < steps; i++) {
        var tempStart = start.clone();
        start.set(1.0 - end.y, tempStart.x);
        end.set(1.0 - tempStart.y, end.x);
      }
    }
  }]);

  return TransformOperation;
}(__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Operation"]);

/**
 * A unique string that identifies this operation. Can be used to select
 * operations.
 * @type {String}
 * @default
 */


TransformOperation.identifier = 'transform';

/**
 * Specifies the available options for this operation
 * @type {Object}
 * @ignore
 */
TransformOperation.prototype.availableOptions = {
  start: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].VECTOR2, default: new Vector2(0, 0) },
  end: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].VECTOR2, default: new Vector2(1, 1) },
  textureScale: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].NUMBER, default: 1 },
  rotation: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].NUMBER, default: 0 }
};

TransformOperation.TransformChange = __WEBPACK_IMPORTED_MODULE_5__transform_change__["a" /* default */];
__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core___default.a.Operations.TransformOperation = TransformOperation;

/* harmony default export */ __webpack_exports__["a"] = (TransformOperation);

/***/ }),
/* 328 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_photoeditorsdk_core__);


var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */


var Vector2 = __WEBPACK_IMPORTED_MODULE_1_photoeditorsdk_core__["Math"].Vector2;

var TransformChange = function () {
  function TransformChange(operation, options) {
    _classCallCheck(this, TransformChange);

    this._operation = operation;
    this._options = options;

    this._inputDimensions = this._operation.getInputDimensions(false);
    this._rotationDelta = options.rotation - this._operation.getRotation();
    this._deltaCos = Math.cos(this._rotationDelta);
    this._deltaSin = Math.sin(this._rotationDelta);

    this._oldAbsoluteSize = this._operation.getEnd().clone().subtract(this._operation.getStart()).multiply(this._inputDimensions);
    this._newAbsoluteSize = options.end.clone().subtract(options.start).multiply(this._inputDimensions);
    this._absoluteStartDiff = this._operation.getStart().clone().subtract(options.start).multiply(this._inputDimensions);
    this._scaleRatio = this._operation.calculateScale(options.rotation) / this._operation.calculateScale();
    this._absoluteStart = this._operation.getStart().clone().multiply(this._inputDimensions);
    this._sizeFactor = this._newAbsoluteSize.clone().divide(this._oldAbsoluteSize);
    this._textureScaleFactor = this._options.textureScale / this._operation.getTextureScale();
  }

  /**
   * Applies this transform change to the given relative point
   * @param  {PhotoEditorSDK.Math.Vector2} point
   * @return {PhotoEditorSDK.Math.Vector2}
   */


  _createClass(TransformChange, [{
    key: 'applyToRelativePoint',
    value: function applyToRelativePoint(point) {
      var oldStart = this._operation.getStart();
      var oldEnd = this._operation.getEnd();

      var cropCenter = oldStart.clone().add(oldEnd.clone().subtract(oldStart).divide(2));

      // Find point's pixel position relative to image center:
      //  - a: Find point's pixel position relative to crop center
      var pixelCropCenter = cropCenter.multiply(this._inputDimensions);

      var pointPixelDistanceToCropCenter = point.clone().multiply(this._oldAbsoluteSize).subtract(this._oldAbsoluteSize.clone().divide(2));

      //  - b: Find crop center's pixel position relative to image center
      //    (Point's pixel position relative to image center = a + b)
      var pointPixelPositionOnImage = pixelCropCenter.clone().add(pointPixelDistanceToCropCenter);
      var pointPixelDistanceToImageCenter = pointPixelPositionOnImage.clone().subtract(this._inputDimensions.clone().divide(2));

      // Rotate (_rotationDelta) and scale (_scaleRatio) distance to image center
      var rotatedPointPixelDistanceToImageCenter = new Vector2(pointPixelDistanceToImageCenter.x * this._deltaCos - pointPixelDistanceToImageCenter.y * this._deltaSin, pointPixelDistanceToImageCenter.x * this._deltaSin + pointPixelDistanceToImageCenter.y * this._deltaCos);

      var rotatedPointPixelPositionOnImage = this._inputDimensions.clone().divide(2).add(rotatedPointPixelDistanceToImageCenter);

      // Apply new crop
      var newAbsoluteStart = this._options.start.clone().multiply(this._inputDimensions);
      return rotatedPointPixelPositionOnImage.clone().subtract(newAbsoluteStart).divide(this._newAbsoluteSize);
    }

    /**
     * Applies this transform change to the given relative size
     * @param  {Number} number
     * @return {Number}
     */

  }, {
    key: 'applyToRelativeSize',
    value: function applyToRelativeSize(size) {
      return size * this._oldAbsoluteSize.min() / this._newAbsoluteSize.min();
    }

    /**
     * Applies this transform change to the given dimensions
     * @param  {PhotoEditorSDK.Math.Vector2} dimensions
     * @return {PhotoEditorSDK.Math.Vector2}
     */

  }, {
    key: 'applyToDimensions',
    value: function applyToDimensions(dimensions) {
      dimensions = dimensions.clone().multiply(this._scaleRatio);
      if (this._options.textureScale) {
        dimensions.multiply(this._textureScaleFactor);
      }
      return dimensions;
    }

    /**
     * Returns the new relative size value for the given relative size value
     * @param  {Number} size
     * @param  {String} side
     * @return {Number}
     */

  }, {
    key: 'scaleSize',
    value: function scaleSize(size) {
      var side = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'y';

      return size / this._sizeFactor[side];
    }

    /**
     * Applies the transform rotation to the given rotation
     * @param  {Number} rotation
     * @return {Number}
     */

  }, {
    key: 'applyToRotation',
    value: function applyToRotation(rotation) {
      return (rotation + this._rotationDelta) % (Math.PI * 2);
    }
  }]);

  return TransformChange;
}();

/* harmony default export */ __webpack_exports__["a"] = (TransformChange);

/***/ }),
/* 329 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor__ = __webpack_require__(7);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__);






var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor___default()(object, property); if (desc === undefined) { var parent = __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if ("value" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */


var Vector2 = __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Math"].Vector2;

/**
 * An operation that can draw a watermark on top of the image
 * @class
 * @extends PhotoEditorSDK.Operation
 * @memberof PhotoEditorSDK.Operations
 */

var WatermarkOperation = function (_Operation) {
  _inherits(WatermarkOperation, _Operation);

  /**
   * Creates a new WatermarkOperation
   * @param  {PhotoEditorSDK} sdk
   * @param  {Object} [options]
   */
  function WatermarkOperation() {
    var _ref;

    _classCallCheck(this, WatermarkOperation);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this = _possibleConstructorReturn(this, (_ref = WatermarkOperation.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(WatermarkOperation)).call.apply(_ref, [this].concat(args)));

    _this._watermarkSprite = new __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Engine"].Sprite();
    _this._watermarkSprite.setAnchor(0.5, 0.5);
    _this._container.addChild(_this._watermarkSprite);
    return _this;
  }

  /**
   * Renders the watermark
   * @param  {PhotoEditorSDK.Engine.Texture} inputTexture
   * @private
   * @override
   */


  _createClass(WatermarkOperation, [{
    key: '_render',
    value: function _render(inputTexture) {
      if (!this._watermarkTexture) {
        this._watermarkTexture = __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Engine"].Texture.fromImage(this._options.image);
        this._watermarkSprite.setTexture(this._watermarkTexture);
      }

      var textureDimensions = inputTexture.getDimensions();

      var _options$image = this._options.image,
          width = _options$image.width,
          height = _options$image.height;

      var dimensions = __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Utils"].resizeVectorToFit(new Vector2(width, height), textureDimensions);
      this._watermarkSprite.setPosition(textureDimensions.clone().divide(2));
      this._watermarkSprite.setWidth(dimensions.x);
      this._watermarkSprite.setHeight(dimensions.y);

      this._renderTexture.render(this._container);

      return __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Promise"].resolve();
    }

    /**
     * Disposes this operation
     */

  }, {
    key: 'dispose',
    value: function dispose() {
      _get(WatermarkOperation.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(WatermarkOperation.prototype), 'dispose', this).call(this);
      this._watermarkSprite.dispose();
    }
  }]);

  return WatermarkOperation;
}(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Operation"]);

/**
 * A unique string that identifies this operation. Can be used to select
 * operations.
 * @type {String}
 * @default
 */


WatermarkOperation.identifier = 'watermark';

/**
 * Specifies the available options for this operation
 * @type {Object}
 * @ignore
 */
WatermarkOperation.prototype.availableOptions = {
  image: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].OBJECT, required: true }
};

__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core___default.a.Operations.WatermarkOperation = WatermarkOperation;

/* harmony default export */ __webpack_exports__["a"] = (WatermarkOperation);

/***/ }),
/* 330 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_photoeditorsdk__ = __webpack_require__(39);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_photoeditorsdk___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_photoeditorsdk__);
/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */



var brushes = [];
if (typeof __WEBPACK_IMPORTED_MODULE_0_photoeditorsdk___default.a.Operations.SpriteOperation !== 'undefined') {
  brushes.push(__WEBPACK_IMPORTED_MODULE_0_photoeditorsdk___default.a.Operations.SpriteOperation.BrushSprite.Brushes.RadialBrush);
}

/**
 * @todo Harmonize keys: Don't wrap them in quotes
 */
/* harmony default export */ __webpack_exports__["a"] = ({
  EVENTS: {
    EXPORT: 'export',
    CLOSE: 'close',

    OPERATION_CREATED: 'operation:created',
    OPERATION_UPDATED: 'operation:updated',
    OPERATION_REMOVED: 'operation:removed',

    WINDOW_RESIZE: 'window:resize',
    EDITOR_RESIZE: 'editor:resize',
    ZOOM: 'editor:zoom',
    ZOOM_CHANGED: 'editor:zoom_changed',
    ZOOM_DONE: 'editor:zoom_done',

    HISTORY_UNDO: 'history:undo',
    HISTORY_UPDATED: 'history:updated',
    HISTORY_BEFORE_UNDO: 'history:before-undo',
    HISTORY_REDO: 'history:redo',
    HISTORY_BEFORE_REDO: 'history:before-redo',

    FEATURES_DISABLED: 'editor:features:disabled',
    FEATURES_ENABLED: 'editor:features:enabled',
    FEATURES_UPDATED: 'editor:features:updated',

    TEXT_SCALED: 'editor:text:scaled',

    TRANSFORM_RESIZE: 'transform:resize',
    TRANSFORM_REAPPLY_RATIO: 'transform:reapply-ratio'
  },
  DEFAULTS: {
    TRANSFORM_RATIO_CATEGORIES: [{
      identifier: 'imgly_transforms_common',
      defaultName: 'Common Ratios',
      ratios: [{
        identifier: 'imgly_transform_common_custom',
        defaultName: 'Custom',
        ratio: '*',
        selected: true
      }, {
        identifier: 'imgly_transform_common_square',
        defaultName: 'Square',
        ratio: 1
      }, {
        identifier: 'imgly_transform_common_4-3',
        defaultName: '4:3',
        ratio: 4 / 3
      }, {
        identifier: 'imgly_transform_common_16-9',
        defaultName: '16:9',
        ratio: 16 / 9
      }]
    }, {
      identifier: 'imgly_transforms_facebook',
      defaultName: 'Facebook',
      ratios: [{
        identifier: 'imgly_transform_facebook_profile',
        defaultName: 'Profile Pic',
        ratio: 1 / 1
      }, {
        identifier: 'imgly_transform_facebook_ad',
        defaultName: 'Ad',
        dimensions: new __WEBPACK_IMPORTED_MODULE_0_photoeditorsdk___default.a.Math.Vector2(1200, 627)
      }, {
        identifier: 'imgly_transform_facebook_post',
        defaultName: 'Post',
        dimensions: new __WEBPACK_IMPORTED_MODULE_0_photoeditorsdk___default.a.Math.Vector2(940, 788)
      }, {
        identifier: 'imgly_transform_facebook_cover',
        defaultName: 'Cover',
        dimensions: new __WEBPACK_IMPORTED_MODULE_0_photoeditorsdk___default.a.Math.Vector2(851, 315)
      }]
    }],
    FONTS: [{
      fontFamily: 'Aleo',
      variations: [{
        identifier: 'imgly_font_aleo_bold',
        fontWeight: 'bold',
        provider: 'file',
        filePath: 'fonts/imgly_font_aleo_bold.otf',
        textMetrics: {
          unitsPerEm: 2048,
          ascender: 1919,
          descender: -409
        }
      }]
    }, {
      fontFamily: 'Amatic SC',
      variations: [{
        identifier: 'imgly_font_amaticsc',
        fontWeight: 'normal',
        provider: 'file',
        filePath: 'fonts/imgly_font_amaticsc.ttf',
        textMetrics: {
          unitsPerEm: 2048,
          ascender: 2332,
          descender: -583
        }
      }]
    }, {
      fontFamily: 'Bernier',
      variations: [{
        identifier: 'imgly_font_bernier_regular',
        fontWeight: 'normal',
        provider: 'file',
        filePath: 'fonts/imgly_font_bernier_regular.otf',
        textMetrics: {
          unitsPerEm: 2048,
          ascender: 2007,
          descender: -552
        }
      }]
    }, {
      fontFamily: 'Cheque',
      variations: [{
        identifier: 'imgly_font_cheque_regular',
        fontWeight: 'normal',
        provider: 'file',
        filePath: 'fonts/imgly_font_cheque_regular.otf',
        textMetrics: {
          unitsPerEm: 2048,
          ascender: 1853,
          descender: -495
        }
      }]
    }, {
      fontFamily: 'Open Sans',
      variations: [{
        identifier: 'imgly_font_open_sans_bold',
        fontWeight: 'bold',
        provider: 'file',
        filePath: 'fonts/imgly_font_open_sans_bold.ttf',
        default: true,
        textMetrics: {
          unitsPerEm: 2048,
          ascender: 2189,
          descender: -640
        }
      }]
    }, {
      fontFamily: 'Gagalin',
      variations: [{
        identifier: 'imgly_font_gagalin_regular',
        fontWeight: 'normal',
        provider: 'file',
        filePath: 'fonts/imgly_font_gagalin_regular.otf',
        textMetrics: {
          unitsPerEm: 2048,
          ascender: 1987,
          descender: -628
        }
      }]
    }, {
      fontFamily: 'Hagin',
      variations: [{
        identifier: 'imgly_font_hagin_caps_thin',
        fontWeight: 200,
        provider: 'file',
        filePath: 'fonts/imgly_font_hagin_caps_thin.otf',
        textMetrics: {
          unitsPerEm: 2048,
          ascender: 1964,
          descender: -482
        }
      }]
    }, {
      fontFamily: 'Intro',
      variations: [{
        identifier: 'imgly_font_intro_inline',
        fontWeight: 'normal',
        provider: 'file',
        filePath: 'fonts/imgly_font_intro_inline.otf',
        textMetrics: {
          unitsPerEm: 2048,
          ascender: 1944,
          descender: -548
        }
      }]
    }, {
      fontFamily: 'Lobster',
      variations: [{
        identifier: 'imgly_font_lobster',
        fontWeight: 'normal',
        provider: 'file',
        filePath: 'fonts/imgly_font_lobster.otf',
        textMetrics: {
          unitsPerEm: 2048,
          ascender: 2048,
          descender: -552
        }
      }]
    }, {
      fontFamily: 'Nexa',
      variations: [{
        identifier: 'imgly_font_nexa_script',
        fontWeight: 'normal',
        provider: 'file',
        filePath: 'fonts/imgly_font_nexa_script.otf',
        textMetrics: {
          unitsPerEm: 2048,
          ascender: 1835,
          descender: -663
        }
      }]
    }, {
      fontFamily: 'Ostrich Black',
      variations: [{
        identifier: 'imgly_font_ostrich_sans_black',
        fontWeight: 800,
        provider: 'file',
        filePath: 'fonts/imgly_font_ostrich_sans_black.otf',
        textMetrics: {
          unitsPerEm: 2048,
          ascender: 1513,
          descender: -235
        }
      }]
    }, {
      fontFamily: 'Ostrich Bold',
      variations: [{
        identifier: 'imgly_font_ostrich_sans_bold',
        fontWeight: 'bold',
        provider: 'file',
        filePath: 'fonts/imgly_font_ostrich_sans_bold.otf',
        textMetrics: {
          unitsPerEm: 2048,
          ascender: 1513,
          descender: -235
        }
      }]
    }, {
      fontFamily: 'Panton Black',
      variations: [{
        identifier: 'imgly_font_panton_black_italic_caps',
        fontWeight: 800,
        fontStyle: 'italic',
        provider: 'file',
        filePath: 'fonts/imgly_font_panton_blackitalic_caps.otf',
        textMetrics: {
          unitsPerEm: 2048,
          ascender: 2033,
          descender: -572
        }
      }]
    }, {
      fontFamily: 'Panton Light',
      variations: [{
        identifier: 'imgly_font_panton_light_italic_caps',
        fontWeight: 200,
        fontStyle: 'italic',
        provider: 'file',
        filePath: 'fonts/imgly_font_panton_lightitalic_caps.otf',
        textMetrics: {
          unitsPerEm: 2048,
          ascender: 1961,
          descender: -556
        }
      }]
    }, {
      fontFamily: 'Perfograma',
      variations: [{
        identifier: 'imgly_font_perfograma',
        fontWeight: 'normal',
        provider: 'file',
        filePath: 'fonts/imgly_font_perfograma.otf',
        textMetrics: {
          unitsPerEm: 2048,
          ascender: 1982,
          descender: -842
        }
      }]
    }, {
      fontFamily: 'Trashhand',
      variations: [{
        identifier: 'imgly_font_trash_hand',
        fontWeight: 'normal',
        provider: 'file',
        filePath: 'fonts/imgly_font_trash_hand.ttf',
        textMetrics: {
          unitsPerEm: 2048,
          ascender: 1554,
          descender: -663
        }
      }]
    }],
    BRUSHES: brushes
  }
});

/***/ }),
/* 331 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__globals__ = __webpack_require__(9);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_shared_exporter__ = __webpack_require__(332);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_shared_managers_font_manager__ = __webpack_require__(132);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__image_resizer__ = __webpack_require__(336);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__editor_operations__ = __webpack_require__(337);





var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */








/**
 * The Editor class is an interface to the SDK (managing operations)
 * @class
 * @memberof PhotoEditorSDK.Server
 */

var Editor = function (_EventEmitter) {
  _inherits(Editor, _EventEmitter);

  function Editor(ui, options, mediator) {
    var shallow = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;

    _classCallCheck(this, Editor);

    var _this = _possibleConstructorReturn(this, (Editor.__proto__ || __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default()(Editor)).call(this));

    _this._ui = ui;
    _this._options = options;
    _this._mediator = mediator;
    _this._shallow = shallow;

    _this._initFonts();

    if (!shallow) {
      _this._initSDK();

      _this.operations = new __WEBPACK_IMPORTED_MODULE_8__editor_operations__["a" /* default */](_this, _this._sdk, _this._mediator);

      _this._initSerializers();
    }
    return _this;
  }

  // -------------------------------------------------------------------------- INITIALIZATION

  _createClass(Editor, [{
    key: '_initFonts',
    value: function _initFonts() {
      var options = __WEBPACK_IMPORTED_MODULE_4__globals__["k" /* SDKUtils */].defaults(this._options.editor.controlsOptions.text, {
        additionalFonts: [],
        replaceFonts: false,
        availableVariations: null
      });

      this._fontManager = new __WEBPACK_IMPORTED_MODULE_6_shared_managers_font_manager__["a" /* default */](this._ui, options);
      var fonts = this._fontManager.getFonts();
      var fontLoader = this._ui.getFontLoader();
      fontLoader.setFonts(fonts);
      fontLoader.load();
    }

    /**
     * Sets the given image to be rendered. If the image needs to be resized to fit into a
     * WebGL texture or to match the `maxMegaPixels` option, resizing is done before setting
     * the image.
     * @param {Image} image
     * @param {Boolean} resetEditor [description]
     */

  }, {
    key: 'setImage',
    value: function setImage() {
      var image = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this._options.editor.image;
      var resetEditor = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;

      if (resetEditor) {
        this.reset();
      }

      var exif = null;
      exif = this._sdk.parseExif(image);
      this._setImage(image, exif);
      this._initWatermark();
    }

    /**
     * Initializes the watermark operation
     * @private
     */

  }, {
    key: '_initWatermark',
    value: function _initWatermark() {
      if (this._options.editor.watermarkImage) {
        this._watermarkOperation = this.operations.getOrCreate('watermark', {
          image: this._options.editor.watermarkImage
        });
      }
    }

    /**
     * Initializes the SDK
     * @private
     */

  }, {
    key: '_initSDK',
    value: function _initSDK() {
      var _options = this._options,
          logLevel = _options.logLevel,
          displayWelcomeMessage = _options.displayWelcomeMessage,
          debug = _options.debug,
          license = _options.license;
      var _options$editor = this._options.editor,
          smoothDownscaling = _options$editor.smoothDownscaling,
          smoothUpscaling = _options$editor.smoothUpscaling,
          preferredRenderer = _options$editor.preferredRenderer,
          pixelRatio = _options$editor.pixelRatio;

      var rendererOptions = {
        logLevel: logLevel,
        debug: debug,
        displayWelcomeMessage: displayWelcomeMessage,
        pixelRatio: pixelRatio,
        smoothDownscaling: smoothDownscaling,
        smoothUpscaling: smoothUpscaling,
        transparent: true,
        license: license,
        renderMode: 'export'
      };
      this._sdk = new __WEBPACK_IMPORTED_MODULE_4__globals__["j" /* SDK */](preferredRenderer, rendererOptions);
    }

    /**
     * Returns the maximum mega pixels
     * @return {Number}
     * @private
     */

  }, {
    key: 'getMaxMegapixels',
    value: function getMaxMegapixels() {
      var maxMegaPixels = this._options.editor.maxMegaPixels;

      return maxMegaPixels;
    }

    // -------------------------------------------------------------------------- MISC PUBLIC API

    /**
     * Returns the output sprite's current dimensions
     * @param {Boolean} incorporateSpriteScale = false
     * @return {PhotoEditorSDK.Math.Vector2}
     */

  }, {
    key: 'getOutputDimensions',
    value: function getOutputDimensions() {
      var incorporateSpriteScale = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;

      return this._sdk.getOutputDimensions(incorporateSpriteScale);
    }

    /**
     * Returns the output texture's current dimensions
     * @param  {Boolean} incorporateSpriteScale = false
     * @return {PhotoEditorSDK.Math.Vector2}
     */

  }, {
    key: 'getOutputTextureDimensions',
    value: function getOutputTextureDimensions() {
      var incorporateSpriteScale = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;

      return this._sdk.getOutputTextureDimensions(incorporateSpriteScale);
    }

    /**
     * Returns the final dimensions that the input image would have
     * after all existing operations have been applied
     * @param {Boolean} incorporateSpriteScale = false
     * @return {PhotoEditorSDK.Math.Vector2}
     */

  }, {
    key: 'getFinalDimensions',
    value: function getFinalDimensions() {
      var incorporateSpriteScale = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;

      return this._sdk.getFinalDimensions(incorporateSpriteScale);
    }

    /**
     * Sets the given image
     * @param {Image} image
     * @param {PhotoEditorSDK.EXIF} [exif]
     * @param {PhotoEditorSDK.Math.Vector2} [dimensions]
     * @private
     */

  }, {
    key: '_setImage',
    value: function _setImage() {
      var image = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this._options.editor.image;
      var exif = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;

      // Invalidate caches
      this._sdk.setAllOperationsToDirty();

      this._options.editor.image = image;
      this._sdk.setImage(image, exif);
    }
  }, {
    key: '_ensureImageIsResized',
    value: function _ensureImageIsResized() {
      var _this2 = this;

      var inputImage = this._sdk.getImage();
      var renderer = this._sdk.getRenderer();
      var maxMegaPixels = this.getMaxMegapixels();
      var maxPixels = maxMegaPixels ? maxMegaPixels * 1000000 : null;
      var maxDimensions = renderer.getMaxDimensions();
      var imageResizer = new __WEBPACK_IMPORTED_MODULE_7__image_resizer__["a" /* default */](inputImage, maxPixels, maxDimensions);

      if (!this._resizedImage && imageResizer.needsResize()) {
        return imageResizer.resize().then(function (_ref) {
          var canvas = _ref.canvas,
              dimensions = _ref.dimensions,
              reason = _ref.reason;

          _this2._resizedImage = canvas;
          _this2._sdk.setImage(canvas);
          return canvas;
        });
      } else {
        return __WEBPACK_IMPORTED_MODULE_4__globals__["h" /* Promise */].resolve(inputImage);
      }
    }

    /**
     * Exports an image
     * @param {Boolean} download = false
     * @return {Promise}
     */

  }, {
    key: 'export',
    value: function _export() {
      var _this3 = this;

      var download = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;

      if (this._watermarkOperation) {
        this._watermarkOperation.setEnabled(false);
      }

      // Invalidate caches
      this._sdk.setAllOperationsToDirty();

      return this._ensureImageIsResized().then(function (image) {
        var options = _this3._options.editor.export;
        var exporter = new __WEBPACK_IMPORTED_MODULE_5_shared_exporter__["a" /* default */](_this3._sdk, options, false);
        return exporter.export().then(function (output) {
          _this3.emit('export', output);
          _this3._mediator.emit(__WEBPACK_IMPORTED_MODULE_4__globals__["c" /* Constants */].EVENTS.EXPORT, output, _this3);

          if (_this3._watermarkOperation) {
            _this3._watermarkOperation.setEnabled(true);
            _this3._sdk.render();
          }

          // Invalidate caches
          _this3._sdk.setAllOperationsToDirty();

          return output;
        });
      });
    }

    /**
     * Broadcasts a transform to all operations that need to be changed
     * @param  {PhotoEditorSDK.Operations.TransformOperation} transformOperation
     * @param  {Object} options
     */

  }, {
    key: 'broadcastTransform',
    value: function broadcastTransform(transformOperation, options) {
      var _this4 = this;

      var transformChange = new __WEBPACK_IMPORTED_MODULE_4__globals__["j" /* SDK */].Operations.TransformOperation.TransformChange(transformOperation, options);
      var transformableOperations = ['sprite', 'selective-blur', 'radial-focus', 'mirrored-focus', 'linear-focus', 'blur'];
      transformableOperations.forEach(function (identifier) {
        var operation = _this4.operations.get(identifier);
        if (!operation) {
          return;
        }
        operation.transform(transformChange);
      });
    }

    /**
     * Broadcasts a flip to all operations that need to be changed
     * @param  {String} direction
     */

  }, {
    key: 'broadcastFlip',
    value: function broadcastFlip(direction) {
      var _this5 = this;

      var flippableOperations = ['mirrored-focus', 'radial-focus', 'sprite', 'selective-blur'];
      flippableOperations.forEach(function (identifier) {
        var operation = _this5.operations.get(identifier);
        if (!operation) {
          return;
        }
        operation.flip(direction);
      });
    }

    /**
     * Broadcasts a rotation to all operations that need to be changed
     * @param  {Number} degrees
     */

  }, {
    key: 'broadcastRotate',
    value: function broadcastRotate(degrees) {
      var _this6 = this;

      var flippableOperations = ['transform', 'mirrored-focus', 'radial-focus', 'sprite', 'selective-blur'];
      flippableOperations.forEach(function (identifier) {
        var operation = _this6.operations.get(identifier);
        if (!operation) {
          return;
        }
        operation.rotate(degrees);
      });
    }

    // -------------------------------------------------------------------------- SERIALIZATION

    /**
     * Initializes the serializers and deserializers
     * @private
     */

  }, {
    key: '_initSerializers',
    value: function _initSerializers() {
      this._serializers = {
        '1.0.0': __webpack_require__(338).default,
        '1.0.1': __webpack_require__(343).default,
        '2.0.0': __webpack_require__(344).default,
        '3.0.0': __webpack_require__(348).default
      };
    }

    /**
     * Serializes the editor state for the given version
     * @param  {Object} options = {}
     * @param  {String} version = '3.0.0'
     * @return {Promise}
     */

  }, {
    key: 'serialize',
    value: function serialize() {
      var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};
      var version = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '3.0.0';

      var Serializer = this._serializers[version];
      if (!Serializer) {
        return __WEBPACK_IMPORTED_MODULE_4__globals__["h" /* Promise */].reject(new Error('No serializer for version ' + version + ' found.'));
      }
      var serializer = new Serializer(this);
      return serializer.serialize(options);
    }

    /**
     * Deserializes the given data
     * @param  {Object} data
     * @return {Promise}
     */

  }, {
    key: 'deserialize',
    value: function deserialize(data) {
      var Serializer = this._serializers[data.version];
      if (!Serializer) {
        return __WEBPACK_IMPORTED_MODULE_4__globals__["h" /* Promise */].reject(new Error('No serializer for version ' + data.version + ' found.'));
      }
      var serializer = new Serializer(this);
      return serializer.deserialize(data);
    }

    // -------------------------------------------------------------------------- RENDERING

    /**
     * Resets everything
     */

  }, {
    key: 'reset',
    value: function reset() {
      this._sdk.reset();
      this.operations.reset();
    }

    // -------------------------------------------------------------------------- DISPOSAL

    /**
     * Cleans this instance up
     */

  }, {
    key: 'dispose',
    value: function dispose() {
      this.stop();

      this._sdk.dispose();
    }

    // -------------------------------------------------------------------------- GETTERS / SETTERS

    /**
     * Returns the renderer
     * @return {PhotoEditorSDK.Engine.BaseRenderer}
     */

  }, {
    key: 'getRenderer',
    value: function getRenderer() {
      return this._sdk.getRenderer();
    }

    /**
     * Returns the SDK
     * @return {PhotoEditorSDK}
     */

  }, {
    key: 'getSDK',
    value: function getSDK() {
      return this._sdk;
    }

    /**
     * Returns the input image dimensions
     * @return {PhotoEditorSDK.Math.Vector2}s
     */

  }, {
    key: 'getInputDimensions',
    value: function getInputDimensions() {
      return this._sdk.getInputDimensions();
    }

    /**
     * Returns the image
     * @return {Image}
     */

  }, {
    key: 'getImage',
    value: function getImage() {
      return this._options.editor.image;
    }

    /**
     * Returns the options
     * @return {Object}
     */

  }, {
    key: 'getOptions',
    value: function getOptions() {
      return this._options;
    }

    /**
     * Returns the UI
     * @return {DesktopUI}
     */

  }, {
    key: 'getUI',
    value: function getUI() {
      return this._ui;
    }
  }, {
    key: 'getMediator',
    value: function getMediator() {
      return this._mediator;
    }
  }]);

  return Editor;
}(__WEBPACK_IMPORTED_MODULE_4__globals__["d" /* EventEmitter */]);

/* harmony default export */ __webpack_exports__["a"] = (Editor);

/***/ }),
/* 332 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_globals__ = __webpack_require__(9);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_shared_downloader_file_downloader__ = __webpack_require__(333);


var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




var Exporter = function () {
  function Exporter(sdk, options, download) {
    _classCallCheck(this, Exporter);

    this._sdk = sdk;
    this._options = options;
    this._download = download;
  }

  /**
   * Exports the image / data url
   * @return {Promise}
   */


  _createClass(Exporter, [{
    key: 'export',
    value: function _export() {
      var _this = this;

      var renderType = this._getRenderType();

      return this._sdk.export(renderType, this._options.format, this._options.quality).then(function (data) {
        if (_this._download) {
          _this._downloadData(renderType, data);
        }
        return data;
      });
    }

    /**
     * Downloads the data using the given render type
     * @param  {RenderType} renderType
     * @param  {String} data
     * @private
     */

  }, {
    key: '_downloadData',
    value: function _downloadData(renderType, data) {
      switch (renderType) {
        case __WEBPACK_IMPORTED_MODULE_1_globals__["i" /* RenderType */].DATAURL:
          __WEBPACK_IMPORTED_MODULE_2_shared_downloader_file_downloader__["a" /* default */].downloadDataURL(data, this._options.fileBasename);
          break;
        case __WEBPACK_IMPORTED_MODULE_1_globals__["i" /* RenderType */].MSBLOB:
          __WEBPACK_IMPORTED_MODULE_2_shared_downloader_file_downloader__["a" /* default */].downloadMSBlob(data, this._options.fileBasename);
          break;
      }
    }

    /**
     * Returns the render type for this export
     * @return {RenderType}
     * @private
     */

  }, {
    key: '_getRenderType',
    value: function _getRenderType() {
      var options = this._options;
      if (options.type !== __WEBPACK_IMPORTED_MODULE_1_globals__["i" /* RenderType */].IMAGE || !this._download) {
        return options.type;
      } else {
        if (__WEBPACK_IMPORTED_MODULE_1_globals__["m" /* Utils */].supportsMSBlob()) {
          return __WEBPACK_IMPORTED_MODULE_1_globals__["i" /* RenderType */].MSBLOB;
        } else {
          return __WEBPACK_IMPORTED_MODULE_1_globals__["i" /* RenderType */].DATAURL;
        }
      }
    }
  }]);

  return Exporter;
}();

/* harmony default export */ __webpack_exports__["a"] = (Exporter);

/***/ }),
/* 333 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_globals__ = __webpack_require__(9);


var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */



var FileDownloader = function () {
  function FileDownloader() {
    _classCallCheck(this, FileDownloader);
  }

  _createClass(FileDownloader, null, [{
    key: 'downloadDataURL',

    /**
     * Exports the given data url
     * @param  {String} data
     * @param  {String} baseName = 'photoeditorsdk-export'
     */
    value: function downloadDataURL(data) {
      var baseName = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'photoeditorsdk-export';

      var url = this.createBlobURLFromDataURL(data);
      var extension = this.getExtensionFromDataURL(data);

      var link = document.createElement('a');
      link.download = baseName + '.' + extension;
      link.href = url;
      document.body.appendChild(link);
      link.click();
      document.body.removeChild(link);
    }

    /**
     * Exports the given data url using msBlob
     * @param  {String} data
     * @param  {String} baseName = 'photoeditorsdk-export'
     */

  }, {
    key: 'downloadMSBlob',
    value: function downloadMSBlob(data) {
      var baseName = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'photoeditorsdk-export';

      navigator.msSaveBlob(data, baseName + '.png');
    }

    /**
     * Returns the file extension by reading the given data url
     * @param  {String} data
     * @return {String}
     */

  }, {
    key: 'getExtensionFromDataURL',
    value: function getExtensionFromDataURL(data) {
      var mimeString = data.split(',')[0].split(':')[1].split(';')[0];
      return mimeString.split('/').pop();
    }

    /**
     * Creates a Blob URI from the given Data URI
     * @param {String} data
     */

  }, {
    key: 'createBlobURLFromDataURL',
    value: function createBlobURLFromDataURL(data) {
      if (!window.Blob || !window.URL || !ArrayBuffer || !Uint8Array) {
        return data;
      }

      var rawData = __WEBPACK_IMPORTED_MODULE_1_globals__["a" /* Base64 */].decode(data.split(',')[1]);
      var mimeString = data.split(',')[0].split(':')[1].split(';')[0];

      // write the bytes of the string to an ArrayBuffer
      var arrayBuffer = new ArrayBuffer(rawData.length);
      var intArray = new Uint8Array(arrayBuffer);
      for (var i = 0; i < rawData.length; i++) {
        intArray[i] = rawData[i];
      }

      // write the ArrayBuffer to a blob, and you're done
      var blob = new window.Blob([arrayBuffer], {
        type: mimeString
      });
      return window.URL.createObjectURL(blob);
    }
  }]);

  return FileDownloader;
}();

/* harmony default export */ __webpack_exports__["a"] = (FileDownloader);

/***/ }),
/* 334 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_photoeditorsdk__ = __webpack_require__(39);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_photoeditorsdk___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_photoeditorsdk__);




function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */



var Font = function (_Configurable) {
  _inherits(Font, _Configurable);

  function Font() {
    _classCallCheck(this, Font);

    return _possibleConstructorReturn(this, (Font.__proto__ || __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default()(Font)).apply(this, arguments));
  }

  return Font;
}(__WEBPACK_IMPORTED_MODULE_3_photoeditorsdk__["Configurable"]);

/**
 * Specifies the available options for the Font class
 * @type {Object}
 * @ignore
 */


/* harmony default export */ __webpack_exports__["a"] = (Font);
Font.prototype.availableOptions = {
  fontFamily: { type: __WEBPACK_IMPORTED_MODULE_3_photoeditorsdk__["OptionType"].STRING, required: true },
  variations: { type: __WEBPACK_IMPORTED_MODULE_3_photoeditorsdk__["OptionType"].ARRAY, required: true }
};

/***/ }),
/* 335 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk__ = __webpack_require__(39);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk__);





var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */



var FONT_WEIGHTS = {
  100: 'Extra Light',
  200: 'Light',
  300: 'Book',
  400: 'Regular',
  500: 'Medium',
  600: 'Semibold',
  700: 'Bold',
  800: 'Black',
  900: 'Extra Black',
  bold: 'Bold',
  normal: 'Regular'
};

var FontVariation = function (_Configurable) {
  _inherits(FontVariation, _Configurable);

  function FontVariation() {
    _classCallCheck(this, FontVariation);

    return _possibleConstructorReturn(this, (FontVariation.__proto__ || __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default()(FontVariation)).apply(this, arguments));
  }

  _createClass(FontVariation, [{
    key: 'getLabel',

    /**
     * Returns the label for this variation
     * @return {String}
     */
    value: function getLabel() {
      var label = FONT_WEIGHTS[this._options.fontWeight];

      switch (this._options.fontStyle) {
        case 'italic':
          label += ' Italic';
          break;
      }

      return label;
    }
  }]);

  return FontVariation;
}(__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk__["Configurable"]);

/**
 * Specifies the available options for the FontVariation class
 * @type {Object}
 * @ignore
 */


/* harmony default export */ __webpack_exports__["a"] = (FontVariation);
FontVariation.prototype.availableOptions = {
  identifier: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk__["OptionType"].STRING, required: true },
  fontFamily: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk__["OptionType"].STRING, required: true },
  fontWeight: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk__["OptionType"].ALL, default: 400 },
  fontStyle: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk__["OptionType"].STRING, default: 'normal' },
  textMetrics: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk__["OptionType"].OBJECT, default: null },
  provider: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk__["OptionType"].STRING, available: ['google', 'file'] },
  filePath: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk__["OptionType"].STRING },
  default: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk__["OptionType"].BOOLEAN, default: false },
  font: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk__["OptionType"].OBJECT }
};

/***/ }),
/* 336 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__globals__ = __webpack_require__(9);


var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */



var ImageResizer = function () {
  function ImageResizer(image, maxPixels, maxDimensions) {
    _classCallCheck(this, ImageResizer);

    this._image = image;
    this._maxPixels = maxPixels;
    this._maxDimensions = maxDimensions;
  }

  /**
   * Checks if the image needs to be resized
   * @return {Boolean}
   */


  _createClass(ImageResizer, [{
    key: 'needsResize',
    value: function needsResize() {
      var dimensions = new __WEBPACK_IMPORTED_MODULE_1__globals__["n" /* Vector2 */](this._image.width, this._image.height);
      var pixels = dimensions.x * dimensions.y;
      var exceedsMaxPixels = this._maxPixels !== null && pixels > this._maxPixels;
      var exceedsMaxDimensions = this._maxDimensions !== null && (dimensions.x > this._maxDimensions || dimensions.y > this._maxDimensions);

      return exceedsMaxPixels || exceedsMaxDimensions;
    }

    /**
     * Resizes the image to match the maximum amount of pixels
     * @return {Promise}
     */

  }, {
    key: 'resize',
    value: function resize() {
      var _this = this;

      var reason = null;
      var canvas = null;
      var maxDimensions = this._maxDimensions;

      return new __WEBPACK_IMPORTED_MODULE_1__globals__["h" /* Promise */](function (resolve, reject) {
        setTimeout(function () {
          var initialDimensions = new __WEBPACK_IMPORTED_MODULE_1__globals__["n" /* Vector2 */](_this._image.width, _this._image.height);
          var dimensions = initialDimensions.clone();

          // If max pixels is exceeded, resize to fit the max pixels
          if (_this._maxPixels !== null && dimensions.x * dimensions.y > _this._maxPixels) {
            dimensions.copy(_this._getDimensionsByMaxPixels());
            reason = 'maxMegaPixels';
          }

          // If max dimensions (maximum texture size) is exceeded,
          // make sure the shorter side equals the maximum texture
          // size
          if (maxDimensions !== null && (dimensions.x > maxDimensions || dimensions.y > maxDimensions)) {
            var scale = Math.min(maxDimensions / dimensions.x, maxDimensions / dimensions.y);
            dimensions.multiply(scale);
            reason = 'maxDimensions';
          }

          dimensions.floor();
          canvas = _this._createResizedImageCanvas(dimensions);

          resolve({ canvas: canvas, dimensions: dimensions, reason: reason });
        }, 1000);
      });
    }

    /**
     * Creates a resized canvas with the given dimensions
     * @param  {PhotoEditorSDK.Math.Vector2} dimensions
     * @param  {PhotoEditorSDK.Math.Vector2} [imageDimensions] = dimensions
     * @return {Canvas}
     * @private
     */

  }, {
    key: '_createResizedImageCanvas',
    value: function _createResizedImageCanvas(dimensions) {
      var imageDimensions = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : dimensions;

      var image = this._image;

      var canvas = __WEBPACK_IMPORTED_MODULE_1__globals__["k" /* SDKUtils */].createCanvas();
      canvas.width = dimensions.x;
      canvas.height = dimensions.y;

      var offset = dimensions.clone().subtract(imageDimensions).divide(2);

      var context = canvas.getContext('2d');
      context.drawImage(image, 0, 0, image.width, image.height, offset.x, offset.y, imageDimensions.x, imageDimensions.y);
      return canvas;
    }

    /**
     * Returns the dimensions that match the max pixel count
     * @return {Vector2}
     * @private
     */

  }, {
    key: '_getDimensionsByMaxPixels',
    value: function _getDimensionsByMaxPixels() {
      var image = this._image;
      var maxPixels = this._maxPixels;

      var ratioHV = image.width / image.height;
      var ratioVH = image.height / image.width;

      return new __WEBPACK_IMPORTED_MODULE_1__globals__["n" /* Vector2 */](Math.sqrt(maxPixels * ratioHV), Math.sqrt(maxPixels * ratioVH)).floor();
    }
  }]);

  return ImageResizer;
}();

/* harmony default export */ __webpack_exports__["a"] = (ImageResizer);

/***/ }),
/* 337 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_symbol_iterator__ = __webpack_require__(22);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_symbol_iterator___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_symbol_iterator__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_symbol__ = __webpack_require__(23);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_symbol___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_symbol__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__globals__ = __webpack_require__(9);




var _typeof = typeof __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_symbol___default.a === "function" && typeof __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_symbol_iterator___default.a === "symbol" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_symbol___default.a === "function" && obj.constructor === __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_symbol___default.a && obj !== __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_symbol___default.a.prototype ? "symbol" : typeof obj; };

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */



var EditorOperations = function () {
  function EditorOperations(editor, sdk, mediator) {
    _classCallCheck(this, EditorOperations);

    this._editor = editor;
    this._sdk = sdk;
    this._mediator = mediator;

    this._available = this._sdk.getOperations();
    this._map = {};
    this._stack = this._sdk.getOperationsStack();
    this._preferredOrder = this._editor.getOptions().editor.operationsOrder;

    this._fixStack();
  }

  /**
   * Checks whether an operation with the given identifier exists
   * @param {String} identifier
   * @return {Boolean}
   */


  _createClass(EditorOperations, [{
    key: 'exists',
    value: function exists(identifier) {
      return !!this._map[identifier];
    }

    /**
     * Adds the given operation to the stack
     * @param {PhotoEditorSDK.Operation} operation
     */

  }, {
    key: 'add',
    value: function add(operation) {
      var _this = this;

      var identifier = operation.constructor.identifier;
      operation.on('update', function () {
        _this._mediator.emit(__WEBPACK_IMPORTED_MODULE_3__globals__["c" /* Constants */].EVENTS.OPERATION_UPDATED, operation);
      });
      var index = this._preferredOrder.indexOf(identifier);
      if (index === -1) {
        throw new Error('EditorOperations#add: `' + identifier + '` does not appear in `operationsOrder`');
      }
      this._stack.set(index, operation);
      this._map[identifier] = operation;

      this._mediator.emit(__WEBPACK_IMPORTED_MODULE_3__globals__["c" /* Constants */].EVENTS.OPERATION_CREATED, operation);
    }

    /**
     * Removes the given operation from the stack
     * @param  {PhotoEditorSDK.Operation} operation
     * @param  {Boolean} broadcast = true
     */

  }, {
    key: 'remove',
    value: function remove(operation) {
      var broadcast = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;

      var identifier = (typeof operation === 'undefined' ? 'undefined' : _typeof(operation)) === 'object' ? operation.constructor.identifier : operation;
      var stack = this._stack.getStack();
      operation = this.get(identifier);

      // Remove operation from map
      delete this._map[identifier];

      // Remove operation from stack
      var index = stack.map(function (op) {
        return op.constructor.identifier;
      }).indexOf(identifier);

      if (index !== -1) {
        this._stack.removeAt(index);

        // Set all following operations to dirty, since they might
        // have cached stuff drawn by the removed operation
        for (var i = index + 1; i < stack.length; i++) {
          var _operation = stack[i];
          if (!_operation) continue;
          _operation.setDirty(true);
        }

        if (broadcast) {
          this._mediator.emit(__WEBPACK_IMPORTED_MODULE_3__globals__["c" /* Constants */].EVENTS.OPERATION_REMOVED, operation);
        }
      }
    }

    /**
     * Returns the operation with the given identifier
     * @param  {String} identifier
     * @return {PhotoEditorSDK.Operation}
     */

  }, {
    key: 'get',
    value: function get(identifier) {
      return this._map[identifier];
    }

    /**
     * If the operation with the given identifier already exists, it returns
     * the existing operation. Otherwise, it creates and returns a new one.
     * @param  {String} identifier
     * @param  {Object} options
     * @return {PhotoEditorSDK.Operation}
     */

  }, {
    key: 'getOrCreate',
    value: function getOrCreate(identifier) {
      var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};

      if (this._map[identifier]) {
        var operation = this._map[identifier];
        operation.set(options, false);
        return operation;
      } else {
        var Operation = this._available[identifier];
        var _operation2 = new Operation(this._sdk, options);
        this.add(_operation2);
        return _operation2;
      }
    }

    /**
     * Returns the operations stack
     * @return {PhotoEditorSDK.OperationsStack}
     */

  }, {
    key: 'getStack',
    value: function getStack() {
      return this._stack;
    }

    /**
     * Resets the operations
     */

  }, {
    key: 'reset',
    value: function reset() {
      this._map = {};
    }

    /**
     * Since the SDK might create some operations upfront (e.g. to fix the EXIF orientation),
     * we might have operations at array positions where they should not be. This method
     * moves them to their appropriate position
     * @private
     */

  }, {
    key: '_fixStack',
    value: function _fixStack() {
      var _this2 = this;

      var stack = this._stack.getStack().slice();
      this._stack.clear();

      stack.forEach(function (s) {
        _this2.add(s);
      });
    }
  }]);

  return EditorOperations;
}();

/* harmony default export */ __webpack_exports__["a"] = (EditorOperations);

/***/ }),
/* 338 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
Object.defineProperty(__webpack_exports__, "__esModule", { value: true });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__serializer__ = __webpack_require__(133);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__deserializer__ = __webpack_require__(134);


var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




var Serialization = function () {
  function Serialization(editor) {
    _classCallCheck(this, Serialization);

    this._editor = editor;
  }

  /**
   * Serializes the editor state
   * @return {Promise}
   */


  _createClass(Serialization, [{
    key: 'serialize',
    value: function serialize() {
      var serializer = new __WEBPACK_IMPORTED_MODULE_1__serializer__["a" /* default */](this._editor);
      return serializer.serialize.apply(serializer, arguments);
    }

    /**
     * Deserializes the given data
     * @param  {Object} data
     * @return {Promise}
     */

  }, {
    key: 'deserialize',
    value: function deserialize(data) {
      var deserializer = new __WEBPACK_IMPORTED_MODULE_2__deserializer__["a" /* default */](this._editor, data);
      return deserializer.deserialize();
    }
  }]);

  return Serialization;
}();

/* harmony default export */ __webpack_exports__["default"] = (Serialization);


Serialization.version = '1.0.0';

/***/ }),
/* 339 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_promise__ = __webpack_require__(11);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_promise___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_promise__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_globals__ = __webpack_require__(9);



var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */



var FilterManager = function () {
  function FilterManager(ui, options) {
    _classCallCheck(this, FilterManager);

    this._ui = ui;
    this._options = options;
    this._categoriesById = {};
    this._filtersByIdentifier = {
      identity: __WEBPACK_IMPORTED_MODULE_2_globals__["j" /* SDK */].Operations.FilterOperation.Filters.IdentityFilter
    };

    this._categories = __WEBPACK_IMPORTED_MODULE_2_globals__["l" /* SharedConstants */].DEFAULTS.FILTERS.slice(0);

    this._initCategories();
  }

  _createClass(FilterManager, [{
    key: 'instantiateFilterWithIdentifier',
    value: function instantiateFilterWithIdentifier(identifier) {
      var _this = this;

      var Filter = this.getFilterByIdentifier(identifier);
      if (!Filter) {
        return __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_promise___default.a.reject(new Error('Unknown filter with identifier `' + identifier + '`!'));
      }

      if (!(Filter.prototype instanceof __WEBPACK_IMPORTED_MODULE_2_globals__["j" /* SDK */].Operations.FilterOperation.Filter)) {
        var lutImage = Filter.lutImage,
            resolution = Filter.resolution,
            horizontalTileCount = Filter.horizontalTileCount,
            verticalTileCount = Filter.verticalTileCount;

        var preloadedImage = void 0;
        if (this._ui.getPreloader) {
          preloadedImage = this._ui.getPreloader().getAsset(lutImage);
        }
        var loadPromise = void 0;
        if (preloadedImage) {
          loadPromise = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_promise___default.a.resolve(preloadedImage);
        } else {
          loadPromise = __WEBPACK_IMPORTED_MODULE_2_globals__["f" /* ImageLoader */].load(this._ui.getAssetPath(lutImage));
        }

        return loadPromise.then(function (image) {
          return __WEBPACK_IMPORTED_MODULE_2_globals__["f" /* ImageLoader */].load(_this._ui.getAssetPath(lutImage)).then(function (image) {
            return new __WEBPACK_IMPORTED_MODULE_2_globals__["j" /* SDK */].Operations.FilterOperation.Filters.ThreeDLUTFilter({
              image: image, resolution: resolution, horizontalTileCount: horizontalTileCount, verticalTileCount: verticalTileCount
            });
          });
        });
      } else {
        return __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_promise___default.a.resolve(new Filter());
      }
    }

    /**
     * Initializes the categories
     * @private
     */

  }, {
    key: '_initCategories',
    value: function _initCategories() {
      var _this2 = this;

      // Should the categories passed in by the user replace the existing ones?
      if (this._options.categories) {
        if (this._options.replaceCategories) {
          this._categories = this._options.categories;
        } else {
          this._categories = __WEBPACK_IMPORTED_MODULE_2_globals__["m" /* Utils */].mergeCategories(this._categories, this._options.categories, 'filters');
        }
      }

      // Remove filters that should not be selectable
      if (this._options.availableFilters) {
        var newCategories = [];
        this._categories.forEach(function (category) {
          var filters = category.filters.filter(function (f) {
            return _this2._options.availableFilters.indexOf(f.identifier) !== -1;
          });
          if (filters.length > 0) {
            newCategories.push({
              identifier: category.identifier,
              defaultName: category.defaultName,
              filters: filters
            });
          }
        });
        this._categories = newCategories;
      }

      var allCategory = {
        identifier: 'all',
        defaultName: 'All',
        filters: this._categories.length <= 0 ? [] : this._categories.map(function (c) {
          return c.filters;
        }).reduce(function (a, b) {
          return a.concat(b);
        })
      };
      this._categories.unshift(allCategory);
      this._categoriesById.all = allCategory;
      this._categories.forEach(function (c) {
        _this2._categoriesById[c.identifier] = c;
      });
      allCategory.filters.forEach(function (filter) {
        _this2._filtersByIdentifier[filter.identifier] = filter;
      });
    }

    /**
     * Returns the filters for the category with the given name
     * @param  {String} categoryIdentifier
     * @return {Object[]}
     */

  }, {
    key: 'getFiltersForCategory',
    value: function getFiltersForCategory(categoryIdentifier) {
      if (!this._categoriesById[categoryIdentifier]) {
        throw new Error('Unknown filter category \'' + categoryIdentifier + '\'');
      }
      return this._categoriesById[categoryIdentifier].filters;
    }

    /**
     * Returns the filter with the given identifier
     * @param  {String} identifier
     * @return {PhotoEditorSDK.Filter}
     */

  }, {
    key: 'getFilterByIdentifier',
    value: function getFilterByIdentifier(identifier) {
      return this._filtersByIdentifier[identifier];
    }

    /**
     * Returns the categories
     * @return {Object[]}
     */

  }, {
    key: 'getCategories',
    value: function getCategories() {
      return this._categories;
    }

    /**
     * Returns the category with the given identifier
     * @param  {String} identifier
     * @return {Object}
     */

  }, {
    key: 'getCategoryByIdentifier',
    value: function getCategoryByIdentifier(identifier) {
      return this._categoriesById[identifier];
    }
  }]);

  return FilterManager;
}();

/* harmony default export */ __webpack_exports__["a"] = (FilterManager);

/***/ }),
/* 340 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_globals__ = __webpack_require__(9);


var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */



var BrushManager = function () {
  function BrushManager(ui, options) {
    _classCallCheck(this, BrushManager);

    this._ui = ui;
    this._options = options;
    this._brushes = [];
    this._brushesById = {};

    this._addBrushes(__WEBPACK_IMPORTED_MODULE_1_globals__["c" /* Constants */].DEFAULTS.BRUSHES);

    var _options = this._options,
        brushes = _options.brushes,
        replaceBrushes = _options.replaceBrushes,
        availableBrushes = _options.availableBrushes;

    if (this._options.brushes) {
      this._addBrushes(brushes, replaceBrushes);
    }

    if (availableBrushes) {
      this._brushes = this._brushes.filter(function (brush) {
        return availableBrushes.indexOf(brush.identifier) !== -1;
      });
    }
  }

  _createClass(BrushManager, [{
    key: '_addBrushes',
    value: function _addBrushes(brushes, replaceBrushes) {
      var _this = this;

      if (replaceBrushes) {
        this._brushes = [];
        this._brushesById = {};
      }

      brushes.forEach(function (brush) {
        _this._brushes.push(brush);
        _this._brushesById[brush.identifier] = brush;
      });
    }

    /**
     * Returns the brush with the given identifier
     * @param  {String} identifier
     */

  }, {
    key: 'getBrushByIdentifier',
    value: function getBrushByIdentifier(identifier) {
      return this._brushesById[identifier];
    }

    /**
     * Returns all brushes
     * @return {PhotoEditorSDK.Operations.SpriteOperation.BrushSprite.Brush[]}
     */

  }, {
    key: 'getBrushes',
    value: function getBrushes() {
      return this._brushes;
    }

    /**
     * Returns the first available brush
     * @return {PhotoEditorSDK.Operations.SpriteOperation.BrushSprite.Brush}
     */

  }, {
    key: 'getFirstBrush',
    value: function getFirstBrush() {
      return this._brushes[0];
    }
  }]);

  return BrushManager;
}();

/* harmony default export */ __webpack_exports__["a"] = (BrushManager);

/***/ }),
/* 341 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor__ = __webpack_require__(7);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_canvas__ = __webpack_require__(19);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_canvas___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_canvas__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__base_font_loader__ = __webpack_require__(342);






var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor___default()(object, property); if (desc === undefined) { var parent = __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if ("value" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




var FileFontLoader = function (_BaseFontLoader) {
  _inherits(FileFontLoader, _BaseFontLoader);

  function FileFontLoader() {
    _classCallCheck(this, FileFontLoader);

    return _possibleConstructorReturn(this, (FileFontLoader.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(FileFontLoader)).apply(this, arguments));
  }

  _createClass(FileFontLoader, [{
    key: 'load',
    value: function load() {
      var _this2 = this;

      this._fonts.forEach(function (variation) {
        var fontPath = _this2._ui.getAssetPath(variation.getFilePath(), false, true);
        Object(__WEBPACK_IMPORTED_MODULE_5_canvas__["registerFont"])(fontPath, {
          family: variation.getFont().getFontFamily(),
          weight: variation.getFontWeight(),
          style: variation.getFontStyle()
        });
      });
      return _get(FileFontLoader.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(FileFontLoader.prototype), 'load', this).call(this);
    }
  }]);

  return FileFontLoader;
}(__WEBPACK_IMPORTED_MODULE_6__base_font_loader__["a" /* default */]);

/* harmony default export */ __webpack_exports__["a"] = (FileFontLoader);

/***/ }),
/* 342 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_promise__ = __webpack_require__(11);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_promise___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_promise__);



var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */

var BaseFontLoader = function () {
  function BaseFontLoader(ui) {
    _classCallCheck(this, BaseFontLoader);

    this._ui = ui;
    this._fonts = [];
  }

  /**
   * Adds the given font to the list of fonts to load
   * @param {Object} variation
   */


  _createClass(BaseFontLoader, [{
    key: "add",
    value: function add(variation) {
      this._fonts.push(variation);
    }

    /**
     * Loads the fonts
     */

  }, {
    key: "load",
    value: function load() {
      return __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_promise___default.a.resolve();
    }

    /**
     * Disposes the observers
     */

  }, {
    key: "dispose",
    value: function dispose() {}
  }]);

  return BaseFontLoader;
}();

/* harmony default export */ __webpack_exports__["a"] = (BaseFontLoader);

/***/ }),
/* 343 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
Object.defineProperty(__webpack_exports__, "__esModule", { value: true });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__serializer__ = __webpack_require__(135);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__deserializer__ = __webpack_require__(136);


var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




var Serialization = function () {
  function Serialization(editor) {
    _classCallCheck(this, Serialization);

    this._editor = editor;
  }

  /**
   * Serializes the editor state
   * @return {Promise}
   */


  _createClass(Serialization, [{
    key: 'serialize',
    value: function serialize() {
      var serializer = new __WEBPACK_IMPORTED_MODULE_1__serializer__["a" /* default */](this._editor);
      return serializer.serialize.apply(serializer, arguments);
    }

    /**
     * Deserializes the given data
     * @param  {Object} data
     * @return {Promise}
     */

  }, {
    key: 'deserialize',
    value: function deserialize(data) {
      var deserializer = new __WEBPACK_IMPORTED_MODULE_2__deserializer__["a" /* default */](this._editor, data);
      return deserializer.deserialize();
    }
  }]);

  return Serialization;
}();

/* harmony default export */ __webpack_exports__["default"] = (Serialization);


Serialization.version = '1.0.1';

/***/ }),
/* 344 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
Object.defineProperty(__webpack_exports__, "__esModule", { value: true });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__serializer__ = __webpack_require__(137);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__deserializer__ = __webpack_require__(139);


var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




var Serialization = function () {
  function Serialization(editor) {
    _classCallCheck(this, Serialization);

    this._editor = editor;
  }

  /**
   * Serializes the editor state
   * @return {Promise}
   */


  _createClass(Serialization, [{
    key: 'serialize',
    value: function serialize() {
      var serializer = new __WEBPACK_IMPORTED_MODULE_1__serializer__["a" /* default */](this._editor);
      return serializer.serialize.apply(serializer, arguments);
    }

    /**
     * Deserializes the given data
     * @param  {Object} data
     * @return {Promise}
     */

  }, {
    key: 'deserialize',
    value: function deserialize(data) {
      var deserializer = new __WEBPACK_IMPORTED_MODULE_2__deserializer__["a" /* default */](this._editor, data);
      return deserializer.deserialize();
    }
  }]);

  return Serialization;
}();

/* harmony default export */ __webpack_exports__["default"] = (Serialization);


Serialization.version = '2.0.0';

/***/ }),
/* 345 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_globals__ = __webpack_require__(9);


var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */



var FrameManager = function () {
  function FrameManager(ui, options) {
    _classCallCheck(this, FrameManager);

    this._ui = ui;
    this._options = options;

    this._categoriesById = {};
    this._categories = [];
    this._framesById = {};

    this._addCategories(__WEBPACK_IMPORTED_MODULE_1_globals__["l" /* SharedConstants */].DEFAULTS.FRAME_CATEGORIES);

    var _options = this._options,
        categories = _options.categories,
        replaceCategories = _options.replaceCategories;

    if (this._options.categories) {
      this._addCategories(categories, replaceCategories);
    } else {
      this._updateAllCategory();
    }
  }

  /**
   * Initializes the categories
   * @param {Object[]} categories
   * @param {Boolean} replace = false
   * @private
   */


  _createClass(FrameManager, [{
    key: '_addCategories',
    value: function _addCategories(categories) {
      var _this = this;

      var replace = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;

      if (replace) {
        this._categories = categories.slice(0);
      } else {
        this._categories = __WEBPACK_IMPORTED_MODULE_1_globals__["m" /* Utils */].mergeCategories(this._categories, categories, 'frames');
      }

      // Build cat id => category hash
      this._categoriesById = {};
      this._categories.forEach(function (c) {
        _this._categoriesById[c.identifier] = c;
      });

      // Filter frames
      var availableFrames = this._options.availableFrames;

      if (availableFrames) {
        this._categories.forEach(function (c) {
          c.frames = c.frames.filter(function (f) {
            return availableFrames.indexOf(f.identifier) !== -1;
          });
        });
      }

      // Build frame id => frame hash
      this._categories.forEach(function (c) {
        c.frames.forEach(function (s) {
          _this._framesById[s.identifier] = s;
        });
      });

      this._updateAllCategory();
    }

    /**
     * Updates the `all` category which contains all frames
     * @private
     */

  }, {
    key: '_updateAllCategory',
    value: function _updateAllCategory() {
      this._allCategory = {
        identifier: 'all',
        defaultName: 'All',
        frames: this._categories.map(function (c) {
          return c.frames;
        }).reduce(function (a, b) {
          return a.concat(b);
        }, [])
      };
      this._categoriesById.all = this._allCategory;
    }

    /**
     * Returns the frames for the category with the given name
     * @param  {String} categoryName
     * @return {Object[]}
     */

  }, {
    key: 'getFramesForCategory',
    value: function getFramesForCategory(categoryName) {
      if (!this._categoriesById[categoryName]) {
        throw new Error('Unknown frame category \'' + categoryName + '\'');
      }
      return this._categoriesById[categoryName].frames;
    }

    /**
     * Returns the frame with the given identifier
     * @param  {String} identifier
     */

  }, {
    key: 'getFrameByIdentifier',
    value: function getFrameByIdentifier(identifier) {
      return this._framesById[identifier];
    }

    /**
     * Returns the categories
     * @return {Object[]}
     */

  }, {
    key: 'getCategories',
    value: function getCategories() {
      return this._categories;
    }

    /**
     * Returns the category object for the given id
     * @param  {String} id
     * @return {Object}
     */

  }, {
    key: 'getCategory',
    value: function getCategory(id) {
      return this._categoriesById[id];
    }
  }]);

  return FrameManager;
}();

/* harmony default export */ __webpack_exports__["a"] = (FrameManager);

/***/ }),
/* 346 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_globals__ = __webpack_require__(9);


var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */



var OverlayManager = function () {
  function OverlayManager(ui, options) {
    var _this = this;

    _classCallCheck(this, OverlayManager);

    this._ui = ui;
    this._options = options;
    this._overlays = __WEBPACK_IMPORTED_MODULE_1_globals__["l" /* SharedConstants */].DEFAULTS.OVERLAYS.slice(0);
    this._overlaysByIdentifier = {};

    if (options.overlays) {
      if (options.replaceOverlays) {
        this._overlays = options.overlays;
      } else {
        this._overlays = this._overlays.concat(options.overlays);
      }
    }

    // Filter available
    if (options.availableOverlays) {
      this._overlays = this._overlays.filter(function (o) {
        return options.availableOverlays.indexOf(o.identifier) !== -1;
      });
    }

    this._overlays.forEach(function (overlay) {
      _this._overlaysByIdentifier[overlay.identifier] = overlay;
    });
  }

  /**
   * Returns the overlays
   * @return {Object[]}
   */


  _createClass(OverlayManager, [{
    key: 'getOverlays',
    value: function getOverlays() {
      return this._overlays;
    }

    /**
     * Returns the overlay with the given identifier
     * @param  {String} identifier
     * @return {Object}
     */

  }, {
    key: 'getOverlayByIdentifier',
    value: function getOverlayByIdentifier(identifier) {
      return this._overlaysByIdentifier[identifier];
    }
  }]);

  return OverlayManager;
}();

/* harmony default export */ __webpack_exports__["a"] = (OverlayManager);

/***/ }),
/* 347 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_promise__ = __webpack_require__(11);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_promise___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_promise__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__globals__ = __webpack_require__(9);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_shared_loaders_image_loader__ = __webpack_require__(48);






var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */



var OptionType = __WEBPACK_IMPORTED_MODULE_5__globals__["j" /* SDK */].OptionType;

var Frame = function (_SDK$Configurable) {
  _inherits(Frame, _SDK$Configurable);

  function Frame(ui) {
    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};

    _classCallCheck(this, Frame);

    var _this = _possibleConstructorReturn(this, (Frame.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(Frame)).call(this, options));

    _this._loaded = false;
    _this._loading = false;
    _this._ui = ui;
    _this._frame = __WEBPACK_IMPORTED_MODULE_5__globals__["j" /* SDK */].Utils.deepClone(_this._options);
    return _this;
  }

  /**
   * Loads the images of this frame
   * @return {Promise}
   */


  _createClass(Frame, [{
    key: 'load',
    value: function load() {
      var _this2 = this;

      if (this._loaded) return __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_promise___default.a.resolve();
      if (this._loading) return __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_promise___default.a.reject(new Error('Called Frame#load while it\'s already loading'));

      this._loading = true;
      var imageGroups = this._frame.imageGroups;


      var promises = [];
      ['top', 'left', 'right', 'bottom'].forEach(function (groupName) {
        if (!(groupName in imageGroups)) return;

        var group = imageGroups[groupName];
        ['start', 'mid', 'end'].forEach(function (partName) {
          if (!(partName in group)) return;

          promises.push(_this2._loadPart(groupName, partName));
        });
      });

      return __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_promise___default.a.all(promises).then(function () {
        _this2._loaded = true;
        _this2._loading = false;
      }).catch(function (e) {
        _this2._loaded = false;
        _this2._loading = false;
      });
    }

    /**
     * Loads the given part of the given group
     * @param  {String} groupName
     * @param  {String} partName
     * @return {Promise}
     * @private
     */

  }, {
    key: '_loadPart',
    value: function _loadPart(groupName, partName) {
      var _this3 = this;

      var imageGroups = this._frame.imageGroups;


      var part = imageGroups[groupName][partName];
      var imageUrl = part;
      // `part` can also be an object containing `mode` and `image`
      if (typeof part !== 'string' && 'image' in part) {
        imageUrl = part.image;
      }

      return __WEBPACK_IMPORTED_MODULE_6_shared_loaders_image_loader__["a" /* default */].load(this._ui.getAssetPath(imageUrl)).then(function (image) {
        if (typeof part !== 'string') {
          _this3._frame.imageGroups[groupName][partName].image = image;
        } else {
          _this3._frame.imageGroups[groupName][partName] = image;
        }
        return image;
      });
    }

    /**
     * Returns the frame
     * @return {Object}
     */

  }, {
    key: 'getFrame',
    value: function getFrame() {
      return this._frame;
    }
  }]);

  return Frame;
}(__WEBPACK_IMPORTED_MODULE_5__globals__["j" /* SDK */].Configurable);

/**
 * Specifies the available options for the Frame class
 * @type {Object}
 * @ignore
 */


/* harmony default export */ __webpack_exports__["a"] = (Frame);
Frame.prototype.availableOptions = {
  identifier: { type: OptionType.STRING, required: true },
  defaultName: { type: OptionType.STRING },
  thumbnail: { type: OptionType.STRING },
  tintable: { type: OptionType.BOOLEAN, default: false },
  layoutMode: {
    type: OptionType.STRING,
    default: 'horizontal-inside',
    available: ['horizontal-inside', 'vertical-inside']
  },
  imageGroups: { type: OptionType.OBJECT, required: true }
};

/***/ }),
/* 348 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
Object.defineProperty(__webpack_exports__, "__esModule", { value: true });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__serializer__ = __webpack_require__(349);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__deserializer__ = __webpack_require__(350);


var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




var Serialization = function () {
  function Serialization(editor) {
    _classCallCheck(this, Serialization);

    this._editor = editor;
  }

  /**
   * Serializes the editor state
   * @return {Promise}
   */


  _createClass(Serialization, [{
    key: 'serialize',
    value: function serialize() {
      var serializer = new __WEBPACK_IMPORTED_MODULE_1__serializer__["a" /* default */](this._editor);
      return serializer.serialize.apply(serializer, arguments);
    }

    /**
     * Deserializes the given data
     * @param  {Object} data
     * @return {Promise}
     */

  }, {
    key: 'deserialize',
    value: function deserialize(data) {
      var deserializer = new __WEBPACK_IMPORTED_MODULE_2__deserializer__["a" /* default */](this._editor, data);
      return deserializer.deserialize();
    }
  }]);

  return Serialization;
}();

/* harmony default export */ __webpack_exports__["default"] = (Serialization);


Serialization.version = '3.0.0';

/***/ }),
/* 349 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor__ = __webpack_require__(7);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_globals__ = __webpack_require__(9);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__2_0_0_serializer__ = __webpack_require__(137);






var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor___default()(object, property); if (desc === undefined) { var parent = __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if ("value" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




var v300Serializer = function (_PreviousSerializer) {
  _inherits(v300Serializer, _PreviousSerializer);

  function v300Serializer() {
    _classCallCheck(this, v300Serializer);

    return _possibleConstructorReturn(this, (v300Serializer.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(v300Serializer)).apply(this, arguments));
  }

  _createClass(v300Serializer, [{
    key: 'serialize',

    /**
     * Serializes the editor state
     * @param {Object} options = {}
     * @return {Promise}
     */
    value: function serialize() {
      var _this2 = this;

      var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};

      return _get(v300Serializer.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(v300Serializer.prototype), 'serialize', this).call(this, options).then(function (data) {
        data.meta = {
          platform: 'html5',
          version: _this2._editor.getSDK().version,
          createdAt: __WEBPACK_IMPORTED_MODULE_5_globals__["k" /* SDKUtils */].ISODateString(new Date())
        };
        data.image = data.inputImage;
        delete data.inputImage;
        return data;
      });
    }

    /**
     * Serializes the given sticker
     * @param  {PhotoEditorSDK.Operation} operation
     * @param  {PhotoEditorSDK.Operations.SpriteOperation.StickerSprite} sprite
     * @return {Object}
     * @private
     */

  }, {
    key: '_serializeSticker',
    value: function _serializeSticker(operation, sprite) {
      var response = _get(v300Serializer.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(v300Serializer.prototype), '_serializeSticker', this).call(this, operation, sprite);
      response.options.alpha = sprite.getAlpha();

      if (response.options.tintColor) {
        response.options.tintColor = {
          rgba: response.options.tintColor
        };
      }

      return response;
    }

    /**
     * Serializes the given text sprite
     * @param  {PhotoEditorSDK.Operation} operation
     * @param  {PhotoEditorSDK.Operations.SpriteOperation.TextSprite} sprite
     * @return {Object}
     * @private
     */

  }, {
    key: '_serializeText',
    value: function _serializeText(operation, sprite) {
      var response = _get(v300Serializer.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(v300Serializer.prototype), '_serializeText', this).call(this, operation, sprite);
      response.options.color = {
        rgba: response.options.color
      };
      response.options.backgroundColor = {
        rgba: response.options.backgroundColor
      };
      response.options.flipHorizontally = false;
      response.options.flipVertically = false;
      delete response.options.fontWeight;
      return response;
    }

    /**
     * Serializes the given path
     * @param  {PhotoEditorSDK.Operations.SpriteOperation.BrushSprite.Path} path
     * @return {Object}
     * @private
     */

  }, {
    key: '_serializePath',
    value: function _serializePath(path) {
      var response = _get(v300Serializer.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(v300Serializer.prototype), '_serializePath', this).call(this, path);

      delete response.hardness;
      delete response.size;
      delete response.color;

      var brush = path.getBrush();
      response.brush = brush.serializeOptions(['identifier', 'size', 'color'], true);
      if (typeof response.brush.identifier === 'undefined') {
        delete response.brush.identifier;
      }
      response.brush.color = {
        rgba: response.brush.color
      };

      var hardness = brush.getOption('hardness');
      if (hardness !== 'undefined') {
        response.brush.hardness = hardness;
      }
      return response;
    }

    /**
     * Serializes the frame operation
     * @param {PhotoEditorSDK.Operation.FrameOperation} operation
     * @param {PhotoEditorSDK.Operation[]} operations
     * @private
     */

  }, {
    key: '_serializeFrameOperation',
    value: function _serializeFrameOperation(operation, operations) {
      _get(v300Serializer.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(v300Serializer.prototype), '_serializeFrameOperation', this).call(this, operation, operations);

      // Find sprite operation and frame sprite from serialized data
      var spriteOperations = operations.filter(function (o) {
        return o.type === 'sprite';
      });
      var spriteOperation = void 0;
      if (spriteOperations.length) {
        spriteOperation = spriteOperations.pop();
        var frame = spriteOperation.options.sprites.filter(function (s) {
          return s.type === 'frame';
        })[0];

        var tintColor = operation.getTintColor();
        if (!tintColor.equals(new __WEBPACK_IMPORTED_MODULE_5_globals__["b" /* Color */](1, 1, 1, 0))) {
          frame.options.tintColor = {
            rgba: operation.serializeOption('tintColor', true)
          };
        }

        var options = operation.serializeOptions(['scale', 'alpha'], true);
        frame.options = __WEBPACK_IMPORTED_MODULE_5_globals__["k" /* SDKUtils */].extend(frame.options, options);
        frame.options.size = frame.options.scale;
        delete frame.options.scale;
      }
    }

    /**
     * Serializes the given transform operation
     * @param  {PhotoEditorSDK.Operation.TransformOperation} operation
     * @return {Object}
     * @private
     */

  }, {
    key: '_serializeTransformOperation',
    value: function _serializeTransformOperation(operation) {
      var response = _get(v300Serializer.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(v300Serializer.prototype), '_serializeTransformOperation', this).call(this, operation);

      if (operation._ratio) {
        response.options.meta = {
          identifier: operation._ratio.identifier
        };
      }
      delete response.options.scale;

      return response;
    }

    /**
     * Serializes the given adjustments operation
     * @param  {PhotoEditorSDK.Operations.AdjustmentsOperation} operation
     * @return {Object}
     * @private
     */

  }, {
    key: '_serializeAdjustmentsOperation',
    value: function _serializeAdjustmentsOperation(operation) {
      var response = _get(v300Serializer.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(v300Serializer.prototype), '_serializeAdjustmentsOperation', this).call(this, operation);

      var availableOptions = operation.availableOptions;

      var option = availableOptions.gamma;
      var value = operation.getGamma();
      var minValue = option.minValue,
          midValue = option.midValue,
          maxValue = option.maxValue;

      response.options.gamma = value <= midValue ? (value - minValue) / (midValue - minValue) - 1 : (value - midValue) / (maxValue - midValue);
      return response;
    }

    /**
     * Serializes the given operation
     * @param  {PhotoEditorSDK.Operation} operation
     * @param  {PhotoEditorSDK.Operation[]} operations
     * @return {Object}
     * @private
     */

  }, {
    key: '_serializeOperation',
    value: function _serializeOperation(operation, operations) {
      switch (operation.constructor.identifier) {
        case 'mirrored-focus':
          return this._serializeMirroredFocusOperation(operation);
        case 'linear-focus':
          return this._serializeLinearFocusOperation(operation);
        case 'blur':
          return this._serializeBlurOperation(operation);
        default:
          return _get(v300Serializer.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(v300Serializer.prototype), '_serializeOperation', this).call(this, operation, operations);
      }
    }

    /**
     * Serializes the given mirrored focus operation
     * @param  {PhotoEditorSDK.Operations.MirroredFocusOperation} operation
     * @return {Object}
     * @private
     */

  }, {
    key: '_serializeMirroredFocusOperation',
    value: function _serializeMirroredFocusOperation(operation) {
      return {
        type: 'focus',
        options: {
          type: 'mirrored',
          options: operation.serializeOptions(['start', 'end', 'blurRadius', 'size', 'gradientSize'], true)
        }
      };
    }

    /**
     * Serializes the given linear focus operation
     * @param  {PhotoEditorSDK.Operations.LinearFocusOperation} operation
     * @return {Object}
     * @private
     */

  }, {
    key: '_serializeLinearFocusOperation',
    value: function _serializeLinearFocusOperation(operation) {
      var options = operation.serializeOptions(['controlPoint1', 'controlPoint2', 'blurRadius'], true);
      options.start = options.controlPoint1;
      delete options.controlPoint1;
      options.end = options.controlPoint2;
      delete options.controlPoint2;

      return {
        type: 'focus',
        options: {
          type: 'linear',
          options: options
        }
      };
    }

    /**
     * Serializes the given blur operation
     * @param  {PhotoEditorSDK.Operations.BlurOperation} operation
     * @return {Object}
     * @private
     */

  }, {
    key: '_serializeBlurOperation',
    value: function _serializeBlurOperation(operation) {
      return {
        type: 'focus',
        options: {
          type: 'gaussian',
          options: operation.serializeOptions(['blurRadius'], true)
        }
      };
    }
  }]);

  return v300Serializer;
}(__WEBPACK_IMPORTED_MODULE_6__2_0_0_serializer__["a" /* default */]);

/* harmony default export */ __webpack_exports__["a"] = (v300Serializer);


v300Serializer.version = '3.0.0';

/***/ }),
/* 350 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor__ = __webpack_require__(7);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_promise__ = __webpack_require__(11);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_promise___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_promise__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_globals__ = __webpack_require__(9);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__2_0_0_deserializer__ = __webpack_require__(139);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8_shared_managers_sticker_manager__ = __webpack_require__(89);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9_shared_loaders_image_loader__ = __webpack_require__(48);







var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor___default()(object, property); if (desc === undefined) { var parent = __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default()(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if ("value" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */






var Brush = void 0;
if (typeof __WEBPACK_IMPORTED_MODULE_6_globals__["j" /* SDK */].Operations.SpriteOperation !== 'undefined') {
  Brush = __WEBPACK_IMPORTED_MODULE_6_globals__["j" /* SDK */].Operations.SpriteOperation.BrushSprite.Brush;
}

var v300Deserializer = function (_PreviousDeserializer) {
  _inherits(v300Deserializer, _PreviousDeserializer);

  function v300Deserializer() {
    _classCallCheck(this, v300Deserializer);

    return _possibleConstructorReturn(this, (v300Deserializer.__proto__ || __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default()(v300Deserializer)).apply(this, arguments));
  }

  _createClass(v300Deserializer, [{
    key: '_deserializeSticker',

    /**
     * Deserializes the given sticker for the given operation
     * @param  {Object} operation
     * @param  {Object} sprite
     * @return {PhotoEditorSDK.Operations.SpriteOperation.StickerSprite}
     * @private
     */
    value: function _deserializeSticker(operation, sprite) {
      var SpriteOperation = __WEBPACK_IMPORTED_MODULE_6_globals__["j" /* SDK */].Operations.SpriteOperation;
      var options = sprite.options;

      var sticker = this._stickerManager.getStickerByIdentifier(options.identifier);
      if (!sticker) {
        __WEBPACK_IMPORTED_MODULE_6_globals__["g" /* Log */].warn('Deserializer', 'Unknown sticker `' + options.identifier + '`. Skipping sprite.');
        return __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_promise___default.a.resolve();
      }
      var url = __WEBPACK_IMPORTED_MODULE_8_shared_managers_sticker_manager__["a" /* default */].getURLForSticker(sticker, 'base');
      var resolvedUrl = this._editor.getUI().getAssetPath(url);
      var inputDimensions = operation.getInputDimensions(false);
      return __WEBPACK_IMPORTED_MODULE_9_shared_loaders_image_loader__["a" /* default */].load(resolvedUrl).then(function (image) {
        var adjustments = SpriteOperation.StickerSprite.prototype.availableOptions.adjustments.structure;
        var rotation = options.rotation,
            flipHorizontally = options.flipHorizontally,
            flipVertically = options.flipVertically;

        var stickerOptions = {
          identifier: options.identifier,
          image: image,
          position: __WEBPACK_IMPORTED_MODULE_6_globals__["n" /* Vector2 */].fromObject(options.position),
          dimensions: __WEBPACK_IMPORTED_MODULE_6_globals__["n" /* Vector2 */].fromObject(options.dimensions).multiply(inputDimensions.min()),
          rotation: rotation || 0,
          flipHorizontally: flipHorizontally,
          flipVertically: flipVertically,
          adjustments: {}
        };

        if (typeof options.adjustments !== 'undefined') {
          ['brightness', 'contrast', 'saturation'].forEach(function (option) {
            if (typeof options.adjustments[option] !== 'undefined') {
              stickerOptions.adjustments[option] = options.adjustments[option] + adjustments[option].default;
            }
          });
        }

        if (typeof options.tintColor !== 'undefined' && typeof sticker.tintMode !== 'undefined') {
          stickerOptions.tintColor = __WEBPACK_IMPORTED_MODULE_6_globals__["b" /* Color */].fromArray(options.tintColor.rgba);
          stickerOptions.tintMode = sticker.tintMode;
        }

        if (typeof options.alpha !== 'undefined') {
          stickerOptions.alpha = options.alpha;
        }

        return operation.createSticker(stickerOptions);
      });
    }

    /**
     * Deserializes the given transform operation
     * @param  {Object} operationData
     * @return {Promise}
     * @private
     */

  }, {
    key: '_deserializeTransformOperation',
    value: function _deserializeTransformOperation(operationData) {
      return _get(v300Deserializer.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default()(v300Deserializer.prototype), '_deserializeTransformOperation', this).call(this, operationData).then(function (operation) {
        if (!operation) return;

        // TODO: Get correct ratio
        operation._ratio = null;
        return operation;
      });
    }

    /**
     * Deserializes the input image (if present)
     * @return {Promise}
     * @private
     */

  }, {
    key: '_deserializeInputImage',
    value: function _deserializeInputImage() {
      var _this2 = this;

      var _data$image = this._data.image,
          data = _data$image.data,
          type = _data$image.type,
          uri = _data$image.uri;


      if (data && type) {
        uri = 'data:' + type + ';base64,' + data;
      }

      if (uri) {
        return __WEBPACK_IMPORTED_MODULE_9_shared_loaders_image_loader__["a" /* default */].load(uri).then(function (image) {
          _this2._editor.setImage(image);
        });
      } else {
        return __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_promise___default.a.resolve();
      }
    }

    /**
     * Deserializes the given adjustments operation
     * @param  {Object} operationData
     * @return {Promise}
     * @private
     */

  }, {
    key: '_deserializeAdjustmentsOperation',
    value: function _deserializeAdjustmentsOperation(operationData) {
      var AdjustmentsOperation = __WEBPACK_IMPORTED_MODULE_6_globals__["j" /* SDK */].Operations.AdjustmentsOperation;

      return _get(v300Deserializer.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default()(v300Deserializer.prototype), '_deserializeAdjustmentsOperation', this).call(this, operationData).then(function (operation) {
        if (!operation) return null;

        var options = operationData.options;

        if (typeof options.gamma !== 'undefined') {
          var _AdjustmentsOperation = AdjustmentsOperation.prototype.availableOptions.gamma,
              minValue = _AdjustmentsOperation.minValue,
              midValue = _AdjustmentsOperation.midValue,
              maxValue = _AdjustmentsOperation.maxValue;

          operation.setGamma(options.gamma < 0 ? midValue + (midValue - minValue) * options.gamma : midValue + (maxValue - midValue) * options.gamma);
        }
        return operation;
      });
    }

    /**
     * Deserializes the given focus operation
     * @param  {Object} operationData
     * @return {Promise}
     * @private
     */

  }, {
    key: '_deserializeFocusOperation',
    value: function _deserializeFocusOperation(operationData) {
      var options = operationData.options.options;

      switch (operationData.options.type) {
        case 'radial':
          return _get(v300Deserializer.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default()(v300Deserializer.prototype), '_deserializeFocusOperation', this).call(this, operationData);
        case 'linear':
          {
            var start = options.start,
                end = options.end,
                blurRadius = options.blurRadius;

            return __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_promise___default.a.resolve(this._editor.operations.getOrCreate('linear-focus', {
              controlPoint1: __WEBPACK_IMPORTED_MODULE_6_globals__["n" /* Vector2 */].fromObject(start),
              controlPoint2: __WEBPACK_IMPORTED_MODULE_6_globals__["n" /* Vector2 */].fromObject(end),
              blurRadius: blurRadius
            }));
          }
        case 'mirrored':
          {
            var _start = options.start,
                _end = options.end,
                size = options.size,
                gradientSize = options.gradientSize,
                _blurRadius = options.blurRadius;

            return __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_promise___default.a.resolve(this._editor.operations.getOrCreate('mirrored-focus', {
              start: __WEBPACK_IMPORTED_MODULE_6_globals__["n" /* Vector2 */].fromObject(_start),
              end: __WEBPACK_IMPORTED_MODULE_6_globals__["n" /* Vector2 */].fromObject(_end),
              size: size,
              gradientSize: gradientSize,
              blurRadius: _blurRadius
            }));
          }
        case 'gaussian':
          {
            var _blurRadius2 = options.blurRadius;

            return __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_promise___default.a.resolve(this._editor.operations.getOrCreate('blur', {
              blurRadius: _blurRadius2
            }));
          }
      }
    }

    /**
     * Deserializes the given text for the given operation
     * @param  {PhotoEditorSDK.Operations.SpriteOperation} operation
     * @param  {Object} text
     * @return {PhotoEditorSDK.Operations.SpriteOperation.TextSprite}
     * @private
     */

  }, {
    key: '_deserializeText',
    value: function _deserializeText(operation, text) {
      var options = text.options;
      var fontSize = options.fontSize,
          lineHeight = options.lineHeight,
          fontIdentifier = options.fontIdentifier,
          alignment = options.alignment,
          rotation = options.rotation,
          maxWidth = options.maxWidth,
          color = options.color,
          backgroundColor = options.backgroundColor;


      var fontLoader = this._ui.getFontLoader();
      var variation = this._fontManager.getVariationByIdentifier(fontIdentifier);
      if (!variation) {
        variation = this._fontManager.getDefaultVariation();
      } else {
        fontLoader.setFonts([variation.getFont()]);
      }
      return fontLoader.load().then(function () {
        var inputDimensions = operation.getInputDimensions(false);

        // For whatever reason, max width is relative to shortest side, while font size isn't
        var fixedMaxWidth = maxWidth * inputDimensions.min() / inputDimensions.x;
        return operation.createText({
          fontSize: fontSize,
          lineHeight: lineHeight,
          fontFamily: variation.getFontFamily(),
          fontWeight: variation.getFontWeight(),
          fontIdentifier: variation.getIdentifier(),
          textMetrics: variation.getTextMetrics(),
          alignment: alignment,
          rotation: rotation,
          maxWidth: fixedMaxWidth,
          text: options.text,
          color: __WEBPACK_IMPORTED_MODULE_6_globals__["b" /* Color */].fromArray(color.rgba),
          backgroundColor: __WEBPACK_IMPORTED_MODULE_6_globals__["b" /* Color */].fromArray(backgroundColor.rgba),
          position: __WEBPACK_IMPORTED_MODULE_6_globals__["n" /* Vector2 */].fromObject(options.position)
        });
      });
    }

    /**
     * Creates a brush face with the given options
     * @param  {PhotoEditorSDK.Operations.SpriteOperation.Sprites.BrushSprite.Path} path
     * @return {PhotoEditorSDK.Operations.SpriteOperation.Sprites.BrushSprite.Brush}
     */

  }, {
    key: '_createBrushForPath',
    value: function _createBrushForPath(path) {
      var _path$brush = path.brush,
          identifier = _path$brush.identifier,
          color = _path$brush.color,
          size = _path$brush.size,
          hardness = _path$brush.hardness;

      var colorObject = __WEBPACK_IMPORTED_MODULE_6_globals__["b" /* Color */].fromArray(color.rgba);

      var brushOptions = {
        color: colorObject,
        size: size
      };

      if (typeof hardness !== 'undefined') {
        brushOptions.hardness = hardness;
      }

      var rawBrush = this._brushManager.getBrushByIdentifier(identifier);
      if (!rawBrush) {
        rawBrush = this._brushManager.getFirstBrush();
      }

      if (rawBrush.prototype && rawBrush.prototype instanceof Brush) {
        // Custom Brush instance, used for special brushes such as radial brush, which has
        // an additional hardness option
        var BrushClass = rawBrush;
        return new BrushClass(brushOptions);
      } else {
        var _brush = __WEBPACK_IMPORTED_MODULE_6_globals__["k" /* SDKUtils */].extend({}, rawBrush);
        delete _brush.image;

        var _BrushClass = function (_Brush) {
          _inherits(_BrushClass, _Brush);

          function _BrushClass() {
            _classCallCheck(this, _BrushClass);

            return _possibleConstructorReturn(this, (_BrushClass.__proto__ || __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default()(_BrushClass)).apply(this, arguments));
          }

          return _BrushClass;
        }(Brush);

        _BrushClass.identifier = rawBrush.identifier;

        // Plain JS object, used for simple image brushes
        return new _BrushClass(__WEBPACK_IMPORTED_MODULE_6_globals__["k" /* SDKUtils */].extend({}, _brush, brushOptions));
      }
    }

    /**
     * Deserializes the given frame sprite
     * @param  {PhotoEditorSDK.Operations.SpriteOperation}
     * @param  {Object} framespriteOperation
     * @return {Promise}
     * @private
     */

  }, {
    key: '_deserializeFrame',
    value: function _deserializeFrame(spriteOperation, frame) {
      var _this4 = this;

      return _get(v300Deserializer.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default()(v300Deserializer.prototype), '_deserializeFrame', this).call(this, spriteOperation, frame).then(function () {
        var frameOperation = _this4._editor.operations.get('frame');

        var _frame$options = frame.options,
            size = _frame$options.size,
            alpha = _frame$options.alpha,
            tintColor = _frame$options.tintColor;

        var options = {};
        if (typeof size !== 'undefined') {
          options.scale = size;
        }
        if (typeof alpha !== 'undefined') {
          options.alpha = alpha;
        }
        if (typeof tintColor !== 'undefined') {
          options.tintColor = __WEBPACK_IMPORTED_MODULE_6_globals__["b" /* Color */].fromArray(tintColor.rgba);
        }
        frameOperation.set(options);
      });
    }
  }]);

  return v300Deserializer;
}(__WEBPACK_IMPORTED_MODULE_7__2_0_0_deserializer__["a" /* default */]);

/* harmony default export */ __webpack_exports__["a"] = (v300Deserializer);


v300Deserializer.version = '3.0.0';

/***/ })
/******/ ])["default"];
});