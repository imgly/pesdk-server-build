var f0=Object.create;var Gs=Object.defineProperty,p0=Object.defineProperties,_0=Object.getOwnPropertyDescriptor,g0=Object.getOwnPropertyDescriptors,y0=Object.getOwnPropertyNames,mu=Object.getOwnPropertySymbols,x0=Object.getPrototypeOf,fu=Object.prototype.hasOwnProperty,b0=Object.prototype.propertyIsEnumerable;var $a=(o,e,t)=>e in o?Gs(o,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[e]=t,C=(o,e)=>{for(var t in e||(e={}))fu.call(e,t)&&$a(o,t,e[t]);if(mu)for(var t of mu(e))b0.call(e,t)&&$a(o,t,e[t]);return o},L=(o,e)=>p0(o,g0(e)),pu=o=>Gs(o,"__esModule",{value:!0});var _=(o,e)=>()=>(o&&(e=o(o=0)),e);var xt=(o,e)=>()=>(e||o((e={exports:{}}).exports,e),e.exports),Te=(o,e)=>{for(var t in e)Gs(o,t,{get:e[t],enumerable:!0})},_u=(o,e,t,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let r of y0(e))!fu.call(o,r)&&(t||r!=="default")&&Gs(o,r,{get:()=>e[r],enumerable:!(i=_0(e,r))||i.enumerable});return o},Ws=(o,e)=>_u(pu(Gs(o!=null?f0(x0(o)):{},"default",!e&&o&&o.__esModule?{get:()=>o.default,enumerable:!0}:{value:o,enumerable:!0})),o),je=(o=>(e,t)=>o&&o.get(e)||(t=_u(pu({}),e,1),o&&o.set(e,t),t))(typeof WeakMap!="undefined"?new WeakMap:0);var M=(o,e,t)=>($a(o,typeof e!="symbol"?e+"":e,t),t);var Gr=(o,e,t)=>new Promise((i,r)=>{var s=l=>{try{a(t.next(l))}catch(h){r(h)}},n=l=>{try{a(t.throw(l))}catch(h){r(h)}},a=l=>l.done?i(l.value):Promise.resolve(l.value).then(s,n);a((t=t.apply(o,e)).next())});var tt={};Te(tt,{FragmentPrecision:()=>Lo,ImageFormat:()=>Mt,OptionType:()=>E,RenderType:()=>qe,RendererType:()=>ke,UniformType:()=>ce});var qe,Mt,E,ce,ke,Lo,ct=_(()=>{qe={IMAGE:"image",DATAURL:"data-url",BUFFER:"buffer",BLOB:"blob",MSBLOB:"ms-blob"},Mt={PNG:"image/png",JPEG:"image/jpeg",RAW:"raw"},E=(u=>(u.NUMBER="number",u.VECTOR2="vector2",u.COLOR_MATRIX="color-matrix",u.COLOR="color",u.ARRAY="array",u.OBJECT="object",u.STRING="string",u.BOOLEAN="boolean",u.CONFIGURABLE="configurable",u.IMAGE="image",u.FUNCTION="function",u.TEXTURE="texture",u.ALL="*",u))(E||{}),ce=(y=>(y.SAMPLER2D="sampler2d",y.INT="i",y.INT1="1i",y.INT2="2i",y.INT3="3i",y.INT4="4i",y.FLOAT="f",y.FLOAT1="1f",y.FLOAT2="2f",y.FLOAT_VECTOR2="2fv",y.FLOAT3="3f",y.FLOAT4="4f",y.MAT3="mat3",y.MAT3FV="mat3fv",y.MAT4="mat4",y))(ce||{}),ke=(t=>(t.WEBGL="webgl",t.CANVAS="canvas",t))(ke||{}),Lo=(i=>(i.High="highp",i.Medium="mediump",i.Low="lowp",i))(Lo||{})});var ui,el=_(()=>{ui=class{constructor(e,t,i){this.width=e;this.height=t;this.data=i}}});var yu={};Te(yu,{serverUtils:()=>T0});var Di,gu,v0,w0,T0,xu=_(()=>{Di=require("canvas"),gu=Ws(require("gl"));el();v0=o=>{let t=new Di.Canvas(o.width,o.height).getContext("2d");t.drawImage(o,0,0);let i=t.getImageData(0,0,o.width,o.height);return new ui(o.width,o.height,i.data)},w0=(o,e)=>{let t=e instanceof ui?e:v0(e),r=new Di.Canvas(t.width,t.height).getContext("2d");r.drawImage(e,0,0);let s=r.getImageData(0,0,t.width,t.height),n=new ui(t.width,t.height,s.data);o.texImage2D(o.TEXTURE_2D,0,o.RGBA,t.width,t.height,0,o.RGBA,o.UNSIGNED_BYTE,n.data)},T0={isSupported:()=>!0,isCanvas:o=>o instanceof Di.Canvas,isImage:o=>!1,Image:Di.Image,createCanvas:()=>new Di.Canvas(300,150),glMaxTexture:o=>o.getParameter(o.MAX_TEXTURE_SIZE),glGet:o=>(0,gu.default)(o.width,o.height,{preserveDrawingBuffer:!0}),glResize(o,e){let t=o.getExtension("STACKGL_resize_drawingbuffer");return t&&t.resize(e.x,e.y),o},glTexImage:w0}});var bu,Ie,Wr,tl,vu,Bt=_(()=>{ct();bu=(xu(),je(yu)).serverUtils;Ie=bu,Wr=o=>o._type==="webgl",tl=o=>Boolean(o&&"tagName"in o&&o.tagName&&o.tagName.toUpperCase()==="CANVAS"),vu=o=>Boolean("tagName"in o&&o.tagName.toUpperCase()==="IMG")});var zo,wu,Tu=_(()=>{zo=class{static head(e){return e[0]}static tail(e){return e.slice(1)}static last(e){return e[e.length-1]}static init(e){return e.slice(0,e.length-1)}static remove(e,t){return e.filter((i,r,s)=>!t(i,r,s))}static findIndex(e,t){for(let i=0;i<e.length;i++)if(t(e[i]))return i;return-1}static find(e,t){for(let i=0;i<e.length;i++)if(t(e[i]))return e[i]}static flatten(e){return e.reduce(function(t,i){return t.concat(Array.isArray(i)?zo.flatten(i):i)},[])}static range(e,t){let i=[];if(t>e)for(let r=e;r<t;r++)i.push(r);return i}static repeat(e,t){let i=[];for(let r=0;r<t;r++)i[r]=e;return i}static zip(e,t){let i=Math.min(e.length,t.length),r=[];for(let s=0;s<i;s++)r[s]=[e[s],t[s]];return r}},wu=zo});var di,R0,kt,Vr=_(()=>{di="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",R0={encode(o){let e="",t,i,r,s,n,a,l,h=0;do t=o[h++],i=o[h++],r=o[h++],s=t>>2,n=(t&3)<<4|i>>4,a=(i&15)<<2|r>>6,l=r&63,isNaN(i)?a=l=64:isNaN(r)&&(l=64),e=e+di.charAt(s)+di.charAt(n)+di.charAt(a)+di.charAt(l),t=i=r="",s=n=a=l="";while(h<o.length);return e},decode(o){let e,t,i,r,s,n,a,l=0,h=[];if(/[^A-Za-z0-9+/=]/g.exec(o))throw new Error(`There were invalid base64 characters in the input text.
Valid base64 characters are A-Z, a-z, 0-9, '+', '/',and '='
Expect errors in decoding.`);o=o.replace(/[^A-Za-z0-9+/=]/g,"");do r=di.indexOf(o.charAt(l++)),s=di.indexOf(o.charAt(l++)),n=di.indexOf(o.charAt(l++)),a=di.indexOf(o.charAt(l++)),e=r<<2|s>>4,t=(s&15)<<4|n>>2,i=(n&3)<<6|a,h.push(e),n!==64&&h.push(t),a!==64&&h.push(i),e=t=i="",r=s=n=a="";while(l<o.length);return h}},kt=R0});var Pi,il,k,Dt=_(()=>{Bt();Tu();Vr();Pi=class{static mapRange(e,t,i){return(e-t.getMin())*i.getLength()/t.getLength()+i.getMin()}static isPlainObject(e){if(typeof e!="object"||!e)return!1;if(typeof Object.getPrototypeOf=="function"){let t=Object.getPrototypeOf(e);return t===Object.prototype||t===null}return Object.prototype.toString.call(e)==="[object Object]"}static isMobile(){if(typeof navigator=="undefined")return!1;let e=navigator.userAgent||navigator.vendor||window.opera;return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od|ad)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))}static isBrowser(){return typeof window!="undefined"}static values(e){let t=[];for(let i in e)t.push(e[i]);return t}static generateUUID(){let e=new Date().getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){let i=(e+Math.random()*16)%16|0;return e=Math.floor(e/16),(t==="x"?i:i&3|8).toString(16)})}static resizeVectorToFit(e,t){let i=Math.min(t.x/e.x,t.y/e.y);return e.clone().multiply(i)}static resizeVectorToFill(e,t){let i=e.x/e.y,r=t.x/t.y;return i>r?t.clone().set(t.y*i,t.y):t.clone().set(t.x,t.x/i)}static isExtendable(e){return typeof e!="undefined"&&e!==null&&(typeof e=="object"||typeof e=="function")}static defaults(e,...t){let i={};for(let r in e)i[r]=e[r];for(let r=0;r<t.length;r++){let s=t[r];for(let n in s)typeof i[n]=="undefined"&&(i[n]=s[n])}return i}static deepMerge(e,...t){let i=(r,s)=>{if(s===void 0)return i(null,r);if(Array.isArray(s))return[...s];if(!Pi.isPlainObject(s))return s;if(!Pi.isPlainObject(r))return C({},s);let n=C({},r);return Object.keys(s).forEach(a=>{let l=s[a];l!==void 0&&(n[a]=i(r[a],l))}),n};return t.reduce(i,e)}static deepDefaults(e,...t){let i=[...t].reverse();return Pi.deepMerge(...i,e)}static deepClone(e){let t={};for(let i in e)Pi.isExtendable(e[i])?t[i]=Pi.deepClone(e[i]):t[i]=e[i];return t}static extend(e,...t){let i={};for(let r in e)i[r]=e[r];for(let r=0;r<t.length;r++){let s=t[r];for(let n in s)i[n]=s[n]}return i}static clone(e){return this.extend({},e)}static getUUID(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){let t=Math.random()*16|0;return(e==="x"?t:t&3|8).toString(16)})}static createCanvas(){return Ie.createCanvas()}static isPowerOfTwo(e){return(e.x&e.x-1)===0&&(e.y&e.y-1)===0}static nextLowestPOT(e){for(let t=1;t<32;t<<=1)e|=e>>t;return e-(e>>1)}static nextHighestPOT(e){e--;for(let t=1;t<32;t<<=1)e|=e>>t;return e+1}static moveArrayItem(e,t,i){if(i>=e.length){let r=i-e.length;for(;r--+1;)e.push(void 0)}e.splice(i,0,e.splice(t,1)[0])}static ensureCanvasDimensions(e,t){return e.width!==t.x||e.height!==t.y?(e.width=t.x,e.height=t.y,!0):!1}static byteArrayToString(e){return e.map(t=>String.fromCharCode(t)).join("")}static clamp(e,t,i){return Math.max(t,Math.min(e,i))}static wildCardMatch(e,t){return new RegExp(`^${t.split("*").join(".*")}$`).test(e)}static flipObject(e){let t={};for(let i in e)t[e[i]]=i;return t}static ISODateString(e){function t(i){return i<10?`0${i}`:i}return`${e.getUTCFullYear()}-${t(e.getUTCMonth()+1)}-${t(e.getUTCDate())}T${t(e.getUTCHours())}:${t(e.getUTCMinutes())}:${t(e.getUTCSeconds())}Z`}static getCrossOriginValue(e){if(!e)return"anonymous";if(e!=="none")return e}static invariant(e,t){if(!e)throw new Error(t)}static executePromises(e){let t=e.length,i=0,r=[],s=[];return new Promise((n,a)=>{let l=()=>{i++,i>=t&&(s.length<=0?n(r):a(s))},h=m=>{r.push(m),l()},c=m=>{s.push(m),l()};e.forEach(m=>{m.then(h).catch(c)})})}},il=Pi;M(il,"Array",wu);k=il});var Cu=xt((lw,Ru)=>{"use strict";var C0=/[|\\{}()[\]^$+*?.]/g;Ru.exports=function(o){if(typeof o!="string")throw new TypeError("Expected a string");return o.replace(C0,"\\$&")}});var Su=xt((hw,ku)=>{"use strict";ku.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}});var rl=xt((cw,Iu)=>{var Ai=Su(),Eu={};for(No in Ai)Ai.hasOwnProperty(No)&&(Eu[Ai[No]]=No);var No,U=Iu.exports={rgb:{channels:3,labels:"rgb"},hsl:{channels:3,labels:"hsl"},hsv:{channels:3,labels:"hsv"},hwb:{channels:3,labels:"hwb"},cmyk:{channels:4,labels:"cmyk"},xyz:{channels:3,labels:"xyz"},lab:{channels:3,labels:"lab"},lch:{channels:3,labels:"lch"},hex:{channels:1,labels:["hex"]},keyword:{channels:1,labels:["keyword"]},ansi16:{channels:1,labels:["ansi16"]},ansi256:{channels:1,labels:["ansi256"]},hcg:{channels:3,labels:["h","c","g"]},apple:{channels:3,labels:["r16","g16","b16"]},gray:{channels:1,labels:["gray"]}};for(Xe in U)if(U.hasOwnProperty(Xe)){if(!("channels"in U[Xe]))throw new Error("missing channels property: "+Xe);if(!("labels"in U[Xe]))throw new Error("missing channel labels property: "+Xe);if(U[Xe].labels.length!==U[Xe].channels)throw new Error("channel and label counts mismatch: "+Xe);Ou=U[Xe].channels,Fu=U[Xe].labels,delete U[Xe].channels,delete U[Xe].labels,Object.defineProperty(U[Xe],"channels",{value:Ou}),Object.defineProperty(U[Xe],"labels",{value:Fu})}var Ou,Fu,Xe;U.rgb.hsl=function(o){var e=o[0]/255,t=o[1]/255,i=o[2]/255,r=Math.min(e,t,i),s=Math.max(e,t,i),n=s-r,a,l,h;return s===r?a=0:e===s?a=(t-i)/n:t===s?a=2+(i-e)/n:i===s&&(a=4+(e-t)/n),a=Math.min(a*60,360),a<0&&(a+=360),h=(r+s)/2,s===r?l=0:h<=.5?l=n/(s+r):l=n/(2-s-r),[a,l*100,h*100]};U.rgb.hsv=function(o){var e,t,i,r,s,n=o[0]/255,a=o[1]/255,l=o[2]/255,h=Math.max(n,a,l),c=h-Math.min(n,a,l),m=function(d){return(h-d)/6/c+1/2};return c===0?r=s=0:(s=c/h,e=m(n),t=m(a),i=m(l),n===h?r=i-t:a===h?r=1/3+e-i:l===h&&(r=2/3+t-e),r<0?r+=1:r>1&&(r-=1)),[r*360,s*100,h*100]};U.rgb.hwb=function(o){var e=o[0],t=o[1],i=o[2],r=U.rgb.hsl(o)[0],s=1/255*Math.min(e,Math.min(t,i));return i=1-1/255*Math.max(e,Math.max(t,i)),[r,s*100,i*100]};U.rgb.cmyk=function(o){var e=o[0]/255,t=o[1]/255,i=o[2]/255,r,s,n,a;return a=Math.min(1-e,1-t,1-i),r=(1-e-a)/(1-a)||0,s=(1-t-a)/(1-a)||0,n=(1-i-a)/(1-a)||0,[r*100,s*100,n*100,a*100]};function k0(o,e){return Math.pow(o[0]-e[0],2)+Math.pow(o[1]-e[1],2)+Math.pow(o[2]-e[2],2)}U.rgb.keyword=function(o){var e=Eu[o];if(e)return e;var t=1/0,i;for(var r in Ai)if(Ai.hasOwnProperty(r)){var s=Ai[r],n=k0(o,s);n<t&&(t=n,i=r)}return i};U.keyword.rgb=function(o){return Ai[o]};U.rgb.xyz=function(o){var e=o[0]/255,t=o[1]/255,i=o[2]/255;e=e>.04045?Math.pow((e+.055)/1.055,2.4):e/12.92,t=t>.04045?Math.pow((t+.055)/1.055,2.4):t/12.92,i=i>.04045?Math.pow((i+.055)/1.055,2.4):i/12.92;var r=e*.4124+t*.3576+i*.1805,s=e*.2126+t*.7152+i*.0722,n=e*.0193+t*.1192+i*.9505;return[r*100,s*100,n*100]};U.rgb.lab=function(o){var e=U.rgb.xyz(o),t=e[0],i=e[1],r=e[2],s,n,a;return t/=95.047,i/=100,r/=108.883,t=t>.008856?Math.pow(t,1/3):7.787*t+16/116,i=i>.008856?Math.pow(i,1/3):7.787*i+16/116,r=r>.008856?Math.pow(r,1/3):7.787*r+16/116,s=116*i-16,n=500*(t-i),a=200*(i-r),[s,n,a]};U.hsl.rgb=function(o){var e=o[0]/360,t=o[1]/100,i=o[2]/100,r,s,n,a,l;if(t===0)return l=i*255,[l,l,l];i<.5?s=i*(1+t):s=i+t-i*t,r=2*i-s,a=[0,0,0];for(var h=0;h<3;h++)n=e+1/3*-(h-1),n<0&&n++,n>1&&n--,6*n<1?l=r+(s-r)*6*n:2*n<1?l=s:3*n<2?l=r+(s-r)*(2/3-n)*6:l=r,a[h]=l*255;return a};U.hsl.hsv=function(o){var e=o[0],t=o[1]/100,i=o[2]/100,r=t,s=Math.max(i,.01),n,a;return i*=2,t*=i<=1?i:2-i,r*=s<=1?s:2-s,a=(i+t)/2,n=i===0?2*r/(s+r):2*t/(i+t),[e,n*100,a*100]};U.hsv.rgb=function(o){var e=o[0]/60,t=o[1]/100,i=o[2]/100,r=Math.floor(e)%6,s=e-Math.floor(e),n=255*i*(1-t),a=255*i*(1-t*s),l=255*i*(1-t*(1-s));switch(i*=255,r){case 0:return[i,l,n];case 1:return[a,i,n];case 2:return[n,i,l];case 3:return[n,a,i];case 4:return[l,n,i];case 5:return[i,n,a]}};U.hsv.hsl=function(o){var e=o[0],t=o[1]/100,i=o[2]/100,r=Math.max(i,.01),s,n,a;return a=(2-t)*i,s=(2-t)*r,n=t*r,n/=s<=1?s:2-s,n=n||0,a/=2,[e,n*100,a*100]};U.hwb.rgb=function(o){var e=o[0]/360,t=o[1]/100,i=o[2]/100,r=t+i,s,n,a,l;r>1&&(t/=r,i/=r),s=Math.floor(6*e),n=1-i,a=6*e-s,(s&1)!==0&&(a=1-a),l=t+a*(n-t);var h,c,m;switch(s){default:case 6:case 0:h=n,c=l,m=t;break;case 1:h=l,c=n,m=t;break;case 2:h=t,c=n,m=l;break;case 3:h=t,c=l,m=n;break;case 4:h=l,c=t,m=n;break;case 5:h=n,c=t,m=l;break}return[h*255,c*255,m*255]};U.cmyk.rgb=function(o){var e=o[0]/100,t=o[1]/100,i=o[2]/100,r=o[3]/100,s,n,a;return s=1-Math.min(1,e*(1-r)+r),n=1-Math.min(1,t*(1-r)+r),a=1-Math.min(1,i*(1-r)+r),[s*255,n*255,a*255]};U.xyz.rgb=function(o){var e=o[0]/100,t=o[1]/100,i=o[2]/100,r,s,n;return r=e*3.2406+t*-1.5372+i*-.4986,s=e*-.9689+t*1.8758+i*.0415,n=e*.0557+t*-.204+i*1.057,r=r>.0031308?1.055*Math.pow(r,1/2.4)-.055:r*12.92,s=s>.0031308?1.055*Math.pow(s,1/2.4)-.055:s*12.92,n=n>.0031308?1.055*Math.pow(n,1/2.4)-.055:n*12.92,r=Math.min(Math.max(0,r),1),s=Math.min(Math.max(0,s),1),n=Math.min(Math.max(0,n),1),[r*255,s*255,n*255]};U.xyz.lab=function(o){var e=o[0],t=o[1],i=o[2],r,s,n;return e/=95.047,t/=100,i/=108.883,e=e>.008856?Math.pow(e,1/3):7.787*e+16/116,t=t>.008856?Math.pow(t,1/3):7.787*t+16/116,i=i>.008856?Math.pow(i,1/3):7.787*i+16/116,r=116*t-16,s=500*(e-t),n=200*(t-i),[r,s,n]};U.lab.xyz=function(o){var e=o[0],t=o[1],i=o[2],r,s,n;s=(e+16)/116,r=t/500+s,n=s-i/200;var a=Math.pow(s,3),l=Math.pow(r,3),h=Math.pow(n,3);return s=a>.008856?a:(s-16/116)/7.787,r=l>.008856?l:(r-16/116)/7.787,n=h>.008856?h:(n-16/116)/7.787,r*=95.047,s*=100,n*=108.883,[r,s,n]};U.lab.lch=function(o){var e=o[0],t=o[1],i=o[2],r,s,n;return r=Math.atan2(i,t),s=r*360/2/Math.PI,s<0&&(s+=360),n=Math.sqrt(t*t+i*i),[e,n,s]};U.lch.lab=function(o){var e=o[0],t=o[1],i=o[2],r,s,n;return n=i/360*2*Math.PI,r=t*Math.cos(n),s=t*Math.sin(n),[e,r,s]};U.rgb.ansi16=function(o){var e=o[0],t=o[1],i=o[2],r=1 in arguments?arguments[1]:U.rgb.hsv(o)[2];if(r=Math.round(r/50),r===0)return 30;var s=30+(Math.round(i/255)<<2|Math.round(t/255)<<1|Math.round(e/255));return r===2&&(s+=60),s};U.hsv.ansi16=function(o){return U.rgb.ansi16(U.hsv.rgb(o),o[2])};U.rgb.ansi256=function(o){var e=o[0],t=o[1],i=o[2];if(e===t&&t===i)return e<8?16:e>248?231:Math.round((e-8)/247*24)+232;var r=16+36*Math.round(e/255*5)+6*Math.round(t/255*5)+Math.round(i/255*5);return r};U.ansi16.rgb=function(o){var e=o%10;if(e===0||e===7)return o>50&&(e+=3.5),e=e/10.5*255,[e,e,e];var t=(~~(o>50)+1)*.5,i=(e&1)*t*255,r=(e>>1&1)*t*255,s=(e>>2&1)*t*255;return[i,r,s]};U.ansi256.rgb=function(o){if(o>=232){var e=(o-232)*10+8;return[e,e,e]}o-=16;var t,i=Math.floor(o/36)/5*255,r=Math.floor((t=o%36)/6)/5*255,s=t%6/5*255;return[i,r,s]};U.rgb.hex=function(o){var e=((Math.round(o[0])&255)<<16)+((Math.round(o[1])&255)<<8)+(Math.round(o[2])&255),t=e.toString(16).toUpperCase();return"000000".substring(t.length)+t};U.hex.rgb=function(o){var e=o.toString(16).match(/[a-f0-9]{6}|[a-f0-9]{3}/i);if(!e)return[0,0,0];var t=e[0];e[0].length===3&&(t=t.split("").map(function(a){return a+a}).join(""));var i=parseInt(t,16),r=i>>16&255,s=i>>8&255,n=i&255;return[r,s,n]};U.rgb.hcg=function(o){var e=o[0]/255,t=o[1]/255,i=o[2]/255,r=Math.max(Math.max(e,t),i),s=Math.min(Math.min(e,t),i),n=r-s,a,l;return n<1?a=s/(1-n):a=0,n<=0?l=0:r===e?l=(t-i)/n%6:r===t?l=2+(i-e)/n:l=4+(e-t)/n+4,l/=6,l%=1,[l*360,n*100,a*100]};U.hsl.hcg=function(o){var e=o[1]/100,t=o[2]/100,i=1,r=0;return t<.5?i=2*e*t:i=2*e*(1-t),i<1&&(r=(t-.5*i)/(1-i)),[o[0],i*100,r*100]};U.hsv.hcg=function(o){var e=o[1]/100,t=o[2]/100,i=e*t,r=0;return i<1&&(r=(t-i)/(1-i)),[o[0],i*100,r*100]};U.hcg.rgb=function(o){var e=o[0]/360,t=o[1]/100,i=o[2]/100;if(t===0)return[i*255,i*255,i*255];var r=[0,0,0],s=e%1*6,n=s%1,a=1-n,l=0;switch(Math.floor(s)){case 0:r[0]=1,r[1]=n,r[2]=0;break;case 1:r[0]=a,r[1]=1,r[2]=0;break;case 2:r[0]=0,r[1]=1,r[2]=n;break;case 3:r[0]=0,r[1]=a,r[2]=1;break;case 4:r[0]=n,r[1]=0,r[2]=1;break;default:r[0]=1,r[1]=0,r[2]=a}return l=(1-t)*i,[(t*r[0]+l)*255,(t*r[1]+l)*255,(t*r[2]+l)*255]};U.hcg.hsv=function(o){var e=o[1]/100,t=o[2]/100,i=e+t*(1-e),r=0;return i>0&&(r=e/i),[o[0],r*100,i*100]};U.hcg.hsl=function(o){var e=o[1]/100,t=o[2]/100,i=t*(1-e)+.5*e,r=0;return i>0&&i<.5?r=e/(2*i):i>=.5&&i<1&&(r=e/(2*(1-i))),[o[0],r*100,i*100]};U.hcg.hwb=function(o){var e=o[1]/100,t=o[2]/100,i=e+t*(1-e);return[o[0],(i-e)*100,(1-i)*100]};U.hwb.hcg=function(o){var e=o[1]/100,t=o[2]/100,i=1-t,r=i-e,s=0;return r<1&&(s=(i-r)/(1-r)),[o[0],r*100,s*100]};U.apple.rgb=function(o){return[o[0]/65535*255,o[1]/65535*255,o[2]/65535*255]};U.rgb.apple=function(o){return[o[0]/255*65535,o[1]/255*65535,o[2]/255*65535]};U.gray.rgb=function(o){return[o[0]/100*255,o[0]/100*255,o[0]/100*255]};U.gray.hsl=U.gray.hsv=function(o){return[0,0,o[0]]};U.gray.hwb=function(o){return[0,100,o[0]]};U.gray.cmyk=function(o){return[0,0,0,o[0]]};U.gray.lab=function(o){return[o[0],0,0]};U.gray.hex=function(o){var e=Math.round(o[0]/100*255)&255,t=(e<<16)+(e<<8)+e,i=t.toString(16).toUpperCase();return"000000".substring(i.length)+i};U.rgb.gray=function(o){var e=(o[0]+o[1]+o[2])/3;return[e/255*100]}});var Bu=xt((uw,Mu)=>{var Uo=rl();function S0(){for(var o={},e=Object.keys(Uo),t=e.length,i=0;i<t;i++)o[e[i]]={distance:-1,parent:null};return o}function O0(o){var e=S0(),t=[o];for(e[o].distance=0;t.length;)for(var i=t.pop(),r=Object.keys(Uo[i]),s=r.length,n=0;n<s;n++){var a=r[n],l=e[a];l.distance===-1&&(l.distance=e[i].distance+1,l.parent=i,t.unshift(a))}return e}function F0(o,e){return function(t){return e(o(t))}}function E0(o,e){for(var t=[e[o].parent,o],i=Uo[e[o].parent][o],r=e[o].parent;e[r].parent;)t.unshift(e[r].parent),i=F0(Uo[e[r].parent][r],i),r=e[r].parent;return i.conversion=t,i}Mu.exports=function(o){for(var e=O0(o),t={},i=Object.keys(e),r=i.length,s=0;s<r;s++){var n=i[s],a=e[n];a.parent!==null&&(t[n]=E0(n,e))}return t}});var Pu=xt((dw,Du)=>{var sl=rl(),I0=Bu(),Hr={},M0=Object.keys(sl);function B0(o){var e=function(t){return t==null?t:(arguments.length>1&&(t=Array.prototype.slice.call(arguments)),o(t))};return"conversion"in o&&(e.conversion=o.conversion),e}function D0(o){var e=function(t){if(t==null)return t;arguments.length>1&&(t=Array.prototype.slice.call(arguments));var i=o(t);if(typeof i=="object")for(var r=i.length,s=0;s<r;s++)i[s]=Math.round(i[s]);return i};return"conversion"in o&&(e.conversion=o.conversion),e}M0.forEach(function(o){Hr[o]={},Object.defineProperty(Hr[o],"channels",{value:sl[o].channels}),Object.defineProperty(Hr[o],"labels",{value:sl[o].labels});var e=I0(o),t=Object.keys(e);t.forEach(function(i){var r=e[i];Hr[o][i]=D0(r),Hr[o][i].raw=B0(r)})});Du.exports=Hr});var Lu=xt((mw,Au)=>{"use strict";var jr=Pu(),Go=(o,e)=>function(){return`\x1B[${o.apply(jr,arguments)+e}m`},Wo=(o,e)=>function(){let t=o.apply(jr,arguments);return`\x1B[${38+e};5;${t}m`},Vo=(o,e)=>function(){let t=o.apply(jr,arguments);return`\x1B[${38+e};2;${t[0]};${t[1]};${t[2]}m`};function P0(){let o=new Map,e={modifier:{reset:[0,0],bold:[1,22],dim:[2,22],italic:[3,23],underline:[4,24],inverse:[7,27],hidden:[8,28],strikethrough:[9,29]},color:{black:[30,39],red:[31,39],green:[32,39],yellow:[33,39],blue:[34,39],magenta:[35,39],cyan:[36,39],white:[37,39],gray:[90,39],redBright:[91,39],greenBright:[92,39],yellowBright:[93,39],blueBright:[94,39],magentaBright:[95,39],cyanBright:[96,39],whiteBright:[97,39]},bgColor:{bgBlack:[40,49],bgRed:[41,49],bgGreen:[42,49],bgYellow:[43,49],bgBlue:[44,49],bgMagenta:[45,49],bgCyan:[46,49],bgWhite:[47,49],bgBlackBright:[100,49],bgRedBright:[101,49],bgGreenBright:[102,49],bgYellowBright:[103,49],bgBlueBright:[104,49],bgMagentaBright:[105,49],bgCyanBright:[106,49],bgWhiteBright:[107,49]}};e.color.grey=e.color.gray;for(let r of Object.keys(e)){let s=e[r];for(let n of Object.keys(s)){let a=s[n];e[n]={open:`\x1B[${a[0]}m`,close:`\x1B[${a[1]}m`},s[n]=e[n],o.set(a[0],a[1])}Object.defineProperty(e,r,{value:s,enumerable:!1}),Object.defineProperty(e,"codes",{value:o,enumerable:!1})}let t=r=>r,i=(r,s,n)=>[r,s,n];e.color.close="\x1B[39m",e.bgColor.close="\x1B[49m",e.color.ansi={ansi:Go(t,0)},e.color.ansi256={ansi256:Wo(t,0)},e.color.ansi16m={rgb:Vo(i,0)},e.bgColor.ansi={ansi:Go(t,10)},e.bgColor.ansi256={ansi256:Wo(t,10)},e.bgColor.ansi16m={rgb:Vo(i,10)};for(let r of Object.keys(jr)){if(typeof jr[r]!="object")continue;let s=jr[r];r==="ansi16"&&(r="ansi"),"ansi16"in s&&(e.color.ansi[r]=Go(s.ansi16,0),e.bgColor.ansi[r]=Go(s.ansi16,10)),"ansi256"in s&&(e.color.ansi256[r]=Wo(s.ansi256,0),e.bgColor.ansi256[r]=Wo(s.ansi256,10)),"rgb"in s&&(e.color.ansi16m[r]=Vo(s.rgb,0),e.bgColor.ansi16m[r]=Vo(s.rgb,10))}return e}Object.defineProperty(Au,"exports",{enumerable:!0,get:P0})});var Nu=xt((fw,zu)=>{"use strict";zu.exports=(o,e)=>{e=e||process.argv;let t=o.startsWith("-")?"":o.length===1?"-":"--",i=e.indexOf(t+o),r=e.indexOf("--");return i!==-1&&(r===-1?!0:i<r)}});var Gu=xt((pw,Uu)=>{"use strict";var A0=require("os"),St=Nu(),Ne=process.env,qr;St("no-color")||St("no-colors")||St("color=false")?qr=!1:(St("color")||St("colors")||St("color=true")||St("color=always"))&&(qr=!0);"FORCE_COLOR"in Ne&&(qr=Ne.FORCE_COLOR.length===0||parseInt(Ne.FORCE_COLOR,10)!==0);function L0(o){return o===0?!1:{level:o,hasBasic:!0,has256:o>=2,has16m:o>=3}}function z0(o){if(qr===!1)return 0;if(St("color=16m")||St("color=full")||St("color=truecolor"))return 3;if(St("color=256"))return 2;if(o&&!o.isTTY&&qr!==!0)return 0;let e=qr?1:0;if(process.platform==="win32"){let t=A0.release().split(".");return Number(process.versions.node.split(".")[0])>=8&&Number(t[0])>=10&&Number(t[2])>=10586?Number(t[2])>=14931?3:2:1}if("CI"in Ne)return["TRAVIS","CIRCLECI","APPVEYOR","GITLAB_CI"].some(t=>t in Ne)||Ne.CI_NAME==="codeship"?1:e;if("TEAMCITY_VERSION"in Ne)return/^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.test(Ne.TEAMCITY_VERSION)?1:0;if(Ne.COLORTERM==="truecolor")return 3;if("TERM_PROGRAM"in Ne){let t=parseInt((Ne.TERM_PROGRAM_VERSION||"").split(".")[0],10);switch(Ne.TERM_PROGRAM){case"iTerm.app":return t>=3?3:2;case"Apple_Terminal":return 2}}return/-256(color)?$/i.test(Ne.TERM)?2:/^screen|^xterm|^vt100|^vt220|^rxvt|color|ansi|cygwin|linux/i.test(Ne.TERM)||"COLORTERM"in Ne?1:(Ne.TERM==="dumb",e)}function ol(o){let e=z0(o);return L0(e)}Uu.exports={supportsColor:ol,stdout:ol(process.stdout),stderr:ol(process.stderr)}});var qu=xt((_w,ju)=>{"use strict";var N0=/(?:\\(u[a-f\d]{4}|x[a-f\d]{2}|.))|(?:\{(~)?(\w+(?:\([^)]*\))?(?:\.\w+(?:\([^)]*\))?)*)(?:[ \t]|(?=\r?\n)))|(\})|((?:.|[\r\n\f])+?)/gi,Wu=/(?:^|\.)(\w+)(?:\(([^)]*)\))?/g,U0=/^(['"])((?:\\.|(?!\1)[^\\])*)\1$/,G0=/\\(u[a-f\d]{4}|x[a-f\d]{2}|.)|([^\\])/gi,W0=new Map([["n",`
`],["r","\r"],["t","	"],["b","\b"],["f","\f"],["v","\v"],["0","\0"],["\\","\\"],["e","\x1B"],["a","\x07"]]);function Hu(o){return o[0]==="u"&&o.length===5||o[0]==="x"&&o.length===3?String.fromCharCode(parseInt(o.slice(1),16)):W0.get(o)||o}function V0(o,e){let t=[],i=e.trim().split(/\s*,\s*/g),r;for(let s of i)if(!isNaN(s))t.push(Number(s));else if(r=s.match(U0))t.push(r[2].replace(G0,(n,a,l)=>a?Hu(a):l));else throw new Error(`Invalid Chalk template style argument: ${s} (in style '${o}')`);return t}function H0(o){Wu.lastIndex=0;let e=[],t;for(;(t=Wu.exec(o))!==null;){let i=t[1];if(t[2]){let r=V0(i,t[2]);e.push([i].concat(r))}else e.push([i])}return e}function Vu(o,e){let t={};for(let r of e)for(let s of r.styles)t[s[0]]=r.inverse?null:s.slice(1);let i=o;for(let r of Object.keys(t))if(Array.isArray(t[r])){if(!(r in i))throw new Error(`Unknown Chalk style: ${r}`);t[r].length>0?i=i[r].apply(i,t[r]):i=i[r]}return i}ju.exports=(o,e)=>{let t=[],i=[],r=[];if(e.replace(N0,(s,n,a,l,h,c)=>{if(n)r.push(Hu(n));else if(l){let m=r.join("");r=[],i.push(t.length===0?m:Vu(o,t)(m)),t.push({inverse:a,styles:H0(l)})}else if(h){if(t.length===0)throw new Error("Found extraneous } in Chalk template literal");i.push(Vu(o,t)(r.join(""))),r=[],t.pop()}else r.push(c)}),i.push(r.join("")),t.length>0){let s=`Chalk template literal is missing ${t.length} closing bracket${t.length===1?"":"s"} (\`}\`)`;throw new Error(s)}return i.join("")}});var Zu=xt((gw,Hs)=>{"use strict";var al=Cu(),Se=Lu(),nl=Gu().stdout,j0=qu(),Yu=process.platform==="win32"&&!(process.env.TERM||"").toLowerCase().startsWith("xterm"),Ku=["ansi","ansi","ansi256","ansi16m"],Ju=new Set(["gray"]),Xr=Object.create(null);function Xu(o,e){e=e||{};let t=nl?nl.level:0;o.level=e.level===void 0?t:e.level,o.enabled="enabled"in e?e.enabled:o.level>0}function Vs(o){if(!this||!(this instanceof Vs)||this.template){let e={};return Xu(e,o),e.template=function(){let t=[].slice.call(arguments);return Y0.apply(null,[e.template].concat(t))},Object.setPrototypeOf(e,Vs.prototype),Object.setPrototypeOf(e.template,e),e.template.constructor=Vs,e.template}Xu(this,o)}Yu&&(Se.blue.open="\x1B[94m");for(let o of Object.keys(Se))Se[o].closeRe=new RegExp(al(Se[o].close),"g"),Xr[o]={get(){let e=Se[o];return Ho.call(this,this._styles?this._styles.concat(e):[e],this._empty,o)}};Xr.visible={get(){return Ho.call(this,this._styles||[],!0,"visible")}};Se.color.closeRe=new RegExp(al(Se.color.close),"g");for(let o of Object.keys(Se.color.ansi))Ju.has(o)||(Xr[o]={get(){let e=this.level;return function(){let i={open:Se.color[Ku[e]][o].apply(null,arguments),close:Se.color.close,closeRe:Se.color.closeRe};return Ho.call(this,this._styles?this._styles.concat(i):[i],this._empty,o)}}});Se.bgColor.closeRe=new RegExp(al(Se.bgColor.close),"g");for(let o of Object.keys(Se.bgColor.ansi)){if(Ju.has(o))continue;let e="bg"+o[0].toUpperCase()+o.slice(1);Xr[e]={get(){let t=this.level;return function(){let r={open:Se.bgColor[Ku[t]][o].apply(null,arguments),close:Se.bgColor.close,closeRe:Se.bgColor.closeRe};return Ho.call(this,this._styles?this._styles.concat(r):[r],this._empty,o)}}}}var q0=Object.defineProperties(()=>{},Xr);function Ho(o,e,t){let i=function(){return X0.apply(i,arguments)};i._styles=o,i._empty=e;let r=this;return Object.defineProperty(i,"level",{enumerable:!0,get(){return r.level},set(s){r.level=s}}),Object.defineProperty(i,"enabled",{enumerable:!0,get(){return r.enabled},set(s){r.enabled=s}}),i.hasGrey=this.hasGrey||t==="gray"||t==="grey",i.__proto__=q0,i}function X0(){let o=arguments,e=o.length,t=String(arguments[0]);if(e===0)return"";if(e>1)for(let r=1;r<e;r++)t+=" "+o[r];if(!this.enabled||this.level<=0||!t)return this._empty?"":t;let i=Se.dim.open;Yu&&this.hasGrey&&(Se.dim.open="");for(let r of this._styles.slice().reverse())t=r.open+t.replace(r.closeRe,r.open)+r.close,t=t.replace(/\r?\n/g,`${r.close}$&${r.open}`);return Se.dim.open=i,t}function Y0(o,e){if(!Array.isArray(e))return[].slice.call(arguments,1).join(" ");let t=[].slice.call(arguments,2),i=[e.raw[0]];for(let r=1;r<e.length;r++)i.push(String(t[r-1]).replace(/[{}\\]/g,"\\$&")),i.push(String(e.raw[r]));return j0(o,i.join(""))}Object.defineProperties(Vs.prototype,Xr);Hs.exports=Vs();Hs.exports.supportsColor=nl;Hs.exports.default=Hs.exports});var K0,Qu,J0,$u,Z0,I,ut=_(()=>{Dt();K0=[{name:"trace",type:"trace",background:"#EEEEEE",color:"#AAAAAA"},{name:"info",type:"log",background:"#BDE5F8",color:"#00529B"},{name:"warn",type:"warn",background:"#FEEFB3",color:"#9F6000"},{name:"error",type:"error",background:"#FFBABA",color:"#D8000C"},{name:"log",type:"log",background:"#EEEEEE",color:"#1f4f6b"}],Qu=()=>console&&console.group&&console.groupCollapsed&&console.groupEnd,J0=(o,e)=>{{let t=Zu();return[t.bgHex("#2D7BFF"),t.bgHex("#2B2B2B").white,t.bgHex("#2D7BFF"),t.bgHex(o).hex(e).bold,t.bgHex("#2B2B2B").white,t.bgHex("#2D7BFF")]}},$u=class{constructor(e="warn",t=K0){this._levels=[...t],this._maxLevel=this.getLevelIndexByName(e),this._consoleFuncs={trace:(...i)=>{Qu()?(console.groupCollapsed(...i),console.trace(),console.groupEnd()):console.trace(...i)}},this._levels.forEach(({name:i})=>{this[i]=(r,...s)=>{this._log(i,r,...s)}})}getLevelIndexByName(e){return k.Array.findIndex(this._levels,t=>t.name===e)}getLevelObjectByName(e){return k.Array.find(this._levels,t=>t.name===e)}canLog(e){let t=this.getLevelIndexByName(e);return t<0?!1:t>=this._maxLevel}setLevel(e){let t=this.getLevelIndexByName(e);t<0||(this._maxLevel=t)}_log(e,t,...i){let r=this.getLevelObjectByName(e);if(!r||!this.canLog(e))return;let{name:s,type:n,background:a,color:l}=r,h=i.filter(u=>u!==void 0).map(u=>u.toObject?JSON.parse(JSON.stringify(u.toObject())):u),c=this._consoleFuncs[n]||console[n]?(...u)=>console[n](...u):(...u)=>console.log(...u),m=h.length,d=J0(a,l);{let u=`${d[0](" ")} ${d[1]("PhotoEditorSDK")} ${d[2](" ")} ${d[3](t)}`,f=`${d[5](" ")} `;if(m<=0){c(`${u} ${f}`);return}if(m===1&&typeof h[0]=="string"){c(`${u} ${d[4](h[0])} ${f}`);return}Qu()?(console.groupCollapsed(`${u} ${f}`),c(...h),console.groupEnd()):c(`${u} ${f}`,...h)}}image(e="",t){}texture(e="",t){}logGlTexture(e,t,i=150,r=150,s){}},Z0=new $u("warn"),I=Z0});var Q0,$0,Ue,Li=_(()=>{Q0=o=>{{let e=require("fs");return new Promise((t,i)=>{try{e.readFile(o,(r,s)=>{r?i(r):t([o,s])})}catch(r){i(r)}})}},$0=o=>{{let e=require("request");return new Promise((t,i)=>{e.get(o,{encoding:null},(r,s,n)=>{if(r)return i(r);if(s.statusCode!==200)return i(new Error(`Server responded with status code ${s.statusCode}`));t([o,s.body])})})}},Ue={load(o,e={cors:!0,value:"anonymous"}){return(()=>o.substr(0,5)==="data:"?Promise.resolve([o,o]):o.match(/^(https?|ftp|file):\/\//)?$0(o):Q0(o))().then(([i,r])=>this._createAndLoadImage(i,r,e))},loadImage(o,e={cors:!0,value:"anonymous"}){return this.load(o,e)},_loadWithoutExif(o,e={cors:!0,value:"anonymous"}){return new Promise((t,i)=>{let r=new window.Image;r.addEventListener("load",()=>{t(r)}),r.addEventListener("error",()=>{i(new Error(`Failed to load image at ${o}`))}),e.cors&&(r.crossOrigin=e.value),r.src=o})},_createAndLoadImage(o,e,t={cors:!0,value:"anonymous"}){return new Promise((i,r)=>{{let s=require("canvas"),n=new s.Image;n.src=e,n.rawSource=e,n.filePath=o,i(n)}})},_stringEndsWith(o,e,t=o.length){return(t===void 0||t>o.length)&&(t=o.length),o.substring(t-e.length,t)===e},_loadAsDataURL(o,e={cors:!0,value:"anonymous"}){return Promise.reject(new Error("Loading images as data urls is only supported in browser environments."))},loadXHR(o,e){return new Promise((t,i)=>{let r;window.XDomainRequest?(r=new window.XDomainRequest,e&&r.overrideMimeType(e),r.onload=function(){t(r)},r.onerror=function(s){i(s)}):window.XMLHttpRequest&&(r=new window.XMLHttpRequest,e&&r.overrideMimeType(e),r.onreadystatechange=function(s){r.readyState===4&&(r.status===200?t(r):i(new Error(`HTTP Status ${r.status}`)))}),r.open("GET",o,!0),r.send()})}}});var td=xt(Yr=>{var js,ed=(js=require("querystring"))&&typeof js=="object"&&"default"in js?js.default:js,ex=/https?|ftp|gopher|file/;function qo(o){typeof o=="string"&&(o=Kr(o));var e=function(t,i,r){var s=t.auth,n=t.hostname,a=t.protocol||"",l=t.pathname||"",h=t.hash||"",c=t.query||"",m=!1;s=s?encodeURIComponent(s).replace(/%3A/i,":")+"@":"",t.host?m=s+t.host:n&&(m=s+(~n.indexOf(":")?"["+n+"]":n),t.port&&(m+=":"+t.port)),c&&typeof c=="object"&&(c=i.encode(c));var d=t.search||c&&"?"+c||"";return a&&a.substr(-1)!==":"&&(a+=":"),t.slashes||(!a||r.test(a))&&m!==!1?(m="//"+(m||""),l&&l[0]!=="/"&&(l="/"+l)):m||(m=""),h&&h[0]!=="#"&&(h="#"+h),d&&d[0]!=="?"&&(d="?"+d),{protocol:a,host:m,pathname:l=l.replace(/[?#]/g,encodeURIComponent),search:d=d.replace("#","%23"),hash:h}}(o,ed,ex);return""+e.protocol+e.host+e.pathname+e.search+e.hash}var hl="http://",cl="w.w",ul=hl+cl,tx=/^([a-z0-9.+-]*:\/\/\/)([a-z0-9.+-]:\/*)?/i,ix=/https?|ftp|gopher|file/;function jo(o,e){var t=typeof o=="string"?Kr(o):o;o=typeof o=="object"?qo(o):o;var i=Kr(e),r="";t.protocol&&!t.slashes&&(r=t.protocol,o=o.replace(t.protocol,""),r+=e[0]==="/"||o[0]==="/"?"/":""),r&&i.protocol&&(r="",i.slashes||(r=i.protocol,e=e.replace(i.protocol,"")));var s=o.match(tx);s&&!i.protocol&&(o=o.substr((r=s[1]+(s[2]||"")).length),/^\/\/[^/]/.test(e)&&(r=r.slice(0,-1)));var n=new URL(o,ul+"/"),a=new URL(e,n).toString().replace(ul,""),l=i.protocol||t.protocol;return l+=t.slashes||i.slashes?"//":"",!r&&l?a=a.replace(hl,l):r&&(a=a.replace(hl,"")),ix.test(a)||~e.indexOf(".")||o.slice(-1)==="/"||e.slice(-1)==="/"||a.slice(-1)!=="/"||(a=a.slice(0,-1)),r&&(a=r+(a[0]==="/"?a.substr(1):a)),a}function zi(){}zi.prototype.parse=Kr,zi.prototype.format=qo,zi.prototype.resolve=jo,zi.prototype.resolveObject=jo;var ll=/^https?|ftp|gopher|file/,rx=/^(.*?)([#?].*)/,sx=/^([a-z0-9.+-]*:)(\/{0,3})(.*)/i,ox=/^([a-z0-9.+-]*:)?\/\/\/*/i,nx=/^([a-z0-9.+-]*:)(\/{0,2})\[(.*)\]$/i;function Kr(o,e,t){if(e===void 0&&(e=!1),t===void 0&&(t=!1),o&&typeof o=="object"&&o instanceof zi)return o;var i=(o=o.trim()).match(rx);o=i?i[1].replace(/\\/g,"/")+i[2]:o.replace(/\\/g,"/"),nx.test(o)&&o.slice(-1)!=="/"&&(o+="/");var r=!/(^javascript)/.test(o)&&o.match(sx),s=ox.test(o),n="";r&&(ll.test(r[1])||(n=r[1].toLowerCase(),o=""+r[2]+r[3]),r[2]||(s=!1,ll.test(r[1])?(n=r[1],o=""+r[3]):o="//"+r[3]),r[2].length!==3&&r[2].length!==1||(n=r[1],o="/"+r[3]));var a,l=(i?i[1]:o).match(/^https?:\/\/[^/]+(:[0-9]+)(?=\/|$)/),h=l&&l[1],c=new zi,m="",d="";try{a=new URL(o)}catch(y){m=y,n||t||!/^\/\//.test(o)||/^\/\/.+[@.]/.test(o)||(d="/",o=o.substr(1));try{a=new URL(o,ul)}catch(g){return c.protocol=n,c.href=n,c}}c.slashes=s&&!d,c.host=a.host===cl?"":a.host,c.hostname=a.hostname===cl?"":a.hostname.replace(/(\[|\])/g,""),c.protocol=m?n||null:a.protocol,c.search=a.search.replace(/\\/g,"%5C"),c.hash=a.hash.replace(/\\/g,"%5C");var u=o.split("#");!c.search&&~u[0].indexOf("?")&&(c.search="?"),c.hash||u[1]!==""||(c.hash="#"),c.query=e?ed.decode(a.search.substr(1)):c.search.substr(1),c.pathname=d+(r?function(y){return y.replace(/['^|`]/g,function(g){return"%"+g.charCodeAt().toString(16).toUpperCase()}).replace(/((?:%[0-9A-F]{2})+)/g,function(g,p){try{return decodeURIComponent(p).split("").map(function(v){var x=v.charCodeAt();return x>256||/^[a-z0-9]$/i.test(v)?v:"%"+x.toString(16).toUpperCase()}).join("")}catch(v){return p}})}(a.pathname):a.pathname),c.protocol==="about:"&&c.pathname==="blank"&&(c.protocol="",c.pathname=""),m&&o[0]!=="/"&&(c.pathname=c.pathname.substr(1)),n&&!ll.test(n)&&o.slice(-1)!=="/"&&c.pathname==="/"&&(c.pathname=""),c.path=c.pathname+c.search,c.auth=[a.username,a.password].map(decodeURIComponent).filter(Boolean).join(":"),c.port=a.port,h&&!c.host.endsWith(h)&&(c.host+=h,c.port=h.slice(1)),c.href=d?""+c.pathname+c.search+c.hash:qo(c);var f=/^(file)/.test(c.href)?["host","hostname"]:[];return Object.keys(c).forEach(function(y){~f.indexOf(y)||(c[y]=c[y]||null)}),c}Yr.parse=Kr,Yr.format=qo,Yr.resolve=jo,Yr.resolveObject=function(o,e){return Kr(jo(o,e))},Yr.Url=zi});var Xo,ax,qs,dt,Ni=_(()=>{Xo=Ws(td()),ax=5e3,qs=typeof window!="undefined"?window:global,dt=class{constructor(e){this._url=e,this._parsedUrl=(0,Xo.parse)(this._url,!0)}_isJSONPRequest(){let{query:e}=this._parsedUrl;for(let t in e)if(e[t]==="?")return!0;return!1}load(){return this._isJSONPRequest()?this._loadJSONP():this._loadJSON()}_loadJSON(){return new Promise((e,t)=>{let i;qs.XDomainRequest?(i=new qs.XDomainRequest,i.onload=function(){let r=JSON.parse(i.responseText);e(r)},i.onerror=function(r){t(r)},i.open("GET",this._url,!0),i.send()):qs.XMLHttpRequest&&(i=new XMLHttpRequest,i.onreadystatechange=function(r){if(i.readyState===4)if(i.status===200){let s=JSON.parse(i.responseText);e(s)}else t(new Error(`HTTP Status ${i.status}`))},i.open("GET",this._url,!0),i.send())})}_loadJSONP(){let e=!1,t=!1,i=`pesdk${Math.round(Math.random()*99999999999999)}`;return new Promise((r,s)=>{let n=this._createJSONPNode(i);qs[i]=a=>{this._removeJSONPNode(n),e||(t=!0,r(a))},qs.setTimeout(()=>{t||(this._removeJSONPNode(n),e=!0,s(new Error("Timeout of 5 seconds exceeded.")))},ax)})}_createJSONPNode(e){let t=this._buildJSONPUrl(e),i=document.querySelector("head"),r=document.createElement("script");return r.src=t,i.appendChild(r),r}_removeJSONPNode(e){e.parentNode.removeChild(e)}_buildJSONPUrl(e){let{query:t}=this._parsedUrl,i=null;for(let r in t)if(t[r]==="?"){i=r;break}return delete this._parsedUrl.search,t[i]=e,(0,Xo.format)(this._parsedUrl)}}});var dl={};Te(dl,{ImageLoader:()=>Ue,JSONLoader:()=>dt});var id=_(()=>{Li();Ni()});var Ye,S,Ui=_(()=>{Ye=class{constructor(e,t,i,r=1){this.r=e,this.g=t,this.b=i,this.a=r}toRGBA(){return`rgba(${[Math.round(this.r*255),Math.round(this.g*255),Math.round(this.b*255),this.a.toFixed(2)].join(",")})`}set(e,t,i,r=this.a){return this.r=e,this.g=t,this.b=i,this.a=r,this}toRGB(){return[Math.round(this.r*255),Math.round(this.g*255),Math.round(this.b*255)]}toHex(){return`#${[this._componentToHex(Math.round(this.r*255)),this._componentToHex(Math.round(this.g*255)),this._componentToHex(Math.round(this.b*255))].join("")}`}toGLColor(){return[this.r,this.g,this.b,this.a]}toArray(){return this.toGLColor()}toRGBGLColor(){return[this.r,this.g,this.b]}toHSV(){let e=Math.max(this.r,this.g,this.b),t=Math.min(this.r,this.g,this.b),i,r,s=e,n=e-t;if(r=e===0?0:n/e,e===t)i=0;else{switch(e){case this.r:i=(this.g-this.b)/n,this.g<this.b&&(i+=6);break;case this.g:i=(this.b-this.r)/n+2;break;case this.b:i=(this.r-this.g)/n+4;break}i/=6}return[i,r,s]}fromHSV(e,t,i){return this.copy(Ye.fromHSV(e,t,i)),this}static fromHSV(e,t,i,r=1){let[s,n,a]=[],l=Math.floor(e*6),h=e*6-l,c=i*(1-t),m=i*(1-h*t),d=i*(1-(1-h)*t);switch(l%6){case 0:s=i,n=d,a=c;break;case 1:s=m,n=i,a=c;break;case 2:s=c,n=i,a=d;break;case 3:s=c,n=m,a=i;break;case 4:s=d,n=c,a=i;break;case 5:s=i,n=c,a=m;break}return new Ye(s,n,a,r)}static fromArray(e){return new Ye(e[0],e[1],e[2],e[3])}static fromHex(e){let[t,i,r]=e.match(/[0-9A-fa-f]{1,2}/g);return new Ye(parseInt(t,16)/255,parseInt(i,16)/255,parseInt(r,16)/255,1)}clone(){return new Ye(this.r,this.g,this.b,this.a)}cloneRGB(){return new Ye(this.r,this.g,this.b,1)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this.a+=e.a,this}minus(e){return this.r-=e.r,this.g-=e.g,this.b-=e.b,this.a-=e.a,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this.a*=e,this}divideScalar(e){return this.r/=e,this.g/=e,this.b/=e,this.a/=e,this}clamp(e,t){return this.r=Math.min(Math.max(this.r,e),t),this.g=Math.min(Math.max(this.g,e),t),this.b=Math.min(Math.max(this.b,e),t),this.a=Math.min(Math.max(this.a,e),t),this}mix(e,t){return this.r=(1-t)*this.r+t*e.r,this.g=(1-t)*this.g+t*e.g,this.b=(1-t)*this.b+t*e.b,this.a=(1-t)*this.a+t*e.a,this}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this.a=e.a,this}equals(e){return this.r===e.r&&this.g===e.g&&this.b===e.b&&this.a===e.a}_componentToHex(e){let t=e.toString(16);return t.length===1?`0${t}`:t}toString(){return`Color(${this.r}, ${this.g}, ${this.b}, ${this.a})`}static get TRANSPARENT(){return new Ye(0,0,0,0)}static get WHITE(){return new Ye(1,1,1,1)}static get BLACK(){return new Ye(0,0,0,1)}static get RED(){return new Ye(1,0,0,1)}static get BLUE(){return new Ye(0,0,1,1)}static get GREEN(){return new Ye(0,1,0,1)}},S=Ye});var lx,rd,Ke,Jr=_(()=>{ut();lx=12,rd=class{constructor(){this._maxListeners=lx,this._events={},this._pipeDestinations=[]}pipeEvents(e){this._pipeDestinations.push(e)}unpipeEvents(e){let t=this._pipeDestinations.indexOf(e);t!==-1&&this._pipeDestinations.splice(t,1)}on(e,t){if(typeof e=="undefined")throw new Error(`Invalid event type: \`${e}\``);if(typeof t!="function")throw new TypeError;let i=this._events[e]||(this._events[e]=[]);return i.indexOf(t)!==-1?this:(i.push(t),this._maxListeners&&i.length>this._maxListeners&&(I.warn("EventEmitter",`Possible memory leak detected, added ${i.length} \`${e}\` listeners (current limit is ${this._maxListeners})`),typeof console!="undefined"&&console.trace()),this)}once(e,t){if(typeof e=="undefined")throw new Error(`Invalid event type: \`${e}\``);let i=this;function r(){i.off(e,r),t.apply(null,arguments)}return this.on(e,r)}off(e,...t){if(typeof e=="undefined")throw new Error(`Invalid event type: \`${e}\``);if(t.length===0)return this._events[e]=null,this;let i=t[0];if(typeof i!="function")throw new TypeError;let r=this._events[e];if(!r||!r.length)return this;let s=r.indexOf(i);return s===-1?this:(r.splice(s,1),this)}emit(e,...t){if(typeof e=="undefined")throw new Error(`Invalid event type: \`${e}\``);this._pipeDestinations.forEach(r=>{r.emit(e,...t)});let i=this._events[e];return!i||!i.length?!1:(i.slice(0).forEach(r=>r.apply(null,t)),!0)}setMaxListeners(e){if(parseInt(e,10)!==e)throw new TypeError;this._maxListeners=e}},Ke=rd});var Ce,Kt=_(()=>{Ce=o=>{if(o){o.width=1,o.height=1;let e=o.getContext("2d");e&&e.clearRect(0,0,1,1)}}});var Gi,ml=_(()=>{ut();Kt();Gi={checkFramebufferStatus(o,e){let t=e.checkFramebufferStatus(e.FRAMEBUFFER),i={[e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT]:"Incomplete attachment",[e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT]:"Missing attachment",[e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS]:"Incomplete dimensions",[e.FRAMEBUFFER_UNSUPPORTED]:"Framebuffer unsupported"};t!==e.FRAMEBUFFER_COMPLETE&&I.warn(o,`Framebuffer incomplete: ${i[t]}`)},determineGPUName(o){let e=null,t=null;o||(t=document.createElement("canvas"),o=t.getContext("experimental-webgl")||t.getContext("webgl"));let i=o&&o.getExtension("WEBGL_debug_renderer_info");return i&&(e=o.getParameter(i.UNMASKED_RENDERER_WEBGL),t&&t.remove()),Ce(t),e},isGPUBlacklisted(o,e=null){return!1}}});var Yo,sd=_(()=>{Yo=o=>typeof o=="number"});var hx,Wi,Ko,A,Jt=_(()=>{sd();hx=o=>o instanceof A,Wi=(o,e)=>hx(o)?{x:o.x,y:o.y}:{x:o,y:Yo(e)?e:o},Ko=(o,e)=>(t,i)=>{let{x:r,y:s}=Wi(t,i);return o.x=e(o.x,r),o.y=e(o.y,s),o},A=class{constructor(e=0,t=0){this.add=Ko(this,(e,t)=>e+t);this.subtract=Ko(this,(e,t)=>e-t);this.divide=Ko(this,(e,t)=>e/t);this.multiply=Ko(this,(e,t)=>e*t);this.x=e,this.y=t}set(e,t){let{x:i,y:r}=Wi(e,t);return this.x=i,this.y=r,this}clone(){return new A(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}clamp(e,t){return Yo(e)&&(e=new A(e,e)),Yo(t)&&(t=new A(t,t)),e&&(this.x=Math.max(e.x,this.x),this.y=Math.max(e.y,this.y)),t&&(this.x=Math.min(t.x,this.x),this.y=Math.min(t.y,this.y)),this}dot(e,t){let{x:i,y:r}=Wi(e,t);return this.x*i+this.y*r}equals(e,t){let{x:i,y:r}=Wi(e,t);return i===this.x&&r===this.y}flip(){let e=this.x;return this.x=this.y,this.y=e,this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}floor(){return this.x|=0,this.y|=0,this}abs(){return this.x=Math.abs(this.x),this.y=Math.abs(this.y),this}len(){return Math.sqrt(this.x*this.x+this.y*this.y)}min(){return Math.min(this.x,this.y)}max(){return Math.max(this.x,this.y)}toObject(){return{x:this.x,y:this.y}}toString(){return`Vector2({ x: ${this.x}, y: ${this.y} })`}roundDecimal(e){return this.x=parseFloat(this.x.toFixed(e)),this.y=parseFloat(this.y.toFixed(e)),this}asArray(e=!1){return e?[this.y,this.x]:[this.x,this.y]}static fromObject(e){return new A(e.x,e.y)}static get NULL(){return new A(0,0)}}});var it,fl=_(()=>{Jt();it=class{constructor(){this.a=1;this.b=0;this.c=0;this.d=1;this.tx=0;this.ty=0;this.reset()}multiply(e){let t,i,r,s,n,a;return t=this.a*e.a+this.b*e.c,i=this.a*e.b+this.b*e.d,r=this.c*e.a+this.d*e.c,s=this.c*e.b+this.d*e.d,n=this.tx*e.a+this.ty*e.c+e.tx,a=this.tx*e.b+this.ty*e.d+e.ty,this.a=t,this.b=i,this.c=r,this.d=s,this.tx=n,this.ty=a,this}applyToVector(e){let{x:t,y:i}=e;return e=e.clone(),e.x=this.a*t+this.c*i+this.tx,e.y=this.b*t+this.d*i+this.tx,e}applyInverseToVector(e){let t=1/(this.a*this.d+this.c*-this.b),{x:i,y:r}=e;return e=e.clone(),e.x=this.d*t*i+-this.c*t*r+(this.ty*this.c-this.tx*this.d)*t,e.y=this.a*t*r+-this.b*t*i+(-this.ty*this.a+this.tx*this.b)*t,e}rectangleToCoordinates(e,t=new A(0,0)){let i=e.width*(1-t.x),r=e.width*-t.x,s=e.height*(1-t.y),n=e.height*-t.y,a=[];return a.push(new A(this.a*r+this.c*n+this.tx,this.d*n+this.b*r+this.ty)),a.push(new A(this.a*i+this.c*n+this.tx,this.d*n+this.b*i+this.ty)),a.push(new A(this.a*i+this.c*s+this.tx,this.d*s+this.b*i+this.ty)),a.push(new A(this.a*r+this.c*s+this.tx,this.d*s+this.b*r+this.ty)),a}reset(){this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0}toArray(){let e=[this.a,this.b,0,this.c,this.d,0,this.tx,this.ty,1];return typeof Float32Array=="undefined"?e:new Float32Array(e)}toString(){return`Matrix({ a: ${this.a}, b: ${this.b}, c: ${this.c}, d: ${this.d}, tx: ${this.tx}, ty: ${this.ty} })`}static get IDENTITY(){return new it}}});var ue,pl=_(()=>{Jt();ue=class{constructor(e=0,t=0,i=0,r=0){this.x=0;this.y=0;this.width=0;this.height=0;this.x=e,this.y=t,this.width=i,this.height=r}set(e,t,i,r){return this.x=e,this.y=t,this.width=i,this.height=r,this}clone(){return new ue(this.x,this.y,this.width,this.height)}copy(e){return this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height,this}equals(e,t,i,r){return e instanceof ue?e.x===this.x&&e.y===this.y&&e.width===this.width&&e.height===this.height:e===this.x&&t===this.y&&i===this.width&&r===this.height}translate(e,t){let{x:i,y:r}=Wi(e,t);return this.x+=i,this.y+=r,this}scale(e,t){let{x:i,y:r}=Wi(e,t);return this.width*=i,this.height*=r,this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.width=Math.round(this.width),this.height=Math.round(this.height),this}getPosition(){return new A(this.x,this.y)}getSize(){return new A(this.width,this.height)}insetBy(e,t){return this.x+=e,this.y+=t,this.width-=2*e,this.height-=2*t,this}intersects(e){let t=new A(this.x,this.y),i=new A(this.x+this.width,this.y+this.height),r=new A(e.x,e.y),s=new A(e.x+e.width,e.y+e.height);return!(r.x>i.x||t.x>s.x||s.y<t.y||i.y<r.y)}toString(){return`Rectangle({ x: ${this.x}, y: ${this.y}, width: ${this.width}, height: ${this.height} })`}static FromDiagonalPoints(e,t){let i=!1;t.x-e.x<0&&(i=!0);let r=i?t:e,s=i?e:t,n=s.x-r.x,a=s.y-r.y;return new ue(r.x,r.y,n,a)}}});var Zr,cx,mi,Re=_(()=>{ut();ct();Ui();Jr();ml();fl();pl();Jt();Dt();Zr=2e3,cx=5,mi=cx*4});var Vi,Jo=_(()=>{Re();Vi=class{constructor(){this._position=new A(0,0),this._scale=new A(1,1),this._pivot=new A(0,0),this._rotation=0,this._lastRotation=null,this._alpha=1,this._visible=!0,this._worldTransform=new it,this._parent=null,this._shaders=[],this._boundsNeedUpdate=!0,this._bounds=new ue(0,0,1,1),this._localBoundsNeedUpdate=!0,this._localBounds=new ue(0,0,1,1),this._filterRectangle=new ue(0,0,0,0)}renderWebGL(e){I.warn(this.constructor.name,"`renderWebGL` is abstract and not implemented in inherited class")}renderCanvas(e){I.warn(this.constructor.name,"`renderCanvas` is abstract and not implemented in inherited class")}updateTransform(){let e=this._parent?this._parent.getWorldTransform():it.IDENTITY,t=this._worldTransform,i=Math.sin(this._rotation),r=Math.cos(this._rotation);t.a=r*this._scale.x,t.b=i*this._scale.x,t.c=-i*this._scale.y,t.d=r*this._scale.y,t.tx=this._position.x,t.ty=this._position.y,(this._pivot.x||this._pivot.y)&&(t.tx-=this._pivot.x*t.a+this._pivot.y*t.c,t.ty-=this._pivot.x*t.b+this._pivot.y*t.d),t.multiply(e),this._boundsNeedUpdate=!0,this._localBoundsNeedUpdate=!0}addShader(e){this._shaders.push(e)}removeShader(e){let t=this._shaders.indexOf(e);return t!==-1?(this._shaders.splice(t,1),!0):!1}removeShaderAt(e){return this._shaders[e]?(this._shaders.splice(e,1),!0):!1}getBounds(){return this._bounds.clone()}getPosition(){return this._position}setPosition(e,t){this._position.set(e,t),this._boundsNeedUpdate=!0,this._localBoundsNeedUpdate=!0}getScale(){return this._scale}setScale(e,t){this._scale.set(e,t),this._boundsNeedUpdate=!0,this._localBoundsNeedUpdate=!0}getPivot(){return this._pivot}setPivot(e,t){this._pivot.set(e,t),this._boundsNeedUpdate=!0,this._localBoundsNeedUpdate=!0}getRotation(){return this._rotation}setRotation(e){this._rotation=e,this._boundsNeedUpdate=!0,this._localBoundsNeedUpdate=!0}getAlpha(){return this._alpha}setAlpha(e){this._alpha=e}getWorldAlpha(){return this._parent?this._parent.getAlpha()*this._alpha:this._alpha}getWorldTransform(){return this._worldTransform}getParent(){return this._parent}setParent(e){this._parent=e}getFilterRectangle(){return this._filterRectangle}setFilterRectangle(e){this._filterRectangle.copy(e)}isVisible(){return this._visible}setVisible(e){this._visible=e}}});var Pt,Zo=_(()=>{Re();Jo();Pt=class extends Vi{constructor(){super();this._children=[],this._filters=[]}addFilter(e){this._filters.push(e)}removeFilter(e){let t=this._filters.indexOf(e);return t!==-1?(this._filters.splice(t,1),!0):!1}setFilters(e){this._filters=e}addChild(e){let t=e.getParent();t instanceof Pt&&t.removeChild(e),e.setParent(this),this._children.push(e)}prependChild(e){let t=e.getParent();t instanceof Pt&&t.removeChild(e),e.setParent(this),this._children.unshift(e)}hasChild(e){return this._children.indexOf(e)!==-1}removeChild(e){let t=this._children.indexOf(e);t!==-1?(this._children.splice(t,1),e.setParent(null)):I.info(this.constructor.name,"Tried to remove a child that does not exist")}clearChildren(){this._children=[]}renderWebGL(e){if(!this._visible)return;let t=e.getFilterManager();this._filters&&this._filters.length&&t.pushFilters(this,this._filters),e.getCurrentObjectRenderer().start(),this._renderWebGL(e),this._children.forEach(i=>{i.renderWebGL(e)}),e.getCurrentObjectRenderer().flush(),this._filters&&this._filters.length&&t.popFilters(),e.getCurrentObjectRenderer().start()}_renderWebGL(e){}renderCanvas(e){if(!this._visible)return;let t=e.getFilterManager();this._filters&&this._filters.length&&t.pushFilters(this,this._filters),this._renderCanvas(e),this._children.forEach(i=>{i.renderCanvas(e)}),this._filters&&this._filters.length&&t.popFilters()}_renderCanvas(e){}updateTransform(){super.updateTransform(),this._children.forEach(e=>{e.updateTransform()})}getLocalBounds(){return this._localBoundsNeedUpdate&&(this._localBoundsNeedUpdate=!1),this._localBounds.clone()}getBounds(){return this._boundsNeedUpdate&&(this._boundsNeedUpdate=!1),this._bounds.clone()}getChildren(){return this._children}getFilters(){return this._filters}dispose(){}}});function ad(o,e,t,i,r,s){if(!(isNaN(s)||s<1)){s|=0;var n=o.data,a,l,h,c,m,d,u,f,y,g,p,v,x,T,D,b,w,G,N,j,K,Y,W,he,He=s+s+1,De=i-1,It=r-1,J=s+1,be=J*(J+1)/2,me=new nd,de,$=me;for(h=1;h<He;h++)$=$.next=new nd,h==J&&(de=$);$.next=me;var ge=null,ze=null;u=d=0;var hi=ux[s],ci=dx[s];for(l=0;l<r;l++){for(b=w=G=N=f=y=g=p=0,v=J*(j=n[d]),x=J*(K=n[d+1]),T=J*(Y=n[d+2]),D=J*(W=n[d+3]),f+=be*j,y+=be*K,g+=be*Y,p+=be*W,$=me,h=0;h<J;h++)$.r=j,$.g=K,$.b=Y,$.a=W,$=$.next;for(h=1;h<J;h++)c=d+((De<h?De:h)<<2),f+=($.r=j=n[c])*(he=J-h),y+=($.g=K=n[c+1])*he,g+=($.b=Y=n[c+2])*he,p+=($.a=W=n[c+3])*he,b+=j,w+=K,G+=Y,N+=W,$=$.next;for(ge=me,ze=de,a=0;a<i;a++)n[d+3]=W=p*hi>>ci,W!==0?(W=255/W,n[d]=(f*hi>>ci)*W,n[d+1]=(y*hi>>ci)*W,n[d+2]=(g*hi>>ci)*W):n[d]=n[d+1]=n[d+2]=0,f-=v,y-=x,g-=T,p-=D,v-=ge.r,x-=ge.g,T-=ge.b,D-=ge.a,c=u+((c=a+s+1)<De?c:De)<<2,b+=ge.r=n[c],w+=ge.g=n[c+1],G+=ge.b=n[c+2],N+=ge.a=n[c+3],f+=b,y+=w,g+=G,p+=N,ge=ge.next,v+=j=ze.r,x+=K=ze.g,T+=Y=ze.b,D+=W=ze.a,b-=j,w-=K,G-=Y,N-=W,ze=ze.next,d+=4;u+=i}for(a=0;a<i;a++){for(w=G=N=b=y=g=p=f=0,d=a<<2,v=J*(j=n[d]),x=J*(K=n[d+1]),T=J*(Y=n[d+2]),D=J*(W=n[d+3]),f+=be*j,y+=be*K,g+=be*Y,p+=be*W,$=me,h=0;h<J;h++)$.r=j,$.g=K,$.b=Y,$.a=W,$=$.next;for(m=i,h=1;h<=s;h++)d=m+a<<2,f+=($.r=j=n[d])*(he=J-h),y+=($.g=K=n[d+1])*he,g+=($.b=Y=n[d+2])*he,p+=($.a=W=n[d+3])*he,b+=j,w+=K,G+=Y,N+=W,$=$.next,h<It&&(m+=i);for(d=a,ge=me,ze=de,l=0;l<r;l++)c=d<<2,n[c+3]=W=p*hi>>ci,W>0?(W=255/W,n[c]=f*hi>>ci,n[c+1]=y*hi>>ci,n[c+2]=g*hi>>ci):n[c]=n[c+1]=n[c+2]=0,f-=v,y-=x,g-=T,p-=D,v-=ge.r,x-=ge.g,T-=ge.b,D-=ge.a,c=a+((c=l+J)<It?c:It)*i<<2,f+=b+=ge.r=n[c],y+=w+=ge.g=n[c+1],g+=G+=ge.b=n[c+2],p+=N+=ge.a=n[c+3],ge=ge.next,v+=j=ze.r,x+=K=ze.g,T+=Y=ze.b,D+=W=ze.a,b-=j,w-=K,G-=Y,N-=W,ze=ze.next,d+=i}}}function nd(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}var ux,dx,ld=_(()=>{"use strict";ux=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],dx=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24]});var At,Xs,_l=_(()=>{Ui();At=class{constructor(e=1,t=0,i=0,r=0,s=0,n=0,a=1,l=0,h=0,c=0,m=0,d=0,u=1,f=0,y=0,g=0,p=0,v=0,x=1,T=0){this.set(e,t,i,r,s,n,a,l,h,c,m,d,u,f,y,g,p,v,x,T)}set(e,t,i,r,s,n,a,l,h,c,m,d,u,f,y,g,p,v,x,T){this.a=e,this.b=t,this.c=i,this.d=r,this.e=s,this.f=n,this.g=a,this.h=l,this.i=h,this.j=c,this.k=m,this.l=d,this.m=u,this.n=f,this.o=y,this.p=g,this.q=p,this.r=v,this.s=x,this.t=T}reset(){this.a=1,this.b=0,this.c=0,this.d=0,this.e=0,this.f=0,this.g=1,this.h=0,this.i=0,this.j=0,this.k=0,this.l=0,this.m=1,this.n=0,this.o=0,this.p=0,this.q=0,this.r=0,this.s=1,this.t=0}apply(e){let t=this.a*e.r+this.b*e.g+this.c*e.b+this.d*e.a+this.e,i=this.f*e.r+this.g*e.g+this.h*e.b+this.i*e.a+this.j,r=this.k*e.r+this.l*e.g+this.m*e.b+this.n*e.a+this.o,s=this.p*e.r+this.q*e.g+this.r*e.b+this.s*e.a+this.t;return new S(t,i,r,s)}multiply(e){let t,i,r,s,n,a,l,h,c,m,d,u,f,y,g,p,v,x,T,D,b=e,w=this;return t=b.a*w.a+b.b*w.f+b.c*w.k+b.d*w.p,i=b.a*w.b+b.b*w.g+b.c*w.l+b.d*w.q,r=b.a*w.c+b.b*w.h+b.c*w.m+b.d*w.r,s=b.a*w.d+b.b*w.i+b.c*w.n+b.d*w.s,a=b.f*w.a+b.g*w.f+b.h*w.k+b.i*w.p,l=b.f*w.b+b.g*w.g+b.h*w.l+b.i*w.q,h=b.f*w.c+b.g*w.h+b.h*w.m+b.i*w.r,c=b.f*w.d+b.g*w.i+b.h*w.n+b.i*w.s,d=b.k*w.a+b.l*w.f+b.m*w.k+b.n*w.p,u=b.k*w.b+b.l*w.g+b.m*w.l+b.n*w.q,f=b.k*w.c+b.l*w.h+b.m*w.m+b.n*w.r,y=b.k*w.d+b.l*w.i+b.m*w.n+b.n*w.s,p=b.p*w.a+b.q*w.f+b.r*w.k+b.s*w.p,v=b.p*w.b+b.q*w.g+b.r*w.l+b.s*w.q,x=b.p*w.c+b.q*w.h+b.r*w.m+b.s*w.r,T=b.p*w.d+b.q*w.i+b.r*w.n+b.s*w.s,n=b.a*w.e+b.b*w.j+b.c*w.o+b.d*w.t+b.e,m=b.f*w.e+b.g*w.j+b.h*w.o+b.i*w.t+b.j,g=b.k*w.e+b.l*w.j+b.m*w.o+b.n*w.t+b.o,D=b.p*w.e+b.q*w.j+b.r*w.o+b.s*w.t+b.t,this.a=t,this.b=i,this.c=r,this.d=s,this.e=n,this.f=a,this.g=l,this.h=h,this.i=c,this.j=m,this.k=d,this.l=u,this.m=f,this.n=y,this.o=g,this.p=p,this.q=v,this.r=x,this.s=T,this.t=D,this}clone(){let e=new At;return e.set(this.a,this.b,this.c,this.d,this.e,this.f,this.g,this.h,this.i,this.j,this.k,this.l,this.m,this.n,this.o,this.p,this.q,this.r,this.s,this.t),e}equals(e){return this.a===e.a&&this.b===e.b&&this.c===e.c&&this.d===e.d&&this.e===e.e&&this.f===e.f&&this.g===e.g&&this.h===e.h&&this.i===e.i&&this.j===e.j&&this.k===e.k&&this.l===e.l&&this.m===e.m&&this.n===e.n&&this.o===e.o&&this.p===e.p&&this.q===e.q&&this.r===e.r&&this.s===e.s&&this.t===e.t}getOffsets(){return[this.e,this.j,this.o,this.t]}toString(){return`ColorMatrix( ${this.a}, ${this.b}, ${this.c}, ${this.d}, ${this.e},
      ${this.f}, ${this.g}, ${this.h}, ${this.i}, ${this.j},
      ${this.k}, ${this.l}, ${this.m}, ${this.n}, ${this.o},
      ${this.p}, ${this.q}, ${this.r}, ${this.s}, ${this.t} )`}toArray(){return"abcdefghijklmnopqrst".split("").map(e=>this[e])}static get IDENTITY(){return new At}static createBrightnessMatrix(e){let t=new At;return t.e=e,t.j=e,t.o=e,t}static createContrastMatrix(e){let t=new At,i=(1-e)/2;return t.a=t.g=t.m=e,t.e=t.j=t.o=i,t}static createSaturationMatrix(e=1){let t=new At,i=1-e,r=.213*i,s=.715*i,n=.072*i;return t.a=r+e,t.b=s,t.c=n,t.f=r,t.g=s+e,t.h=n,t.k=r,t.l=s,t.m=n+e,t}static createExposureMatrix(e=0){let t=Math.pow(2,e);return new At(t,0,0,0,0,0,t,0,0,0,0,0,t,0,0,0,0,0,1,0)}static createLinearMatrix(e=1,t=0){let i=new At;return i.a=i.g=i.m=e,i.e=i.j=i.o=t,i}},Xs=At});var Qr,V,$r=_(()=>{ct();Bt();Ui();Jr();_l();Jt();Dt();Qr=class extends Ke{constructor(e={},t={}){super();this.availableOptions=C(C({},Object.getPrototypeOf(this).availableOptions),t),this._onConfigurableUpdate=this._onConfigurableUpdate.bind(this),this._initOptions(e)}_buildConfigError(e){let t="";return this.constructor.name&&(t=`${this.constructor.name}: `),t+=e,new Error(t)}_onOptionsChange(){}validateSettings(){return new Promise((e,t)=>{for(let i in this.availableOptions)if(this.availableOptions[i].required&&typeof this._options[i]=="undefined")return t(this._buildConfigError(`Option \`${i}\` is required.`));e()})}_initOptions(e={}){this._options={};let t,i,r,s=this;for(t in this.availableOptions){if(r=t.charAt(0).toUpperCase()+t.slice(1),i=this.availableOptions[t],["string","number","boolean","object","vector2","color","configurable","color-matrix","array","image","function","*"].indexOf(i.type)===-1)throw this._buildConfigError(`Unknown option type: \`${i.type}\``);if(function(l){s[`set${r}`]=function(h,c,m){s.setOption(l,h,c,m)},s[`get${r}`]=function(){return s.getOption(l)}}(t),i.type==="configurable"&&(this._options[t]=new Qr(void 0,i.structure||{}),this._options[t].on("update",this._onConfigurableUpdate)),!(t in e)||typeof e[t]=="undefined")if(typeof i.default!="undefined"){let a=i.default;typeof i.default=="function"&&(a=i.default()),this[`set${r}`](a,!1,!0)}else i.type!=="configurable"&&(this._options[t]=void 0)}for(t in e){if(typeof this.availableOptions[t]=="undefined")throw new Error(`Invalid option: ${t}`);typeof e[t]!="undefined"&&(r=t.charAt(0).toUpperCase()+t.slice(1),this[`set${r}`](e[t],!1,!0))}}set(e,t=!0){Object.keys(e).forEach(i=>{this.setOption(i,e[i],!1)}),this._onOptionsChange(),t&&this.emit("update",this,e)}getOption(e){return this._options[e]}hasOption(e){return!!this.availableOptions[e]}getOptionDefault(e){let t=this.availableOptions[e];if(!t)throw new Error(`Invalid option: ${e}`);return t.default}resetOptions(){this.set(this.getDefaultOptions())}getDefaultOptions(){let e={};for(let t in this.availableOptions){let i=this.availableOptions[t].default;typeof i!="undefined"&&(e[t]=i)}return e}getOptions(){return C({},this._options)}equals(e){let t=e.getOptions();return this.optionsEqual(t)}optionsEqual(e){for(let t in e){let i=e[t];if(!this._optionEquals(t,i))return!1}return!0}_optionEquals(e,t){if(typeof this.availableOptions[e]=="undefined")throw new Error(`Invalid option: ${e}`);let r=this.availableOptions[e].type,s=this._options[e];if(s===t)return!0;if(typeof t=="undefined"||typeof s=="undefined")return!1;switch(r){case"object":return typeof s.optionsEqual=="function"?s.optionsEqual(t._options):s===t;case"string":case"number":case"boolean":case"function":case"*":return s===t;case"vector2":return s.equals(t);case"color":case"color-matrix":return t.equals(s);case"configurable":return s.optionsEqual(t);case"array":return this._arrayOptionEquals(e,t);case"image":return s.src===t.src}}_arrayOptionEquals(e,t){let i=this._options[e];if(t.length!==i.length)return!1;let r=!0;for(let s=0;s<i.length;s++){let n=i[s],a=t[s];if(n instanceof Qr){if(typeof a=="undefined"||!n.optionsEqual(a)){r=!1;break}}else if(a!==n){r=!1;break}}return r}serializeOptions(e=Object.keys(this._options),t=!1){let i={};return e.forEach(r=>{if(typeof this.availableOptions[r]=="undefined")return Log.warn(`Trying to serialize a key that does not exist: ${r}`);this.availableOptions[r].serializable!==!1&&(i[r]=this.serializeOption(r,t))}),i}serializeOption(e,t=!1){let i=this.availableOptions[e],r=i.type,s=this._options[e];if(!s)return s;if(i.serializable===!1)throw new Error(`Option \`${e}\` is not serializable.`);switch(r){case"string":case"number":case"boolean":case"object":case"function":case"*":return s;case"vector2":return t?s.toObject():s.clone();case"color":case"color-matrix":return t?s.toArray():s.clone();case"configurable":return s.serializeOptions(void 0,t);case"array":return s.slice(0);case"image":return t?s.src:s}}setOption(e,t,i=!0,r=!1){let s=this.availableOptions[e];if(!s)throw new Error(`Invalid option: ${e}`);if(typeof s.setter!="undefined"&&(t=s.setter.call(this,t,r)),typeof s.validation!="undefined"&&s.validation(t),t===null||typeof t=="undefined"){if(s.required)throw this._buildConfigError(`Option \`${e}\` is required.`);this._options[e]=t}else switch(s.type){case"string":{if(typeof t!=="string")throw this._buildConfigError(`Option \`${e}\` has to be a string.`);let{available:n}=s;if(typeof n!="undefined"&&n.indexOf(t)===-1)throw this._buildConfigError(`Invalid value for \`${e}\` (valid values are: ${s.available.join(", ")})`);this._options[e]=t;break}case"number":if(typeof t!=="number")throw this._buildConfigError(`Option \`${e}\` has to be a number.`);this._options[e]=t;break;case"boolean":if(typeof t!=="boolean")throw this._buildConfigError(`Option \`${e}\` has to be a boolean.`);this._options[e]=t;break;case"vector2":if(!(t instanceof A)&&!(typeof t=="object"&&"x"in t&&"y"in t))throw this._buildConfigError(`Option \`${e}\` has to be an instance of Vector2 or an Object holding x and y values.`);t instanceof A?this._options[e]=t.clone():this._options[e]=A.fromObject(t);break;case"color":if(!(t instanceof S))throw this._buildConfigError(`Option \`${e}\` has to be an instance of Color.`);this._options[e]=t;break;case"color-matrix":if(!(t instanceof Xs))throw this._buildConfigError(`Option \`${e}\` has to be an instance of ColorMatrix.`);this._options[e]=t.clone();break;case"function":if(typeof t!="function")throw this._buildConfigError(`Option \`${e}\` has to be a function.`);this._options[e]=t;break;case"object":case"*":this._options[e]=t;break;case"image":{let{Image:n}=Ie;if(typeof t=="string"){let a=new n;vu(a)&&(a.crossOrigin=k.getCrossOriginValue(s.crossOrigin)),a.src=t,this._options[e]=a}else if(t instanceof n||typeof HTMLCanvasElement!="undefined"&&t instanceof HTMLCanvasElement||typeof HTMLImageElement!="undefined"&&t instanceof HTMLImageElement)this._options[e]=t;else throw this._buildConfigError(`Option \`${e}\` has to be an Image, Canvas or String.`);break}case"configurable":t instanceof Qr?this._options[e]=t:this._options[e].set(t);break;case"array":if(!(t instanceof Array))throw this._buildConfigError(`Option \`${e}\` has to be an Array.`);this._options[e]=t.slice(0);break;default:throw this._buildConfigError(`Unknown option type: \`${s.type}\``)}i&&(this._onOptionsChange(),this.emit("update",this,{[e]:t}))}_onConfigurableUpdate(...e){this.emit("update",...e)}hasChanges(){let e=this.getDefaultOptions();return!this.optionsEqual(e)}},V=Qr});var Ys,gl=_(()=>{ct();Re();Re();Ys=class{constructor(e,t,i,r={},s=[]){this._program=null;this._renderer=e,this._vertexSource=t,this._fragmentSource=i,this._uniforms=r,this._uniformLocations={},this._attributes=s,this._attributeLocations={},this._onContextChange=this._onContextChange.bind(this),this._renderer.on("context",this._onContextChange),this._init()}_init(){this._compile(),this._renderer.getContext().useProgram(this._program),this._cacheUniformLocations(),this._cacheAttributeLocations()}_onContextChange(){this._init()}setupBuffers(e,t){let i=this._renderer.getContext();i.bindBuffer(i.ARRAY_BUFFER,e),i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,t),i.vertexAttribPointer(this._attributeLocations.a_position,2,i.FLOAT,!1,mi,0),i.vertexAttribPointer(this._attributeLocations.a_texCoord,2,i.FLOAT,!1,mi,2*4),i.vertexAttribPointer(this._attributeLocations.a_color,4,i.UNSIGNED_BYTE,!0,mi,4*4)}syncUniforms(){Object.keys(this._uniforms).forEach(e=>{this.syncUniform(e)})}syncUniform(e){let t=this._renderer.getContext(),i=this._uniforms[e],r=this._uniformLocations[e];switch(i.type){case"sampler2d":t.uniform1i(r,i.value);break;case"i":case"1i":t.uniform1i(r,i.value);break;case"2i":t.uniform2i(r,i.value[0],i.value[1]);break;case"3i":t.uniform3i(r,i.value[0],i.value[1],i.value[2]);break;case"4i":t.uniform4i(r,i.value[0],i.value[1],i.value[2],i.value[3]);break;case"f":case"1f":t.uniform1f(r,i.value);break;case"2f":t.uniform2f(r,i.value[0],i.value[1]);break;case"3f":t.uniform3f(r,i.value[0],i.value[1],i.value[2]);break;case"4f":t.uniform4f(r,i.value[0],i.value[1],i.value[2],i.value[3]);break;case"2fv":t.uniform2fv(r,i.value);break;case"mat3":case"mat3fv":t.uniformMatrix3fv(r,!1,i.value);break;case"mat4":t.uniformMatrix4fv(r,!1,i.value);break;default:I.warn(this.constructor.name,`Unknown uniform type: ${i.type}`)}}_cacheAttributeLocations(){let e=this._renderer.getContext();this._attributes.forEach(t=>{this._program&&(this._attributeLocations[t]=e.getAttribLocation(this._program,t))})}_cacheUniformLocations(){let e=this._renderer.getContext();Object.keys(this._uniforms).forEach(i=>{if(this._program){let r=e.getUniformLocation(this._program,i);r&&(this._uniformLocations[i]=r)}})}_addPrecisionToSource(e){let t=this._renderer.getMaxFloatPrecision(),i="mediump";return k.isMobile()&&t==="highp"&&(i="highp"),`precision ${i} float;
${e}`}_compile(){let e=this._renderer.getContext(),t=this._compileShader(e.VERTEX_SHADER,this._vertexSource);this._vertexShader=t;let i=this._addPrecisionToSource(this._fragmentSource),r=this._compileShader(e.FRAGMENT_SHADER,i);this._fragmentShader=r;let s=e.createProgram();if(!s)return;if(e.attachShader(s,t),e.attachShader(s,r),e.linkProgram(s),e.getProgramParameter(s,e.LINK_STATUS))this._program=s;else{let a=e.getProgramInfoLog(s);e.isContextLost()&&(a="WebGL context lost"),e.deleteProgram(s),I.error(this.constructor.name,`WebGL program linking error: ${a}`)}}_compileShader(e,t){let i=this._renderer.getContext(),r=i.createShader(e);if(!r)throw new Error(`Cannot create shared: ${JSON.stringify(e)}`);if(i.shaderSource(r,t),i.compileShader(r),!i.getShaderParameter(r,i.COMPILE_STATUS)){let n=i.getShaderInfoLog(r);i.isContextLost()&&(n="WebGL context lost"),i.deleteShader(r),I.error(this.constructor.name,`WebGL shader compilation error: ${n}`)}return r}setUniform(e,t,i=!1){this._uniforms[e].value=t,i&&this.syncUniform(e)}setUniforms(e,t=!1){Object.keys(e).forEach(i=>{this._uniforms[i].value=e[i],t&&this.syncUniform(i)})}getUniforms(){return this._uniforms}getAttributes(){return this._attributes}getAttributeLocations(){return this._attributeLocations}getProgram(){return this._program}dispose(){let e=this._renderer.getContext();e.deleteProgram(this._program),e.deleteShader(this._vertexShader),e.deleteShader(this._fragmentShader),this._renderer.off("context",this._onContextChange)}}});var cd,hd=_(()=>{cd=`uniform sampler2D u_image;
varying vec2 v_texCoord;
varying vec4 v_color;

void main() {
  gl_FragColor = texture2D(u_image, v_texCoord) * v_color;
}
`});var dd,ud=_(()=>{dd=`attribute vec2 a_position;
attribute vec2 a_texCoord;
attribute vec4 a_color;
varying vec2 v_texCoord;
varying vec4 v_color;
uniform mat3 u_projMatrix;

void main() {
  gl_Position = vec4((u_projMatrix * vec3(a_position, 1)).xy, 0, 1);
  v_texCoord = a_texCoord;
  v_color = vec4(a_color.rgb * a_color.a, a_color.a);
}
`});var px,Zt,yl,md=_(()=>{ct();Re();gl();hd();ud();px=new it,Zt={vertexSource:dd,fragmentSource:cd,uniforms:{u_image:{type:"sampler2d",value:0},u_projMatrix:{type:"mat3",value:px.toArray()}},attributes:["a_position","a_texCoord","a_color"]},yl=class extends Ys{constructor(e,t=Zt.vertexSource,i=Zt.fragmentSource){super(e,t,i,Zt.uniforms,Zt.attributes)}}});var xl=_(()=>{gl();md()});var Ot,es=_(()=>{Kt();ld();ct();$r();Re();xl();Bt();Ot=class extends V{constructor(e={},t={}){super(e,t);this._initOptions(e)}_initOptions(e={}){this._shaders=[],this._availableUniforms=Zt.uniforms,this._attributes=Zt.attributes,this._vertexSource=Zt.vertexSource,this._fragmentSource=Zt.fragmentSource,this._initUniforms(),super._initOptions(e)}_initUniforms(){this._uniforms={};for(let e in this._availableUniforms){let t=this._availableUniforms[e];this._uniforms[e]={type:t.type,value:t.default||null}}for(let e in this.availableOptions){let t=this.availableOptions[e];t.uniformType?this._uniforms[`u_${e}`]={type:t.uniformType,value:t.default||null}:I.trace(this.constructor.name,`Option \`${e}\` is missing a \`uniformType\`!`)}}setOption(e,t,i=!0){super.setOption(e,t,i);let r=t,s=this.availableOptions[e];if(!s.uniformType)return;let n=`u_${e}`;switch(s.type){case"color":s.uniformType==="4f"?r=t.toGLColor():s.uniformType==="3f"&&(r=t.toRGBGLColor());break;case"vector2":r=[t.x,t.y];break;case"color-matrix":{r=[t.a,t.b,t.c,t.d,t.f,t.g,t.h,t.i,t.k,t.l,t.m,t.n,t.p,t.q,t.r,t.s];let a=[t.e,t.j,t.o,t.t];this._uniforms[`${n}_vec`]={value:a,type:"4f"}}}this.setUniform(n,r)}setUniform(e,t,i=!1){this._uniforms[e].value=t}setUniforms(e,t=!1){Object.entries(e).forEach(([i,r])=>{this._uniforms[i].value=r,t&&this.syncUniform(i)})}syncUniform(e){this._shaders.forEach(t=>{t.syncUniform(e)})}syncUniforms(){this._shaders.forEach(e=>{e.syncUniforms()})}getShaderForRenderer(e){let{id:t}=e;this._shaders||(this._shaders=[]);let i=this._shaders[t];return i||(i=new Ys(e,this._vertexSource,this._fragmentSource,this._uniforms,this._attributes),this._shaders[t]=i),i}apply(e,t,i,r=!1){Wr(e)?this._applyWebGL(e,t,i,r):this._applyCanvas(e,t,i,r)}_applyWebGL(e,t,i,r=!1){let s=e.getContext(),n=this.getShaderForRenderer(e);e.setRenderTarget(i),r&&i.clear(),e.setShader(n);let a=e.getCurrentRenderTarget().getProjectionMatrix().toArray();n.setUniform("u_projMatrix",a),n.syncUniforms(),s.activeTexture(s.TEXTURE0),s.bindTexture(s.TEXTURE_2D,t.getTexture()),s.drawElements(s.TRIANGLES,6,s.UNSIGNED_SHORT,0)}_applyCanvas(e,t,i,r=!1){let s=t.getCanvas(),n=i.getContext();I.warn(this.constructor.name,"`_applyCanvas` is not implemented. Just copying image data from `inputTarget` to `outputTarget`."),n.clearRect(0,0,s.width,s.height),n.drawImage(s,0,0)}dispose(){this._shaders.forEach(e=>e.dispose()),this._shaders=[]}_blurImage(e,t,i){let s=e.getCanvas(),n=Math.min(1,10/(i*Math.min(s.width,s.height))),a=k.createCanvas();a.width=Math.round(s.width*n),a.height=Math.round(s.height*n);let l=a.getContext("2d");l.drawImage(s,0,0,s.width,s.height,0,0,a.width,a.height);let h=i*Math.min(a.width,a.height),c=l.getImageData(0,0,a.width,a.height);ad(c,0,0,a.width,a.height,h),l.putImageData(c,0,0),t.getContext().drawImage(a,0,0,a.width,a.height,0,0,s.width,s.height),Ce(a)}}});var pd,fd=_(()=>{pd=`uniform sampler2D u_image;
varying vec2 v_texCoord;
varying vec4 v_color;

void main() {
  vec4 color = texture2D(u_image, v_texCoord);
  gl_FragColor = vec4(color.a > 0. ? color.rgb / color.a : vec3(0), color.a);
}
`});var ts,_d=_(()=>{es();fd();ts=class extends Ot{constructor(){super();this._fragmentSource=pd}}});var yd,gd=_(()=>{yd=`uniform sampler2D u_image;
varying vec2 v_texCoord;
uniform vec4 u_color;

void main() {
  vec4 color = texture2D(u_image, v_texCoord);
  gl_FragColor = vec4(mix(color.rgb, u_color.rgb, u_color.a), color.a) * color.a;
}
`});var yx,xx,bl,xd,bd=_(()=>{Re();es();gd();({OptionType:yx,UniformType:xx}=tt),bl=class extends Ot{constructor(...e){super(...e);this._fragmentSource=yd}_applyCanvas(e,t,i,r=!1){let s=t.getCanvas(),n=t.getContext(),a=i.getContext(),{color:l}=this._options,h=n.getImageData(0,0,s.width,s.height),c=a.getImageData(0,0,s.width,s.height),m=s.width*s.height,d=new S,u=new S;for(let f=0;f<m*4;f+=4){d.set(h.data[f]/255,h.data[f+1]/255,h.data[f+2]/255,h.data[f+3]/255),u.set(c.data[f]/255,c.data[f+1]/255,c.data[f+2]/255,c.data[f+3]/255);let y=u.r+d.a*(d.r-u.r);c.data[f]=(y+d.a*(l.r-y))*255;let g=u.g+d.a*(d.g-u.g);c.data[f+1]=(g+d.a*(l.g-g))*255;let p=u.b+d.a*(d.b-u.b);c.data[f+2]=(p+d.a*(l.b-p))*255}a.putImageData(c,0,0)}};bl.prototype.availableOptions={color:{type:yx.COLOR,default:S.WHITE,uniformType:xx.FLOAT4}};xd=bl});var wd,vd=_(()=>{wd=`uniform sampler2D u_image;
varying vec2 v_texCoord;
uniform vec4 u_color;
uniform int u_mode;
vec3 W = vec3(0.2125, 0.7154, 0.0721);
const float EPSILON = 0.0000001;
void main() {
    vec4 color = texture2D(u_image, v_texCoord); // Is premultiplied.
    color.rgb /= max(color.a, EPSILON); // Revert premultiplied alpha.
    vec4 newColor;
    if (u_mode == 0) {
        newColor = vec4(color.rgb, 1.0); // We use alpha 1.0 becaue color is not premultiplied.
        newColor *= color.a; // Premultiply the result
    } else if (u_mode == 1) {
        newColor = vec4(u_color.rgb, 1.0); // Use alpha 1.0 because it is not premultiplied.
        newColor *= color.a * u_color.a; // Changed alpha and premultiplied the result.
    } else if (u_mode == 2) {
        float luminance = dot(color.rgb, W); // Convert to color to gray value.
        newColor = vec4(vec3(luminance) * u_color.rgb, 1.0); // Colorize and with alpha 1.0 because it is not premultiplied.
        newColor *= color.a * u_color.a; // Changed alpha and premultiplied the result.
    }
    gl_FragColor = newColor;
}`});var Td,Rd,fi,Cd,kd=_(()=>{Re();es();vd();({OptionType:Td,UniformType:Rd}=tt),fi=class extends Ot{constructor(...e){super(...e);this._fragmentSource=wd}_applyCanvas(e,t,i,r=!1){let s=t.getCanvas(),n=t.getContext(),a=i.getContext(),l=n.getImageData(0,0,s.width,s.height),{mode:h,color:c}=this._options,{r:m,g:d,b:u,a:f}=c,y=[.2125,.7154,.0721];switch(h){case fi.MODES.SOLID:for(let g=0;g<s.width*s.height;g++){let p=g*4;l.data[p]+=(m*255-l.data[p])*f,l.data[p+1]+=(d*255-l.data[p+1])*f,l.data[p+2]+=(u*255-l.data[p+2])*f}break;case fi.MODES.COLORIZED:for(let g=0;g<s.width*s.height;g++){let p=g*4,v=l.data[p]/255*y[0]+l.data[p+1]/255*y[1]+l.data[p+2]/255*y[2],x=new S(v*m,v*d,v*u);l.data[p]+=(x.r*255-l.data[p])*f,l.data[p+1]+=(x.g*255-l.data[p+1])*f,l.data[p+2]+=(x.b*255-l.data[p+2])*f}break}a.putImageData(l,0,0)}};fi.MODES={NONE:0,SOLID:1,COLORIZED:2};fi.prototype.availableOptions={color:{type:Td.COLOR,default:S.WHITE,uniformType:Rd.FLOAT4},mode:{type:Td.NUMBER,default:fi.MODES.NONE,uniformType:Rd.INT}};Cd=fi});var Od,Sd=_(()=>{Od=`uniform sampler2D u_image;
varying vec2 v_texCoord;
uniform sampler2D u_overlayImage;
uniform int u_blendMode;
uniform float u_alpha;

const float EPSILON = 0.000001;

vec4 overlay(vec4 a, vec4 b) {
    vec3 result = mix(
          1.0 - 2.0 * (1.0 - a.rgb) * (1.0 - b.rgb),
          2.0 * a.rgb * b.rgb,
          vec3(a.r < 0.5, a.g < 0.5, a.b < 0.5)
      );
    return mix(a, vec4(result, a.a), u_alpha * b.a);
}

vec4 hardLight(vec4 b, vec4 a) {
    vec3 result = mix(
          1.0 - 2.0 * (1.0 - a.rgb) * (1.0 - b.rgb),
          2.0 * a.rgb * b.rgb,
          vec3(a.r < 0.5, a.g < 0.5, a.b < 0.5)
      );
    return mix(b, vec4(result, b.a), u_alpha * a.a);
}

vec4 softLight(vec4 a, vec4 b) {
    vec3 result = mix(
          2.0 * a.rgb * (1.0 - b.rgb) + (2.0 * b.rgb - 1.0) * sqrt(a.rgb),
          2.0 * a.rgb * b.rgb + a.rgb * a.rgb * (1.0 - 2.0 * b.rgb),
          vec3(b.r < 0.5, b.g < 0.5, b.b < 0.5)
      );
    return mix(a, vec4(result, a.a), u_alpha * b.a);
}

vec4 multiply(vec4 a, vec4 b) {
    vec3 result = a.rgb * b.rgb;
    return mix(a, vec4(result, a.a), u_alpha * b.a);
}

vec4 darken(vec4 a, vec4 b) {
    vec3 result = min(a.rgb, b.rgb);
    return mix(a, vec4(result, a.a), u_alpha * b.a);
}

vec4 lighten(vec4 a, vec4 b) {
    vec3 result = max(a.rgb, b.rgb);
    return mix(a, vec4(result, a.a), u_alpha * b.a);
}

vec4 screen(vec4 a, vec4 b) {
    vec3 result = 1.0 - (1.0 - a.rgb) * (1.0 - b.rgb);
    return mix(a, vec4(result, a.a), u_alpha * b.a);
}

vec4 colorBurn(vec4 a, vec4 b) {
    vec3 result = clamp(1.0 - (1.0 - a.rgb) / max(b.rgb, EPSILON), 0.0, 1.0);
    return mix(a, vec4(result, a.a), u_alpha * b.a);
}

vec4 normal(vec4 a, vec4 b) {
    return mix(a, vec4(b.rgb, a.a), u_alpha * b.a);
}

void main() {
  vec4 color = texture2D(u_image, v_texCoord);
  vec4 overlayColor = texture2D(u_overlayImage, v_texCoord);

  vec4 resultColor;
  if (u_blendMode == 0) {
    resultColor = normal(color, overlayColor);
  } else if (u_blendMode == 1) {
    resultColor = overlay(color, overlayColor);
  } else if (u_blendMode == 2) {
    resultColor = hardLight(color, overlayColor);
  } else if (u_blendMode == 3) {
    resultColor = softLight(color, overlayColor);
  } else if (u_blendMode == 4) {
    resultColor = multiply(color, overlayColor);
  } else if (u_blendMode == 5) {
    resultColor = darken(color, overlayColor);
  } else if (u_blendMode == 6) {
    resultColor = lighten(color, overlayColor);
  } else if (u_blendMode == 7) {
    resultColor = screen(color, overlayColor);
  } else if (u_blendMode == 8) {
    resultColor = colorBurn(color, overlayColor);
  }
  gl_FragColor = vec4(resultColor.rgb * resultColor.a, resultColor.a);
}
`});var Qo,vl,wl,Je,Fd,Ed=_(()=>{Re();es();Sd();({OptionType:Qo,UniformType:vl}=tt),wl=1e-6,Je=class extends Ot{constructor(...e){super(...e);this._fragmentSource=Od,this._lastImage=null}_applyCanvas(e,t,i,r=!1){let s=this._options.overlayTexture.getRenderTarget().getContext(),n=t.getCanvas(),a=t.getContext(),l=i.getContext(),h=a.getImageData(0,0,n.width,n.height),c=s.getImageData(0,0,n.width,n.height),{blendMode:m,alpha:d}=this._options,u=new S,f=new S,y=new S;for(let g=0;g<n.width*n.height*4;g+=4){u.set(h.data[g]/255,h.data[g+1]/255,h.data[g+2]/255,h.data[g+3]/255),f.set(c.data[g]/255,c.data[g+1]/255,c.data[g+2]/255,c.data[g+3]/255);let p,v,x,T,D,b,w,G,N;switch(m){case Je.BLEND_MODES.NORMAL:y.set(u.r+f.a*d*(f.r-u.r),u.g+f.a*d*(f.g-u.g),u.b+f.a*d*(f.b-u.b),u.a);break;case Je.BLEND_MODES.OVERLAY:p=1-2*(1-u.r)*(1-f.r),v=2*u.r*f.r,x=p+(u.r<.5?1:0)*(v-p),T=1-2*(1-u.g)*(1-f.g),D=2*u.g*f.g,b=T+(u.g<.5?1:0)*(D-T),w=1-2*(1-u.b)*(1-f.b),G=2*u.b*f.b,N=w+(u.b<.5?1:0)*(G-w),y.set(u.r+f.a*d*(x-u.r),u.g+f.a*d*(b-u.g),u.b+f.a*d*(N-u.b),u.a);break;case Je.BLEND_MODES.HARD_LIGHT:p=1-2*(1-f.r)*(1-u.r),v=2*f.r*u.r,x=p+(f.r<.5?1:0)*(v-p),T=1-2*(1-f.g)*(1-u.g),D=2*f.g*u.g,b=T+(f.g<.5?1:0)*(D-T),w=1-2*(1-f.b)*(1-u.b),G=2*f.b*u.b,N=w+(f.b<.5?1:0)*(G-w),y.set(u.r+f.a*d*(x-u.r),u.g+f.a*d*(b-u.g),u.b+f.a*d*(N-u.b),u.a);break;case Je.BLEND_MODES.SOFT_LIGHT:p=2*u.r*(1-f.r)+(2*f.r-1)*Math.sqrt(u.r),v=2*u.r*f.r+u.r*u.r*(1-2*f.r),x=p+(f.r<.5?1:0)*(v-p),T=2*u.g*(1-f.g)+(2*f.g-1)*Math.sqrt(u.g),D=2*u.g*f.g+u.g*u.g*(1-2*f.g),b=T+(f.g<.5?1:0)*(D-T),w=2*u.b*(1-f.b)+(2*f.b-1)*Math.sqrt(u.b),G=2*u.b*f.b+u.b*u.b*(1-2*f.b),N=w+(f.b<.5?1:0)*(G-w),y.set(u.r+f.a*d*(x-u.r),u.g+f.a*d*(b-u.g),u.b+f.a*d*(N-u.b),u.a);break;case Je.BLEND_MODES.MULTIPLY:x=u.r*f.r,b=u.g*f.g,N=u.b*f.b,y.set(u.r+f.a*d*(x-u.r),u.g+f.a*d*(b-u.g),u.b+f.a*d*(N-u.b),u.a);break;case Je.BLEND_MODES.DARKEN:x=Math.min(u.r,f.r),b=Math.min(u.g,f.g),N=Math.min(u.b,f.b),y.set(u.r+f.a*d*(x-u.r),u.g+f.a*d*(b-u.g),u.b+f.a*d*(N-u.b),u.a);break;case Je.BLEND_MODES.LIGHTEN:x=Math.max(u.r,f.r),b=Math.max(u.g,f.g),N=Math.max(u.b,f.b),y.set(u.r+f.a*d*(x-u.r),u.g+f.a*d*(b-u.g),u.b+f.a*d*(N-u.b),u.a);break;case Je.BLEND_MODES.SCREEN:x=1-(1-u.r)*(1-f.r),b=1-(1-u.g)*(1-f.g),N=1-(1-u.b)*(1-f.b),y.set(u.r+f.a*d*(x-u.r),u.g+f.a*d*(b-u.g),u.b+f.a*d*(N-u.b),u.a);break;case Je.BLEND_MODES.COLOR_BURN:x=Math.max(0,Math.min(1,1-(1-u.r)/Math.max(f.r,wl))),b=Math.max(0,Math.min(1,1-(1-u.g)/Math.max(f.g,wl))),N=Math.max(0,Math.min(1,1-(1-u.b)/Math.max(f.b,wl))),y.set(u.r+f.a*d*(x-u.r),u.g+f.a*d*(b-u.g),u.b+f.a*d*(N-u.b),u.a);break}h.data[g]=y.r*255,h.data[g+1]=y.g*255,h.data[g+2]=y.b*255,h.data[g+3]=y.a*255}l.putImageData(h,0,0)}};Je.BLEND_MODES={NORMAL:0,OVERLAY:1,HARD_LIGHT:2,SOFT_LIGHT:3,MULTIPLY:4,DARKEN:5,LIGHTEN:6,SCREEN:7,COLOR_BURN:8};Je.prototype.availableOptions={blendMode:{type:Qo.NUMBER,default:Je.BLEND_MODES.NORMAL,uniformType:vl.INT},overlayImage:{type:Qo.NUMBER,required:!0,uniformType:vl.SAMPLER2D},overlayTexture:{type:Qo.OBJECT,required:!0},alpha:{type:Qo.NUMBER,default:1,uniformType:vl.FLOAT}};Fd=Je});var Tl={};Te(Tl,{ColorOverlayFilter:()=>xd,OverlayFilter:()=>Fd,TintFilter:()=>Cd,UnpremultiplyFilter:()=>ts});var Rl=_(()=>{_d();bd();kd();Ed()});var Id,is,ve,rs=_(()=>{Re();Bt();Id={[1]:"LINEAR",[0]:"NEAREST",[2]:"LINEAR_MIPMAP_NEAREST",[3]:"LINEAR_MIPMAP_LINEAR"},is=class extends Ke{constructor(e){super();this._renderers=[];this._glTextures={};this._dirty=!0;this._mipMapping=!1;this._glUnit=0;this._magFilter=is.DefaultMagFilter;this._minFilter=is.DefaultMinFilter;this._repeatX=0;this._repeatY=0;this._pixelRatio=1;this._loaded=!1;this._frame=new ue(0,0,100,100);this._onSourceLoaded=this._onSourceLoaded.bind(this),this._source=e,this._loadSource()}resizeTo(e){this._frame.width===e.x&&this._frame.height===e.y||(this._frame.width=e.x,this._frame.height=e.y,this._dirty=!0)}_loadSource(){let e=this._source;if(!!e){if(Ie.isCanvas(e))return this._onSourceLoaded();if(e.complete)return this._onSourceLoaded();e.addEventListener&&e.addEventListener("load",this._onSourceLoaded)}}_onSourceLoaded(){this._loaded=!0,this.emit("loaded"),this.update()}_updateGLFilters(){if(!this._source)return;let e=new A(this._source.width,this._source.height);k.isPowerOfTwo(e)?(I.info(this.constructor.name,"Mip-mapping enabled"),this._minFilter=is.TrilinearFilter,this._mipMapping=!0):(this._minFilter=is.LinearFilter,this._mipMapping=!1)}update(){!this._source||((this._frame.width!==this._source.width||this._frame.height!==this._source.height)&&(this._frame=new ue(0,0,this._source.width,this._source.height),this._dirty=!0),this._updateGLFilters(),this.emit("update"))}getRenderers(){return[...this._renderers]}getGLFilter(e,t){switch(t){case"min":return e[Id[this._minFilter]];case"mag":return e[Id[this._magFilter]]}}isLoaded(){return this._loaded}setLoaded(e){this._loaded=e}getSource(){return this._source}setSource(e){this._source=e}getGLTextureForRenderer(e){return this._glTextures[e.id]}setGLTextureForRenderer(e,t){this._renderers[t.id]=t,this._glTextures[t.id]=e}getFrame(){return this._frame}setFrame(e){this._frame=e}getDimensions(){return new A(this._frame.width,this._frame.height)}getPixelRatio(){return this._pixelRatio}setPixelRatio(e){this._pixelRatio=e}getGLUnit(){return this._glUnit}setGLUnit(e){this._glUnit=e}setMinFilter(e){this._minFilter=e}getMinFilter(){return this._minFilter}setMagFilter(e){this._magFilter=e}getMagFilter(){return this._magFilter}setRepeatX(e){this._repeatX=e}getRepeatX(){return this._repeatX}setRepeatY(e){this._repeatY=e}getRepeatY(){return this._repeatY}getGLRepeat(e,t){switch(t==="x"?this.getRepeatX():this.getRepeatY()){case 0:return e.CLAMP_TO_EDGE;case 1:return e.REPEAT;case 2:return e.MIRRORED_REPEAT;default:return 0}}isDirty(){return this._dirty}setDirty(e){this._dirty=e}disposeGLTextures(){this._renderers.forEach(e=>{Wr(e)&&this.disposeGLTexturesForRenderer(e)})}disposeGLTexturesForRenderer(e){if(!this._glTextures[e.id])return;e.getContext().deleteTexture(this._glTextures[e.id]),delete this._glTextures[e.id],this._renderers[e.id]||delete this._renderers[e.id]}isMipMappingEnabled(){return this._mipMapping}setMipMappingEnabled(e){this._mipMapping=e}dispose(){this.disposeGLTextures(),this._source=void 0}},ve=is;ve.NearestFilter=0,ve.LinearFilter=1,ve.BilinearFilter=2,ve.TrilinearFilter=3,ve.DefaultMagFilter=0,ve.DefaultMinFilter=1,ve.Repeat=1,ve._id=0});var Qt,Ks=_(()=>{Re();rs();Bt();Qt=class{constructor(e,t,i,r=Ie.createCanvas(),s){this._width=e,this._height=t,this._pixelRatio=i,this._baseTexture=new ve,this._canvas=r;let n=s||this._canvas.getContext("2d");if(!n)throw new Error("Cannot get canvas context");this._context=n,this._baseTexture.setSource(this._canvas),this._canvas.width=this._width*this._pixelRatio,this._canvas.height=this._height*this._pixelRatio,this._filterStack=[{renderTarget:this,filters:[]}]}clear(){let e=this._context;e.setTransform(1,0,0,1,0,0),e.clearRect(0,0,this._width*this._pixelRatio,this._height*this._pixelRatio)}resizeTo(e){this._baseTexture.resizeTo(e),this._width!==e.x&&(this._width=e.x,this._canvas.width=this._width*this._pixelRatio),this._height!==e.y&&(this._height=e.y,this._canvas.height=this._height*this._pixelRatio)}getCanvas(){return this._canvas}getContext(){return this._context}getFilterStack(){return this._filterStack}getWidth(){return this._width}getHeight(){return this._height}getPixelRatio(){return this._pixelRatio}setPixelRatio(e){this._pixelRatio=e}getDimensions(){return new A(this._width,this._height)}getBaseTexture(){return this._baseTexture}dispose(){delete this._canvas,delete this._context,this._baseTexture.dispose()}}});var Hi,$o=_(()=>{Re();Ks();Hi=class{constructor(e){this._renderer=e,this._filterStack=[{renderTarget:e.getCurrentRenderTarget(),filters:[]}],this._textures=[],this._textureFrame=new ue(0,0,e.getWidth(),e.getHeight())}resizeTo(e){this._textureFrame.width=e.x,this._textureFrame.height=e.y,this._textures.forEach(t=>t.resizeTo(e))}pushFilters(e,t){this._currentFrame=e.getBounds();let i=this._getOrCreateRenderTarget();this._renderer.setRenderTarget(i),this._filterStack.push({renderTarget:i,filters:t}),i.clear()}popFilters(){let e=this._filterStack.pop();if(!e)return;let{filters:t,renderTarget:i}=e,r=this._filterStack[this._filterStack.length-1],s=i,n=r.renderTarget;return t.length===1?(t[0].apply(this._renderer,s,n),this._textures.push(s)):this._applyFilters(t,s,n),t}_applyFilters(e,t,i){let r=t,s=this._getOrCreateRenderTarget(!0),n=e[e.length-1];e.forEach(a=>{if(a===n)a.apply(this._renderer,r,i);else{a.apply(this._renderer,r,s);let h=r;r=s,s=h}}),this._textures.push(r),this._textures.push(s)}_getOrCreateRenderTarget(e=!1){let t=this._textures.pop();return t||(t=new Qt(this._textureFrame.width,this._textureFrame.height,1)),e&&t.clear(),t}setFilterStack(e){this._filterStack=e}dispose(){}}});var ss=xt((Md,Js)=>{(function(){var o,e,t,i,r,s;typeof performance!="undefined"&&performance!==null&&performance.now?Js.exports=function(){return performance.now()}:typeof process!="undefined"&&process!==null&&process.hrtime?(Js.exports=function(){return(o()-r)/1e6},e=process.hrtime,o=function(){var n;return n=e(),n[0]*1e9+n[1]},i=o(),s=process.uptime()*1e9,r=i-s):Date.now?(Js.exports=function(){return Date.now()-t},t=Date.now()):(Js.exports=function(){return new Date().getTime()-t},t=new Date().getTime())}).call(Md)});var Bd,Dd,en,Cl=_(()=>{Re();Bd=typeof window!="undefined"&&window.performance&&window.performance.now?window.performance.now.bind(window.performance):ss(),Dd=class{constructor(e){this._context=e,this._tracking=!1;let t=this;for(let i in e)typeof e[i]=="function"?this[i]=function(...s){let n=e[i];if(!t._tracking)return n.apply(e,s);let a=Bd(),l=n.apply(e,s),h=Bd()-a,c={functionName:i,arguments:s,duration:h};return t._trackedCalls.push(c),l}:this._makePropertyWrapper(i)}_makePropertyWrapper(e){if(["_context","_trackedCalls","_tracking"].indexOf(e)!==-1)return;let i=this._context;this.__defineGetter__(e,()=>i[e]),this.__defineSetter__(e,r=>{i[e]=r})}startFrame(){this._tracking=!0,this._trackedCalls=[]}endFrame(){let e="Rendering";I.log(e,"Frame rendering results:"),I.log(e,`Context calls: ${this._trackedCalls.length}`);let t={};this._trackedCalls.forEach(({functionName:r,duration:s})=>{t[r]=t[r]||{totalDuration:0,calls:0},t[r].totalDuration+=s,t[r].calls++});let i=[];for(let r in t){let s=t[r];s.averageDuration=s.totalDuration/s.calls,i.push({functionName:r,data:s})}i.sort((r,s)=>s.data.totalDuration-r.data.totalDuration),i=i.slice(0,3),i.forEach(r=>{I.log(e,`${r.functionName}: ${r.data.calls} calls, ${r.data.totalDuration.toFixed(2)}ms`)})}},en=Dd});var Zs,kl=_(()=>{Re();Zs=class extends Ke{constructor(e=800,t=600,i){super();this._maxTextureSize=null;this._options=L(C({debug:!1,transparent:!1,clearColor:S.TRANSPARENT},i),{pixelRatio:1}),this.setMaxListeners(0),this._width=e,this._height=t,this._dimensions=new A(this._width,this._height),this._maxTextureSize=null,this._pixelRatio=this._options.pixelRatio,this._canvas=this._options.canvas,this._clearColor=this._options.transparent?S.TRANSPARENT:this._options.clearColor||S.BLACK}setCanvas(e){let t=this._canvas;this._canvas=e,t!==e&&(this._createContext(),this._onBeforeContext(),this._setupContext()),this.resizeTo(new A(this._width,this._height))}getCanvas(){return this._canvas}_onBeforeContext(){}resizeTo(e,t=!0){this._width=e.x*this._pixelRatio,this._height=e.y*this._pixelRatio,t&&this._canvas&&(this._canvas.width=this._width,this._canvas.height=this._height,"style"in this._canvas&&(this._canvas.style.width=`${this._width/this._pixelRatio}px`,this._canvas.style.height=`${this._height/this._pixelRatio}px`)),this._dimensions=e.clone()}_createContext(){I.warn(this.constructor.name,"`_createContext` is abstract and not implemented in inherited class")}_setupContext(){I.warn(this.constructor.name,"`_setupContext` is abstract and not implemented in inherited class")}render(e){I.warn(this.constructor.name,"`render` is abstract and not implemented in inherited class")}getMaxDimensions(){return null}getContext(){return this._context}getWidth(){return this._dimensions.x}getHeight(){return this._dimensions.y}getDimensions(){return this._dimensions}getPixelRatio(){return this._pixelRatio}setPixelRatio(e){this._pixelRatio=e,this._defaultRenderTarget&&this._defaultRenderTarget.setPixelRatio(e)}getMaxTextureSize(){return this._maxTextureSize}getFilterManager(){return this._filterManager}setFilterManager(e){this._filterManager=e}setClearColor(e){this._clearColor=e}getClearColor(){return this._clearColor}isOfType(e){return this._type===e}dispose(){I.warn(this.constructor.name,"`dispose` is abstract and not implemented in inherited class")}}});var Pd,Sl,os,Ad=_(()=>{Kt();Jo();Re();$o();Ks();Cl();Bt();kl();({RendererType:Pd}=tt),Sl=class extends Zs{constructor(e=800,t=600,i){super(e,t,C({},i));this.id=0;this.setCanvas((i==null?void 0:i.canvas)||Ie.createCanvas()),this._type=Pd.CANVAS}_createContext(){let t=this._canvas.getContext("2d");if(!!t)return this._options.debug&&(t=new en(t)),this.id=Sl.contextId++,this._context=t,this.emit("context",t),t}_setupContext(){let e=this._context;"imageSmoothingEnabled"in e?e.imageSmoothingEnabled=!0:["moz","webkit","ms"].forEach(t=>{e[t]&&(e[t]=!0)}),this._defaultRenderTarget=new Qt(this._width,this._height,this._pixelRatio,this._canvas,this._context),this.setRenderTarget(this._defaultRenderTarget),this._filterManager=new Hi(this)}render(e){let t=this._renderTarget.getContext(),i=e.getParent();e.setParent(new Vi),e.updateTransform(),i&&e.setParent(i),t.setTransform(1,0,0,1,0,0),t.globalAlpha=1;let{width:r,height:s}=this._canvas;t.clearRect(0,0,r,s),this._clearColor.a!==0&&(t.save(),t.fillStyle=this._clearColor.toRGBA(),t.fillRect(0,0,r,s),t.restore()),this.renderDisplayObject(e,this._renderTarget)}renderDisplayObject(e,t){let i=this._renderTarget;this._filterManager.setFilterStack(t.getFilterStack()),this.setRenderTarget(t),e.renderCanvas(this),this.setRenderTarget(i)}getCurrentRenderTarget(){return this._renderTarget}setRenderTarget(e){this._renderTarget=e}getContext(){return this._renderTarget.getContext()}dispose(){Ce(this._canvas),this._filterManager.dispose()}},os=Sl;os.contextId=0,os.type=Pd.CANVAS});var Ld,zd=_(()=>{Ld=o=>{if(typeof window!="undefined"){let{WebGLDebugUtils:e}=window;if(e){let t=(i,r)=>{console.error(`gl.${i}(${e.glFunctionArgsToString(i,r)})`)};o=e.makeDebugContext(o,null,t)}}return o}});var Ol,Nd=_(()=>{Ol=class{constructor(e){this.vertices=new Float32Array([0,0,100,0,100,100,0,100]);this.uvs=new Float32Array([0,0,1,0,1,1,0,1]);this.indices=new Uint16Array([0,1,2,0,3,2]);this.colors=new Float32Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]);this.vertexBuffer=null;this.indexBuffer=null;this.gl=e,this.initBuffers(),this.uploadBuffers()}map(e,t){let{x:i,y:r}=t;this.uvs[2]=t.width/e.width,this.uvs[4]=this.uvs[2],this.uvs[5]=t.height/e.height,this.uvs[7]=this.uvs[5],this.vertices[0]=i,this.vertices[1]=r,this.vertices[2]=i+t.width,this.vertices[3]=r,this.vertices[4]=this.vertices[2],this.vertices[5]=r+t.height,this.vertices[6]=i,this.vertices[7]=this.vertices[5],this.uploadBuffers()}getVertexBuffer(){return this.vertexBuffer}getIndexBuffer(){return this.indexBuffer}dispose(){this.cleanBuffer()}initBuffers(){let{gl:e}=this;this.cleanBuffer(),this.vertexBuffer=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,this.vertexBuffer),e.bufferData(e.ARRAY_BUFFER,(8+8+16)*4,e.DYNAMIC_DRAW),this.indexBuffer=e.createBuffer(),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.indexBuffer),e.bufferData(e.ELEMENT_ARRAY_BUFFER,this.indices,e.STATIC_DRAW)}uploadBuffers(){let{gl:e}=this;e.bindBuffer(e.ARRAY_BUFFER,this.vertexBuffer),e.bufferSubData(e.ARRAY_BUFFER,0,this.vertices),e.bufferSubData(e.ARRAY_BUFFER,8*4,this.uvs),e.bufferSubData(e.ARRAY_BUFFER,(8+8)*4,this.colors)}cleanBuffer(){let{gl:e}=this;e.deleteBuffer(this.vertexBuffer),e.deleteBuffer(this.indexBuffer)}}});var $t,Qs=_(()=>{Re();rs();$t=class{constructor(e,t,i,r,s=!1){this._renderer=e,this._gl=e.getContext(),this._width=t,this._height=i,this._frame=null,this._pixelRatio=r,this._projectionMatrix=new it,this._mipMapping=!1,this._baseTexture=new ve;let n=this._baseTexture.getFrame();n.width=t,n.height=i,this._baseTexture.setPixelRatio(r),this._baseTexture.setLoaded(!0),this._framebuffer=null,this._isRoot=s,this._filterStack=[{renderTarget:this,filters:[]}],s||this._initFrameBuffer()}resizeTo(e){this._width=e.x|0,this._height=e.y|0,this._baseTexture.resizeTo(e),this._isRoot||this._resizeTexture(),this._baseTexture.setMinFilter(this._getMinFilter()),this._baseTexture.setMagFilter(this._getMagFilter()),this._calculateProjectionMatrix()}_getMinFilter(){let e=ve.DefaultMinFilter;return this._mipMapping&&(e=ve.TrilinearFilter),e}_getMagFilter(){return ve.DefaultMagFilter}_resizeTexture(){let e=this._gl,t=this._width*this._pixelRatio,i=this._height*this._pixelRatio;this._texture&&(e.deleteTexture(this._texture),this._texture=null),this._texture=e.createTexture(),e.bindTexture(e.TEXTURE_2D,this._texture),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,t,i,0,e.RGBA,e.UNSIGNED_BYTE,null),e.bindFramebuffer(e.FRAMEBUFFER,this._framebuffer),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,this._texture,0),this._texture&&this._baseTexture.setGLTextureForRenderer(this._texture,this._renderer),this._renderer._options.debug&&Gi.checkFramebufferStatus("WebGLRenderTarget#_initFramebuffer",e);let r=new A(this._width,this._height);k.isPowerOfTwo(r)?(I.info("WebGLRenderTarget","Mip-mapping enabled"),this._mipMapping=!0):this._mipMapping=!1,this._baseTexture.setMipMappingEnabled(this._mipMapping)}activate(){let e=this._gl;e.bindFramebuffer(e.FRAMEBUFFER,this._framebuffer),this._calculateProjectionMatrix(),e.viewport(0,0,this._width*this._pixelRatio,this._height*this._pixelRatio),e.disable(e.STENCIL_TEST)}clear(e=S.TRANSPARENT){let t=this._gl;t.bindFramebuffer(t.FRAMEBUFFER,this._framebuffer),this._renderer._options.debug&&Gi.checkFramebufferStatus("WebGLRenderTarget#clear",t),t.clearColor.apply(t,e.toGLColor()),t.clear(t.COLOR_BUFFER_BIT)}_calculateProjectionMatrix(){let e=this._projectionMatrix;e.reset();let t=this._frame||new ue(0,0,this._width,this._height),{x:i,y:r}=t;this._isRoot?(e.a=1/this._width*2,e.d=-1/this._height*2,e.tx=-1-i*e.a,e.ty=1-r*e.d):(e.a=1/this._width*2,e.d=1/this._height*2,e.tx=-1-i*e.a,e.ty=-1-r*e.d)}_initFrameBuffer(){let e=this._gl;this._framebuffer&&(e.deleteFramebuffer(this._framebuffer),this._framebuffer=null),this._texture&&(e.deleteTexture(this._texture),this._texture=null),this._framebuffer=e.createFramebuffer(),this._texture=e.createTexture(),e.bindTexture(e.TEXTURE_2D,this._texture),e.bindFramebuffer(e.FRAMEBUFFER,this._framebuffer),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,this._texture,0),this._texture&&this._baseTexture.setGLTextureForRenderer(this._texture,this._renderer),this.resizeTo(new A(this._width,this._height)),this._renderer._options.debug&&Gi.checkFramebufferStatus("WebGLRenderTarget#_initFramebuffer",e)}getProjectionMatrix(){return this._projectionMatrix}getTexture(){return this._texture}getFrame(){return this._frame}setFrame(e){this._frame=e}getFilterStack(){return this._filterStack}getPixelRatio(){return this._pixelRatio}setPixelRatio(e){this._pixelRatio=e,this._isRoot||this._resizeTexture()}getBaseTexture(){return this._baseTexture}dispose(){let e=this._gl;this._baseTexture.dispose(),this._framebuffer&&(e.deleteFramebuffer(this._framebuffer),this._framebuffer=null),this._texture&&(e.deleteTexture(this._texture),this._texture=null)}}});var $s,Fl=_(()=>{Rl();Re();Nd();Bt();Qs();$s=class{constructor(e){this._renderer=e,this._filterStack=[],this._currentFrame=null,this._renderTargets=[],this._textureFrame=new ue(0,0,e.getWidth(),e.getHeight()),this._onContextChange=this._onContextChange.bind(this),this._renderer.on("context",this._onContextChange),this._onContextChange()}resizeTo(e){this._textureFrame.width=e.x,this._textureFrame.height=e.y,this._renderTargets.forEach(t=>t.resizeTo(e))}getFilterStack(){return this._filterStack}setFilterStack(e){this._filterStack=e}_getOrCreateRenderTarget(e=!1){let t=this._renderTargets.pop();return t||(t=new $t(this._renderer,this._textureFrame.width,this._textureFrame.height,1)),this._currentFrame&&t.setFrame(this._currentFrame),e&&t.clear(),t}pushFilters(e,t){let i=e.getBounds();this._currentFrame=i;let r=e.getFilterRectangle();r.width>0&&r.height>0&&(this._currentFrame=r);let s=this._getOrCreateRenderTarget();this._renderer.setRenderTarget(s),t[0]instanceof ts?s.clear(this._renderer.getClearColor()):s.clear(),this._filterStack.push({renderTarget:s,filters:t})}popFilters(){let e=this._filterStack.pop();if(!e)return;let{filters:t,renderTarget:i}=e,r=this._filterStack[this._filterStack.length-1],s=i,n=r.renderTarget,a=s.getFrame();a&&this._quad.map(this._textureFrame,a);let l=t[0].getShaderForRenderer(this._renderer),h=this._quad.getVertexBuffer(),c=this._quad.getIndexBuffer(),m=this._renderer.getContext();m.bindBuffer(m.ARRAY_BUFFER,h),m.bindBuffer(m.ELEMENT_ARRAY_BUFFER,c);let d=l.getAttributeLocations();return m.vertexAttribPointer(d.a_position,2,m.FLOAT,!1,0,0),m.vertexAttribPointer(d.a_texCoord,2,m.FLOAT,!1,0,2*4*4),m.vertexAttribPointer(d.a_color,4,m.FLOAT,!1,0,4*4*4),this._renderer.updateTexture(s.getBaseTexture(),!1),t.length===1?(t[0].apply(this._renderer,s,n),this._renderTargets.push(s)):this._applyFilters(t,s,n),t}_applyFilters(e,t,i){let r=t,s=this._getOrCreateRenderTarget(!0);this._renderer.updateTexture(s.getBaseTexture(),!1);let n=e[e.length-1];e.forEach(a=>{if(a===n)a.apply(this._renderer,r,i,!0);else{a.apply(this._renderer,r,s,!0);let h=r;r=s,s=h}}),this._renderTargets.push(r),this._renderTargets.push(s)}_onContextChange(){this._renderTargets.length=0,Wr(this._renderer)&&(this._quad&&this._quad.dispose(),this._quad=new Ol(this._renderer.getContext()))}dispose(){this._renderer.off("context",this._onContextChange),this._quad&&this._quad.dispose(),this._renderTargets.forEach(e=>{e.dispose()})}}});var pi,tn,Ud=_(()=>{pi=Ws(require("stats.js")),tn=class{constructor(e){this._context=e,this._domAvailable=typeof document!="undefined",this._hookIntoContext(),this._textures={},this._framebuffers={},this._programs={},this._shaders={},this._buffers={},this._boundTexture=null,this._id=0,this._enums={},this._setupStats(),this._createEnumMap(),this._updateMemoryStats=this._updateMemoryStats.bind(this),this._updateMemoryStats()}_createEnumMap(){for(let e in this._context){let t=this._context[e];typeof t=="number"&&(this._enums[t]=e)}}_enumValueToString(e){let t=this._enums[e];return typeof t=="undefined"?e:t}_setupStats(){!this._domAvailable||(this._stats=new pi.default,this._stats.showPanel(3),this._memPanel=this._stats.addPanel(new pi.default.Panel("MB [WebGL]","#43ADEB","#282828")),this._texPanel=this._stats.addPanel(new pi.default.Panel("Textures","#43ADEB","#282828")),this._bufPanel=this._stats.addPanel(new pi.default.Panel("Buffers","#43ADEB","#282828")),this._fboPanel=this._stats.addPanel(new pi.default.Panel("FBOs","#43ADEB","#282828")),this._prgPanel=this._stats.addPanel(new pi.default.Panel("Programs","#43ADEB","#282828")),this._shdPanel=this._stats.addPanel(new pi.default.Panel("Shaders","#43ADEB","#282828")))}_updatePanel(e){if(!!this._domAvailable){switch(this._stats.begin(),e){case"tex":this._texPanel.update(this.getTexturesCount(),50);break;case"buf":this._bufPanel.update(this.getBuffersCount(),50);break;case"fbo":this._fboPanel.update(this.getFBOCount(),50);break;case"prg":this._prgPanel.update(this.getProgramCount(),50);break;case"shd":this._shdPanel.update(this.getShaderCount(),50);break}this._stats.end()}}getTexturesCount(){return Object.keys(this._textures).length}getBuffersCount(){return Object.keys(this._buffers).length}getFBOCount(){return Object.keys(this._framebuffers).length}getProgramCount(){return Object.keys(this._programs).length}getShaderCount(){return Object.keys(this._shaders).length}_updateMemoryStats(){if(!this._domAvailable)return;let e=this._getMemoryUsage()/1e3/1e3;this._memPanel.update(e,400),setTimeout(this._updateMemoryStats,1e3)}_getMemoryUsage(){let e=0;for(let t in this._textures)e+=this._textures[t].memory;for(let t in this._buffers)e+=this._buffers[t].memory;return e}_hookIntoContext(){for(let e in this._context)typeof this._context[e]=="function"?this[e]=function(...i){let r=this._context[e];return this._trackGLCall(r,e,i)}:this._makePropertyWrapper(e)}_makePropertyWrapper(e){if(["_context"].indexOf(e)!==-1)return;let i=this._context;this.__defineGetter__(e,()=>i[e]),this.__defineSetter__(e,r=>{i[e]=r})}_trackGLCall(e,t,i){let r=["texImage2D","bindTexture","createTexture","deleteTexture","createBuffer","bindBuffer","bufferData","deleteBuffer","createFramebuffer","deleteFramebuffer","createProgram","deleteProgram","createShader","deleteShader"],s;r.indexOf(t)!==-1?s=this[`_${t}`](i):s=e.apply(this._context,i);let n=this._context.getError();if(n!==0){let a=i.join(", ");a.length>100&&(a=`${a.substr(0,100)}...`),console.error(new Error(`WebGL Error ${this._enumValueToString(n)} in ${t}(${a})`))}return s}_createProgram(){let e=this._context.createProgram();return e._wmmId=this._id++,this._programs[e._wmmId]=e,this._updatePanel("prg"),e}_deleteProgram([e]){!e||!this._programs[e._wmmId]||(delete this._programs[e._wmmId],this._context.deleteProgram(e),this._updatePanel("prg"))}_createShader([e]){let t=this._context.createShader(e);return t._wmmId=this._id++,this._shaders[t._wmmId]=t,this._updatePanel("shd"),t}_deleteShader([e]){!e||!this._shaders[e._wmmId]||(delete this._shaders[e._wmmId],this._context.deleteShader(e),this._updatePanel("shd"))}_createFramebuffer(){let e=this._context.createFramebuffer();return e._wmmId=this._id++,this._framebuffers[e._wmmId]=e,this._updatePanel("fbo"),e}_deleteFramebuffer([e]){!e||!this._framebuffers[e._wmmId]||(delete this._framebuffers[e._wmmId],this._context.deleteFramebuffer(e),this._updatePanel("fbo"))}_createBuffer(){let e=this._context.createBuffer();return e._wmmId=this._id++,this._buffers[e._wmmId]={buffer:e,memory:0},this._updatePanel("buf"),e}_bindBuffer([e,t]){this._context.bindBuffer(e,t),this._boundBuffer=t._wmmId}_bufferData([e,t,i]){this._context.bufferData(e,t,i);let r;typeof t=="number"?r=t:"byteLength"in t?r=t.byteLength:"length"in t&&(r=t.length),this._buffers[this._boundBuffer].memory=r}_deleteBuffer([e]){!e||!this._buffers[e._wmmId]||(delete this._buffers[e._wmmId],this._context.deleteBuffer(e),this._updatePanel("buf"))}_createTexture(){let e=this._context.createTexture();return e._wmmId=this._id++,this._textures[e._wmmId]={texture:e,memory:0},this._updatePanel("tex"),e}_deleteTexture([e]){!e||!this._textures[e._wmmId]||(delete this._textures[e._wmmId],this._context.deleteTexture(e),this._updatePanel("tex"))}_bindTexture([e,t]){this._context.bindTexture(e,t),this._boundTexture=t._wmmId}_texImage2D(e){let[,,t,i,r,s,,,n]=e;typeof n=="undefined"&&(n=s),this._context.texImage2D.apply(this._context,e);let a=this._calculateByteCountForTexture(t,i,r,n);this._textures[this._boundTexture].memory=a}_calculateByteCountForTexture(e,t,i,r){if(r!==null)if("width"in r)t=r.width,i=r.height;else return r.length;let s=1;switch(e){case this._context.ALPHA:s=1;break;case this._context.RGB:s=3;break;case this._context.RGBA:s=4;break}return t*i*s}}});var eo,El=_(()=>{eo=class{constructor(e){this._renderer=e,this._onContextChange=this._onContextChange.bind(this),this._renderer.on("context",this._onContextChange)}_onContextChange(){}start(){}stop(){this.flush()}flush(){}dispose(){this._renderer.off("context",this._onContextChange),delete this._renderer}}});var Il,Gd=_(()=>{Re();El();Il=class extends eo{constructor(e){super(e);this._vertexBuffer=null;this._indexBuffer=null;this._maxBatchSize=Zr,this._vertices=new ArrayBuffer(Zr*4*mi),this._positions=new Float32Array(this._vertices),this._colors=new Uint32Array(this._vertices),this._indices=new Uint16Array(Zr*6);for(let t=0,i=0;t<Zr*6;t+=6,i+=4)this._indices[t+0]=i+0,this._indices[t+1]=i+1,this._indices[t+2]=i+2,this._indices[t+3]=i+0,this._indices[t+4]=i+2,this._indices[t+5]=i+3;this._sprites=[],this._currentBatchSize=0,this._onContextChange()}render(e){let t=e.getTexture();if(!t)return;let i=t.getFrame(),r=t.getBaseTexture();this._currentBatchSize>=this._maxBatchSize&&this.flush();let s=t.getUVs();if(!s)return;let n=this._currentBatchSize*mi;this._addVertexCoordinates(e,n,i),this._addTextureUVs(e,n,s),this._addColors(e,n),this._sprites[this._currentBatchSize]=e,this._currentBatchSize++}_addColors(e,t){let i=this._colors,r=16777215,s=(r>>16)+(r&65280)+((r&255)<<16)+(e.getWorldAlpha()*255<<24);i[t+4]=i[t+9]=i[t+14]=i[t+19]=s}_addTextureUVs(e,t,i){let r=this._positions,[s,n,a,l]=i;r[t+2]=s.x,r[t+3]=s.y,r[t+7]=n.x,r[t+8]=n.y,r[t+12]=a.x,r[t+13]=a.y,r[t+17]=l.x,r[t+18]=l.y}_addVertexCoordinates(e,t,i){let r=this._positions,s=e.getWorldTransform(),n=e.getAnchor(),a=s.rectangleToCoordinates(i,n),l=5;for(let h=0;h<4;h++)r[t+h*l]=a[h].x,r[t+h*l+1]=a[h].y}_onContextChange(){let e=this._renderer.getContext();this._shader=this._renderer.shaders.default,this._vertexBuffer&&(this._vertexBuffer=null),this._indexBuffer&&(this._indexBuffer=null),this._vertexBuffer=e.createBuffer(),this._indexBuffer=e.createBuffer(),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this._indexBuffer),e.bufferData(e.ELEMENT_ARRAY_BUFFER,this._indices,e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,this._vertexBuffer),e.bufferData(e.ARRAY_BUFFER,this._vertices,e.DYNAMIC_DRAW)}start(){this._vertexBuffer&&this._indexBuffer&&this._shader.setupBuffers(this._vertexBuffer,this._indexBuffer)}flush(){var d;let e=this._renderer,t=e.getContext();if(this._currentBatchSize===0)return;if(this._currentBatchSize>Zr*.5)t.bufferSubData(t.ARRAY_BUFFER,0,this._vertices);else{let u=this._positions.subarray(0,this._currentBatchSize*mi);t.bufferSubData(t.ARRAY_BUFFER,0,u)}let i=0,r=null,s=null,n=null,a=null,l=!1,h=!1,c=null,m=0;for(let u=0,f=this._currentBatchSize;u<f;u++){if(c=this._sprites[u],s=(d=c.getTexture())==null?void 0:d.getBaseTexture(),a=c.getShader()||this._shader,l=n!==a,h=r!==s,(h||l)&&(r&&this._renderBatch(r,i,m),m=u,i=0,r=s,l)){n=a,e.setShader(n);let g=e.getCurrentRenderTarget().getProjectionMatrix().toArray();n.setUniform("u_projMatrix",g),n.syncUniforms(),t.activeTexture(t.TEXTURE0)}i++}r&&this._renderBatch(r,i,m),this._currentBatchSize=0,this._sprites=[]}_renderBatch(e,t,i){if(t===0)return;let r=this._renderer,s=r.getContext(),n=e.getGLTextureForRenderer(r);n||(n=r.getOrCreateGLTexture(e)),e.isDirty()&&(r.updateTexture(e),e.setDirty(!1)),s.activeTexture(s.TEXTURE0+e.getGLUnit()),s.bindTexture(s.TEXTURE_2D,n);let a=t*6,l=i*6*2;s.drawElements(s.TRIANGLES,a,s.UNSIGNED_SHORT,l)}dispose(){let t=this._renderer.getContext();this._sprites.forEach(i=>{i.dispose()}),this._vertexBuffer&&(t.deleteBuffer(this._vertexBuffer),this._vertexBuffer=null),this._indexBuffer&&(t.deleteBuffer(this._indexBuffer),this._indexBuffer=null),delete this._vertices,delete this._positions,delete this._colors,delete this._indices,super.dispose()}}});var Ml,rn,Wd=_(()=>{zd();Kt();ct();Jo();Re();Fl();xl();Cl();Bt();Qs();Ud();kl();El();Gd();Ml=class extends Zs{constructor(e=800,t=600,i){super(e,t,i);this.type="webgl";this.maxTextureDimensions=null;this._type="webgl",this._onContextLost=this._onContextLost.bind(this),this._onContextRestored=this._onContextRestored.bind(this),this.setCanvas(this._options.canvas||Ie.createCanvas()),this.shaders={default:new yl(this,void 0,void 0)},this.renderers={sprite:new Il(this)}}_onContextLost(e){e.preventDefault(),I.warn(this.constructor.name,"WebGL context has been lost - trying to restore."),this.emit("context-lost")}_onContextCreationError(e){e.preventDefault(),I.warn(this.constructor.name,`Failed to create WebGL context: ${e.statusMessage||"Unknown error"}`)}_onContextRestored(){I.warn(this.constructor.name,"WebGL context has been restored. Clearing all textures."),this._createContext(),this._setupContext(),this.emit("context-restored")}_onBeforeContext(){this._filterManager&&this._filterManager.dispose(),this._filterManager=new $s(this),this._currentObjectRenderer=new eo(this)}setShader(e){this._currentShader=e,this._context.useProgram(e.getProgram()),this._setAttributesForShader(e)}setCanvas(e){this._canvas&&this._removeContextEventListeners(),super.setCanvas(e),this._addContextEventListeners()}_addContextEventListeners(){tl(this._canvas)&&(this._canvas.addEventListener("webglcontextlost",this._onContextLost),this._canvas.addEventListener("webglcontextrestored",this._onContextRestored),this._canvas.addEventListener("webglcontextcreationerror",this._onContextCreationError))}_removeContextEventListeners(){tl(this._canvas)&&(this._canvas.removeEventListener("webglcontextlost",this._onContextLost),this._canvas.removeEventListener("webglcontextrestored",this._onContextRestored),this._canvas.removeEventListener("webglcontextcreationerror",this._onContextCreationError))}_setAttributesForShader(e){if(!this._canvas)return;let t=this._context,i=e.getAttributes(),r=e.getAttributeLocations();i.forEach(s=>{let n=r[s];t.enableVertexAttribArray(n)})}_createContext(){if(!this._canvas)return;let e=Ie.glGet(this._canvas);return this._options.debug&&Ld(e),this._options.debug&&(e=new en(e),e=new tn(e)),this.id=Ml.contextId++,this._context=e,this._maxTextureSize=e.getParameter(e.MAX_TEXTURE_SIZE),this.emit("context",e),e}_setupContext(){let e=this._context;e.disable(e.DEPTH_TEST),e.disable(e.CULL_FACE),e.enable(e.BLEND),e.blendFunc(e.ONE,e.ONE_MINUS_SRC_ALPHA),this._defaultRenderTarget=new $t(this,this._width,this._height,this._pixelRatio,!0),this.setRenderTarget(this._defaultRenderTarget),this._getMaxPrecision()}getContext(){return this._context}_getMaxPrecision(){let e=this._context,t=e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.HIGH_FLOAT);this._maxFloatPrecision=(t==null?void 0:t.precision)!==0?"highp":"mediump";let i=e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.HIGH_INT);this._maxIntPrecision=(i==null?void 0:i.rangeMax)!==0?"highp":"lowp"}resizeTo(e,t=!0){super.resizeTo(e,t),this._currentRenderTarget&&this._currentRenderTarget.resizeTo(e),this._context=Ie.glResize(this._context,e)}setRenderTarget(e=this._defaultRenderTarget){this._currentRenderTarget=e,this._currentRenderTarget.activate()}setObjectRenderer(e){this._currentObjectRenderer.stop(),this._currentObjectRenderer=e,this._currentObjectRenderer.start()}render(e){this.setRenderTarget(this._defaultRenderTarget),this._defaultRenderTarget.clear(this._clearColor);let t=e.getParent();e.setParent(new Vi),e.updateTransform(),t&&e.setParent(t),this.renderDisplayObject(e,this._defaultRenderTarget)}renderDisplayObject(e,t){this.setRenderTarget(t),this._filterManager.setFilterStack(t.getFilterStack()),e.renderWebGL(this),this._currentObjectRenderer.flush()}clear(){let e=this._context;e.clearColor.apply(e,this._clearColor.toGLColor),e.clear(e.COLOR_BUFFER_BIT)}save(){return{renderTarget:this._currentRenderTarget,objectRenderer:this._currentObjectRenderer,filterStack:this._filterManager.getFilterStack()}}restore(e){this.setRenderTarget(e.renderTarget),this._filterManager.setFilterStack(e.filterStack),this._currentObjectRenderer=e.objectRenderer}getOrCreateGLTexture(e){let t=this._context,i=e.getGLTextureForRenderer(this);return i||(i=t.createTexture(),e.setGLTextureForRenderer(i,this)),i}updateTexture(e,t=!0){let i=e.getSource(),r=this._context,s=e.getGLUnit(),n=this.getOrCreateGLTexture(e);r.activeTexture(r.TEXTURE0+s),r.bindTexture(r.TEXTURE_2D,n),r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),t&&i&&Ie.glTexImage(r,i),e.isMipMappingEnabled()?r.generateMipmap(r.TEXTURE_2D):(r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,e.getGLRepeat(r,"x")),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,e.getGLRepeat(r,"y"))),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,e.getGLFilter(r,"min")),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,e.getGLFilter(r,"mag")),r.activeTexture(r.TEXTURE0)}getMaxDimensions(){return this.maxTextureDimensions||(this.maxTextureDimensions=Ie.glMaxTexture(this._context)),this.maxTextureDimensions}getCurrentRenderTarget(){return this._currentRenderTarget}getCurrentObjectRenderer(){return this._currentObjectRenderer}getMaxFloatPrecision(){return this._maxFloatPrecision}getMaxIntPrecision(){return this._maxIntPrecision}dispose(){this._canvas&&Ce(this._canvas),this._filterManager.dispose(),this._currentObjectRenderer.dispose(),this._defaultRenderTarget.dispose();for(let i in this.shaders)this.shaders[i].dispose(),delete this.shaders[i];this._removeContextEventListeners();let t=this._context.getExtension("WEBGL_lose_context");t&&t.loseContext()}},rn=Ml;rn.contextId=0});var wx,Tx,Bl,Vd=_(()=>{Jt();wx=()=>[new A(0,0),new A(1,0),new A(1,1),new A(0,1)],Tx=(o,e,t)=>{let[i,r,s,n]=o;return i.x=e.x/t.width,i.y=e.y/t.height,r.x=(e.x+e.width)/t.width,r.y=e.y/t.height,s.x=(e.x+e.width)/t.width,s.y=(e.y+e.height)/t.height,n.x=e.x/t.width,n.y=(e.y+e.height)/t.height,o},Bl={create:wx,updateViaFrames:Tx}});var _i,Dl=_(()=>{Vd();Re();rs();_i=class extends Ke{constructor(e,t){super();if(!(e instanceof ve))throw new Error("`baseTexture` should be an instance of BaseTexture");this._uvs=Bl.create(),this._frame=t?t.clone():new ue(0,0,1,1),this._frameLocked=Boolean(t),this._onBaseTextureLoaded=this._onBaseTextureLoaded.bind(this),this._onBaseTextureUpdated=this._onBaseTextureUpdated.bind(this),this.setBaseTexture(e)}static fromImage(e){let t=new ve(e);return new _i(t)}static fromCanvas(e){let t=new ve(e);return new _i(t)}_onBaseTextureLoaded(){if(!this._frameLocked){let e=this._baseTexture.getFrame().clone();this.setFrame(e)}this._baseTexture.on("update",this._onBaseTextureUpdated)}_onBaseTextureUpdated(){let{width:e,height:t}=this._baseTexture.getFrame();this._frame.width=e,this._frame.height=t,this.emit("update")}_updateUVs(){this._uvs=Bl.updateViaFrames(this._uvs,this._frame,this._baseTexture.getFrame())}getBaseTexture(){return this._baseTexture}setBaseTexture(e){if(this._baseTexture=e,!this._baseTexture.isLoaded())this._baseTexture.once("loaded",this._onBaseTextureLoaded);else{let{width:t,height:i}=e.getFrame();this._frameLocked||(this._frame=new ue(0,0,t,i)),this._onBaseTextureLoaded()}}getFrame(){return this._frame}setFrame(e){this._frame=e,this._updateUVs()}getWidth(){return this._frame.width}getHeight(){return this._frame.height}getUVs(){return this._uvs}getDimensions(){return new A(this._frame.width,this._frame.height)}dispose(e=!0){e&&this._baseTexture.dispose()}}});var to,io,Pl=_(()=>{ct();Re();$o();Fl();Ks();Qs();rs();Dl();to=o=>o._type==="webgl",io=class extends _i{constructor(e,t=100,i=100,r=1){super(new ve,new ue(0,0,t,i));this._loaded=!0,this._width=t,this._height=i,this._pixelRatio=r,this._renderer=e,this._setupFilterManager(),this._setupBuffer(),this.setBaseTexture(this._renderTarget.getBaseTexture()),this._updateUVs()}_setupFilterManager(){this._filterManager&&this._filterManager.dispose(),to(this._renderer)?this._filterManager=new $s(this._renderer):this._filterManager=new Hi(this._renderer),this._filterManager.resizeTo(new A(this._width,this._height))}_setupBuffer(){this._renderTarget&&this._renderTarget.dispose(),to(this._renderer)?this._renderTarget=new $t(this._renderer,this._width,this._height,this._pixelRatio):this._renderTarget=new Qt(this._width,this._height,this._pixelRatio)}clear(e){this._renderTarget.clear(e)}resizeTo(e){this._width===e.x&&this._height===e.y||(this._width=e.x,this._height=e.y,this._frame.width=e.x,this._frame.height=e.y,this._renderTarget.resizeTo(e),this._filterManager.resizeTo(e))}render(e){to(this._renderer)?this._renderWebGL(e):this._renderCanvas(e)}_renderWebGL(e){if(!to(this._renderer))return;this._renderTarget.activate(),e.getWorldTransform().reset(),e.getChildren().forEach(i=>{i.updateTransform()});let t=this._renderer.getFilterManager();this._renderer.setFilterManager(this._filterManager),this._renderer.renderDisplayObject(e,this._renderTarget),this._renderer.setFilterManager(t)}_renderCanvas(e){if(to(this._renderer))return;e.getWorldTransform().reset(),e.getChildren().forEach(i=>{i.updateTransform()});let t=this._renderer.getFilterManager();this._renderer.setFilterManager(this._filterManager),this._renderer.renderDisplayObject(e,this._renderTarget),this._renderer.setFilterManager(t)}getRenderTarget(){return this._renderTarget}dispose(){this._renderTarget.dispose(),this._filterManager.dispose(),super.dispose()}}});var ns,Lt,as=_(()=>{ns={EXPORT:"export",CLOSE:"close",OPERATION_CREATED:"operation:created",OPERATION_UPDATED:"operation:updated",OPERATION_REMOVED:"operation:removed",EDITOR_READY:"editor:ready",WINDOW_RESIZE:"window:resize",ZOOM_DONE:"editor:zoom_done",HISTORY_UNDO:"history:undo",HISTORY_UPDATED:"history:update",FEATURES_DISABLED:"editor:features:disabled",FEATURES_ENABLED:"editor:features:enabled",FEATURES_UPDATED:"editor:features:updated",TRANSFORM_REAPPLY_RATIO:"transform:reapply_ratio"},Lt={DEFAULTS:{FILTERS:[{identifier:"imgly_filters_duotone",defaultName:"DuoTone",assetFileName:"duotone",filters:[{identifier:"imgly_duotone_desert",defaultName:"Desert",lightColor:"#e1de9a",darkColor:"#cb2129"},{identifier:"imgly_duotone_peach",defaultName:"Peach",lightColor:"#e9abb8",darkColor:"#0040ff"},{identifier:"imgly_duotone_clash",defaultName:"Clash",lightColor:"#f41a0f",darkColor:"#23007c"},{identifier:"imgly_duotone_plum",defaultName:"Plum",lightColor:"#74d7ff",darkColor:"#23007c"},{identifier:"imgly_duotone_breezy",defaultName:"Breezy",lightColor:"#68fdff",darkColor:"#c20000"},{identifier:"imgly_duotone_deepblue",defaultName:"Deep Blue",lightColor:"#2de9eb",darkColor:"#58007c"},{identifier:"imgly_duotone_frog",defaultName:"Frog",lightColor:"#5bff60",darkColor:"#7f23a9"},{identifier:"imgly_duotone_sunset",defaultName:"Sunset",lightColor:"#f8ea46",darkColor:"#c400be"}]},{identifier:"imgly_filters_bw",assetFileName:"b&w",defaultName:"Black & White",filters:[{identifier:"imgly_lut_ad1920",defaultName:"1920 A.D.",lutImage:"filters/imgly_lut_ad1920_5_5_128.png"},{identifier:"imgly_lut_bw",defaultName:"Greyed",lutImage:"filters/imgly_lut_bw_5_5_128.png"},{identifier:"imgly_lut_x400",defaultName:"Dusty",lutImage:"filters/imgly_lut_dusty_5_5_128.png"},{identifier:"imgly_lut_litho",defaultName:"Litho",lutImage:"filters/imgly_lut_litho_5_5_128.png"},{identifier:"imgly_lut_sepiahigh",defaultName:"Sepia",lutImage:"filters/imgly_lut_sepia_5_5_128.png"},{identifier:"imgly_lut_plate",defaultName:"Weathered",lutImage:"filters/imgly_lut_weathered_5_5_128.png"},{identifier:"imgly_lut_sin",defaultName:"Hard Stuff",lutImage:"filters/imgly_lut_hard_stuff_8_8_512.png",resolution:512,horizontalTileCount:8,verticalTileCount:8}]},{identifier:"imgly_filters_retro",assetFileName:"vintage",defaultName:"Vintage",filters:[{identifier:"imgly_lut_blues",defaultName:"Polaroid",lutImage:"filters/imgly_lut_polaroid_5_5_128.png"},{identifier:"imgly_lut_front",defaultName:"Sunny 70s",lutImage:"filters/imgly_lut_sunny_70s_8_8_512.png",resolution:512,horizontalTileCount:8,verticalTileCount:8},{identifier:"imgly_lut_texas",defaultName:"Oldtimer",lutImage:"filters/imgly_lut_oldtimer_8_8_512.png",resolution:512,horizontalTileCount:8,verticalTileCount:8},{identifier:"imgly_lut_celsius",defaultName:"Inferno",lutImage:"filters/imgly_lut_inferno_8_8_512.png",resolution:512,horizontalTileCount:8,verticalTileCount:8},{identifier:"imgly_lut_cool",defaultName:"Snappy",lutImage:"filters/imgly_lut_snappy_5_5_128.png"}]},{identifier:"imgly_filters_analog",assetFileName:"smooth",defaultName:"Smooth",filters:[{identifier:"imgly_lut_chest",defaultName:"Chestnut",lutImage:"filters/imgly_lut_chestnut_8_8_512.png",resolution:512,horizontalTileCount:8,verticalTileCount:8},{identifier:"imgly_lut_winter",defaultName:"Softly",lutImage:"filters/imgly_lut_softly_5_5_128.png"},{identifier:"imgly_lut_kdynamic",defaultName:"Pebble",lutImage:"filters/imgly_lut_pebble_5_5_128.png"},{identifier:"imgly_lut_fall",defaultName:"Moss",lutImage:"filters/imgly_lut_moss_5_5_128.png"},{identifier:"imgly_lut_lenin",defaultName:"Lemon",lutImage:"filters/imgly_lut_lemon_5_5_128.png"},{identifier:"imgly_lut_pola669",defaultName:"Green Gap",lutImage:"filters/imgly_lut_green_gap_5_5_128.png"}]},{identifier:"imgly_filters_winter",assetFileName:"cold",defaultName:"Cold",filters:[{identifier:"imgly_lut_elder",defaultName:"Colla",lutImage:"filters/imgly_lut_colla_5_5_128.png"},{identifier:"imgly_lut_orchid",defaultName:"Solanus",lutImage:"filters/imgly_lut_solanus_5_5_128.png"},{identifier:"imgly_lut_bleached",defaultName:"Kalmen",lutImage:"filters/imgly_lut_kalmen_5_5_128.png"},{identifier:"imgly_lut_bleachedblue",defaultName:"Joran",lutImage:"filters/imgly_lut_joran_5_5_128.png"},{identifier:"imgly_lut_breeze",defaultName:"Levante",lutImage:"filters/imgly_lut_levante_5_5_128.png"},{identifier:"imgly_lut_blueshadows",defaultName:"Zephyr",lutImage:"filters/imgly_lut_zephyr_5_5_128.png"}]},{identifier:"imgly_filters_summer",assetFileName:"warm",defaultName:"Warm",filters:[{identifier:"imgly_lut_sunset",defaultName:"Golden",lutImage:"filters/imgly_lut_golden_5_5_128.png"},{identifier:"imgly_lut_eighties",defaultName:"Low Fire",lutImage:"filters/imgly_lut_low_fire_5_5_128.png"},{identifier:"imgly_lut_evening",defaultName:"Sunrise",lutImage:"filters/imgly_lut_sunrise_5_5_128.png"},{identifier:"imgly_lut_k2",defaultName:"Flat Black",lutImage:"filters/imgly_lut_flat_black_8_8_512.png",resolution:512,horizontalTileCount:8,verticalTileCount:8},{identifier:"imgly_lut_nogreen",defaultName:"Pumpkin",lutImage:"filters/imgly_lut_pumpkin_5_5_128.png"}]},{identifier:"imgly_filters_legacy",defaultName:"Legacy",assetFileName:"legacy",filters:[{identifier:"imgly_lut_ancient",defaultName:"Ancient",lutImage:"filters/imgly_lut_ancient_5_5_128.png"},{identifier:"imgly_lut_cottoncandy",defaultName:"Candy",lutImage:"filters/imgly_lut_cottoncandy_5_5_128.png"},{identifier:"imgly_lut_classic",defaultName:"Classic",lutImage:"filters/imgly_lut_classic_5_5_128.png"},{identifier:"imgly_lut_colorful",defaultName:"Colorful",lutImage:"filters/imgly_lut_colorful_5_5_128.png"},{identifier:"imgly_lut_creamy",defaultName:"Creamy",lutImage:"filters/imgly_lut_creamy_5_5_128.png"},{identifier:"imgly_lut_fixie",defaultName:"Fixie",lutImage:"filters/imgly_lut_fixie_8_8_512.png",resolution:512,horizontalTileCount:8,verticalTileCount:8},{identifier:"imgly_lut_food",defaultName:"Food",lutImage:"filters/imgly_lut_food_5_5_128.png"},{identifier:"imgly_lut_fridge",defaultName:"Fridge",lutImage:"filters/imgly_lut_fridge_8_8_512.png",resolution:512,horizontalTileCount:8,verticalTileCount:8},{identifier:"imgly_lut_glam",defaultName:"Glam",lutImage:"filters/imgly_lut_glam_5_5_128.png"},{identifier:"imgly_lut_gobblin",defaultName:"Gobblin",lutImage:"filters/imgly_lut_gobblin_5_5_128.png"},{identifier:"imgly_lut_highcontrast",defaultName:"Hicon",lutImage:"filters/imgly_lut_highcontrast_5_5_128.png"},{identifier:"imgly_lut_highcarb",defaultName:"High Carb",lutImage:"filters/imgly_lut_highcarb_5_5_128.png"},{identifier:"imgly_lut_k1",defaultName:"K1",lutImage:"filters/imgly_lut_k1_5_5_128.png"},{identifier:"imgly_lut_k6",defaultName:"K6",lutImage:"filters/imgly_lut_k6_5_5_128.png"},{identifier:"imgly_lut_keen",defaultName:"Keen",lutImage:"filters/imgly_lut_keen_5_5_128.png"},{identifier:"imgly_lut_lomo",defaultName:"Lomo",lutImage:"filters/imgly_lut_lomo_8_8_512.png",resolution:512,horizontalTileCount:8,verticalTileCount:8},{identifier:"imgly_lut_lomo100",defaultName:"Lomo 100",lutImage:"filters/imgly_lut_lomo100_5_5_128.png"},{identifier:"imgly_lut_lucid",defaultName:"Lucid",lutImage:"filters/imgly_lut_lucid_5_5_128.png"},{identifier:"imgly_lut_mellow",defaultName:"Mellow",lutImage:"filters/imgly_lut_mellow_8_8_512.png",resolution:512,horizontalTileCount:8,verticalTileCount:8},{identifier:"imgly_lut_neat",defaultName:"Neat",lutImage:"filters/imgly_lut_neat_5_5_128.png"},{identifier:"imgly_lut_pale",defaultName:"Pale",lutImage:"filters/imgly_lut_pale_5_5_128.png"},{identifier:"imgly_lut_pitched",defaultName:"Pitched",lutImage:"filters/imgly_lut_pitched_5_5_128.png"},{identifier:"imgly_lut_polasx",defaultName:"Pola SX",lutImage:"filters/imgly_lut_polasx_5_5_128.png"},{identifier:"imgly_lut_pro400",defaultName:"Pro 400",lutImage:"filters/imgly_lut_pro400_5_5_128.png"},{identifier:"imgly_lut_quozi",defaultName:"Quozi",lutImage:"filters/imgly_lut_quozi_5_5_128.png"},{identifier:"imgly_lut_settled",defaultName:"Settled",lutImage:"filters/imgly_lut_settled_5_5_128.png"},{identifier:"imgly_lut_seventies",defaultName:"Seventies",lutImage:"filters/imgly_lut_seventies_5_5_128.png"},{identifier:"imgly_lut_soft",defaultName:"Soft",lutImage:"filters/imgly_lut_soft_5_5_128.png"},{identifier:"imgly_lut_steel",defaultName:"Steel",lutImage:"filters/imgly_lut_steel_5_5_128.png"},{identifier:"imgly_lut_summer",defaultName:"Summer",lutImage:"filters/imgly_lut_summer_5_5_128.png"},{identifier:"imgly_lut_tender",defaultName:"Tender",lutImage:"filters/imgly_lut_tender_5_5_128.png"},{identifier:"imgly_lut_twilight",defaultName:"Twilight",lutImage:"filters/imgly_lut_twilight_5_5_128.png"}]}],OVERLAYS:[{identifier:"imgly_overlay_golden",defaultName:"Golden",image:"overlays/imgly_overlay_golden.jpg",thumbnail:"overlays/imgly_overlay_golden_thumb.jpg",blendMode:"lighten"},{identifier:"imgly_overlay_bokeh",defaultName:"Bokeh",image:"overlays/imgly_overlay_bokeh.jpg",thumbnail:"overlays/imgly_overlay_bokeh_thumb.jpg",blendMode:"lighten"},{identifier:"imgly_overlay_hearts",defaultName:"Hearts",image:"overlays/imgly_overlay_hearts.jpg",thumbnail:"overlays/imgly_overlay_hearts_thumb.jpg",blendMode:"screen"},{identifier:"imgly_overlay_lightleak1",defaultName:"Light Leak",image:"overlays/imgly_overlay_lightleak1.jpg",thumbnail:"overlays/imgly_overlay_lightleak1_thumb.jpg",blendMode:"screen"},{identifier:"imgly_overlay_lightleak2",defaultName:"Light Leak 2",image:"overlays/imgly_overlay_lightleak2.jpg",thumbnail:"overlays/imgly_overlay_lightleak2_thumb.jpg",blendMode:"lighten"},{identifier:"imgly_overlay_rain",defaultName:"Rain",image:"overlays/imgly_overlay_rain.jpg",thumbnail:"overlays/imgly_overlay_rain_thumb.jpg",blendMode:"overlay"},{identifier:"imgly_overlay_wood",defaultName:"Wood",image:"overlays/imgly_overlay_wood.jpg",thumbnail:"overlays/imgly_overlay_wood_thumb.jpg",blendMode:"multiply"},{identifier:"imgly_overlay_mosaic",defaultName:"Mosaic",image:"overlays/imgly_overlay_mosaic.jpg",thumbnail:"overlays/imgly_overlay_mosaic_thumb.jpg",blendMode:"multiply"},{identifier:"imgly_overlay_chop",defaultName:"Chop",image:"overlays/imgly_overlay_chop.jpg",thumbnail:"overlays/imgly_overlay_chop_thumb.jpg",blendMode:"multiply"},{identifier:"imgly_overlay_vintage",defaultName:"Vintage",image:"overlays/imgly_overlay_vintage.jpg",thumbnail:"overlays/imgly_overlay_vintage_thumb.jpg",blendMode:"darken"},{identifier:"imgly_overlay_metal",defaultName:"Metal",image:"overlays/imgly_overlay_metal.jpg",thumbnail:"overlays/imgly_overlay_metal_thumb.jpg",blendMode:"overlay"},{identifier:"imgly_overlay_paper",defaultName:"Paper",image:"overlays/imgly_overlay_paper.jpg",thumbnail:"overlays/imgly_overlay_paper_thumb.jpg",blendMode:"multiply"},{identifier:"imgly_overlay_painting",defaultName:"Painting",image:"overlays/imgly_overlay_painting.jpg",thumbnail:"overlays/imgly_overlay_painting_thumb.jpg",blendMode:"overlay"},{identifier:"imgly_overlay_grain",defaultName:"Grain",image:"overlays/imgly_overlay_grain.jpg",thumbnail:"overlays/imgly_overlay_grain_thumb.jpg",blendMode:"overlay"},{identifier:"imgly_overlay_clouds",defaultName:"Clouds",image:"overlays/imgly_overlay_clouds.jpg",thumbnail:"overlays/imgly_overlay_clouds_thumb.jpg",blendMode:"softLight"},{identifier:"imgly_overlay_wall1",defaultName:"Wall",image:"overlays/imgly_overlay_wall1.jpg",thumbnail:"overlays/imgly_overlay_wall1_thumb.jpg",blendMode:"lighten"},{identifier:"imgly_overlay_wall2",defaultName:"Wall 2",image:"overlays/imgly_overlay_wall2.jpg",thumbnail:"overlays/imgly_overlay_wall2_thumb.jpg",blendMode:"overlay"}],FRAME_CATEGORIES:[{identifier:"imgly_frame_generic",defaultName:"Generic",metaData:{backgroundImage:"frames/generic.png"},frames:[{identifier:"imgly_frame_dia",defaultName:"Dia",layoutMode:"horizontal-inside",thumbnail:"frames/imgly_frame_dia/imgly_frame_dia_thumb.png",imageGroups:{top:{mid:{image:"frames/imgly_frame_dia/imgly_frame_dia_top.png",mode:"repeat"}},left:{start:"frames/imgly_frame_dia/imgly_frame_dia_top_corner_left.png",mid:"frames/imgly_frame_dia/imgly_frame_dia_left.png",end:"frames/imgly_frame_dia/imgly_frame_dia_bottom_corner_left.png"},right:{start:"frames/imgly_frame_dia/imgly_frame_dia_top_corner_right.png",mid:"frames/imgly_frame_dia/imgly_frame_dia_right.png",end:"frames/imgly_frame_dia/imgly_frame_dia_bottom_corner_right.png"},bottom:{mid:{image:"frames/imgly_frame_dia/imgly_frame_dia_bottom.png",mode:"repeat"}}}},{identifier:"imgly_frame_art_decor",defaultName:"Art Decor",tintable:!0,layoutMode:"horizontal-inside",thumbnail:"frames/imgly_frame_art_decor/imgly_frame_art_decor_thumb.png",imageGroups:{top:{start:"frames/imgly_frame_art_decor/imgly_frame_art_decor_top_corner_left.png",mid:{image:"frames/imgly_frame_art_decor/imgly_frame_art_decor_top.png",mode:"stretch"},end:"frames/imgly_frame_art_decor/imgly_frame_art_decor_top_corner_right.png"},left:{mid:{image:"frames/imgly_frame_art_decor/imgly_frame_art_decor_left.png",mode:"stretch"}},right:{mid:{image:"frames/imgly_frame_art_decor/imgly_frame_art_decor_right.png",mode:"stretch"}},bottom:{start:"frames/imgly_frame_art_decor/imgly_frame_art_decor_bottom_corner_left.png",mid:{image:"frames/imgly_frame_art_decor/imgly_frame_art_decor_bottom.png",mode:"stretch"},end:"frames/imgly_frame_art_decor/imgly_frame_art_decor_bottom_corner_right.png"}}},{identifier:"imgly_frame_black_passepartout",defaultName:"Black Passepartout",layoutMode:"horizontal-inside",thumbnail:"frames/imgly_frame_black_passepartout/imgly_frame_black_passepartout_thumb.png",imageGroups:{top:{start:"frames/imgly_frame_black_passepartout/imgly_frame_black_passepartout_top_corner_left.png",mid:{image:"frames/imgly_frame_black_passepartout/imgly_frame_black_passepartout_top.png",mode:"stretch"},end:"frames/imgly_frame_black_passepartout/imgly_frame_black_passepartout_top_corner_right.png"},left:{mid:{image:"frames/imgly_frame_black_passepartout/imgly_frame_black_passepartout_left.png",mode:"stretch"}},right:{mid:{image:"frames/imgly_frame_black_passepartout/imgly_frame_black_passepartout_right.png",mode:"stretch"}},bottom:{start:"frames/imgly_frame_black_passepartout/imgly_frame_black_passepartout_bottom_corner_left.png",mid:{image:"frames/imgly_frame_black_passepartout/imgly_frame_black_passepartout_bottom.png",mode:"stretch"},end:"frames/imgly_frame_black_passepartout/imgly_frame_black_passepartout_bottom_corner_right.png"}}},{identifier:"imgly_frame_lowpoly_shadow",defaultName:"Low Poly",layoutMode:"horizontal-inside",thumbnail:"frames/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_thumb.png",imageGroups:{top:{start:"frames/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_top_corner_left.png",mid:{image:"frames/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_top.png",mode:"stretch"},end:"frames/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_top_corner_right.png"},left:{mid:{image:"frames/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_left.png",mode:"stretch"}},right:{mid:{image:"frames/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_right.png",mode:"stretch"}},bottom:{start:"frames/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_bottom_corner_left.png",mid:{image:"frames/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_bottom.png",mode:"stretch"},end:"frames/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_bottom_corner_right.png"}}},{identifier:"imgly_frame_wood_passepartout",defaultName:"Wood Passepartout",layoutMode:"horizontal-inside",thumbnail:"frames/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_thumb.png",imageGroups:{top:{start:"frames/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_top_corner_left.png",mid:{image:"frames/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_top.png",mode:"stretch"},end:"frames/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_top_corner_right.png"},left:{mid:{image:"frames/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_left.png",mode:"stretch"}},right:{mid:{image:"frames/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_right.png",mode:"stretch"}},bottom:{start:"frames/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_bottom_corner_left.png",mid:{image:"frames/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_bottom.png",mode:"stretch"},end:"frames/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_bottom_corner_right.png"}}}]}],STICKER_CATEGORIES:[{identifier:"imgly_sticker_emoticons",defaultName:"Emoticons",metaData:{backgroundImage:"stickers/emoticons/background.png"},stickers:[{identifier:"imgly_sticker_emoticons_alien",defaultName:"Alien",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_alien.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_alien.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_alien.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_alien.png"],width:1e3,height:935}}},{identifier:"imgly_sticker_emoticons_angel",defaultName:"Angel",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_angel.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_angel.png"],width:62,height:64},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_angel.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_angel.png"]}}},{identifier:"imgly_sticker_emoticons_angry",defaultName:"Angry",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_angry.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_angry.png"],width:62,height:62},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_angry.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_angry.png"]}}},{identifier:"imgly_sticker_emoticons_anxious",defaultName:"Anxious",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_anxious.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_anxious.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_anxious.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_anxious.png"]}}},{identifier:"imgly_sticker_emoticons_asleep",defaultName:"Asleep",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_asleep.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_asleep.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_asleep.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_asleep.png"]}}},{identifier:"imgly_sticker_emoticons_attention",defaultName:"Attention",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_attention.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_attention.png"],width:62,height:60},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_attention.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_attention.png"]}}},{identifier:"imgly_sticker_emoticons_baby_chicken",defaultName:"Baby Chicken",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_baby_chicken.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_baby_chicken.png"],width:61,height:42},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_baby_chicken.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_baby_chicken.png"]}}},{identifier:"imgly_sticker_emoticons_batman",defaultName:"Batman",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_batman.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_batman.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_batman.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_batman.png"]}}},{identifier:"imgly_sticker_emoticons_beer",defaultName:"Beer",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_beer.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_beer.png"],width:62,height:59},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_beer.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_beer.png"]}}},{identifier:"imgly_sticker_emoticons_blush",defaultName:"Blush",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_blush.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_blush.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_blush.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_blush.png"]}}},{identifier:"imgly_sticker_emoticons_boxer",defaultName:"Boxer",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_boxer.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_boxer.png"],width:62,height:62},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_boxer.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_boxer.png"]}}},{identifier:"imgly_sticker_emoticons_business",defaultName:"Business",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_business.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_business.png"],width:60,height:63},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_business.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_business.png"]}}},{identifier:"imgly_sticker_emoticons_chicken",defaultName:"Chicken",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_chicken.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_chicken.png"],width:63,height:55},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_chicken.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_chicken.png"]}}},{identifier:"imgly_sticker_emoticons_cool",defaultName:"Cool",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_cool.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_cool.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_cool.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_cool.png"]}}},{identifier:"imgly_sticker_emoticons_cry",defaultName:"Cry",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_cry.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_cry.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_cry.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_cry.png"]}}},{identifier:"imgly_sticker_emoticons_deceased",defaultName:"Deceased",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_deceased.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_deceased.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_deceased.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_deceased.png"]}}},{identifier:"imgly_sticker_emoticons_devil",defaultName:"Devil",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_devil.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_devil.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_devil.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_devil.png"]}}},{identifier:"imgly_sticker_emoticons_duckface",defaultName:"Duckface",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_duckface.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_duckface.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_duckface.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_duckface.png"]}}},{identifier:"imgly_sticker_emoticons_furious",defaultName:"Furious",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_furious.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_furious.png"],width:62,height:61},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_furious.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_furious.png"]}}},{identifier:"imgly_sticker_emoticons_grin",defaultName:"Grin",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_grin.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_grin.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_grin.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_grin.png"]}}},{identifier:"imgly_sticker_emoticons_guitar",defaultName:"Guitar",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_guitar.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_guitar.png"],width:64,height:60},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_guitar.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_guitar.png"]}}},{identifier:"imgly_sticker_emoticons_harry_potter",defaultName:"Harry Potter",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_harry_potter.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_harry_potter.png"],width:64,height:62},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_harry_potter.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_harry_potter.png"]}}},{identifier:"imgly_sticker_emoticons_hippie",defaultName:"Hippie",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_hippie.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_hippie.png"],width:62,height:62},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_hippie.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_hippie.png"]}}},{identifier:"imgly_sticker_emoticons_hitman",defaultName:"Hitman",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_hitman.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_hitman.png"],width:64,height:60},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_hitman.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_hitman.png"]}}},{identifier:"imgly_sticker_emoticons_humourous",defaultName:"Humourous",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_humourous.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_humourous.png"],width:64,height:64},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_humourous.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_humourous.png"]}}},{identifier:"imgly_sticker_emoticons_idea",defaultName:"Idea",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_idea.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_idea.png"],width:64,height:62},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_idea.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_idea.png"]}}},{identifier:"imgly_sticker_emoticons_impatient",defaultName:"Impatient",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_impatient.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_impatient.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_impatient.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_impatient.png"]}}},{identifier:"imgly_sticker_emoticons_kiss",defaultName:"Kiss",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_kiss.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_kiss.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_kiss.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_kiss.png"]}}},{identifier:"imgly_sticker_emoticons_kisses",defaultName:"Kisses",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_kisses.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_kisses.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_kisses.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_kisses.png"]}}},{identifier:"imgly_sticker_emoticons_laugh",defaultName:"Laugh",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_laugh.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_laugh.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_laugh.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_laugh.png"]}}},{identifier:"imgly_sticker_emoticons_loud_cry",defaultName:"Loud Cry",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_loud_cry.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_loud_cry.png"],width:64,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_loud_cry.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_loud_cry.png"]}}},{identifier:"imgly_sticker_emoticons_loving",defaultName:"Loving",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_loving.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_loving.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_loving.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_loving.png"]}}},{identifier:"imgly_sticker_emoticons_masked",defaultName:"Masked",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_masked.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_masked.png"],width:62,height:62},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_masked.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_masked.png"]}}},{identifier:"imgly_sticker_emoticons_music",defaultName:"Music",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_music.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_music.png"],width:62,height:54},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_music.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_music.png"]}}},{identifier:"imgly_sticker_emoticons_nerd",defaultName:"Nerd",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_nerd.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_nerd.png"]},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_nerd.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_nerd.png"]}}},{identifier:"imgly_sticker_emoticons_ninja",defaultName:"Ninja",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_ninja.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_ninja.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_ninja.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_ninja.png"]}}},{identifier:"imgly_sticker_emoticons_not_speaking_to_you",defaultName:"Not Speaking To You",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_not_speaking_to_you.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_not_speaking_to_you.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_not_speaking_to_you.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_not_speaking_to_you.png"]}}},{identifier:"imgly_sticker_emoticons_pig",defaultName:"Pig",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_pig.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_pig.png"],width:63,height:41},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_pig.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_pig.png"]}}},{identifier:"imgly_sticker_emoticons_pumpkin",defaultName:"Pumpkin",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_pumpkin.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_pumpkin.png"],width:62,height:60},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_pumpkin.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_pumpkin.png"]}}},{identifier:"imgly_sticker_emoticons_question",defaultName:"Question",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_question.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_question.png"],width:62,height:62},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_question.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_question.png"]}}},{identifier:"imgly_sticker_emoticons_rabbit",defaultName:"Rabbit",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_rabbit.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_rabbit.png"],width:65,height:47},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_rabbit.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_rabbit.png"]}}},{identifier:"imgly_sticker_emoticons_sad",defaultName:"Sad",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_sad.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_sad.png"]},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_sad.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_sad.png"]}}},{identifier:"imgly_sticker_emoticons_sick",defaultName:"Sick",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_sick.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_sick.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_sick.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_sick.png"]}}},{identifier:"imgly_sticker_emoticons_skateboard",defaultName:"Skateboard",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_skateboard.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_skateboard.png"],width:62,height:64},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_skateboard.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_skateboard.png"]}}},{identifier:"imgly_sticker_emoticons_skull",defaultName:"Skull",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_skull.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_skull.png"],width:62,height:62},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_skull.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_skull.png"]}}},{identifier:"imgly_sticker_emoticons_sleepy",defaultName:"Sleepy",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_sleepy.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_sleepy.png"],width:62,height:60},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_sleepy.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_sleepy.png"]}}},{identifier:"imgly_sticker_emoticons_smile",defaultName:"Smile",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_smile.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_smile.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_smile.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_smile.png"]}}},{identifier:"imgly_sticker_emoticons_smoking",defaultName:"Smoking",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_smoking.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_smoking.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_smoking.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_smoking.png"]}}},{identifier:"imgly_sticker_emoticons_sobbing",defaultName:"Sobbing",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_sobbing.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_sobbing.png"],width:62,height:59},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_sobbing.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_sobbing.png"]}}},{identifier:"imgly_sticker_emoticons_star",defaultName:"Star",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_star.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_star.png"],width:64,height:64},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_star.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_star.png"]}}},{identifier:"imgly_sticker_emoticons_steaming_furious",defaultName:"Steaming Furious",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_steaming_furious.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_steaming_furious.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_steaming_furious.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_steaming_furious.png"]}}},{identifier:"imgly_sticker_emoticons_sunbathing",defaultName:"Sunbathing",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_sunbathing.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_sunbathing.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_sunbathing.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_sunbathing.png"]}}},{identifier:"imgly_sticker_emoticons_tired",defaultName:"Tired",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_tired.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_tired.png"],width:62,height:60},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_tired.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_tired.png"]}}},{identifier:"imgly_sticker_emoticons_tongue_out_wink",defaultName:"Tongue Out Wink",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_tongue_out_wink.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_tongue_out_wink.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_tongue_out_wink.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_tongue_out_wink.png"]}}},{identifier:"imgly_sticker_emoticons_wave",defaultName:"Wave",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_wave.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_wave.png"],width:62,height:60},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_wave.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_wave.png"]}}},{identifier:"imgly_sticker_emoticons_wide_grin",defaultName:"Wide Grin",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_wide_grin.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_wide_grin.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_wide_grin.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_wide_grin.png"]}}},{identifier:"imgly_sticker_emoticons_wink",defaultName:"Wink",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_wink.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_wink.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_wink.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_wink.png"]}}},{identifier:"imgly_sticker_emoticons_wrestler",defaultName:"Wrestler",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_wrestler.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_wrestler.png"],width:62,height:60},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_wrestler.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_wrestler.png"]}}}]},{identifier:"imgly_sticker_shapes",defaultName:"Shapes",metaData:{backgroundImage:"stickers/shapes/background.png"},stickers:[{identifier:"imgly_sticker_shapes_arrow_02",defaultName:"Arrow 1",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_arrow_02.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_arrow_02.png"],width:2e3,height:1236},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_arrow_02.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_arrow_02.png"],width:2e3,height:1236}}},{identifier:"imgly_sticker_shapes_arrow_03",defaultName:"Arrow 2",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_arrow_03.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_arrow_03.png"],width:2e3,height:2e3},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_arrow_03.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_arrow_03.png"],width:2e3,height:2e3}}},{identifier:"imgly_sticker_shapes_badge_01",defaultName:"Badge 1",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_01.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_01.png"],width:2e3,height:2e3},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_01.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_01.png"],width:2e3,height:2e3}}},{identifier:"imgly_sticker_shapes_badge_04",defaultName:"Badge 2",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_04.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_04.png"],width:2e3,height:1589},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_04.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_04.png"],width:2e3,height:1589}}},{identifier:"imgly_sticker_shapes_badge_06",defaultName:"Badge 3",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_06.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_06.png"],width:2e3,height:1733},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_06.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_06.png"],width:2e3,height:1733}}},{identifier:"imgly_sticker_shapes_badge_08",defaultName:"Badge 4",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_08.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_08.png"],width:2e3,height:2e3},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_08.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_08.png"],width:2e3,height:2e3}}},{identifier:"imgly_sticker_shapes_badge_11",defaultName:"Badge 5",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_11.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_11.png"],width:2e3,height:2e3},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_11.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_11.png"],width:2e3,height:2e3}}},{identifier:"imgly_sticker_shapes_badge_12",defaultName:"Badge 6",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_12.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_12.png"],width:2001,height:1903},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_12.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_12.png"],width:2001,height:1903}}},{identifier:"imgly_sticker_shapes_badge_13",defaultName:"Badge 7",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_13.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_13.png"],width:2e3,height:1718},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_13.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_13.png"],width:2e3,height:1718}}},{identifier:"imgly_sticker_shapes_badge_15",defaultName:"Badge 8",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_15.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_15.png"],width:1618,height:2e3},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_15.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_15.png"],width:1618,height:2e3}}},{identifier:"imgly_sticker_shapes_badge_18",defaultName:"Badge 9",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_18.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_18.png"],width:1198,height:2e3},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_18.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_18.png"],width:1198,height:2e3}}},{identifier:"imgly_sticker_shapes_badge_19",defaultName:"Badge 10",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_19.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_19.png"],width:2127,height:481},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_19.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_19.png"],width:2127,height:481}}},{identifier:"imgly_sticker_shapes_badge_20",defaultName:"Badge 11",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_20.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_20.png"],width:2e3,height:1404},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_20.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_20.png"],width:2e3,height:1404}}},{identifier:"imgly_sticker_shapes_badge_28",defaultName:"Badge 12",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_28.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_28.png"],width:2e3,height:2e3},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_28.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_28.png"],width:2e3,height:2e3}}},{identifier:"imgly_sticker_shapes_badge_32",defaultName:"Badge 13",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_32.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_32.png"],width:1960,height:2e3},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_32.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_32.png"],width:1960,height:2e3}}},{identifier:"imgly_sticker_shapes_badge_35",defaultName:"Badge 14",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_35.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_35.png"],width:2e3,height:2002},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_35.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_35.png"],width:2e3,height:2002}}},{identifier:"imgly_sticker_shapes_badge_36",defaultName:"Badge 15",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_36.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_36.png"],width:2e3,height:1668},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_36.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_36.png"],width:2e3,height:1668}}},{identifier:"imgly_sticker_shapes_spray_01",defaultName:"Spray 1",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_spray_01.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_spray_01.png"],width:1912,height:2039},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_spray_01.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_spray_01.png"],width:1912,height:2039}}},{identifier:"imgly_sticker_shapes_spray_03",defaultName:"Spray 2",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_spray_03.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_spray_03.png"],width:1681,height:1779},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_spray_03.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_spray_03.png"],width:1681,height:1779}}},{identifier:"imgly_sticker_shapes_spray_04",defaultName:"Spray 3",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_spray_04.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_spray_04.png"],width:1407,height:2248},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_spray_04.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_spray_04.png"],width:1407,height:2248}}}]}]}}});function F(o,e,t){o!=null&&(typeof o=="number"?this.fromNumber(o,e,t):e==null&&typeof o!="string"?this.fromString(o,256):this.fromString(o,e))}function re(){return new F(null)}function Cx(o,e,t,i,r,s){for(;--s>=0;){var n=e*this[o++]+t[i]+r;r=Math.floor(n/67108864),t[i++]=n&67108863}return r}function kx(o,e,t,i,r,s){for(var n=e&32767,a=e>>15;--s>=0;){var l=this[o]&32767,h=this[o++]>>15,c=a*l+h*n;l=n*l+((c&32767)<<15)+t[i]+(r&1073741823),r=(l>>>30)+(c>>>15)+a*h+(r>>>30),t[i++]=l&1073741823}return r}function Sx(o,e,t,i,r,s){for(var n=e&16383,a=e>>14;--s>=0;){var l=this[o]&16383,h=this[o++]>>14,c=a*l+h*n;l=n*l+((c&16383)<<14)+t[i]+r,r=(l>>28)+(c>>14)+a*h,t[i++]=l&268435455}return r}function qd(o){return Ox.charAt(o)}function Xd(o,e){var t=sn[o.charCodeAt(e)];return t==null?-1:t}function Fx(o){for(var e=this.t-1;e>=0;--e)o[e]=this[e];o.t=this.t,o.s=this.s}function Ex(o){this.t=1,this.s=o<0?-1:0,o>0?this[0]=o:o<-1?this[0]=o+this.DV:this.t=0}function gi(o){var e=re();return e.fromInt(o),e}function Ix(o,e){var t;if(e==16)t=4;else if(e==8)t=3;else if(e==256)t=8;else if(e==2)t=1;else if(e==32)t=5;else if(e==4)t=2;else{this.fromRadix(o,e);return}this.t=0,this.s=0;for(var i=o.length,r=!1,s=0;--i>=0;){var n=t==8?o[i]&255:Xd(o,i);if(n<0){o.charAt(i)=="-"&&(r=!0);continue}r=!1,s==0?this[this.t++]=n:s+t>this.DB?(this[this.t-1]|=(n&(1<<this.DB-s)-1)<<s,this[this.t++]=n>>this.DB-s):this[this.t-1]|=n<<s,s+=t,s>=this.DB&&(s-=this.DB)}t==8&&(o[0]&128)!=0&&(this.s=-1,s>0&&(this[this.t-1]|=(1<<this.DB-s)-1<<s)),this.clamp(),r&&F.ZERO.subTo(this,this)}function Mx(){for(var o=this.s&this.DM;this.t>0&&this[this.t-1]==o;)--this.t}function Bx(o){if(this.s<0)return"-"+this.negate().toString(o);var e;if(o==16)e=4;else if(o==8)e=3;else if(o==2)e=1;else if(o==32)e=5;else if(o==4)e=2;else return this.toRadix(o);var t=(1<<e)-1,i,r=!1,s="",n=this.t,a=this.DB-n*this.DB%e;if(n-- >0)for(a<this.DB&&(i=this[n]>>a)>0&&(r=!0,s=qd(i));n>=0;)a<e?(i=(this[n]&(1<<a)-1)<<e-a,i|=this[--n]>>(a+=this.DB-e)):(i=this[n]>>(a-=e)&t,a<=0&&(a+=this.DB,--n)),i>0&&(r=!0),r&&(s+=qd(i));return r?s:"0"}function Dx(){var o=re();return F.ZERO.subTo(this,o),o}function Px(){return this.s<0?this.negate():this}function Ax(o){var e=this.s-o.s;if(e!=0)return e;var t=this.t;if(e=t-o.t,e!=0)return this.s<0?-e:e;for(;--t>=0;)if((e=this[t]-o[t])!=0)return e;return 0}function on(o){var e=1,t;return(t=o>>>16)!=0&&(o=t,e+=16),(t=o>>8)!=0&&(o=t,e+=8),(t=o>>4)!=0&&(o=t,e+=4),(t=o>>2)!=0&&(o=t,e+=2),(t=o>>1)!=0&&(o=t,e+=1),e}function Lx(){return this.t<=0?0:this.DB*(this.t-1)+on(this[this.t-1]^this.s&this.DM)}function zx(o,e){var t;for(t=this.t-1;t>=0;--t)e[t+o]=this[t];for(t=o-1;t>=0;--t)e[t]=0;e.t=this.t+o,e.s=this.s}function Nx(o,e){for(var t=o;t<this.t;++t)e[t-o]=this[t];e.t=Math.max(this.t-o,0),e.s=this.s}function Ux(o,e){var t=o%this.DB,i=this.DB-t,r=(1<<i)-1,s=Math.floor(o/this.DB),n=this.s<<t&this.DM,a;for(a=this.t-1;a>=0;--a)e[a+s+1]=this[a]>>i|n,n=(this[a]&r)<<t;for(a=s-1;a>=0;--a)e[a]=0;e[s]=n,e.t=this.t+s+1,e.s=this.s,e.clamp()}function Gx(o,e){e.s=this.s;var t=Math.floor(o/this.DB);if(t>=this.t){e.t=0;return}var i=o%this.DB,r=this.DB-i,s=(1<<i)-1;e[0]=this[t]>>i;for(var n=t+1;n<this.t;++n)e[n-t-1]|=(this[n]&s)<<r,e[n-t]=this[n]>>i;i>0&&(e[this.t-t-1]|=(this.s&s)<<r),e.t=this.t-t,e.clamp()}function Wx(o,e){for(var t=0,i=0,r=Math.min(o.t,this.t);t<r;)i+=this[t]-o[t],e[t++]=i&this.DM,i>>=this.DB;if(o.t<this.t){for(i-=o.s;t<this.t;)i+=this[t],e[t++]=i&this.DM,i>>=this.DB;i+=this.s}else{for(i+=this.s;t<o.t;)i-=o[t],e[t++]=i&this.DM,i>>=this.DB;i-=o.s}e.s=i<0?-1:0,i<-1?e[t++]=this.DV+i:i>0&&(e[t++]=i),e.t=t,e.clamp()}function Vx(o,e){var t=this.abs(),i=o.abs(),r=t.t;for(e.t=r+i.t;--r>=0;)e[r]=0;for(r=0;r<i.t;++r)e[r+t.t]=t.am(0,i[r],e,r,0,t.t);e.s=0,e.clamp(),this.s!=o.s&&F.ZERO.subTo(e,e)}function Hx(o){for(var e=this.abs(),t=o.t=2*e.t;--t>=0;)o[t]=0;for(t=0;t<e.t-1;++t){var i=e.am(t,e[t],o,2*t,0,1);(o[t+e.t]+=e.am(t+1,2*e[t],o,2*t+1,i,e.t-t-1))>=e.DV&&(o[t+e.t]-=e.DV,o[t+e.t+1]=1)}o.t>0&&(o[o.t-1]+=e.am(t,e[t],o,2*t,0,1)),o.s=0,o.clamp()}function jx(o,e,t){var i=o.abs();if(!(i.t<=0)){var r=this.abs();if(r.t<i.t){e!=null&&e.fromInt(0),t!=null&&this.copyTo(t);return}t==null&&(t=re());var s=re(),n=this.s,a=o.s,l=this.DB-on(i[i.t-1]);l>0?(i.lShiftTo(l,s),r.lShiftTo(l,t)):(i.copyTo(s),r.copyTo(t));var h=s.t,c=s[h-1];if(c!=0){var m=c*(1<<this.F1)+(h>1?s[h-2]>>this.F2:0),d=this.FV/m,u=(1<<this.F1)/m,f=1<<this.F2,y=t.t,g=y-h,p=e==null?re():e;for(s.dlShiftTo(g,p),t.compareTo(p)>=0&&(t[t.t++]=1,t.subTo(p,t)),F.ONE.dlShiftTo(h,p),p.subTo(s,s);s.t<h;)s[s.t++]=0;for(;--g>=0;){var v=t[--y]==c?this.DM:Math.floor(t[y]*d+(t[y-1]+f)*u);if((t[y]+=s.am(0,v,t,g,0,h))<v)for(s.dlShiftTo(g,p),t.subTo(p,t);t[y]<--v;)t.subTo(p,t)}e!=null&&(t.drShiftTo(h,e),n!=a&&F.ZERO.subTo(e,e)),t.t=h,t.clamp(),l>0&&t.rShiftTo(l,t),n<0&&F.ZERO.subTo(t,t)}}}function qx(o){var e=re();return this.abs().divRemTo(o,null,e),this.s<0&&e.compareTo(F.ZERO)>0&&o.subTo(e,e),e}function ji(o){this.m=o}function Xx(o){return o.s<0||o.compareTo(this.m)>=0?o.mod(this.m):o}function Yx(o){return o}function Kx(o){o.divRemTo(this.m,null,o)}function Jx(o,e,t){o.multiplyTo(e,t),this.reduce(t)}function Zx(o,e){o.squareTo(e),this.reduce(e)}function Qx(){if(this.t<1)return 0;var o=this[0];if((o&1)==0)return 0;var e=o&3;return e=e*(2-(o&15)*e)&15,e=e*(2-(o&255)*e)&255,e=e*(2-((o&65535)*e&65535))&65535,e=e*(2-o*e%this.DV)%this.DV,e>0?this.DV-e:-e}function qi(o){this.m=o,this.mp=o.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<o.DB-15)-1,this.mt2=2*o.t}function $x(o){var e=re();return o.abs().dlShiftTo(this.m.t,e),e.divRemTo(this.m,null,e),o.s<0&&e.compareTo(F.ZERO)>0&&this.m.subTo(e,e),e}function eb(o){var e=re();return o.copyTo(e),this.reduce(e),e}function tb(o){for(;o.t<=this.mt2;)o[o.t++]=0;for(var e=0;e<this.m.t;++e){var t=o[e]&32767,i=t*this.mpl+((t*this.mph+(o[e]>>15)*this.mpl&this.um)<<15)&o.DM;for(t=e+this.m.t,o[t]+=this.m.am(0,i,o,e,0,this.m.t);o[t]>=o.DV;)o[t]-=o.DV,o[++t]++}o.clamp(),o.drShiftTo(this.m.t,o),o.compareTo(this.m)>=0&&o.subTo(this.m,o)}function ib(o,e){o.squareTo(e),this.reduce(e)}function rb(o,e,t){o.multiplyTo(e,t),this.reduce(t)}function sb(){return(this.t>0?this[0]&1:this.s)==0}function ob(o,e){if(o>4294967295||o<1)return F.ONE;var t=re(),i=re(),r=e.convert(this),s=on(o)-1;for(r.copyTo(t);--s>=0;)if(e.sqrTo(t,i),(o&1<<s)>0)e.mulTo(i,r,t);else{var n=t;t=i,i=n}return e.revert(t)}function nb(o,e){var t;return o<256||e.isEven()?t=new ji(e):t=new qi(e),this.exp(o,t)}function ab(){var o=re();return this.copyTo(o),o}function lb(){if(this.s<0){if(this.t==1)return this[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this[0];if(this.t==0)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]}function hb(){return this.t==0?this.s:this[0]<<24>>24}function cb(){return this.t==0?this.s:this[0]<<16>>16}function ub(o){return Math.floor(Math.LN2*this.DB/Math.log(o))}function db(){return this.s<0?-1:this.t<=0||this.t==1&&this[0]<=0?0:1}function mb(o){if(o==null&&(o=10),this.signum()==0||o<2||o>36)return"0";var e=this.chunkSize(o),t=Math.pow(o,e),i=gi(t),r=re(),s=re(),n="";for(this.divRemTo(i,r,s);r.signum()>0;)n=(t+s.intValue()).toString(o).substr(1)+n,r.divRemTo(i,r,s);return s.intValue().toString(o)+n}function fb(o,e){this.fromInt(0),e==null&&(e=10);for(var t=this.chunkSize(e),i=Math.pow(e,t),r=!1,s=0,n=0,a=0;a<o.length;++a){var l=Xd(o,a);if(l<0){o.charAt(a)=="-"&&this.signum()==0&&(r=!0);continue}n=e*n+l,++s>=t&&(this.dMultiply(i),this.dAddOffset(n,0),s=0,n=0)}s>0&&(this.dMultiply(Math.pow(e,s)),this.dAddOffset(n,0)),r&&F.ZERO.subTo(this,this)}function pb(o,e,t){if(typeof e=="number")if(o<2)this.fromInt(1);else for(this.fromNumber(o,t),this.testBit(o-1)||this.bitwiseTo(F.ONE.shiftLeft(o-1),Ll,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(e);)this.dAddOffset(2,0),this.bitLength()>o&&this.subTo(F.ONE.shiftLeft(o-1),this);else{var i=new Array,r=o&7;i.length=(o>>3)+1,e.nextBytes(i),r>0?i[0]&=(1<<r)-1:i[0]=0,this.fromString(i,256)}}function _b(){var o=this.t,e=new Array;e[0]=this.s;var t=this.DB-o*this.DB%8,i,r=0;if(o-- >0)for(t<this.DB&&(i=this[o]>>t)!=(this.s&this.DM)>>t&&(e[r++]=i|this.s<<this.DB-t);o>=0;)t<8?(i=(this[o]&(1<<t)-1)<<8-t,i|=this[--o]>>(t+=this.DB-8)):(i=this[o]>>(t-=8)&255,t<=0&&(t+=this.DB,--o)),(i&128)!=0&&(i|=-256),r==0&&(this.s&128)!=(i&128)&&++r,(r>0||i!=this.s)&&(e[r++]=i);return e}function gb(o){return this.compareTo(o)==0}function yb(o){return this.compareTo(o)<0?this:o}function xb(o){return this.compareTo(o)>0?this:o}function bb(o,e,t){var i,r,s=Math.min(o.t,this.t);for(i=0;i<s;++i)t[i]=e(this[i],o[i]);if(o.t<this.t){for(r=o.s&this.DM,i=s;i<this.t;++i)t[i]=e(this[i],r);t.t=this.t}else{for(r=this.s&this.DM,i=s;i<o.t;++i)t[i]=e(r,o[i]);t.t=o.t}t.s=e(this.s,o.s),t.clamp()}function vb(o,e){return o&e}function wb(o){var e=re();return this.bitwiseTo(o,vb,e),e}function Ll(o,e){return o|e}function Tb(o){var e=re();return this.bitwiseTo(o,Ll,e),e}function Yd(o,e){return o^e}function Rb(o){var e=re();return this.bitwiseTo(o,Yd,e),e}function Kd(o,e){return o&~e}function Cb(o){var e=re();return this.bitwiseTo(o,Kd,e),e}function kb(){for(var o=re(),e=0;e<this.t;++e)o[e]=this.DM&~this[e];return o.t=this.t,o.s=~this.s,o}function Sb(o){var e=re();return o<0?this.rShiftTo(-o,e):this.lShiftTo(o,e),e}function Ob(o){var e=re();return o<0?this.lShiftTo(-o,e):this.rShiftTo(o,e),e}function Fb(o){if(o==0)return-1;var e=0;return(o&65535)==0&&(o>>=16,e+=16),(o&255)==0&&(o>>=8,e+=8),(o&15)==0&&(o>>=4,e+=4),(o&3)==0&&(o>>=2,e+=2),(o&1)==0&&++e,e}function Eb(){for(var o=0;o<this.t;++o)if(this[o]!=0)return o*this.DB+Fb(this[o]);return this.s<0?this.t*this.DB:-1}function Ib(o){for(var e=0;o!=0;)o&=o-1,++e;return e}function Mb(){for(var o=0,e=this.s&this.DM,t=0;t<this.t;++t)o+=Ib(this[t]^e);return o}function Bb(o){var e=Math.floor(o/this.DB);return e>=this.t?this.s!=0:(this[e]&1<<o%this.DB)!=0}function Db(o,e){var t=F.ONE.shiftLeft(o);return this.bitwiseTo(t,e,t),t}function Pb(o){return this.changeBit(o,Ll)}function Ab(o){return this.changeBit(o,Kd)}function Lb(o){return this.changeBit(o,Yd)}function zb(o,e){for(var t=0,i=0,r=Math.min(o.t,this.t);t<r;)i+=this[t]+o[t],e[t++]=i&this.DM,i>>=this.DB;if(o.t<this.t){for(i+=o.s;t<this.t;)i+=this[t],e[t++]=i&this.DM,i>>=this.DB;i+=this.s}else{for(i+=this.s;t<o.t;)i+=o[t],e[t++]=i&this.DM,i>>=this.DB;i+=o.s}e.s=i<0?-1:0,i>0?e[t++]=i:i<-1&&(e[t++]=this.DV+i),e.t=t,e.clamp()}function Nb(o){var e=re();return this.addTo(o,e),e}function Ub(o){var e=re();return this.subTo(o,e),e}function Gb(o){var e=re();return this.multiplyTo(o,e),e}function Wb(){var o=re();return this.squareTo(o),o}function Vb(o){var e=re();return this.divRemTo(o,e,null),e}function Hb(o){var e=re();return this.divRemTo(o,null,e),e}function jb(o){var e=re(),t=re();return this.divRemTo(o,e,t),new Array(e,t)}function qb(o){this[this.t]=this.am(0,o-1,this,0,0,this.t),++this.t,this.clamp()}function Xb(o,e){if(o!=0){for(;this.t<=e;)this[this.t++]=0;for(this[e]+=o;this[e]>=this.DV;)this[e]-=this.DV,++e>=this.t&&(this[this.t++]=0),++this[e]}}function ro(){}function Jd(o){return o}function Yb(o,e,t){o.multiplyTo(e,t)}function Kb(o,e){o.squareTo(e)}function Jb(o){return this.exp(o,new ro)}function Zb(o,e,t){var i=Math.min(this.t+o.t,e);for(t.s=0,t.t=i;i>0;)t[--i]=0;var r;for(r=t.t-this.t;i<r;++i)t[i+this.t]=this.am(0,o[i],t,i,0,this.t);for(r=Math.min(o.t,e);i<r;++i)this.am(0,o[i],t,i,0,e-i);t.clamp()}function Qb(o,e,t){--e;var i=t.t=this.t+o.t-e;for(t.s=0;--i>=0;)t[i]=0;for(i=Math.max(e-this.t,0);i<o.t;++i)t[this.t+i-e]=this.am(e-i,o[i],t,0,0,this.t+i-e);t.clamp(),t.drShiftTo(1,t)}function hs(o){this.r2=re(),this.q3=re(),F.ONE.dlShiftTo(2*o.t,this.r2),this.mu=this.r2.divide(o),this.m=o}function $b(o){if(o.s<0||o.t>2*this.m.t)return o.mod(this.m);if(o.compareTo(this.m)<0)return o;var e=re();return o.copyTo(e),this.reduce(e),e}function ev(o){return o}function tv(o){for(o.drShiftTo(this.m.t-1,this.r2),o.t>this.m.t+1&&(o.t=this.m.t+1,o.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);o.compareTo(this.r2)<0;)o.dAddOffset(1,this.m.t+1);for(o.subTo(this.r2,o);o.compareTo(this.m)>=0;)o.subTo(this.m,o)}function iv(o,e){o.squareTo(e),this.reduce(e)}function rv(o,e,t){o.multiplyTo(e,t),this.reduce(t)}function sv(o,e){var t=o.bitLength(),i,r=gi(1),s;if(t<=0)return r;t<18?i=1:t<48?i=3:t<144?i=4:t<768?i=5:i=6,t<8?s=new ji(e):e.isEven()?s=new hs(e):s=new qi(e);var n=new Array,a=3,l=i-1,h=(1<<i)-1;if(n[1]=s.convert(this),i>1){var c=re();for(s.sqrTo(n[1],c);a<=h;)n[a]=re(),s.mulTo(c,n[a-2],n[a]),a+=2}var m=o.t-1,d,u=!0,f=re(),y;for(t=on(o[m])-1;m>=0;){for(t>=l?d=o[m]>>t-l&h:(d=(o[m]&(1<<t+1)-1)<<l-t,m>0&&(d|=o[m-1]>>this.DB+t-l)),a=i;(d&1)==0;)d>>=1,--a;if((t-=a)<0&&(t+=this.DB,--m),u)n[d].copyTo(r),u=!1;else{for(;a>1;)s.sqrTo(r,f),s.sqrTo(f,r),a-=2;a>0?s.sqrTo(r,f):(y=r,r=f,f=y),s.mulTo(f,n[d],r)}for(;m>=0&&(o[m]&1<<t)==0;)s.sqrTo(r,f),y=r,r=f,f=y,--t<0&&(t=this.DB-1,--m)}return s.revert(r)}function ov(o){var e=this.s<0?this.negate():this.clone(),t=o.s<0?o.negate():o.clone();if(e.compareTo(t)<0){var i=e;e=t,t=i}var r=e.getLowestSetBit(),s=t.getLowestSetBit();if(s<0)return e;for(r<s&&(s=r),s>0&&(e.rShiftTo(s,e),t.rShiftTo(s,t));e.signum()>0;)(r=e.getLowestSetBit())>0&&e.rShiftTo(r,e),(r=t.getLowestSetBit())>0&&t.rShiftTo(r,t),e.compareTo(t)>=0?(e.subTo(t,e),e.rShiftTo(1,e)):(t.subTo(e,t),t.rShiftTo(1,t));return s>0&&t.lShiftTo(s,t),t}function nv(o){if(o<=0)return 0;var e=this.DV%o,t=this.s<0?o-1:0;if(this.t>0)if(e==0)t=this[0]%o;else for(var i=this.t-1;i>=0;--i)t=(e*t+this[i])%o;return t}function av(o){var e=o.isEven();if(this.isEven()&&e||o.signum()==0)return F.ZERO;for(var t=o.clone(),i=this.clone(),r=gi(1),s=gi(0),n=gi(0),a=gi(1);t.signum()!=0;){for(;t.isEven();)t.rShiftTo(1,t),e?((!r.isEven()||!s.isEven())&&(r.addTo(this,r),s.subTo(o,s)),r.rShiftTo(1,r)):s.isEven()||s.subTo(o,s),s.rShiftTo(1,s);for(;i.isEven();)i.rShiftTo(1,i),e?((!n.isEven()||!a.isEven())&&(n.addTo(this,n),a.subTo(o,a)),n.rShiftTo(1,n)):a.isEven()||a.subTo(o,a),a.rShiftTo(1,a);t.compareTo(i)>=0?(t.subTo(i,t),e&&r.subTo(n,r),s.subTo(a,s)):(i.subTo(t,i),e&&n.subTo(r,n),a.subTo(s,a))}if(i.compareTo(F.ONE)!=0)return F.ZERO;if(a.compareTo(o)>=0)return a.subtract(o);if(a.signum()<0)a.addTo(o,a);else return a;return a.signum()<0?a.add(o):a}function hv(o){var e,t=this.abs();if(t.t==1&&t[0]<=Ze[Ze.length-1]){for(e=0;e<Ze.length;++e)if(t[0]==Ze[e])return!0;return!1}if(t.isEven())return!1;for(e=1;e<Ze.length;){for(var i=Ze[e],r=e+1;r<Ze.length&&i<lv;)i*=Ze[r++];for(i=t.modInt(i);e<r;)if(i%Ze[e++]==0)return!1}return t.millerRabin(o)}function cv(o){var e=this.subtract(F.ONE),t=e.getLowestSetBit();if(t<=0)return!1;var i=e.shiftRight(t);o=o+1>>1,o>Ze.length&&(o=Ze.length);for(var r=re(),s=0;s<o;++s){r.fromInt(Ze[Math.floor(Math.random()*Ze.length)]);var n=r.modPow(i,this);if(n.compareTo(F.ONE)!=0&&n.compareTo(e)!=0){for(var a=1;a++<t&&n.compareTo(e)!=0;)if(n=n.modPowInt(2,this),n.compareTo(F.ONE)==0)return!1;if(n.compareTo(e)!=0)return!1}}return!0}var Hd,yi,Rx,jd,Al,Ox,sn,ls,bt,Ze,lv,Zd,Qd=_(()=>{Hd={},Rx=244837814094590,jd=(Rx&16777215)==15715070;jd&&Hd.appName=="Microsoft Internet Explorer"?(F.prototype.am=kx,yi=30):jd&&Hd.appName!="Netscape"?(F.prototype.am=Cx,yi=26):(F.prototype.am=Sx,yi=28);F.prototype.DB=yi;F.prototype.DM=(1<<yi)-1;F.prototype.DV=1<<yi;Al=52;F.prototype.FV=Math.pow(2,Al);F.prototype.F1=Al-yi;F.prototype.F2=2*yi-Al;Ox="0123456789abcdefghijklmnopqrstuvwxyz",sn=new Array;ls="0".charCodeAt(0);for(bt=0;bt<=9;++bt)sn[ls++]=bt;ls="a".charCodeAt(0);for(bt=10;bt<36;++bt)sn[ls++]=bt;ls="A".charCodeAt(0);for(bt=10;bt<36;++bt)sn[ls++]=bt;ji.prototype.convert=Xx;ji.prototype.revert=Yx;ji.prototype.reduce=Kx;ji.prototype.mulTo=Jx;ji.prototype.sqrTo=Zx;qi.prototype.convert=$x;qi.prototype.revert=eb;qi.prototype.reduce=tb;qi.prototype.mulTo=rb;qi.prototype.sqrTo=ib;F.prototype.copyTo=Fx;F.prototype.fromInt=Ex;F.prototype.fromString=Ix;F.prototype.clamp=Mx;F.prototype.dlShiftTo=zx;F.prototype.drShiftTo=Nx;F.prototype.lShiftTo=Ux;F.prototype.rShiftTo=Gx;F.prototype.subTo=Wx;F.prototype.multiplyTo=Vx;F.prototype.squareTo=Hx;F.prototype.divRemTo=jx;F.prototype.invDigit=Qx;F.prototype.isEven=sb;F.prototype.exp=ob;F.prototype.toString=Bx;F.prototype.negate=Dx;F.prototype.abs=Px;F.prototype.compareTo=Ax;F.prototype.bitLength=Lx;F.prototype.mod=qx;F.prototype.modPowInt=nb;F.ZERO=gi(0);F.ONE=gi(1);ro.prototype.convert=Jd;ro.prototype.revert=Jd;ro.prototype.mulTo=Yb;ro.prototype.sqrTo=Kb;hs.prototype.convert=$b;hs.prototype.revert=ev;hs.prototype.reduce=tv;hs.prototype.mulTo=rv;hs.prototype.sqrTo=iv;Ze=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],lv=(1<<26)/Ze[Ze.length-1];F.prototype.chunkSize=ub;F.prototype.toRadix=mb;F.prototype.fromRadix=fb;F.prototype.fromNumber=pb;F.prototype.bitwiseTo=bb;F.prototype.changeBit=Db;F.prototype.addTo=zb;F.prototype.dMultiply=qb;F.prototype.dAddOffset=Xb;F.prototype.multiplyLowerTo=Zb;F.prototype.multiplyUpperTo=Qb;F.prototype.modInt=nv;F.prototype.millerRabin=cv;F.prototype.clone=ab;F.prototype.intValue=lb;F.prototype.byteValue=hb;F.prototype.shortValue=cb;F.prototype.signum=db;F.prototype.toByteArray=_b;F.prototype.equals=gb;F.prototype.min=yb;F.prototype.max=xb;F.prototype.and=wb;F.prototype.or=Tb;F.prototype.xor=Rb;F.prototype.andNot=Cb;F.prototype.not=kb;F.prototype.shiftLeft=Sb;F.prototype.shiftRight=Ob;F.prototype.getLowestSetBit=Eb;F.prototype.bitCount=Mb;F.prototype.testBit=Bb;F.prototype.setBit=Pb;F.prototype.clearBit=Ab;F.prototype.flipBit=Lb;F.prototype.add=Nb;F.prototype.subtract=Ub;F.prototype.multiply=Gb;F.prototype.divide=Vb;F.prototype.remainder=Hb;F.prototype.divideAndRemainder=jb;F.prototype.modPow=sv;F.prototype.modInverse=av;F.prototype.pow=Jb;F.prototype.gcd=ov;F.prototype.isProbablePrime=hv;F.prototype.square=Wb;Zd=F});function $d(o){var e=8,t=0;function i(g,p){var v=(g&65535)+(p&65535),x=(g>>16)+(p>>16)+(v>>16);return x<<16|v&65535}function r(g,p){return g>>>p|g<<32-p}function s(g,p){return g>>>p}function n(g,p,v){return g&p^~g&v}function a(g,p,v){return g&p^g&v^p&v}function l(g){return r(g,2)^r(g,13)^r(g,22)}function h(g){return r(g,6)^r(g,11)^r(g,25)}function c(g){return r(g,7)^r(g,18)^s(g,3)}function m(g){return r(g,17)^r(g,19)^s(g,10)}function d(g,p){var v=new Array(1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298),x=new Array(1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225),T=new Array(64),D,b,w,G,N,j,K,Y,W,he,He,De;g[p>>5]|=128<<24-p%32,g[(p+64>>9<<4)+15]=p;for(var W=0;W<g.length;W+=16){D=x[0],b=x[1],w=x[2],G=x[3],N=x[4],j=x[5],K=x[6],Y=x[7];for(var he=0;he<64;he++)he<16?T[he]=g[he+W]:T[he]=i(i(i(m(T[he-2]),T[he-7]),c(T[he-15])),T[he-16]),He=i(i(i(i(Y,h(N)),n(N,j,K)),v[he]),T[he]),De=i(l(D),a(D,b,w)),Y=K,K=j,j=N,N=i(G,He),G=w,w=b,b=D,D=i(He,De);x[0]=i(D,x[0]),x[1]=i(b,x[1]),x[2]=i(w,x[2]),x[3]=i(G,x[3]),x[4]=i(N,x[4]),x[5]=i(j,x[5]),x[6]=i(K,x[6]),x[7]=i(Y,x[7])}return x}function u(g){for(var p=Array(),v=(1<<e)-1,x=0;x<g.length*e;x+=e)p[x>>5]|=(g.charCodeAt(x/e)&v)<<24-x%32;return p}function f(g){g=g.replace(/\r\n/g,`
`);for(var p="",v=0;v<g.length;v++){var x=g.charCodeAt(v);x<128?p+=String.fromCharCode(x):x>127&&x<2048?(p+=String.fromCharCode(x>>6|192),p+=String.fromCharCode(x&63|128)):(p+=String.fromCharCode(x>>12|224),p+=String.fromCharCode(x>>6&63|128),p+=String.fromCharCode(x&63|128))}return p}function y(g){for(var p=t?"0123456789ABCDEF":"0123456789abcdef",v="",x=0;x<g.length*4;x++)v+=p.charAt(g[x>>2]>>(3-x%4)*8+4&15)+p.charAt(g[x>>2]>>(3-x%4)*8&15);return v}return o=f(o),y(d(u(o),o.length*e))}var em=_(()=>{});var uv,dv,Xi,tm=_(()=>{uv=/^(0|[1-9]\d*)\.(0|[1-9]\d*)\.(0|[1-9]\d*)(?:-((?:0|[1-9]\d*|\d*[a-zA-Z-][0-9a-zA-Z-]*)(?:\.(?:0|[1-9]\d*|\d*[a-zA-Z-][0-9a-zA-Z-]*))*))?(?:\+([0-9a-zA-Z-]+(?:\.[0-9a-zA-Z-]+)*))?$/g,dv=/^(0|[1-9]\d*)\.(0|[1-9]\d*)(\.(0|[1-9]\d*))?(?:-((?:0|[1-9]\d*|\d*[a-zA-Z-][0-9a-zA-Z-]*)(?:\.(?:0|[1-9]\d*|\d*[a-zA-Z-][0-9a-zA-Z-]*))*))?(?:\+([0-9a-zA-Z-]+(?:\.[0-9a-zA-Z-]+)*))?$/g,Xi=class{get major(){return this._major}get minor(){return this._minor}get patch(){return this._patch}constructor(e,t=!1){let i=t?dv:uv,r=i.exec(e);i.lastIndex=0,this._major=r[1],this._minor=r[2],this._patch=r[3]||0}equals(e){return this._major===e._major&&this._minor===e._minor&&this._patch===e._patch}isMoreRecentThan(e){if(this._major<e.major)return!1;if(this._major>e.major)return!0;if(this._minor<e.minor)return!1;if(this._minor>e.minor)return!0;if(this._patch<=e.patch)return!1;if(this._patch>e.patch)return!0}}});function mv(o){return o.map(e=>`0${(e&255).toString(16)}`.slice(-2)).join("")}var Pe,fv,pv,im,_v,rm,zl,gv,yv,Nl,xv,sm,Ul,nn,Gl=_(()=>{Ni();Qd();em();Vr();tm();Dt();Pe=o=>k.byteArrayToString(kt.decode(o));fv="TDNSeVlXTnJQMkZ3YVV0bGVUMD0=",pv="ZW50ZXJwcmlzZV9saWNlbnNl",im="YXBwX2lkZW50aWZpZXJz",_v="cGxhdGZvcm0=",rm="ZmVhdHVyZXM=",zl="ZXhwaXJlc19hdA==",gv="ZG9tYWlucw==",yv="YXBpX3Rva2Vu",Nl="c2lnbmF0dXJl",xv="dmVyc2lvbg==",sm=class{constructor(e){this._version="2.4",this._l=typeof e=="string"?e.trim():e,this._e=this._parseBigInt("65537",10),this._n=this._parseBigInt("681984042382424091378806337544846672160292647422517223678775230983366046720611873368204040735766698395282492937192783016867164773742859209434481353888637963692711665138989982680829529436715362566735813634679619274059040232728883894511099669775400556584329435375723951309340934658571478665059403241851229195311069345899870108307225910988692123234379186643268583453907260879685992156955936561142314233983397819356937109343127504441076920088455337597736475086676246750168976219763398350254797168313954762459542746440628077261880980924552698138857743609502132632199713575442848784271304503226045319991689413234228439044522583790713890093165912455428688507463773064216328753265963237930998706891042679105987175588970202082466871461192706070321938250462103821558100761330890228135620208935801286878657384108721268761878694436895194628411397454202904351577771506916746612289964053490210990342857409030179406810634136188751670648983222653319056818302012063874664196648868156305696644664362171542503665321455971335955948698828939948786720193132672749776162913092000667953299803216404664087988046584107737900256954976744353601826341965438148646041640662195744770544094748295945844184507459808803114917301124088082458306086473490516969815873631",10),this._parseLicense()}v(){return this._sigValid()&&!this.isExp()}_jsonValid(){try{this._decLic=JSON.parse(this._l)}catch(e){return this._decLic={},!1}return!0}_hostnameValid(){if(typeof window=="undefined"||!this._decLic[Pe(im)].length)return!0;let{hostname:e}=window.location,t=!1;return this._decLic[Pe(im)].forEach(i=>{k.wildCardMatch(e,i)&&(t=!0)}),t}_platformValid(){let e=this._decLic[Pe(_v)];return"Server"===e}c(){return new Promise((e,t)=>{let i=this._validateError();i!==null&&t(i),e()})}validate(){return this._validateError()===null}_validateError(){if(typeof this._l!=="string"||!this._jsonValid()){let t=new Error;return t.code="ELICINVFMT",t}if(!this._sigValid()){let t=new Error;return t.code="ELICINV",t}if(!this._hostnameValid()){let t=new Error;return t.code="ELICINVHOST",t}if(!this._platformValid()){let t=new Error;return t.code="ELICINVPLAT",t}if(this.isExp()){let t=new Error;return t.code="ELICEXP",t}return null}isToolAllowed(e){return this._includesFeature(e)}isWhiteLabel(){return this._includesFeature("whitelabel",new Xi("2.4",!0))}areCustomAssetsAllowed(){return this._includesFeature("customassets",new Xi("2.4",!0))}t(){if(this._decLic.enterprise_license||this._includesFeature("noexporttracking",new Xi("2.4",!0)))return Promise.resolve();let e=this._decLic[Pe(gv)][0]+Pe(Pe(fv))+this._decLic[Pe(yv)];return new dt(e).load().catch(()=>{})}isENT(){return this._decLic?this._decLic[Pe(pv)]:!1}_sigValid(){return this._verify(this._message,this._sig)}exp(){return!!this._decLic[Pe(zl)]}dl(){return Math.ceil((this._expAt()-Date.now())/(60*60*24*1e3))}isExp(e=Date.now()){return this._decLic[Pe(zl)]===null?!1:e>this._expAt()}_expAt(){return this._decLic[Pe(zl)]*1e3}_verify(e,t){let i,r;return r=this._encodeMessage(e),i=this._decodeSignature(t),i=i.substr(-64),r===i}_encodeMessage(e){return $d(e)}_decodeSignature(e){let t;return e=kt.decode(e),e=mv(e),e=this._parseBigInt(e,16),t=e.modPowInt(this._e,this._n),t=t.toString(16),t}_parseBigInt(e,t){return new Zd(e,t)}_parseLicense(){typeof this._l=="string"&&(!this._jsonValid()||(this._sig=this._decLic[Pe(Nl)]||"",delete this._decLic[Pe(Nl)],this._sig=this._sig.replace(/[^A-Za-z0-9+/=]/g,""),this._message=this._l.replace(new RegExp(`,"${Pe(Nl)}":"([^"]*)"`),"")))}_includesFeature(e,t=new Xi("1.0",!0)){let i=new Xi(this._decLic[Pe(xv)],!0);return t.isMoreRecentThan(i)?!0:this._decLic[Pe(rm)]&&this._decLic[Pe(rm)].indexOf(e)!==-1}},Ul=class{v(){return!0}c(){return Promise.resolve()}isToolAllowed(e){return!0}isWhiteLabel(){return!1}areCustomAssetsAllowed(){return!0}t(){return Promise.resolve()}isENT(){return!1}exp(){return!1}dl(){return 0}isExp(e=Date.now()){return!1}},nn=sm});var Yi,ei,xi,om,an,nm=_(()=>{Yi=typeof window=="undefined"?global:window,ei=Yi.requestAnimationFrame,xi=Yi.cancelAnimationFrame,om=0,an=["ms","moz","webkit","o"];for(let o=0;o<an.length&&!ei;++o)ei=Yi[`${an[o]}RequestAnimationFrame`],xi=Yi[`${an[o]}CancelAnimationFrame`]||Yi[`${an[o]}CancelRequestAnimationFrame`];ei&&(ei=ei.bind(Yi));xi&&(xi=xi.bind(Yi));ei||(ei=function(o,e){let t=new Date().getTime(),i=Math.max(0,16-(t-om)),r=setTimeout(function(){o(t+i)},i);return om=t+i,r});xi||(xi=function(o){clearTimeout(o)})});var am,Wl,lm=_(()=>{ut();Jt();am=class{constructor(e=new A(0,0),t=new A(1,1),i=new A(2,-1),r=new A(2,0)){this._p0=e.clone(),this._p1=t.clone(),this._p2=i.clone(),this._p3=r.clone(),this._segments=[],this._length=-1,this._sample=[]}set(e=new A(0,0),t=new A(1,1),i=new A(2,1),r=new A(2,0)){this._p0=e.clone(),this._p1=t.clone(),this._p2=i.clone(),this._p3=r.clone()}getLength(){return this._length}calculateSegments(e=100){let t=0,i=0,r=[],s=1/e,n=this._p0.clone();for(let a=1;a<=e;a++){let l=[];l.push({t,s:i,point:n}),t+=s,t=Math.min(t,1);let h=this.evalAt(t);i+=h.clone().subtract(n).len(),l.push({t,s:i,point:h}),r.push(l),n=h}return this._segments=r,this._length=i,i}evalAt(e){e=this.normalizeParameter(e);let t=this._p0.clone().multiply((1-e)**3),i=this._p1.clone().multiply(3*(1-e)*(1-e)*e),r=this._p2.clone().multiply(3*(1-e)*e*e),s=this._p3.clone().multiply(e*e*e);return t.add(i).add(r).add(s)}isInSegment(e,t){return e=this.normalizeArcLength(e),e>=t[0].s&&e<=t[1].s}getArcLengthSegment(e){e=this.normalizeArcLength(e);for(let t=0;t<this._segments.length;t++){let i=this._segments[t];if(this.isInSegment(e,i))return i}return null}normalizeArcLength(e){return Math.max(Math.min(this._length,e),0)}normalizeParameter(e){return Math.max(Math.min(1,e),0)}getParameterForArcLength(e){let t=this.normalizeArcLength(e),i=this.getArcLengthSegment(t);if(!i)return I.warn("CubicBezierCurve#getParameterForArcLength","Segment not found."),-1;let r=(t-i[1].s)/(i[0].s-i[1].s);return r*i[0].t+(1-r)*i[1].t}evalAtArcLength(e){return this.evalAt(this.getParameterForArcLength(e))}approximateAtArcLength(e){let t=this.normalizeArcLength(e),i=this.getArcLengthSegment(t);if(!i)return-1;let r=(t-i[1].s)/(i[0].s-i[1].s);return i[0].point.clone().multiply(r).add(i[1].point.clone().multiply(1-r))}parameterSample(e=100){let t=1/e,i=[],r=0;for(let s=0;s<=e+1;s++)i.push(this.evalAt(r)),r+=t;return this._sample=i,[...i]}arcLengthApproxSample(e=100,t=!1,i=!1){let r=this._length/e,s=[],n=0;for(let a=t?1:0;a<e+1;a++)s.push(this.approximateAtArcLength(n)),n+=r;return i&&s.pop(),this._sample=s,[...s]}},Wl=am});var hm,Vl,cm=_(()=>{hm=class{constructor(e,t){this.min=e,this.max=t}getMin(){return this.min}getMax(){return this.max}getLength(){return this.max-this.min}contains(e){return this.min<=e&&e<=this.max}},Vl=hm});var Qe,Hl,um=_(()=>{Qe=class{constructor(e,t,i){this.x=e,this.y=t,this.z=i,typeof this.x=="undefined"&&(this.x=0),typeof this.y=="undefined"&&(this.y=0),typeof this.z=="undefined"&&(this.z=0)}set(e,t,i){return this.x=e,this.y=t,this.z=i,this}clone(){return new Qe(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}clamp(e,t){let i=e!==null&&typeof e!="undefined",r=t!==null&&typeof t!="undefined";return!(e instanceof Qe)&&i&&(e=new Qe(e,e,e)),!(t instanceof Qe)&&r&&(t=new Qe(t,t,t)),i&&(this.x=Math.max(e.x,this.x),this.y=Math.max(e.y,this.y),this.z=Math.max(e.z,this.z)),r&&(this.x=Math.min(t.x,this.x),this.y=Math.min(t.y,this.y),this.z=Math.min(t.z,this.z)),this}divide(e){return e instanceof Qe?(this.x/=e.x,this.y/=e.y,this.z/=e.z):(this.x/=e,this.y/=e,this.z/=e),this}subtract(e){return e instanceof Qe?(this.x-=e.x,this.y-=e.y,this.z-=e.z):(this.x-=e,this.y-=e,this.z-=e),this}multiply(e){return e instanceof Qe?(this.x*=e.x,this.y*=e.y,this.z*=e.z):(this.x*=e,this.y*=e,this.z*=e),this}add(e){return e instanceof Qe?(this.x+=e.x,this.y+=e.y,this.z+=e.z):(this.x+=e,this.y+=e,this.z+=e),this}equals(e){return e instanceof Qe?e.x===this.x&&e.y===this.y&&e.z===this.z:e===this.x&&e===this.y&&e===this.z}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}fract(){return this.x%=1,this.y%=1,this.z%=1,this}toInt(){return this.x|=0,this.y|=0,this.z|=0,this}abs(){return this.x=Math.abs(this.x),this.y=Math.abs(this.y),this.z=Math.abs(this.z),this}len(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}min(){return Math.min(Math.min(this.x,this.y),this.z)}max(){return Math.max(Math.max(this.x,this.y),this.z)}toObject(){return{x:this.x,y:this.y,z:this.z}}toString(){return`Vector3({ x: ${this.x}, y: ${this.y}, z: ${this.z} })`}roundDecimal(e){return this.x=parseFloat(this.x.toFixed(e)),this.y=parseFloat(this.y.toFixed(e)),this.z=parseFloat(this.z.toFixed(e)),this}static fromObject(e){return new Qe(e.x,e.y,e.z)}static get NULL(){return new Qe(0,0,0)}},Hl=Qe});var B={};Te(B,{ColorMatrix:()=>Xs,CubicBezierCurve:()=>Wl,Matrix:()=>it,Range:()=>Vl,Rectangle:()=>ue,Vector2:()=>A,Vector3:()=>Hl});var jl=_(()=>{_l();lm();fl();cm();pl();Jt();um()});var so={};Te(so,{Base64:()=>kt,Color:()=>S,ColorMatrix:()=>Xs,Configurable:()=>V,Constants:()=>tt,CubicBezierCurve:()=>Wl,Engine:()=>R,EventEmitter:()=>Ke,Events:()=>ns,FreeLicenseChecker:()=>Ul,GLUtils:()=>Gi,LicenseChecker:()=>nn,Log:()=>I,Matrix:()=>it,Range:()=>Vl,Rectangle:()=>ue,Utils:()=>k,Vector2:()=>A,Vector3:()=>Hl,cancelAnimationFrame:()=>xi,requestAnimationFrame:()=>ei});var Ki=_(()=>{ut();as();ct();oo();Vr();Ui();$r();Jr();ml();Gl();Dt();nm();jl()});var ql,dm=_(()=>{Zo();Xl();Pl();Ki();ql=class{constructor(){this._container=new Pt;this._sprite=new no;this._container.addChild(this._sprite)}render(e,t,i){let r=i.getDimensions(),s=this._getNextHighestPOT(r);this._renderTexture?this._renderTexture.resizeTo(s):this._renderTexture=new io(e,s.x,s.y);let n=this._renderTexture.getDimensions();this._sprite.setTexture(i),this._sprite.updateTransform(),this._renderTexture.clear(),this._renderTexture.render(this._container),this._updateSprite(e,t,r,n)}_updateSprite(e,t,i,r){t.setTexture(this._renderTexture),this._renderTexture.setFrame(new ue(0,0,i.x,i.y))}_getNextHighestPOT(e){return new A(k.nextHighestPOT(e.x),k.nextHighestPOT(e.y))}getRenderTexture(){return this._renderTexture}dispose(){!this._renderTexture||(this._renderTexture.dispose(),delete this._renderTexture)}}});var no,Xl=_(()=>{dm();Zo();Re();no=class extends Pt{constructor(e){super();this._shader=null;this._width=0;this._height=0;this._anchor=new A(0,0);this._canvasSmoothingEnabled=!0;this._smoothDownscaling=!1;this._onTextureUpdate=this._onTextureUpdate.bind(this),this.setTexture(e)}_onTextureUpdate(){this._boundsNeedUpdate=!0,this._localBoundsNeedUpdate=!0}_renderWebGL(e){let t=e.save();this._smoothDownscaling&&(this._potRenderer||(this._potRenderer=new ql),this._texture&&this._potRenderer.render(e,this,this._texture)),e.restore(t),e.setObjectRenderer(e.renderers.sprite),e.renderers.sprite.render(this)}_renderCanvas(e){if(!this._texture)return;let t=this._worldTransform,i=this._texture.getFrame(),{width:r,height:s}=i,n=e.getCurrentRenderTarget().getPixelRatio(),a=this._anchor.x*-r|0,l=this._anchor.y*-s|0,h=e.getContext();if(h.setTransform(t.a,t.b,t.c,t.d,t.tx*n,t.ty*n),h.globalAlpha=this.getWorldAlpha(),!this._texture)return;let c=this._texture.getBaseTexture(),m=c.getPixelRatio(),d=c.getSource();h.imageSmoothingEnabled=this._canvasSmoothingEnabled,"beforeDraw"in e&&e.beforeDraw(h),h.drawImage(d,0,0,(d.naturalWidth||r)*m,(d.naturalHeight||s)*m,a*n,l*n,r*n,s*n)}isAtPosition(e){if(!this._texture)return;let t=this._worldTransform.applyInverseToVector(e),i=this._texture.getFrame(),{width:r,height:s}=i,n=new A(-r,-s);n.multiply(this._anchor);let a=n.clone().add(r,s);return!(t.x<n.x||t.x>a.x||t.y<n.y||t.y>a.y)}getLocalBounds(){if(this._localBoundsNeedUpdate&&this._texture){let e=this._localBounds,t=this._texture.getFrame();e.x=-t.width*this._anchor.x,e.y=-t.height*this._anchor.y,e.width=t.width,e.height=t.height,this._localBoundsNeedUpdate=!1}return this._localBounds.clone()}getBounds(){if(this._boundsNeedUpdate&&this._texture){let e=this._bounds,t=this._texture.getFrame(),i=this._worldTransform,r=this._anchor,s=i.rectangleToCoordinates(t,r),n=s[0].x,a=s[0].y,l=n,h=a;s.forEach(({x:c,y:m})=>{n=Math.min(n,c),a=Math.min(a,m),l=Math.max(l,c),h=Math.max(h,m)}),e.x=n,e.width=Math.abs(l-n),e.y=a,e.height=Math.abs(h-a),this._boundsNeedUpdate=!1}return this._bounds.clone()}getTexture(){return this._texture}clearTexture(e=!0){!this._texture||(this._texture.off("update",this._onTextureUpdate),e&&this._texture.dispose(),this._texture=null,this._potRenderer&&(e&&this._potRenderer.dispose(),delete this._potRenderer))}setTexture(e){!e||(this._texture&&this._texture.off("update",this._onTextureUpdate),this._potRenderer&&this._potRenderer.getRenderTexture().getBaseTexture().setDirty(!0),this._texture=e,e.getBaseTexture().isLoaded()&&this._onTextureUpdate(),e.on("update",this._onTextureUpdate))}getShader(){return this._shader}setShader(e){this._shader=e}getWidth(){return this._width}setWidth(e){!this._texture||(this._scale.x=e/this._texture.getFrame().width,this._width=e,this._boundsNeedUpdate=!0,this._localBoundsNeedUpdate=!0)}getHeight(){return this._height}setHeight(e){!this._texture||(this._scale.y=e/this._texture.getFrame().height,this._height=e,this._boundsNeedUpdate=!0,this._localBoundsNeedUpdate=!0)}getDimensions(){return new A(this._width,this._height)}getAnchor(){return this._anchor}setAnchor(e,t){this._anchor.set(e,t),this._boundsNeedUpdate=!0,this._localBoundsNeedUpdate=!0}isSmoothDownscaling(){return this._smoothDownscaling}setSmoothDownscaling(e){this._smoothDownscaling=e}dispose(e=!1,t=!1){this._texture&&this._texture.off("update",this._onTextureUpdate),(e||t)&&this._texture&&this._texture.dispose(t),this._potRenderer&&this._potRenderer.dispose()}}});var bv,R,oo=_(()=>{Zo();Rl();es();$o();Ad();Wd();Xl();rs();Pl();Dl();Ks();el();Bt();Qs();bv={CanvasFilterManager:Hi,Container:Pt,BaseTexture:ve,Texture:_i,RenderTexture:io,WebGLRenderTarget:$t,CanvasRenderTarget:Qt,Sprite:no,Filter:Ot,Filters:Tl,PixelArrayImage:ui,autoDetectRenderer(o,e,t={}){return Ie.isSupported()?new rn(o,e,t):new os(o,e,t)},canvasRenderer(o,e,t={}){return new os(o,e,t)}},R=bv});var mm,fm,pm=_(()=>{mm=class{static current(){return process.env.ENV}static isTest(){return process.env.ENV==="test"}static isDevelopment(){return process.env.ENV==="development"}static isProduction(){return process.env.ENV==="production"||!this.isTest()&&!this.isDevelopment()}},fm=mm});var _m,Ji,ln=_(()=>{_m=class{constructor(e){this._head=0,this._buf=e}peekInt8(){return this._buf[this._head]}peekInt16(e=!1){let t=this._buf[this._head],i=this._buf[this._head+1];return e?(i<<8)+t:(t<<8)+i}peekInt24(e=!1){let t=this._buf[this._head],i=this._buf[this._head+1],r=this._buf[this._head+2];return e?(r<<16)+(i<<8)+t:(t<<16)+(i<<8)+r}peekInt32(e=!1){let t=this._buf[this._head],i=this._buf[this._head+1],r=this._buf[this._head+2],s=this._buf[this._head+3];return e?(s<<32)+(r<<16)+(i<<8)+t:(t<<32)+(i<<16)+(r<<8)+s}writeInt8(e){this._buf[this._head]=e&255}writeInt16(e){this._buf[this._head]=e>>8,this._buf[this._head+1]=e&255}readInt8(){let e=this.peekInt8();return this._head+=1,e}readInt16(e=!1){let t=this.peekInt16(e);return this._head+=2,t}readInt24(e=!1){let t=this.peekInt24(e);return this._head+=3,t}readInt32(e=!1){let t=this.peekInt32(e);return this._head+=4,t}readString(e){let t="";for(let i=0;i<e;i++){let r=this.readInt8();t+=String.fromCharCode(r)}return t}getHead(){return this._head}setHead(e){this._head=e}},Ji=_m});var vv,wv,cs,hn=_(()=>{vv={SOI:65496,SOS:65498,APP0:65504,APP1:65505,JFIF:65504,EXIF:65505},wv={256:"ImageWidth",257:"ImageHeight",34665:"ExifIFDPointer",34853:"GPSInfoIFDPointer",40965:"InteroperabilityIFDPointer",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",274:"Orientation",277:"SamplesPerPixel",284:"PlanarConfiguration",530:"YCbCrSubSampling",531:"YCbCrPositioning",282:"XResolution",283:"YResolution",296:"ResolutionUnit",273:"StripOffsets",278:"RowsPerStrip",279:"StripByteCounts",513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength",301:"TransferFunction",318:"WhitePoint",319:"PrimaryChromaticities",529:"YCbCrCoefficients",532:"ReferenceBlackWhite",306:"DateTime",270:"ImageDescription",271:"Make",272:"Model",305:"Software",315:"Artist",33432:"Copyright"},cs={MARKERS:vv,EXIF_TAGS:wv}});var Yl,Tv,gm,ym,xm,bm=_(()=>{ln();Dt();hn();({invariant:Yl}=k),{MARKERS:Tv,EXIF_TAGS:gm}=cs,ym=class{constructor(e){this._buf=e,this._stream=new Ji(this._buf),this._stream.setHead(0),this._parse(),this._bigEndian=!1}isValid(){return this._stream.setHead(0),!(this._stream.readInt16()!==Tv.EXIF||!(this._stream.readInt16()>0)||this._stream.readString(4)!=="Exif")}_parse(){if(!this.isValid())return;this._stream.setHead(10);let e=this._stream.getHead();this._bigEndian=!1;let t=this._stream.readInt16();t===18761?this._bigEndian=!1:t===19789?this._bigEndian=!0:Yl(!1,"Invalid TIFF data: No endian type found"),Yl(this._stream.readInt16(!this._bigEndian)===42,"Invalid TIFF data: No 0x002A");let i=this._stream.readInt32(!this._bigEndian);Yl(i>=8,"Invalid TIFF data: First IFD offset < 8");let r=e+i,s=this._readTags(this._stream,e,r,this._bigEndian);this._tags=s.tags,this._tagData=s.tagData}getTags(){return this._tags}getTagData(){return this._tagData}setOrientation(e){if(this._tagData.Orientation){let{entryOffset:t}=this._tagData.Orientation;this._stream.setHead(t+8),this._stream.writeInt16(this._bigEndian?e:(e&255)<<8|e>>8&255)}}_readTags(e,t,i,r){e.setHead(i);let s=e.readInt16(!r),n={},a=[];for(let l=0;l<s;l++){let h=i+l*12+2;e.setHead(h);let c=e.readInt16(!r),m,d,u;if(gm[c]){c=gm[c],m=e.readInt16(!r),d=e.readInt32(!r),u=e.readInt32(!r)+t;let f=null;switch(m){case 1:case 7:if(d===1)f=e.readInt8(!r);else{f=[];for(let y=0;y<d;y++)f.push(e.readInt8(!r))}break;case 2:e.setHead(d>4?u:h+8),f=e.readString(d);break;case 3:if(e.setHead(d>2?u:h+8),d===1)f=e.readInt16(!r);else{f=[];for(let y=0;y<d;y++)f.push(e.readInt16(!r))}break;case 4:case 9:if(e.setHead(d>1?u:h+8),d===1)f=e.readInt32(!r);else{f=[];for(let y=0;y<d;y++)f.push(e.readInt32(!r))}break;case 5:case 10:if(e.setHead(u),d===1){let y=e.readInt32(!r),g=e.readInt32(!r);f=y/g}else{f=[];for(let y=0;y<d;y++){let g=e.readInt32(!r),p=e.readInt32(!r),v=g/p;f.push(v)}}break}n[c]=f,a[c]={value:f,numValues:d,entryOffset:h,valueOffset:u,type:m}}}return{tags:n,tagData:a}}getBuffer(){return this._buf}},xm=ym});var Rv,vm,Kl,wm=_(()=>{ln();hn();({MARKERS:Rv}=cs),vm=class{constructor(e){this._buf=e,this._stream=new Ji(this._buf),this._stream.setHead(0)}isValid(){if(this._stream.setHead(0),this._stream.readInt16()!==Rv.APP0||!(this._stream.readInt16()>=16))return!1;let i=this._stream.readString(4),r=this._stream.readInt8();return!(i!=="JFIF"||r!==0)}setUnitDensity(e){this._stream.setHead(11),this._stream.writeInt8(e)}setDensityX(e){this._stream.setHead(12),this._stream.writeInt16(e)}setDensityY(e){this._stream.setHead(14),this._stream.writeInt16(e)}getUnitDensity(){return this._stream.setHead(11),this._stream.readInt8()}getDensityX(){return this._stream.setHead(12),this._stream.readInt16()}getDensityY(){return this._stream.setHead(14),this._stream.readInt16()}getBuffer(){return this._buf}},Kl=vm});var GC,ao,cn,Cv,zt,lo,Jl=_(()=>{ln();Vr();hn();bm();wm();Dt();({invariant:GC}=k),{MARKERS:ao}=cs,cn="data:image/jpeg;base64,",Cv=new RegExp(`^${cn}`,"i"),zt=class{constructor(e){this._buf=e,this._stream=new Ji(this._buf),this._stream.setHead(0),this._segments=this._sliceIntoSegments(this._buf),this._exifData=new xm(this._getMarkerBuffer(ao.EXIF)),this._jfifData=new Kl(this._getMarkerBuffer(ao.JFIF))}static toDataURL(e){return cn+kt.encode(e)}static fromDataURL(e){let t=e.replace(cn,"");return kt.decode(t)}restoreSegmentsInArray(e){return e=this.restoreExifTagsToImageData(e),this.restoreJfifSegmentToImageData(e)}restoreSegments(e){let t=zt.fromDataURL(e);return t=this.restoreSegmentsInArray(t),zt.toDataURL(t)}restoreExifTagsToImageData(e){if(!this._exifData.isValid())return e;let i=this._sliceIntoSegments(e)[1][0],r=e.slice(0,i),s=e.slice(i),n=r.concat(this._exifData.getBuffer());return n=n.concat(s),n}restoreJfifSegmentToImageData(e){if(!this._jfifData.isValid())return e;let t=this._sliceIntoSegments(e),i=this._findSegment(ao.JFIF,t),r=[];if(i){let s=i[0],n=i[1],a=e.slice(0,s),l=e.slice(s,n),h=e.slice(n),c=new Kl(l);c.setDensityX(this._jfifData.getDensityX()),c.setDensityY(this._jfifData.getDensityY()),c.setUnitDensity(this._jfifData.getUnitDensity()),r=a.concat(l).concat(h)}else return e;return r}restoreExifTags(e){let t=zt.fromDataURL(e),i=this.restoreExifTagsToImageData(t);return zt.toDataURL(i)}restoreJfifSegment(e){if(!this._jfifData.isValid())return e;let t=zt.fromDataURL(e),i=this.restoreJfifSegmentToImageData(t);return zt.toDataURL(i)}setOrientation(e){return this._exifData.setOrientation(e)}static isJPEG(e){return Cv.test(e)}static bufferIsJPEG(e){return e[0]===255&&e[1]===216&&e[2]===255}static fromBase64String(e){let t=e.replace(cn,""),i=kt.decode(t);return new zt(i)}_findSegment(e,t=this._segments){for(let i=0;i<t.length;i++){let r=t[i][0],s=t[i][1];if(this._stream.setHead(r),this._stream.peekInt16()===e)return[r,s]}return!1}_getLastSegment(e=this._segments){return e[e.length-1]}_getMarkerBuffer(e,t=this._segments){let i=this._findSegment(e,t);if(i){let r=i[0],s=i[1];return this._buf.slice(r,s)}return!1}_sliceIntoSegments(e){let t=new Ji(e),i=[];for(;t.getHead()<e.length;){let r=t.readInt16();if(r!==ao.SOI){if(r===ao.SOS)break;if(r>=65280&&r<=65535){let s=t.readInt16(),n=t.getHead()+s-2;i.push([t.getHead()-4,n]),t.setHead(n)}else throw new Error(`Invalid marker: 0x${r.toString(16)}`)}}return this._stream.setHead(0),i}getTags(){return this._exifData.getTags()}getTagData(){return this._exifData.getTagData()}dispose(){this._buf=[],this._segments=[]}},lo=zt});var Tm,Ge,un=_(()=>{Tm=require("canvas").Image;Ge=Tm});var dn,mn,Zl=_(()=>{Ki();Jr();dn=class extends Ke{constructor(e=[]){super();this._onOperationUpdate=this._onOperationUpdate.bind(this),this._cacheEnabled=!0,this._stack=e,this._stack.forEach(t=>{t.on("update",this._onOperationUpdate)})}clear(){this.forEach(e=>this.remove(e)),this._stack=[]}hasChanges(){return this._stack.filter(e=>!!e).some(e=>e.hasChanges())}_onOperationUpdate(e,t){this.emit(ns.OPERATION_UPDATED,e,t)}enableCache(){this._cacheEnabled=!0}disableCache(){this._cacheEnabled=!1}forEach(e){return this._stack.filter(t=>!!t).forEach(e)}render(e,t){let i=t,r=this._stack.filter(h=>!!h).filter(h=>h.getEnabled());r.reverse();let s=r.filter(h=>!h.isDirtyForRenderer(e.getRenderer()))[0],n=r.indexOf(s);r.reverse();let a=0;n!==-1&&(a=r.length-n-1);for(let h=0;h<a;h++)I.info(this.constructor.name,`Skipping ${r[h].constructor.name}`);let l=Promise.resolve(i);for(let h=a;h<r.length;h++){let c=r[h],m,d;l=l.then(u=>c.render(u).then(f=>(m&&f!==m&&!this._cacheEnabled&&d.disposeRenderTextures(),m=f,d=c,f)))}return l.then(h=>{let c=!r.some(m=>m.isDirtyForRenderer(e.getRenderer()));return{outputTexture:h,renderDone:c}})}validateSettings(){return Promise.all(this._stack.filter(e=>!!e).map(e=>e.validateSettings()))}setAllToDirty(e=!1){this.forEach(t=>t.setDirty(!0,e))}updateDirtinessForRenderer(e){let t=!1;for(let i=0;i<this._stack.length;i++){let r=this._stack[i];!r||(r.isDirtyForRenderer(e)&&(t=!0),t&&r.setDirtyForRenderer(!0,e))}}push(e){this._stack.push(e),e.on("update",this._onOperationUpdate)}pop(){let e=this._stack.pop();e&&(e.off("update",this._onOperationUpdate),e.dispose())}unshift(e){this._stack.unshift(e),e.on("update",this._onOperationUpdate)}clone(){return new dn(this._stack.slice(0))}get(e){return this._stack[e]}getByIdentifier(e){return k.Array.find(this._stack,t=>t&&t.constructor.identifier===e)}getIndexByIdentifier(e){return k.Array.findIndex(this._stack,t=>t&&t.constructor.identifier===e)}moveToTop(e){let t=k.Array.findIndex(this._stack,r=>r&&r.constructor.identifier===e);if(t<0||t===this._stack.length-1)return;let i=this.getByIdentifier(e);this._stack.splice(t,1),this._stack[this._stack.length]=i}set(e,t){this._stack[e]&&(this._stack[e].off("update",this._onOperationUpdate),this._stack[e].dispose()),this._stack[e]=t,t.on("update",this._onOperationUpdate)}remove(e){let t=this._stack.indexOf(e);t!==-1&&(this._stack[t]&&(this._stack[t].off("update",this._onOperationUpdate),this._stack[t].dispose()),this._stack.splice(t,1))}removeAt(e){this._stack[e]&&(this._stack[e].off("update",this._onOperationUpdate),this._stack[e].dispose()),delete this._stack[e]}getStack(){return this._stack}dispose(){this.forEach(e=>{e.dispose()})}},mn=dn});var Rm,Cm,fn,Ql=_(()=>{Ki();Rm=typeof window!="undefined"&&window.performance&&window.performance.now?window.performance.now.bind(window.performance):ss(),Cm=class{constructor(e,t){this._tag=e,this._name=t,this._start=Rm()}stop(){let t=Rm()-this._start,i=Math.round(1e3/t);I.info(this._tag,`${this._name} took ${t.toFixed(2)}ms (${i} FPS)`)}},fn=Cm});var $l,te,eh=_(()=>{ut();ct();oo();$r();Ql();$l=class extends V{constructor(e,t={}){super(t,{enabled:{type:"boolean",default:!0,serializable:!1}});this._sdk=e,this._cacheEnabled=!1,this._dirtiness={},this._sprite=new R.Sprite,this._container=new R.Container,this._container.addChild(this._sprite)}_onOptionsChange(){this.setDirty(!0)}render(e){if(!this.getEnabled())return I.info(this.constructor.name,"Disabled - skipping"),Promise.resolve(e);if(!this._renderTexture){let s=e.getDimensions().floor();this._renderTexture=new R.RenderTexture(this._sdk.getRenderer(),s.x,s.y)}let t=this._sdk.getRenderer(),i,r;if(I.canLog("info")&&(r=new fn(this.constructor.name,"Rendering")),this.isDirtyForRenderer(t)){this._sprite.setTexture(e);let s=this.getNewDimensions(e.getDimensions()).floor();this._renderTexture.resizeTo(s),this._renderTexture.clear(),i=this._render(e).then((n=!1)=>(this.setDirtyForRenderer(n,t),this._renderTexture))}else I.info(this.constructor.name,"Rendering from cache"),i=Promise.resolve(this._renderTexture);return i.then(s=>(r&&r.stop(),s))}_render(e){let t;return this._sdk.getRenderer().isOfType("webgl")?t=this._renderWebGL.bind(this):t=this._renderCanvas.bind(this),t(e)}_renderWebGL(e){throw new Error("Operation#_renderWebGL is abstract and not implemented in inherited class.")}_renderCanvas(e){throw new Error("Operation#_renderCanvas is abstract and not implemented in inherited class.")}getNewDimensions(e){return e.clone()}onBeforeExport(){this.transform&&this._tempTransformChange&&this.transform(this._tempTransformChange),this._onBeforeExport()}onAfterExport(){this.transform&&this._tempInverseTransformChange&&this.transform(this._tempInverseTransformChange),this._onAfterExport()}_onBeforeExport(){}_onAfterExport(){}setTemporaryTransformChange(e,t){this._tempTransformChange=e,this._tempInverseTransformChange=t}reset(){this._dirty=!0,this._glslPrograms={}}isDirtyForRenderer(e){let t=this._dirtiness[e.id];return typeof t=="undefined"?!0:t}setDirtyForRenderer(e,t,i=!1){this._dirtiness[t.id]=e}setDirty(e,t=!1){for(let i in this._dirtiness)this.setDirtyForRenderer(e,{id:i},t)}getSDK(){return this._sdk}getInputDimensions(e=!0){let t=this._sdk.getInputDimensions();e&&t.multiply(this._sdk.getZoom()).floor();let i;return this._sdk.getOperationsStack().forEach(r=>{if(!i){if(r===this){i=!0;return}t=r.getNewDimensions(t)}}),t.floor()}clone(){let e=this.constructor;return new e(this._sdk,this.serializeOptions())}disposeRenderTextures(){this._renderTexture&&this._renderTexture.dispose(),this._renderTexture=null}dispose(){this.disposeRenderTextures(),this._sprite.dispose()}};$l.identifier=null;te=$l});var kv,pn,km,Sm=_(()=>{Ki();Jt();eh();({OptionType:kv}=tt),pn=class extends te{getRotation(){let e=0;switch(this.getTags().Orientation){case 7:case 8:e=-90;break;case 3:case 4:e=-180;break;case 5:case 6:e=90;break}return e}_getFlipVertically(){let{Orientation:e}=this.getTags();return[5,7].indexOf(e)!==-1}_getFlipHorizontally(){let{Orientation:e}=this.getTags();return[2,4].indexOf(e)!==-1}_getFinalOptions(){return{rotation:this.getRotation(),flipVertically:this._getFlipVertically(),flipHorizontally:this._getFlipHorizontally()}}_render(e){let t=this._getFinalOptions(),r=t.rotation%360*(Math.PI/180);this._sprite.setScale(t.flipHorizontally?-1:1,t.flipVertically?-1:1),this._sprite.setRotation(r),this._sprite.setAnchor(.5,.5),this._sprite.updateTransform();let s=this._sprite.getBounds();return this._renderTexture.resizeTo(new A(s.width,s.height)),this._sprite.setPosition(this._renderTexture.getDimensions().divide(2)),this._renderTexture.render(this._container),Promise.resolve()}getNewDimensions(e){let t=this._getFinalOptions();return e=e.clone(),t.rotation%180&&e.flip(),e}applyTo(e){let t=this._getFinalOptions(),i=k.createCanvas();Math.abs(t.rotation%180)===90?(i.width=e.height,i.height=e.width):(i.width=e.width,i.height=e.height);let r=i.getContext("2d"),s=t.rotation*Math.PI/180,n=.5*(i.width-e.width),a=.5*(i.height-e.height);return r.translate(n,a),r.translate(.5*e.width,.5*e.height),r.rotate(s),r.translate(-.5*e.width,-.5*e.height),t.flipVertically&&(r.translate(0,e.height),r.scale(1,-1)),t.flipHorizontally&&(r.translate(e.width,0),r.scale(-1,1)),r.drawImage(e,0,0),i}};pn.identifier="exif-orientation";pn.prototype.availableOptions={tags:{type:kv.OBJECT,default:{}}};km=pn});var us={};Te(us,{ExifOrientationOperation:()=>km});var th=_(()=>{Sm()});var ih,Om,Fm=_(()=>{Kt();ct();oo();Ui();$r();un();Dt();ih=class extends V{constructor(e,t={}){super(t);this._sdk=e}export(){let{imageFormat:e,transparent:t}=this._options,i=r=>r.renderDone?r:this._sdk.render().then(s=>i(s));return this.validateSettings().then(()=>this._prepareSDK().then(r=>i(r))).then(r=>{let{outputTexture:s,renderDone:n}=r,a=this._sdk.getRenderer(),l=a.getClearColor();e==="image/png"&&t&&a.setClearColor(new S(0,0,0,0));let h=a.getCanvas();return a.isOfType("webgl")&&(h=this._createCanvasFromTexture(s)),a.setClearColor(l),this._encodeImageFormat(h)}).then(r=>this._restoreExifMetadata(r,e)).then(r=>this._restoreSDK().then(()=>r))}_restoreExifMetadata(e,t,i){if(t===Mt.JPEG){let r=this._sdk.getExif();if(r){let{renderType:s}=this._options;s===qe.BUFFER?e=Buffer.from(r.restoreSegmentsInArray([...e])):s===qe.DATAURL&&typeof e=="string"&&(e=r.restoreSegments(e))}}return Promise.resolve(e)}_encodeAsDataURL(e,t,i){if(k.isBrowser){let r=e.toDataURL(t,i);return Ce(e),Promise.resolve(r)}try{let r=e.toDataURL(t,i);return Ce(e),Promise.resolve(r)}catch(r){return Promise.error(r)}}_encodeAsHTMLImage(e,t,i){return this._encodeAsDataURL(e,t,i).then(r=>{let s=new Ge;return s.src=r,Ce(e),Promise.resolve(s)})}_encodeAsBuffer(e,t,i){if(t===Mt.JPEG){let r=e.toBuffer(t,{quality:i,progressive:!0,chromaSubsampling:!1});return Ce(e),Promise.resolve(r)}if(t===Mt.PNG){let r=e.toBuffer(t,{quality:i});return Ce(e),Promise.resolve(r)}if(t===Mt.RAW){let r=e.toBuffer(t);return Ce(r),Promise.resolve(r)}return Promise.reject(new Error(`Unsupported imageFormat: ${t}`))}_encodeAsMSBlob(e,t,i){let r=e.msToBlob();return Ce(e),Promise.resolve(r)}_encodeAsBLOB(e,t,i){return new Promise((r,s)=>{e.toBlob(n=>{r(n)},t,i)})}_encodeImageFormat(e){let{imageFormat:t,quality:i}=this._options,{renderType:r}=this._options;switch(r===qe.BLOB&&e.msToBlob&&!e.toBlob&&(r=qe.MSBLOB),r){case qe.IMAGE:return this._encodeAsHTMLImage(e,t,i);case qe.DATAURL:return this._encodeAsDataURL(e,t,i);case qe.BUFFER:return this._encodeAsBuffer(e,t,i);case qe.MSBLOB:return this._encodeAsMSBlob(e,t,i);case qe.BLOB:return this._encodeAsBLOB(e,t,i)}return Promise.reject(new Error(`Unsupported RenderType: ${r}!`))}_prepareSDK(){let e=this._sdk.getRenderer();this._sdkSettings={dimensions:e.getDimensions().clone(),textureQuality:this._sdk.getTextureQuality(),rendererPixelRatio:e.getPixelRatio(),renderMode:this._sdk.getRenderMode()},this._sdk.setRenderMode("export"),this._sdk.setTextureQuality(1);let t=e.isOfType("canvas");e.setPixelRatio(1),e.resizeTo(this._sdk.getFinalDimensions(),t),this._sdk.setAllOperationsToDirty(!0);let i=this._sdk.getOperationsStack();return i.forEach(r=>{r.disposeRenderTextures()}),i.disableCache(),this._sdk.render()}_restoreSDK(){this._sdk.getOperationsStack().enableCache(),this._sdk.setRenderMode(this._sdkSettings.renderMode);let t=this._sdk.getRenderer(),i=t.isOfType("canvas");return t.setPixelRatio(this._sdkSettings.rendererPixelRatio),t.resizeTo(this._sdkSettings.dimensions,i),this._sdk.setTextureQuality(this._sdkSettings.textureQuality),this._sdk.setAllOperationsToDirty(!0),this._sdk.render()}_createCanvasFromTexture(e){let t=this._sdk.getRenderer(),i=this._sdk.getFinalDimensions(),r=this._sdk.getRenderer().getContext(),s=r.createFramebuffer();r.bindFramebuffer(r.FRAMEBUFFER,s);let n=e.getBaseTexture().getGLTextureForRenderer(t);r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,n,0);let a=new Uint8Array(i.x*i.y*4);r.readPixels(0,0,i.x,i.y,r.RGBA,r.UNSIGNED_BYTE,a);let l=this._checkPixelsForTransparency(a),h;if(l){let u=new R.Sprite(e);u.setFilters([new R.Filters.UnpremultiplyFilter]);let f=new R.Container;f.addChild(u),h=new R.RenderTexture(t,i.x,i.y),h.render(f);let y=h.getBaseTexture().getGLTextureForRenderer(t);r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,y,0),r.readPixels(0,0,i.x,i.y,r.RGBA,r.UNSIGNED_BYTE,a),t.setRenderTarget(),h.dispose()}let c=k.createCanvas();c.width=i.x,c.height=i.y;let m=c.getContext("2d"),d=m.createImageData(i.x,i.y);return d.data.set(a),m.putImageData(d,0,0),r.deleteFramebuffer(s),c}_checkPixelsForTransparency(e){let t=this._sdk.getFinalDimensions(),i=t.x*t.y*4,r;for(let s=3;s<i;s+=4)if(r=e[s],r!==255)return!0;return!1}};ih.prototype.availableOptions={renderType:{type:"string",available:k.values(qe),default:qe.IMAGE},imageFormat:{type:"string",available:k.values(Mt),default:Mt.PNG},quality:{type:"number",default:.8},transparent:{type:"boolean",default:!0}};Om=ih});var Sv,Ov,vt,Im,Fv,rh,sh,Nt,Ev,xk,pe,Iv,Mv,Em,Mm,ye,Bm=_(()=>{Ki();Jl();un();Fm();Zl();Ql();th();({Rectangle:Sv,Constants:Ov,Engine:vt,Utils:Im,EventEmitter:Fv,Events:rh,Vector2:sh,Log:Nt,Base64:Ev,Color:xk}=so),pe=o=>Im.byteArrayToString(Ev.decode(o)),{RenderType:Iv,ImageFormat:Mv,RendererType:Em}=Ov,Mm=class extends Fv{constructor(e,t={}){super();M(this,"_onContextLost",()=>{this.emit("context-lost")});M(this,"_initWatermark",()=>{this._options.watermark&&this._options.watermark.watermarkURI&&(this._watermarkOperation=this.createOperation("watermark",{watermarkURI:this._options.watermark.watermarkURI,alignment:this._options.watermark.alignment,inset:this._options.watermark.inset,size:this._options.watermark.size,crossOrigin:this._options.crossOrigin}))});if(this._onOperationUpdate=this._onOperationUpdate.bind(this),this._onContextRestored=this._onContextRestored.bind(this),this.version="4.26.1",this[pe("VG04Z1lHRndhVXRsZVdBZ2IzQjBhVzl1SUdkcGRtVnU=")]=!0,this._preferredRenderer=e,this._options=L(C({},t),{extensions:{},renderMode:"dynamic",versionCheck:!0,displayWelcomeMessage:!0,image:null,canvas:null,transparent:!1,textureQuality:1,zoom:1,spriteScale:1,rotation:0,smoothDownscaling:!1,smoothUpscaling:!1,crossOrigin:"anonymous",logLevel:"warn",pixelRatio:Math.max(typeof window!="undefined"&&window.devicePixelRatio||1,1)}),this._options.smoothUpscaling&&(vt.BaseTexture.DefaultMagFilter=vt.BaseTexture.LinearFilter),this._options.extensions=Object.assign(this._options.extensions,{operations:[],controls:[],languages:[]}),Nt.setLevel(this._options.logLevel),this[pe("Wm5KbFpVeHBZMlZ1YzAxdlpHVT0=")]=!1,!this[pe("X29wdGlvbnM=")][pe("bGljZW5zZQ==")])this[pe("Wm5KbFpVeHBZMlZ1YzAxdlpHVT0=")]=!0,this._l=new so[pe("RnJlZUxpY2Vuc2VDaGVja2Vy")];else{let r=so[pe("TGljZW5zZUNoZWNrZXI=")];this._l=new r(this[pe("X29wdGlvbnM=")][pe("bGljZW5zZQ==")]),this._cv(!0).then(()=>{this._ct()}).catch(s=>{Nt.error(pe("TGljZW5zaW5n"),s.message)})}this._defaultRenderMode=this._options.renderMode,this._renderMode=this._options.renderMode,this._textureQuality=this._options.textureQuality,this._offset=new sh,this._zoom=this._options.zoom,this._spriteScale=this._options.spriteScale,this._rotation=this._options.rotation,this._operations={},this._operationsStack=null,this.setOperationsStack(new mn),this._container=new vt.Container,this._sprite=new vt.Sprite,this._container.addChild(this._sprite),this._inputTexture=this._options.inputTexture,this._currentInputTexture=null,this._currentTexture=null,this._resizedTexture=null,this._resizedContainer=new vt.Container,this._resizedSprite=new vt.Sprite,this._resizedContainer.addChild(this._resizedSprite),this._texturesToDispose=[],this.setSmoothDownscaling(this._options.smoothDownscaling),this._registerOperations(),this._initRenderer();let i=this._renderer.constructor.type;this._options.displayWelcomeMessage&&Nt.log("Version:",`${this.version} (${i}) - https://img.ly/photo-sdk`),this[pe("Wm5KbFpVeHBZMlZ1YzAxdlpHVT0=")]&&Nt.log(pe("VGhlIFBob3RvRWRpdG9yIFNESyBpcyBhIGNvbW1lcmNpYWwgcHJvZHVjdC4gQmVmb3JlIGJlaW5nIGFibGUgdG8gdXNlIGl0IHdpdGhvdXQgbGltaXRhdGlvbnMsIHlvdSBuZWVkIHRvIHVubG9jayB0aGUgU0RLIHdpdGggYSBsaWNlbnNlIGZpbGUuIFlvdSBjYW4gb2J0YWluIGEgdGltZS1saW1pdGVkIGV2YWx1YXRpb24gbGljZW5zZSBieSBzdGFydGluZyBhIHRyaWFsIGF0IGh0dHBzOi8vd3d3LmltZy5seS9zaWdudXAgb3IgeW91IGNhbiBwdXJjaGFzZSBhIGxpY2Vuc2UgYnkgcmVxdWVzdGluZyBhIHF1b3RlIGF0IGh0dHBzOi8vd3d3LmltZy5seS9wcmljaW5nLgoKQmVjYXVzZSB5b3UgZGlkIG5vdCBzcGVjaWZ5IGEgbGljZW5zZSBmaWxlIHlldCwgdGhlIFNESyB3aWxsIG5vdyBkaXNwbGF5IGEgd2F0ZXJtYXJrIGltYWdlIG9uIHRvcCBvZiBhbnkgcGhvdG9zIHlvdSBkaXNwbGF5IG9yIGV4cG9ydCB3aXRoIGl0LiBGb3IgaW5zdHJ1Y3Rpb25zIGZvciBob3cgdG8gdW5sb2NrIHRoZSBTREssIHBsZWFzZSB2aXNpdCBodHRwczovL2ltZy5seS9kb2NzL3Blc2RrL3dlYi9pbnRyb2R1Y3Rpb24vZ2V0dGluZ19zdGFydGVkLg==")),this._options.image&&this.setImage(this._options.image,this._options.exif)}_ct(){this._l.exp()&&(this._l.isExp()?Nt.error(pe("TGljZW5zaW5n"),pe("WW91ciB0cmlhbCBsaWNlbnNlIGhhcyBleHBpcmVkLiBQbGVhc2UgY29udGFjdCBvdXIgc2FsZXMgc3RhZmYgYXQgc2FsZXNAaW1nLmx5Lg==")):Nt.warn(pe("TGljZW5zaW5n"),pe("WW91ciB0cmlhbCBsaWNlbnNlIHdpbGwgZXhwaXJlIGluICVkIGRheXMu").replace("%d",this._l.dl())))}_cv(e=!1){return this._l.c().catch(t=>{this[pe("VG04Z1lHRndhVXRsZVdBZ2IzQjBhVzl1SUdkcGRtVnU=")]=!1;let i=pe("SW52YWxpZCBsaWNlbnNlLg==");throw e&&(t.code==="ELICEXP"?i=pe("WW91ciB0cmlhbCBsaWNlbnNlIGhhcyBleHBpcmVkLiBQbGVhc2UgY29udGFjdCBvdXIgc2FsZXMgc3RhZmYgYXQgc2FsZXNAaW1nLmx5Lg=="):t.code==="ELICINVHOST"?i=pe("VGhlIGJ1bmRsZSBpZGVudGlmaWVycyB0aGF0IHlvdSBzcGVjaWZpZWQgaW4geW91ciBsaWNlbnNlIGZpbGUgZG8gbm90IG1hdGNoIHRoZSBhcHAncyBidW5kbGUgaWRlbnRpZmllci4gUGxlYXNlIHVwZGF0ZSBhbmQgcmVkb3dubG9hZCB5b3VyIGxpY2Vuc2UgZnJvbSB5b3VyIGN1c3RvbWVyIGRhc2hib2FyZCBhdCBodHRwczovL3d3dy5pbWcubHkvbG9naW4u"):t.code==="ELICINVPLAT"?i=pe("VGhlIGxpY2Vuc2UgdGhhdCB5b3Ugc3BlY2lmaWVkIGlzIGZvciBhbm90aGVyIHBsYXRmb3JtLiBQbGVhc2UgZG93bmxvYWQgeW91ciBsaWNlbnNlIGZvciB0aGUgd2ViIHBsYXRmb3JtIGZyb20geW91ciBjdXN0b21lciBkYXNoYm9hcmQgYXQgaHR0cHM6Ly93d3cuaW1nLmx5L2xvZ2luLg=="):t.code==="ELICINVFMT"?i=pe("SW52YWxpZCBsaWNlbnNlIGZvcm1hdC4gUGxlYXNlIG1ha2Ugc3VyZSB5b3UncmUgcGFzc2luZyB5b3VyIGxpY2Vuc2UgYXMgYSBzdHJpbmcsIG5vdCBhcyBgJGZvcm1hdGAu").replace("$format",typeof this._options.license):t.code==="ELICINV"?i=pe("VGhlIHNpZ25hdHVyZSBvZiB5b3VyIGxpY2Vuc2UgaXMgbm90IHZhbGlkLiBQbGVhc2UgdHJ5IHRvIHJlZG93bmxvYWQgeW91ciBsaWNlbnNlIGZyb20geW91ciBjdXN0b21lciBkYXNoYm9hcmQgYXQgaHR0cHM6Ly93d3cuaW1nLmx5L2xvZ2luLg=="):i=pe("SW4gY2FzZSB5b3UgZG9uJ3QgaGF2ZSBhIGxpY2Vuc2UgeWV0LCBwbGVhc2UgY29udGFjdCBvdXIgc2FsZXMgc3RhZmYgYXQgc2FsZXNAaW1nLmx5IHRvIG9idGFpbiBhIGxpY2Vuc2Ugb3IgbG9nIGluIHRvIHlvdXIgY3VzdG9tZXIgZGFzaGJvYXJkLg==")),t.message=i,new Error(t)})}_t(){this._l.t()}_fl(){return this[pe("Wm5KbFpVeHBZMlZ1YzAxdlpHVT0=")]}_onOperationUpdate(...e){this.emit(rh.OPERATION_UPDATED,...e)}_onContextRestored(){Nt.warn(this.constructor.name,"Trying to re-render after WebGL context has been restored."),this.setAllOperationsToDirty(),this._operationsStack.forEach(e=>{e.disposeRenderTextures()}),this.render()}export(e=Iv.DATAURL,t=Mv.PNG,i=.8,r=!0){return this._cv(!0).then(()=>(this.hasChanges()&&this._t(),this._operationsStack.forEach(n=>{n.onBeforeExport()}),new Om(this,{renderType:e,imageFormat:t,quality:i,transparent:r}).export().then(n=>(this._operationsStack.forEach(a=>{a.onAfterExport()}),Promise.resolve(n)))))}render(e=!0){if(!this._inputTexture)throw new Error("You need to set an image before calling PhotoEditorSDK#render.");let t=this._renderer.getContext();t.startFrame&&t.startFrame();let i;Nt.canLog("info")&&(i=new fn("\u26A1\u26A1\u26A1","Frame rendering")),Nt.info("\u26A1\u26A1\u26A1","Rendering starts");let r=this._operationsStack;return r.updateDirtinessForRenderer(this._renderer),this._prepareTexture().then(s=>{this._renderMode==="export"&&(s=this._inputTexture),this._currentTexture=s,this._sprite.setTexture(s),this._container.updateTransform()}).then(()=>r.validateSettings()).then(()=>((this._fl()||!this[pe("VG04Z1lHRndhVXRsZVdBZ2IzQjBhVzl1SUdkcGRtVnU=")])&&(r.getByIdentifier("license-watermark")?r.moveToTop("license-watermark"):this.createOperation("license-watermark")),r.getByIdentifier("watermark")?r.moveToTop("watermark"):this._initWatermark(),r.render(this,this._currentTexture))).then(s=>{let{outputTexture:n}=s;switch(this._currentTexture=n,this._sprite.setTexture(this._currentTexture),this._renderMode){case"dynamic":{let a=this._renderer.getDimensions().clone().divide(2).add(this._offset);this._container.setScale(this._zoom/this.getTextureScale(),this._zoom/this.getTextureScale()),this._container.setPosition(a),this._sprite.setAnchor(.5,.5),this._sprite.setScale(this._spriteScale,this._spriteScale),this._sprite.setRotation(this._rotation);break}case"export":this._container.setScale(1,1),this._container.setPosition(0,0),this._sprite.setAnchor(0,0),this._sprite.setPosition(0,0),this._sprite.setScale(this._spriteScale,this._spriteScale),this._sprite.setRotation(0);break;case"adapter":this._container.setScale(1,1),this._container.setPosition(0,0),this._sprite.setAnchor(0,0),this._sprite.setPosition(0,0),this._sprite.setScale(1,1),this._sprite.setRotation(0);break}return e&&this._renderer.render(this._container),s}).then(s=>(i&&i.stop(),t.endFrame&&t.endFrame(),this._disposeTextures(),s))}getTextureScale(){return Math.min(1,this._textureQuality*this._options.pixelRatio)}_prepareTexture(){return new Promise((e,t)=>{let i=this.getTextureScale();if(this._textureQuality===1)return e(this._inputTexture);let r=this.getInputDimensions().multiply(i).floor(),s;this._resizedTexture?this._resizedTexture.getDimensions().equals(r)||(this._resizedTexture.resizeTo(r),s=!0):(this._resizedTexture=new vt.RenderTexture(this._renderer,r.x,r.y),s=!0),s&&(this._resizedSprite.setScale(i,i),this._resizedSprite.setTexture(this._inputTexture),this._resizedTexture.render(this._resizedContainer)),e(this._resizedTexture)})}_registerOperations(){this._operations={};for(let e in us){let t=us[e];this._operations[t.identifier]=t}this._operations=C(C({},this._operations),this._options.extensions.operations)}registerOperations(e){e.forEach(t=>{this._operations[t.identifier]=t})}setAllOperationsToDirty(e=!1){this._operationsStack.setAllToDirty(e)}createOperation(e,t={},i=!0){let r=this._operations[e];if(!r)throw new Error(`No operation with identifier \`${e}\` found.`);let s=new r(this,t);return i&&this.addOperation(s),s}addOperation(e){this._operationsStack.push(e)}removeOperation(e){this._operationsStack.remove(e)}getInputDimensions(){let e=this._inputTexture.getFrame();return new sh(e.width,e.height)}getFinalDimensions(e=!1){let t=this.getInputDimensions();return this._operationsStack.forEach(r=>{!r.getEnabled()||(t=r.getNewDimensions(t))}),e&&t.multiply(this._spriteScale),t.floor()}getOutputDimensions(e=!1){return this.getFinalDimensions(e).clone().multiply(this._zoom).floor()}getOutputTextureDimensions(e=!1){let t=this.getTextureScale(),i=this.getInputDimensions().multiply(t).floor();return this._operationsStack.forEach(r=>{i=r.getNewDimensions(i)}),i}getCrossOrigin(){return Im.getCrossOrigin(this._options.crossOrigin||"Anonymous")}_initRenderer(){let e={canvas:this._options.canvas,pixelRatio:this._options.pixelRatio,debug:this._options.debug,transparent:this._options.transparent,clearColor:this._options.clearColor},t,i;if(this._renderMode!=="export"&&this._options.canvas){let{canvas:r}=this._options;t=r.width,i=r.height}else if(this._inputTexture){let r=this.getFinalDimensions();t=r.x,i=r.y}else t=1,i=1;switch(this._preferredRenderer){case Em.WEBGL:this._renderer=vt.autoDetectRenderer(t,i,e),this._renderer.on("context-restored",this._onContextRestored),this._renderer.on("context-lost",this._onContextLost);break;case Em.CANVAS:this._renderer=vt.canvasRenderer(t,i,e),this._renderer.on("context-restored",this._onContextRestored);break;default:Nt.warn("PhotoEditorSDK",`PhotoEditorSDK Error: Renderer \`${this._preferredRenderer}\` not supported. Falling back to automatically detected renderer.`),this._renderer=vt.autoDetectRenderer(t,i,e)}}resizeTo(e){this._renderer.resizeTo(e,!0)}reset(){this._operationsStack.clear()}parseExif(e){if(!e)return;let{src:t}=e,i=!1,r=null;if(e instanceof Ge&&e.rawSource){let s=e.rawSource;if(e.rawSource instanceof Buffer)t=e.rawSource.toString("base64");else{let n=e.rawSource.replace("data:image/jpeg;base64,","");s=Buffer.from(n,"base64"),t=e.rawSource}i=lo.bufferIsJPEG(s),i&&(r=t)}if(i){let s=null;try{s=lo.fromBase64String(r)}catch(n){}return s||void 0}}_handleExifOrientation(){let e=this._exif.getTags();if(e&&e.Orientation){let t=e.Orientation!==1&&e.Orientation!==2,i=[2,4,5,7].indexOf(e.Orientation)!==-1;if(t||i){if(typeof navigator=="undefined")this._exifOperation||(this._exifOperation=this.createOperation("exif-orientation")),this._exifOperation.setTags(e);else{let r=window&&window.navigator&&window.navigator.userAgent||"";(!!r.match(/msie|trident/i)||r.indexOf("Edge")!==-1||!CSS.supports("image-orientation","from-image"))&&(this._exifOperation||(this._exifOperation=this.createOperation("exif-orientation")),this._exifOperation.setTags(e))}this._exif.setOrientation(1)}}}correctExifOrientation(e){let t=this.parseExif(e);if(!t)return e;let i=t.getTags();if(i&&i.Orientation){let r=i.Orientation!==1&&i.Orientation!==2,s=[2,4,5,7].indexOf(i.Orientation)!==-1;if(r||s){if(typeof navigator=="undefined"){let n=this.createOperation("exif-orientation",{},!1);n.setTags(i),e=n.applyTo(e)}else{let n=window&&window.navigator&&window.navigator.userAgent||"";if(!!n.match(/msie|trident/i)||n.indexOf("Edge")!==-1||!CSS.supports("image-orientation","from-image")){let a=this.createOperation("exif-orientation",{},!1);a.setTags(i),e=a.applyTo(e)}}return t.setOrientation(1),i.Orientation=1,e}}return e}hasImage(){return this._image!==null&&typeof this._image!="undefined"}getImage(){return this._image}disposeTexture(e){this._texturesToDispose.push(e)}_disposeTextures(){for(let e=0;e<this._texturesToDispose.length;e++)this._texturesToDispose[e].dispose();this._texturesToDispose=[]}setImage(e,t=null,i=null){this._disposeTextures(),this._exifOperation&&(this.removeOperation(this._exifOperation),this._exifOperation=null),this._options.image=e,this._image=e,this._exif=t||this.parseExif(e),this._exif&&this._handleExifOrientation();let r=new vt.BaseTexture(this._image),s=new Sv(0,0,this._image.naturalWidth||this._image.width,this._image.naturalHeight||this._image.height);i&&(s.width=i.x,s.height=i.y),this._resizedTexture&&this._resizedTexture.dispose(),this._resizedTexture=null,this._inputTexture&&this.disposeTexture(this._inputTexture.getBaseTexture()),this._inputTexture=new vt.Texture(r,s),this._currentTexture=this._inputTexture,this._sprite.clearTexture(!1),this._sprite.setTexture(this._inputTexture),this.emit("new-image"),this.setAllOperationsToDirty(!0)}setInputTexture(e){this._inputTexture=e}getCanvas(){return this._renderer.getCanvas()}setCanvas(e){this._renderer.setCanvas(e)}getSprite(){return this._sprite}getContainer(){return this._container}getOperationsStack(){return this._operationsStack}setOperationsStack(e){this._operationsStack&&this._operationsStack.off(rh.OPERATION_UPDATED,this._onOperationUpdate),this._operationsStack=e,this._operationsStack.on(rh.OPERATION_UPDATED,this._onOperationUpdate)}getOperations(){return this._operations}getRenderer(){return this._renderer}getOffset(){return this._offset}setOffset(e,t){e instanceof sh?this._offset.copy(e):this._offset.set(e,t)}getRenderMode(){return this._renderMode}setRenderMode(e){this._renderMode=e}getZoom(){return this._zoom}setZoom(e){this._zoom=e,this._container.setScale(this._zoom,this._zoom),this._container.updateTransform()}getTextureQuality(){return this._renderMode==="export"?1:this._textureQuality}setTextureQuality(e){e!==this._textureQuality&&this.setAllOperationsToDirty(!0),this._textureQuality=Math.min(1,e),this._textureQuality===1&&this._resizedTexture&&(this._resizedTexture.dispose(),this._resizedTexture=null)}getSpriteScale(){return this._spriteScale}setSpriteScale(e){this._spriteScale=e,this._sprite.setScale(e,e),this._sprite.updateTransform()}getPixelRatio(){return this._options.pixelRatio}getExif(){return this._exif}getOptions(){return this._options}getInputTexture(){return this._inputTexture}setSmoothDownscaling(e){this._options.smoothDownscaling=e,this._sprite.setSmoothDownscaling(e),this._resizedSprite.setSmoothDownscaling(e)}setRotation(e){this._rotation=e}getRotation(){return this._rotation}hasChanges(){return this.getOperationsStack().hasChanges()}dispose(){this._operationsStack.dispose(),this._renderer.dispose(),this._exif&&this._exif.dispose(),this._resizedTexture&&this._resizedTexture.dispose()}},ye=Mm});var Bv,P,ho=_(()=>{ut();id();ct();oo();Vr();Ui();$r();pm();Jr();Jl();un();Gl();jl();Zl();Dt();th();eh();Bm();ye.version="4.26.1";ye.Math=B;ye.Operations=us;ye.Engine=R;ye.Color=S;ye.LicenseChecker=nn;ye.Operation=te;ye.EventEmitter=Ke;ye.Utils=k;ye.Env=fm;ye.OperationsStack=mn;ye.EXIF=lo;ye.Image=Ge;ye.Configurable=V;ye.Log=I;ye.Loaders=dl;ye.RenderType=qe;ye.ImageFormat=Mt;ye.OptionType=E;ye.RendererType=ke;ye.UniformType=ce;ye.Base64=kt;Bv={};ye.UI=Bv;P=ye});var O=_(()=>{ho();ho()});var Pm,Dm=_(()=>{Pm=`precision highp float;

varying vec2 v_texCoord;
uniform sampler2D u_image;

uniform float u_gamma;
uniform float u_shadows;
uniform float u_highlights;
uniform float u_whites;
uniform float u_blacks;

uniform mat4 u_colorMatrix;
uniform vec4 u_colorOffset;

const float EPSILON = 0.0000001;

float calculateLuminance(vec3 rgb) {
    // This is the luminance calculation part of the RGB to HSL formular.
    vec4 p = mix(
        vec4(rgb.gb, 0.0, -1.0 / 3.0),
        vec4(rgb.bg, -1.0, 2.0 / 3.0),
        vec4(rgb.g < rgb.b)
    );

    vec4 q = mix(
        vec4(rgb.r, p.yzx),
        vec4(p.xyw, rgb.r),
        vec4(rgb.r < p.x)
    );

    float croma = q.x - min(q.w, q.y);
    float luminance = q.x - croma * 0.5;
    return luminance;
}

vec3 map(vec3 x, float in_min, float in_max, float out_min, float out_max){
  return (x - in_min) * (out_max - out_min) / (in_max - in_min) + out_min;
}

void main() {

  vec4 color = clamp(texture2D(u_image, v_texCoord), 0.0, 1.0);
  color.rgb /= max(color.a, EPSILON); // Revert premultiplied alpha

  // Apply gamma
  if (u_gamma != 1.0) {
    color.rgb = pow(color.rgb, vec3(1.0 / max(u_gamma, EPSILON)));
  }

  // Apply shadows and highlights
  float luminance = calculateLuminance(color.rgb);

  float shadow = u_shadows >= 0.0
    ? clamp(
          pow(luminance, 1.0 / (u_shadows + 1.0))
          + pow(luminance, 2.0 / (u_shadows + 1.0)) * -0.76
          - luminance
    , 0.0, max(u_shadows, 1.0))
    : -clamp(
          pow(luminance, 1.0 / (-u_shadows + 1.0))
          + pow(luminance, 2.0 / (-u_shadows + 1.0)) * -0.76
          - luminance
    , 0.0, max(-u_shadows, 1.0));

  float highlight = u_highlights < 0.0
    ? clamp(
          1.0
          - pow(1.0 - luminance, 1.0 / (1.0 - u_highlights))
          - pow(1.0 - luminance, 2.0 / (1.0 - u_highlights)) * -0.8
          - luminance
     , -1.0, 0.0)
    : -clamp(
          1.0
          - pow(1.0 - luminance, 1.0 / (1.0 + u_highlights))
          - pow(1.0 - luminance, 2.0 / (1.0 + u_highlights)) * -0.8
          - luminance
     , -1.0, 0.0);

  // Bright color need more contrast and dark color need more brightness.
  // This is to keep saturatation because the color information of a dark colors is lost.
  float shadowContrast   = shadow * luminance * luminance;
  float shadowBrightness = shadow - shadowContrast;

  float offset = luminance + shadowContrast + highlight;
  color.rgb = clamp(offset * ((color.rgb + shadowBrightness) / max(luminance, EPSILON)), 0.0, 1.0);
  
  // Apply Color Matrix
  color.rgb = clamp(color * u_colorMatrix + u_colorOffset, 0.0, 1.0).rgb;
  color.rgb = map(color.rgb, 0.0, 1.0, u_blacks / 2.0, 1.0 + u_whites / 2.0);
  color = clamp(color, 0.0, 1.0);
  color.rgb *= color.a; // Reset premultiplied alpha

  gl_FragColor = color;
}
`});function oh(o,e,t,i,r){return(o-e)*(r-i)/(t-e)+i}var Pv,ds,Av,nh,_n,ah=_(()=>{O();Dm();({ColorMatrix:Pv}=B),ds=1e-7;Av=o=>{let e=Math.max(o.r,o.g,o.b),t=Math.min(o.r,o.g,o.b);return(e+t)/2},nh=class extends R.Filter{constructor(){super();this._fragmentSource=Pm}_applyCanvas(e,t,i,r=!1){let s=t.getCanvas(),n=t.getContext(),a=i.getContext(),l=n.getImageData(0,0,s.width,s.height),{colorMatrix:h,gamma:c,shadows:m,highlights:d,whites:u,blacks:f}=this._options,y=c!==1,g=m!==0||d!==0,p=new S(0,0,0,0);for(let v=0;v<s.width*s.height;v++){let x=v*4;if(p.r=l.data[x]/255,p.g=l.data[x+1]/255,p.b=l.data[x+2]/255,y&&(p.r=Math.pow(p.r,1/Math.max(c,ds)),p.g=Math.pow(p.g,1/Math.max(c,ds)),p.b=Math.pow(p.b,1/Math.max(c,ds))),g){let T=Av(p),D=m>=0?k.clamp(Math.pow(T,1/(m+1))+Math.pow(T,2/(m+1))*-.76-T,0,Math.max(m,1)):-k.clamp(Math.pow(T,1/(-m+1))+Math.pow(T,2/(-m+1))*-.76-T,0,Math.max(-m,1)),b=d<0?k.clamp(1-Math.pow(1-T,1/(1-d))-Math.pow(1-T,2/(1-d))*-.8-T,-1,0):-k.clamp(1-Math.pow(1-T,1/(1+d))-Math.pow(1-T,2/(1+d))*-.8-T,-1,0),w=D*T*T,G=D-w,N=T+w+b;p.r=k.clamp(N*((p.r+G)/Math.max(T,ds)),0,1),p.g=k.clamp(N*((p.g+G)/Math.max(T,ds)),0,1),p.b=k.clamp(N*((p.b+G)/Math.max(T,ds)),0,1)}p=h.apply(p).clamp(0,1),p.r=oh(p.r,0,1,f/2,1+u/2),p.g=oh(p.g,0,1,f/2,1+u/2),p.b=oh(p.b,0,1,f/2,1+u/2),l.data[x]=p.r*255,l.data[x+1]=p.g*255,l.data[x+2]=p.b*255}a.putImageData(l,0,0)}};nh.prototype.availableOptions={gamma:{type:"number",default:1,uniformType:"f"},shadows:{type:"number",default:0,uniformType:"f"},highlights:{type:"number",default:1,uniformType:"f"},whites:{type:"number",default:0,uniformType:"f"},blacks:{type:"number",default:0,uniformType:"f"},colorMatrix:{type:"color-matrix",default:new Pv,uniformType:"mat4"},colorOffset:{type:"array",default:[],uniformType:"4f"}};_n=nh});var Lm,Am=_(()=>{Lm=`precision mediump float;

// Input Image with config WRAP_S and WRAP_T: CLAMP_TO_EDGE
uniform sampler2D u_image;

// Size of one pixel == vec2(1.0 / u_image.width, 1.0 / u_image.height)
uniform vec2 u_pixelDimension;

// Range (-1.0 - 1.0)
uniform float u_clarity;

varying vec2 v_texCoord;

uniform mat4 u_colorMatrix;
uniform vec4 u_colorOffset;

const float EPSILON = 0.000001;

vec4 unpremultiply(vec4 col) {
    col.rgb /= max(col.a, EPSILON);
    return col;
}

void main() {
    vec4 color = texture2D(u_image, v_texCoord);
    color = unpremultiply(color);

    // L = Left, R = Right, C = Center, T = Top, B = Bottom
    vec4 colLB = texture2D(u_image, v_texCoord + vec2(-u_pixelDimension.x, -u_pixelDimension.y));
    vec4 colLC = texture2D(u_image, v_texCoord + vec2(-u_pixelDimension.x,                 0.0));
    vec4 colLT = texture2D(u_image, v_texCoord + vec2(-u_pixelDimension.x,  u_pixelDimension.y));

    vec4 colCL = texture2D(u_image, v_texCoord + vec2(                0.0, -u_pixelDimension.y));
    vec4 colCR = texture2D(u_image, v_texCoord + vec2(                0.0,  u_pixelDimension.y));
    
    vec4 colRB = texture2D(u_image, v_texCoord + vec2( u_pixelDimension.x, -u_pixelDimension.y));
    vec4 colRC = texture2D(u_image, v_texCoord + vec2( u_pixelDimension.x,                 0.0));
    vec4 colRT = texture2D(u_image, v_texCoord + vec2( u_pixelDimension.x,  u_pixelDimension.y));

    vec4 mergedColor = color;
    mergedColor.rgb += unpremultiply(colLB).rgb + unpremultiply(colLC).rgb + unpremultiply(colLT).rgb;
    mergedColor.rgb += unpremultiply(colCL).rgb + unpremultiply(colCR).rgb;
    mergedColor.rgb += unpremultiply(colRB).rgb + unpremultiply(colRC).rgb + unpremultiply(colRT).rgb;

    mergedColor /= 9.0;

    float grayValue = clamp(color.r * 0.3 + color.g * 0.59 + color.b * 0.1, 0.111111, 0.999999);
    // 1.0 and 0.0 result in white not black, therefore we clamp

    // Here we create a function that will map values below 0.1 to 0. Values above 0.2 will be mapped to 1,
    // and for values between 0.1 and 0.2 it will produce a gradient.
    // The funtion is mirror at 0.5, meaning values between 0.8 and 0.9 will result in a decending gradient.
    // And values above 0.9 will be mapped to 0.
    float frequenceFactor = min(smoothstep(1.0 - grayValue, 0.0, 0.11), smoothstep(grayValue, 0.0, 0.11));

    // here we apply the high pass filter. Its strength is determined by the uniform ,
    // and the frequence factor. That means the only the mid tones are affected by this filter.
    // Clarity input is ranging from -1 to 1. But we want to strengthen the effect.
    // Therefore we see this little magic number '3.7'.
    color.rgb = clamp(color + clamp((color - mergedColor) * u_clarity * 3.7 * frequenceFactor, 0.0, 10.0), 0.0, 1.0).rgb;

    // apply exposure but only to the mid tones.
    color.rgb = color.rgb * pow(2.0, u_clarity * 0.27 * frequenceFactor);

    // apply contrast and desaturation matrix
    color.rgb = clamp(color * u_colorMatrix + u_colorOffset, 0.0, 1.0).rgb;

    color.rgb *= color.a; // Premultiply alpha

    gl_FragColor = clamp(color, 0.0, 1.0);
}
`});var zv,Nv,lh,zm,Nm=_(()=>{O();Am();({Vector2:zv,ColorMatrix:Nv}=B),lh=class extends R.Filter{constructor(){super();this._fragmentSource=Lm}_applyCanvas(e,t,i,r=!1){let s=i.getContext(),n=t.getCanvas(),a=t.getContext(),{clarity:l}=this._options,{colorMatrix:h}=this._options,c=new S(this._options.colorOffset[0],this._options.colorOffset[1],this._options.colorOffset[2],this._options.colorOffset[3]),{width:m}=n,{height:d}=n,u=a.getImageData(0,0,m,d),f=s.createImageData(m,d);this.canvasShader(u,f,l,h,c),s.putImageData(f,0,0)}canvasShader(e,t,i,r,s){let n=(p,v,x)=>Math.min(Math.max(p,v),x),a=(p,v,x)=>{let T=n((x-p)/(v-p),0,1);return T*T*(3-2*T)},l=e.width*4,{length:h}=e.data,c=h-1,m=0,d=e.data,u=t.data,f=new S,y=255*9,g=p=>(p=p<m?m:p,p=p>c?c:p,d[p]);for(let p=0;p<h;p+=4){let v=g(p+0),x=g(p+1),T=g(p+2),D=g(p+3),b=(v+g(p-4-l+0)+g(p-4+0)+g(p-4+l+0)+g(p-l+0)+g(p+l+0)+g(p+4-l+0)+g(p+4+0)+g(p+4+l))/y,w=(x+g(p-4-l+1)+g(p-4+1)+g(p-4+l+1)+g(p-l+1)+g(p+l+1)+g(p+4-l+1)+g(p+4+1)+g(p+4+l+1))/y,G=(T+g(p-4-l+2)+g(p-4+2)+g(p-4+l+2)+g(p-l+2)+g(p+l+2)+g(p+4-l+2)+g(p+4+2)+g(p+4+l+2))/y,N=(D+g(p-4-l+3)+g(p-4+3)+g(p-4+l+3)+g(p-l+3)+g(p+l+3)+g(p+4-l+3)+g(p+4+3)+g(p+4+l+3))/y;v/=255,x/=255,T/=255,D/=255;let j=n(v*.3+x*.59+T*.1,.111111,.999999),K=Math.min(a(1-j,0,.11),a(j,0,.11)),Y=i*3.7*K,W=Math.pow(2,i*.27*K),he=n(v+n((v-b)*Y,0,10),0,1)*W,He=n(x+n((x-w)*Y,0,10),0,1)*W,De=n(T+n((T-G)*Y,0,10),0,1)*W,It=n(D+n((D-N)*Y,0,10),0,1);f.set(he,He,De,It);let J=r.apply(f).clamp(0,1);u[p+0]=J.r*255,u[p+1]=J.g*255,u[p+2]=J.b*255,u[p+3]=J.a*255}}};lh.prototype.availableOptions={clarity:{type:"number",default:0,uniformType:"f"},pixelDimension:{type:"vector2",default:new zv(100,100),uniformType:"2f"},colorMatrix:{type:"color-matrix",default:new Nv,uniformType:"mat4"},colorOffset:{type:"array",default:[],uniformType:"4f"}};zm=lh});var Gm,Um=_(()=>{Gm=`varying vec2 v_texCoord;
uniform sampler2D u_image;
uniform vec2 u_pixelDimension;
uniform float u_sharpness;
 
const float EPSILON = 0.000001;
 
void main() {
    vec4 color = clamp(texture2D(u_image, v_texCoord), 0.0, 1.0);

    float factor        = mix(0.2, -1.0, float(u_sharpness > 0.0));
    vec4 sharpenedColor = mix(0.2,  5.0, float(u_sharpness > 0.0)) * color;
 
    sharpenedColor += factor * clamp(texture2D(u_image, v_texCoord + u_pixelDimension * vec2(-1.0,  0.0)), 0.0, 1.0);
    sharpenedColor += factor * clamp(texture2D(u_image, v_texCoord + u_pixelDimension * vec2( 0.0, -1.0)), 0.0, 1.0);
    sharpenedColor += factor * clamp(texture2D(u_image, v_texCoord + u_pixelDimension * vec2( 0.0,  1.0)), 0.0, 1.0);
    sharpenedColor += factor * clamp(texture2D(u_image, v_texCoord + u_pixelDimension * vec2( 1.0,  0.0)), 0.0, 1.0);
 
    color.rgb /= max(color.a, EPSILON); // unpremultiply
    sharpenedColor.rgb /= max(sharpenedColor.a, EPSILON); // unpremultiply
 
    sharpenedColor = clamp(sharpenedColor, 0.0, 1.0);
 
    color = clamp(mix(color, sharpenedColor, abs(u_sharpness)), 0.0, 1.0);
      
    gl_FragColor = vec4(color.rgb * color.a, color.a); // premultiply
}`});var Gv,hh,Wm,Vm=_(()=>{O();Um();({Vector2:Gv}=B),hh=class extends R.Filter{constructor(){super();this._fragmentSource=Gm}_applyCanvas(e,t,i,r=!1){let s=i.getContext(),n=t.getCanvas(),a=t.getContext(),{sharpness:l}=this._options,{width:h}=n,{height:c}=n,m=a.getImageData(0,0,h,c),d=s.createImageData(h,c);this.canvasShader(m,d,l),s.putImageData(d,0,0)}canvasShader(e,t,i){let r=(T,D,b)=>Math.min(Math.max(T,D),b),{width:n}=e,{height:a}=e,l=e.data,h=t.data,c=(T,D,b)=>T*(1-b)+D*b,m=T=>r(l[T]/255,0,1),d=(T,D)=>{let b=r(T,0,n-1),w=r(D,0,a-1);return 4*(b+n*w)},u=[],f=[],y=[-1,0,0,1],g=[0,-1,1,0],p=i>0?-1:.2,v=i>0?5:.2,x=Math.abs(i);for(let T=0;T<n;T++)for(let D=0;D<a;D++){let b=d(T,D);u[0]=m(b+0),u[1]=m(b+1),u[2]=m(b+2),u[3]=m(b+3),f[0]=v*u[0]*u[3],f[1]=v*u[1]*u[3],f[2]=v*u[2]*u[3],f[3]=v*u[3];for(let w=0;w<4;w++){let G=y[w],N=g[w],j=d(T+G,D+N),K=m(j+3);f[3]+=p*K;for(let Y=0;Y<3;Y++)f[Y]+=p*m(j+Y)*K}for(let w=0;w<3;w++)f[w]/=Math.max(f[3],1e-6),f[w]=r(f[w],0,1);f[3]=r(f[3],0,1);for(let w=0;w<4;w++)u[w]=r(c(u[w],f[w],x),0,1),h[b+w]=u[w]*255}}};hh.prototype.availableOptions={sharpness:{type:"number",default:0,uniformType:"f"},pixelDimension:{type:"vector2",default:new Gv(100,100),uniformType:"2f"}};Wm=hh});var jm,Hm=_(()=>{jm=`precision mediump float;

// Input Image with config WRAP_S and WRAP_T: CLAMP_TO_EDGE
uniform sampler2D u_image;

// Range (-1.0 - 1.0)
uniform float u_temperature;

const lowp vec3 warmFilter = vec3(0.93, 0.54, 0.0);

const mediump mat3 RGBtoYIQ = mat3(0.299, 0.587, 0.114, 0.596, -0.274, -0.322, 0.212, -0.523, 0.311);
const mediump mat3 YIQtoRGB = mat3(1.0, 0.956, 0.621, 1.0, -0.272, -0.647, 1.0, -1.105, 1.702);

const float EPSILON = 0.0000001;

varying vec2 v_texCoord;
void main() {
  float temperature = u_temperature;
  const float tint = 0.0;
  vec4 source = texture2D(u_image, v_texCoord);

  source.rgb /= max(source.a, EPSILON);   // Revert premultiplied alpha

  vec3 yiq = RGBtoYIQ * source.rgb;
  yiq.b = clamp(yiq.b + tint*0.5226*0.1, -0.5226, 0.5226);
  vec3 rgb = YIQtoRGB * yiq;

  vec3 processed = mix(
    (1.0 - 2.0 * (1.0 - rgb) * (1.0 - warmFilter)),
    (2.0 * rgb * warmFilter),
    vec3(rgb.r < 0.5, rgb.g < 0.5, rgb.b < 0.5)
  );

  vec4 color = vec4(mix(rgb, processed, temperature), source.a);

  color.rgb *= color.a;   // Premultiply alpha again

  gl_FragColor = color;
}
`});var iS,ch,qm,Xm=_(()=>{O();Hm();({Vector3:iS}=B),ch=class extends R.Filter{constructor(){super();this._fragmentSource=jm}_applyCanvas(e,t,i,r=!1){let s=i.getContext(),n=t.getCanvas(),a=t.getContext(),{temperature:l}=this._options,{width:h}=n,{height:c}=n,m=a.getImageData(0,0,h,c),d=s.createImageData(h,c);this.canvasShader(m,d,l),s.putImageData(d,0,0)}canvasShader(e,t,i){let r=(p,v,x)=>Math.min(Math.max(p,v),x),s=(p,v,x)=>p*(1-x)+v*x,n=(p,v)=>{let x=p[0]*v[0]+p[3]*v[1]+p[6]*v[2],T=p[1]*v[0]+p[4]*v[1]+p[7]*v[2],D=p[2]*v[0]+p[5]*v[1]+p[8]*v[2];return[x,T,D]},{length:a}=e.data,l=a-1,h=0,c=e.data,m=t.data,d=p=>(p=p<h?h:p,p=p>l?l:p,c[p]),u=[.93,.54,0],f=[.299,.587,.114,.596,-.274,-.322,.212,-.523,.311],y=[1,.956,.621,1,-.272,-.647,1,-1.105,1.702],g=0;for(let p=0;p<a;p+=4){let v=d(p+0)/255,x=d(p+1)/255,T=d(p+2)/255,D=d(p+3)/255,w=n(f,[v,x,T]);w.z=r(w.z+g*.5226*.1,-.5226,.5226);let G=n(y,w),N=[G[0]<.5?2*G[0]*u[0]:1-2*(1-G[0])*(1-u[0]),G[1]<.5?2*G[1]*u[1]:1-2*(1-G[1])*(1-u[1]),G[2]<.5?2*G[2]*u[2]:1-2*(1-G[2])*(1-u[2])];m[p+0]=s(G[0],N[0],i)*255,m[p+1]=s(G[1],N[1],i)*255,m[p+2]=s(G[2],N[2],i)*255,m[p+3]=D*255}}};ch.prototype.availableOptions={temperature:{type:"number",default:0,uniformType:"f"}};qm=ch});var bi,co,Ym,Km=_(()=>{O();ah();Nm();Vm();Xm();({ColorMatrix:bi}=B),co=class extends te{constructor(...e){super(...e);this._clarityFilter=new zm,this._temperatureFilter=new qm,this._sharpnessFilter=new Wm,this._filter=new _n,this._sprite.setFilters([this._clarityFilter,this._temperatureFilter,this._filter])}_render(e){let t=e.getDimensions();t.x=1/t.x,t.y=1/t.y;let i=new bi;i.multiply(bi.createSaturationMatrix(-.3*this._options.clarity+1)),i.multiply(bi.createContrastMatrix(.1*this._options.clarity+1)),this._clarityFilter.set({clarity:this._options.clarity,pixelDimension:t,colorMatrix:i,colorOffset:i.getOffsets()}),this._temperatureFilter.set({temperature:this._options.temperature}),this._sharpnessFilter.set({sharpness:this._options.sharpness,pixelDimension:t});let r=new bi;r.multiply(bi.createExposureMatrix(this._options.exposure)),r.multiply(bi.createSaturationMatrix(this._options.saturation+1)),r.multiply(bi.createContrastMatrix((this._options.contrast>0?this._options.contrast*2:this._options.contrast)+1)),r.multiply(bi.createBrightnessMatrix(this._options.brightness)),this._filter.set({gamma:this._options.gamma,shadows:this._options.shadows,highlights:this._options.highlights,whites:this._options.whites,blacks:this._options.blacks,colorMatrix:r,colorOffset:r.getOffsets()});let s=[];return this._options.clarity!==0&&s.push(this._clarityFilter),this._options.sharpness!==0&&s.push(this._sharpnessFilter),this._options.temperature!==0&&s.push(this._temperatureFilter),s.push(this._filter),this._sprite.setFilters(s),this._renderTexture.render(this._container),Promise.resolve()}dispose(){super.dispose(),this._filter.dispose(),this._clarityFilter.dispose(),this._temperatureFilter.dispose(),this._sharpnessFilter.dispose()}};co.identifier="adjustments";co.prototype.availableOptions={brightness:{type:"number",default:0,minValue:-1,midValue:0,maxValue:1},saturation:{type:"number",default:0,minValue:-1,midValue:0,maxValue:1},contrast:{type:"number",default:0,minValue:-1,midValue:0,maxValue:1},gamma:{type:"number",default:1,minValue:.5,midValue:1,maxValue:2},exposure:{type:"number",default:0,minValue:-1,midValue:0,maxValue:1},shadows:{type:"number",default:0,minValue:-2,midValue:0,maxValue:2},highlights:{type:"number",default:0,minValue:-1,midValue:0,maxValue:1},clarity:{type:"number",default:0,minValue:-1,midValue:0,maxValue:1},whites:{type:"number",default:0,minValue:-1,midValue:0,maxValue:1},blacks:{type:"number",default:0,minValue:-1,midValue:0,maxValue:1},temperature:{type:"number",default:0,minValue:-1,midValue:0,maxValue:1},sharpness:{type:"number",default:0,minValue:-1,midValue:0,maxValue:1}};P.Operations.AdjustmentsOperation=co;Ym=co});var Zm,Jm=_(()=>{Zm=`/*
 * Based on evanw's glfx.js tilt shift shader:
 * https://github.com/evanw/glfx.js/blob/master/src/filters/blur/tiltshift.js
 * @license
 */

uniform sampler2D u_image;
uniform float u_blurRadius;
uniform vec2 u_delta;
uniform vec2 u_texSize;
varying vec2 v_texCoord;

float random(vec2 co)
{
    highp float a = 12.9898;
    highp float b = 78.233;
    highp float c = 43758.5453;
    highp float dt = dot(co.xy,vec2(a,b));
    highp float sn = mod(dt, 3.14);
    return fract(sin(sn) * c);
}

void main() {
    vec4 color = vec4(0.0);
    float total = 0.0;

    float offset = random(gl_FragCoord.xy / u_texSize.xy);
    float radius = u_blurRadius;

    const float steps = 30.0;

    for (float t = -steps; t <= steps; t++) {
        float percent = (t + offset - 0.5) / steps;
        float weight = 1.0 - abs(percent);

        // Somehow \`sample\` is a keyword in headless-gl
        vec4 _sample = texture2D(u_image, v_texCoord + u_delta * percent * radius / u_texSize);

        color += _sample * weight;
        total += weight;
    }

    gl_FragColor = color / total;
}
`});var gn,uh,rt,ms=_(()=>{O();Jm();({Vector2:gn}=B),uh=class extends R.Filter{constructor(...e){super(...e);this._fragmentSource=Zm,this._lastBlurRadius=null,this._lastDimensions=new gn(0,0),this._blurredRenderTarget=new R.CanvasRenderTarget(100,100,1)}_applyCanvas(e,t,i,r=!1,s=null){if(this._options.blurQuality==="low"){this._renderLQBlur(e,t,i,r);return}let n=t.getCanvas(),a=t.getContext(),l=i.getContext();this._lastBlurRadius===this._options.blurRadius&&l.drawImage(n,0,0);let h=a.getImageData(0,0,n.width,n.height),c=l.getImageData(0,0,n.width,n.height),m=this._options.blurRadius,{delta:d}=this._options,u=30;for(let f=0;f<n.width;f++)for(let y=0;y<n.height;y++){let p=(f+y*n.width)*4,v=0,x=0,T=0,D=0,b=0;s&&(m=s(f/n.width,y/n.height));let w=this._random(f,1-y/n.height);for(let G=-u;G<=u;G++){let N=(G+w-.5)/u,j=1-Math.abs(N),K=d.x*N*m,Y=d.y*N*m,W=Math.max(Math.min(f+K,n.width-1),0),he=Math.max(Math.min(y+Y,n.height-1),0),He=(Math.round(he)*n.width+Math.round(W))*4,De=h.data[He+3],It=De*h.data[He],J=De*h.data[He+1],be=De*h.data[He+2];v+=It*j,x+=J*j,T+=be*j,D+=De*j,b+=j}v/=b,x/=b,T/=b,D/=b,c.data[p]=v/D,c.data[p+1]=x/D,c.data[p+2]=T/D,c.data[p+3]=D}l.putImageData(c,0,0),this._lastDimensions.copy(new gn(n.width,n.height))}_renderLQBlur(e,t,i,r){let s=t.getDimensions(),n=!this._lastDimensions.equals(s);this._blurredRenderTarget.setPixelRatio(t.getPixelRatio()),this._blurredRenderTarget.resizeTo(t.getDimensions()),i.setPixelRatio(t.getPixelRatio()),i.resizeTo(t.getDimensions()),(this._lastBlurRadius!==this._options.blurRadius||n)&&(this._blurImage(t,this._blurredRenderTarget,this._options.blurRadius),this._lastBlurRadius=this._options.blurRadius),i.getContext().drawImage(this._blurredRenderTarget.getCanvas(),0,0),this._lastDimensions.copy(s)}_random(e,t){let s=43758.5453,n=e*12.9898+t*78.233,a=n-3.14*Math.floor(n/3.14),l=Math.sin(a)*s;return l-Math.floor(l)}};uh.prototype.availableOptions={blurRadius:{type:"number",default:30,uniformType:"f"},delta:{type:"vector2",default:new gn(1,1),uniformType:"2f"},texSize:{type:"vector2",default:new gn(100,100),uniformType:"2f"},blurQuality:{type:"string",default:"low"}};rt=uh});var Qm,uo,$m,ef=_(()=>{O();ms();({Vector2:Qm}=B),uo=class extends te{constructor(...e){super(...e);this._lastBlurRadius=this._options.blurRadius;let t={blurQuality:{type:"string"}};this._horizontalFilter=new rt({},t),this._verticalFilter=new rt({},t),this._sprite.setFilters([this._horizontalFilter,this._verticalFilter]),this._horizontalFilter.setDelta(new Qm(.5,.5)),this._verticalFilter.setDelta(new Qm(-.5,.5)),this._filter=new rt({},t)}_renderWebGL(e){return this._renderBlur(e)}_renderCanvas(e){return this._options.highQualityCanvasBlur?this._renderBlur(e):this._renderLQCanvasBlur(e)}_renderBlur(e){let t=e.getDimensions(),i=t.min(),{blurRadius:r}=this._options,s={blurRadius:r*i,texSize:t,blurQuality:"high"};return this._horizontalFilter.set(s),this._verticalFilter.set(s),this._renderTexture.render(this._container),Promise.resolve()}_renderLQCanvasBlur(e){let{blurRadius:t}=this._options,i=e.getDimensions();return this._filter.set({blurRadius:t,texSize:i,blurQuality:"low"}),this._sprite.setFilters([this._filter]),this._renderTexture.render(this._container),Promise.resolve()}transform(e){let t=this.getBlurRadius(),i=e.applyToRelativeSize(t);this.set({blurRadius:i},!1)}dispose(){super.dispose(),this._filter.dispose(),this._verticalFilter.dispose(),this._horizontalFilter.dispose()}hasChanges(){return!0}};uo.identifier="blur";uo.prototype.availableOptions={blurRadius:{type:"number",default:.025},highQualityCanvasBlur:{type:"boolean",default:!1}};P.Operations.BlurOperation=uo;$m=uo});var rf,tf=_(()=>{rf=`varying vec2 v_texCoord;
uniform sampler2D u_image;
uniform sampler2D u_filteredImage;
uniform float u_intensity;

void main() {
  vec4 color0 = texture2D(u_image, v_texCoord);
  vec4 color1 = texture2D(u_filteredImage, v_texCoord);
  gl_FragColor = mix(color0, color1, u_intensity);
}
`});var dh,sf,mh,of=_(()=>{O();tf();dh=class extends R.Filter{constructor(){super();this._fragmentSource=rf}_applyCanvas(e,t,i,r=!1){let s=t.getCanvas(),n=i.getContext(),{filteredCanvas:a}=this._options;n.save(),n.drawImage(s,0,0),n.globalAlpha=this._options.intensity,n.drawImage(a,0,0),n.restore()}};dh.prototype.availableOptions={filteredImage:{type:"number",default:1,uniformType:"i"},filteredCanvas:{type:"object",default:null},intensity:{type:"number",default:1,uniformType:"f"}};sf=class{constructor(e=1){this._intensity=e,this._stack=[],this._dirtiness={},this._renderTextures={},this._container=new R.Container,this._sprite=new R.Sprite,this._container.addChild(this._sprite),this._blendFilter=new dh}push(e){this._stack.push(e)}clear(){this._stack=[]}render(e,t,i){if(this.isEmpty())return Promise.resolve();let r=e.getRenderer();this._sprite.setTexture(t);let s=this._renderTextures[r.id];if(!s){let l=e.getSprite().getTexture().getFrame();s=new R.RenderTexture(e.getRenderer(),l.width,l.height),this._renderTextures[r.id]=s}let n=i.getDimensions();s.resizeTo(n);let a=this.isDirtyForRenderer(r);if(a){this._stack.forEach(h=>{h.update(e)});let l=this._stack.map(h=>h.getFilter());this._sprite.setFilters(l),s.render(this._container),this.setDirtyForRenderer(!1,r)}if(this._blendFilter.setIntensity(this._intensity),r.isOfType("canvas"))this._blendFilter.setFilteredCanvas(s.getRenderTarget().getCanvas());else if(r.isOfType("webgl")){let l=s.getBaseTexture();l.setGLUnit(this._blendFilter.getFilteredImage()),r.updateTexture(l,!1)}return this._sprite.setFilters([this._blendFilter]),i.clear(S.TRANSPARENT),i.render(this._container),a&&this.disposeRenderTextures(),Promise.resolve()}setIntensity(e){this._intensity=e}isEmpty(){return this._stack.length===0}isDirtyForRenderer(e){return e.id in this._dirtiness||(this._dirtiness[e.id]=!0),this._dirtiness[e.id]}setDirtyForRenderer(e,t){this._dirtiness[t.id]=e}setDirty(e){for(let t in this._dirtiness)this._dirtiness[t]=e}disposeRenderTextures(){for(let e in this._renderTextures)this._renderTextures[e].dispose(),delete this._renderTextures[e]}dispose(){this.disposeRenderTextures(),this._stack.forEach(e=>e.dispose()),this._stack=[],this._blendFilter.dispose(),this._sprite.dispose()}},mh=sf});var fs,z,se=_(()=>{O();of();fs=class extends V{constructor(e={},t={}){super(e,C({intensity:{type:"number",default:1,setter(i){return this._stack&&this._stack.setIntensity(i),i}},dirty:{type:"boolean",default:!0}},t));this._stack=new mh(this._options.intensity)}render(e,t,i){return this._stack.render(e,t,i).then(r=>(this.setDirty(!1),r))}setDirtyForRenderer(e,t){this._stack.setDirtyForRenderer(e,t)}disposeRenderTextures(){this._stack.disposeRenderTextures()}dispose(){this._stack.dispose()}};fs.identifier=null;fs.isIdentity=!1;fs.displayName=null;fs.PrimitivesStack=mh;z=fs});var af,nf=_(()=>{af=`varying vec2 v_texCoord;
uniform sampler2D u_image;
uniform float u_brightness;

void main() {
  vec4 texColor = texture2D(u_image, v_texCoord);
  gl_FragColor = vec4((texColor.rgb + vec3(u_brightness) * texColor.a), texColor.a);;
}
`});var lf,ae,We=_(()=>{O();lf=class extends V{update(){}getFilter(){return this._filter}dispose(){this._filter&&(this._filter.dispose(),this._filter=null)}},ae=lf});var yn,fh,Zi,hf=_(()=>{O();nf();We();yn=class extends R.Filter{constructor(){super();this._fragmentSource=af}_applyCanvas(e,t,i,r=!1){let s=t.getCanvas(),n=t.getContext(),a=i.getContext(),l=n.getImageData(0,0,s.width,s.height),{brightness:h}=this._options;if(h===0){a.putImageData(l,0,0);return}h*=255;for(let c=0;c<s.width*s.height;c++){let m=c*4;l.data[m]+=h,l.data[m+1]+=h,l.data[m+2]+=h}a.putImageData(l,0,0)}};yn.prototype.availableOptions={brightness:{type:"number",default:0,uniformType:"f"}};fh=class extends ae{constructor(...e){super(...e);this._filter=new yn}update(){this._filter.setBrightness(this._options.brightness)}};fh.prototype.availableOptions=yn.prototype.availableOptions;Zi=fh});var uf,cf=_(()=>{uf=`varying vec2 v_texCoord;
uniform sampler2D u_image;
uniform float u_contrast;

void main() {
  vec4 texColor = texture2D(u_image, v_texCoord);
  gl_FragColor = vec4(((texColor.rgb - vec3(0.5)) * u_contrast + vec3(0.5) * texColor.a), texColor.a);
}
`});var xn,ph,st,df=_(()=>{O();cf();We();xn=class extends R.Filter{constructor(){super();this._fragmentSource=uf}_applyCanvas(e,t,i,r=!1){let s=t.getCanvas(),n=t.getContext(),a=i.getContext(),l=n.getImageData(0,0,s.width,s.height),{contrast:h}=this._options;if(h!==1){for(let c=0;c<s.width*s.height;c++){let m=c*4;l.data[m]=(l.data[m]-127)*h+127,l.data[m+1]=(l.data[m+1]-127)*h+127,l.data[m+2]=(l.data[m+2]-127)*h+127}a.putImageData(l,0,0)}}};xn.prototype.availableOptions={contrast:{type:"number",default:1,uniformType:"f"}};ph=class extends ae{constructor(...e){super(...e);this._filter=new xn}update(){this._filter.setContrast(this._options.contrast)}};ph.prototype.availableOptions=xn.prototype.availableOptions;st=ph});var ff,mf=_(()=>{ff=`varying vec2 v_texCoord;
uniform sampler2D u_image;
uniform mat4 u_colorMatrix;
uniform vec4 u_colorMatrixOffset;

void main() {
  vec4 texColor = texture2D(u_image, v_texCoord);
  gl_FragColor = texColor * u_colorMatrix + u_colorMatrixOffset;
}
`});var Yv,bn,_h,vn,pf=_(()=>{O();mf();We();({ColorMatrix:Yv}=B),bn=class extends R.Filter{constructor(){super();this._fragmentSource=ff}_applyCanvas(e,t,i,r=!1){let s=t.getCanvas(),n=t.getContext(),a=i.getContext(),l=n.getImageData(0,0,s.width,s.height),{colorMatrix:h}=this._options,c=new S(0,0,0,0);for(let m=0;m<s.width*s.height;m++){let d=m*4;c.r=l.data[d]/255,c.g=l.data[d+1]/255,c.b=l.data[d+2]/255,c=h.apply(c),l.data[d]=c.r*255,l.data[d+1]=c.g*255,l.data[d+2]=c.b*255}a.putImageData(l,0,0)}};bn.prototype.availableOptions={colorMatrix:{type:"color-matrix",default:new Yv,uniformType:"mat4"},colorMatrixOffset:{type:"array",default:[],uniformType:"4f"}};_h=class extends ae{constructor(...e){super(...e);this._filter=new bn}update(){this._filter.setColorMatrix(this._options.colorMatrix)}};_h.prototype.availableOptions=bn.prototype.availableOptions;vn=_h});var gf,_f=_(()=>{gf=`varying vec2 v_texCoord;
uniform sampler2D u_image;
uniform float u_desaturation;

void main() {
  vec4 texColor = texture2D(u_image, v_texCoord);
  vec3 grayXfer = vec3(0.3, 0.59, 0.11);
  vec3 gray = vec3(dot(grayXfer, texColor.xyz));
  gl_FragColor = vec4(mix(texColor.xyz, gray, u_desaturation) * texColor.a, texColor.a);
}
`});var wn,gh,Ut,yf=_(()=>{O();_f();We();wn=class extends R.Filter{constructor(){super();this._fragmentSource=gf}_applyCanvas(e,t,i,r=!1){let s=t.getCanvas(),n=t.getContext(),a=i.getContext(),l=n.getImageData(0,0,s.width,s.height),h=[.3,.59,.11],{desaturation:c}=this._options;for(let m=0;m<s.width*s.height;m++){let d=m*4,u=h[0]*l.data[d]/255+h[1]*l.data[d+1]/255+h[2]*l.data[d+2]/255;l.data[d]+=(u*255-l.data[d])*c,l.data[d+1]+=(u*255-l.data[d+1])*c,l.data[d+2]+=(u*255-l.data[d+2])*c}a.putImageData(l,0,0)}};wn.prototype.availableOptions={desaturation:{type:"number",default:1,uniformType:"f"}};gh=class extends ae{constructor(...e){super(...e);this._filter=new wn}update(){this._filter.setDesaturation(this._options.desaturation)}};gh.prototype.availableOptions=wn.prototype.availableOptions;Ut=gh});var bf,xf=_(()=>{bf=`precision highp float;

uniform sampler2D u_image;
uniform vec4 u_lightColor;
uniform vec4 u_darkColor;
uniform float u_intensity;
varying vec2 v_texCoord;

const float EPSILON = 0.0000001;
const vec3 GRAYSCALE_WEIGHTS = vec3(0.2126, 0.7152, 0.0722);

vec4 duotoneKernel(vec4 sampledCol, vec4 light, vec4 dark, float intensity) {
  vec4 color = clamp(sampledCol, 0.0, 1.0);
  color.rgb /= max(color.a, EPSILON);
  color = clamp(color, 0.0, 1.0); // necessary to get rid of all extended sRGB issues with OpenGL ES
 
  // Apply intensity as "symmetric gamma"
  if (intensity > 0.0) {
    color.rgb = 1.0 - pow(1.0 - color.rgb, vec3(max(intensity + 1.0, EPSILON)));
  } else {
    color.rgb = pow(color.rgb, vec3(max(-intensity + 1.0, EPSILON)));
  }
 
  // Colorimetric (perceptual luminance-preserving) RGB to grayscale conversion
  // https://en.wikipedia.org/wiki/Grayscale#Colorimetric_(perceptual_luminance-preserving)_conversion_to_grayscale
  float luminance = dot(GRAYSCALE_WEIGHTS, color.rgb);
 
  // Apply DuoTone
  vec4 duotone = mix(dark, light, clamp(luminance, 0.0, 1.0));
  duotone.a *= color.a;
  
  duotone.rgb *= duotone.a;

  return duotone;
}

void main() {
  vec4 texColor = texture2D(u_image, v_texCoord);
  gl_FragColor = duotoneKernel(texColor, u_lightColor, u_darkColor, u_intensity);
}`});var Tn,yh,Rn,vf=_(()=>{O();xf();We();Tn=class extends R.Filter{constructor(){super();this._fragmentSource=bf}_applyCanvas(e,t,i,r=!1){let s=t.getCanvas(),n=t.getContext(),a=i.getContext(),l=n.getImageData(0,0,s.width,s.height),{lightColor:h,darkColor:c,intensity:m}=this._options;for(let d=0;d<s.width*s.height;d++){let u=d*4,f=l.data[u]/255,y=l.data[u+1]/255,g=l.data[u+2]/255,p=l.data[u+3]/255,v=new S(f,y,g,p),x=this._duoToneKernel(v,h,c,m);l.data[u]=x.r*255,l.data[u+1]=x.g*255,l.data[u+2]=x.b*255,l.data[u+3]=x.a*255}a.putImageData(l,0,0)}_duoToneKernel(e,t,i,r){if(e.clone().clamp(0,1),r>0){let h=Math.max(r+1,1e-7);e.r=1-Math.pow(1-e.r,h),e.g=1-Math.pow(1-e.g,h),e.b=1-Math.pow(1-e.b,h)}else{let h=Math.max(-r+1,1e-7);e.r=Math.pow(e.r,h),e.g=Math.pow(e.g,h),e.b=Math.pow(e.b,h)}let n=.2126*e.r+.7152*e.g+.0722*e.b,a=Math.min(Math.max(n,0),1),l=i.clone().mix(t,a);return l.a*=e.a,l}};Tn.prototype.availableOptions={lightColor:{type:"color",default:S.RED,uniformType:"4f"},darkColor:{type:"color",default:S.BLACK,uniformType:"4f"},intensity:{type:"number",default:.5,uniformType:"f"}};yh=class extends ae{constructor(...e){super(...e);this._filter=new Tn}update(){this._filter.setLightColor(this._options.lightColor),this._filter.setDarkColor(this._options.darkColor);let e=2*this._options.intensity-1;this._filter.setIntensity(e)}};yh.prototype.availableOptions=Tn.prototype.availableOptions;Rn=yh});var Tf,wf=_(()=>{Tf=`varying vec2 v_texCoord;
uniform sampler2D u_image;
uniform vec3 u_gamma;

void main() {
  vec4 texColor = texture2D(u_image, v_texCoord);
  vec3 rgb = vec3(texColor.r, texColor.g, texColor.b);
  rgb = pow(rgb, u_gamma);
  gl_FragColor = vec4(rgb * texColor.a, texColor.a);;
}
`});var Cn,xh,kn,Rf=_(()=>{O();wf();We();Cn=class extends R.Filter{constructor(){super();this._fragmentSource=Tf}_applyCanvas(e,t,i,r=!1){let s=t.getCanvas(),n=t.getContext(),a=i.getContext(),l=n.getImageData(0,0,s.width,s.height),{gamma:h}=this._options,c=new Float32Array(256);for(let u=0;u<256;u++)c[u]=255*Math.pow(u/255,h.r);let m=new Float32Array(256);for(let u=0;u<256;u++)m[u]=255*Math.pow(u/255,h.g);let d=new Float32Array(256);for(let u=0;u<256;u++)d[u]=255*Math.pow(u/255,h.b);for(let u=0;u<s.width*s.height;u++){let f=u*4;l.data[f]=c[l.data[f]],l.data[f+1]=m[l.data[f+1]],l.data[f+2]=d[l.data[f+2]]}a.putImageData(l,0,0)}};Cn.prototype.availableOptions={gamma:{type:"color",default:S.WHITE,uniformType:"3f"}};xh=class extends ae{constructor(...e){super(...e);this._filter=new Cn}update(){this._filter.setGamma(this._options.gamma)}};xh.prototype.availableOptions=Cn.prototype.availableOptions;kn=xh});var kf,Cf=_(()=>{kf=`varying vec2 v_texCoord;
uniform sampler2D u_image;

uniform vec3 u_color;

void main() {
  vec4 texColor = texture2D(u_image, v_texCoord);

  vec2 textureCoord = v_texCoord - vec2(0.5, 0.5);
  textureCoord /= 0.75;

  float d = 1.0 - dot(textureCoord, textureCoord);
  d = clamp(d, 0.2, 1.0);
  vec3 newColor = texColor.rgb * d * u_color.rgb;
  gl_FragColor = vec4(vec3(newColor) * texColor.a, texColor.a);
}
`});var Sn,bh,ps,Sf=_(()=>{O();Cf();We();Sn=class extends R.Filter{constructor(){super();this._fragmentSource=kf}_applyCanvas(e,t,i,r=!1){let s=t.getCanvas(),n=t.getContext(),a=i.getContext(),l=n.getImageData(0,0,s.width,s.height),{color:h}=this._options,c;for(let m=0;m<s.width;m++)for(let d=0;d<s.height;d++){let u=(s.width*d+m)*4,f=m/s.width,y=d/s.height,g=(f-.5)/.75,p=(y-.5)/.75,v=g*g,x=p*p;c=1-(v+x),c=Math.min(Math.max(c,.1),1),l.data[u]*=c*h.r,l.data[u+1]=l.data[u+1]*(c*h.g),l.data[u+2]=l.data[u+2]*(c*h.b),l.data[u+3]=255}a.putImageData(l,0,0)}};Sn.prototype.availableOptions={color:{type:"color",default:S.WHITE,uniformType:"3f"}};bh=class extends ae{constructor(...e){super(...e);this._filter=new Sn}update(){this._filter.setColor(this._options.color)}};bh.prototype.availableOptions=Sn.prototype.availableOptions;ps=bh});var Ff,Of=_(()=>{Ff=`varying vec2 v_texCoord;
uniform sampler2D u_image;

void main() {
  vec4 texColor = texture2D(u_image, v_texCoord);
  texColor.b = texColor.g * 0.33;
  texColor.r = texColor.r * 0.6;
  texColor.b += texColor.r * 0.33;
  texColor.g = texColor.g * 0.7;
  gl_FragColor = texColor;
}
`});var Ef,If,On,Mf=_(()=>{O();Of();We();Ef=class extends R.Filter{constructor(){super();this._fragmentSource=Ff}_applyCanvas(e,t,i,r=!1){let s=t.getCanvas(),n=t.getContext(),a=i.getContext(),l=n.getImageData(0,0,s.width,s.height);for(let h=0;h<s.width;h++)for(let c=0;c<s.height;c++){let m=(s.width*c+h)*4;l.data[m+2]=l.data[m+1]*.33,l.data[m]*=.6,l.data[m+2]+=l.data[m]*.33,l.data[m+1]=l.data[m+1]*.7,l.data[m+3]=255}a.putImageData(l,0,0)}},If=class extends ae{constructor(...e){super(...e);this._filter=new Ef}},On=If});var Df,Bf=_(()=>{Df=`varying vec2 v_texCoord;
uniform sampler2D u_image;
vec3 W = vec3(0.2125, 0.7154, 0.0721);

void main() {
  vec4 texColor = texture2D(u_image, v_texCoord);
  float luminance = dot(texColor.rgb, W);
  gl_FragColor = vec4(vec3(luminance) * texColor.a, texColor.a);
}
`});var Pf,Af,_s,Lf=_(()=>{O();Bf();We();Pf=class extends R.Filter{constructor(){super();this._fragmentSource=Df}_applyCanvas(e,t,i,r=!1){let s=t.getCanvas(),n=t.getContext(),a=i.getContext(),l=n.getImageData(0,0,s.width,s.height);for(let h=0;h<s.width;h++)for(let c=0;c<s.height;c++){let m=(s.width*c+h)*4,d=l.data[m]*.2125+l.data[m+1]*.7154+l.data[m+2]*.0721;l.data[m]=d,l.data[m+1]=d,l.data[m+2]=d}a.putImageData(l,0,0)}},Af=class extends ae{constructor(...e){super(...e);this._filter=new Pf}},_s=Af});var Nf,zf=_(()=>{Nf=`varying vec2 v_texCoord;
uniform sampler2D u_image;
uniform sampler2D u_lookupTable;

void main() {
  vec4 texColor = texture2D(u_image, v_texCoord);
  float r = texture2D(u_lookupTable, vec2(texColor.r, 0.0)).r;
  float g = texture2D(u_lookupTable, vec2(texColor.g, 0.0)).g;
  float b = texture2D(u_lookupTable, vec2(texColor.b, 0.0)).b;

  gl_FragColor = vec4(vec3(r, g, b) * texColor.a, texColor.a);
}
`});var vh,Uf,Fn,wh=_(()=>{O();zf();We();vh=class extends R.Filter{constructor(...e){super(...e);this._fragmentSource=Nf}_applyCanvas(e,t,i,r=!1){let s=t.getCanvas(),n=t.getContext(),a=i.getContext(),l=n.getImageData(0,0,s.width,s.height),h=this._options.lookupTableData;for(let c=0;c<s.width*s.height;c++){let m=c*4,d=l.data[m];l.data[m]=h[d*4];let u=l.data[m+1];l.data[m+1]=h[1+u*4];let f=l.data[m+2];l.data[m+2]=h[2+f*4]}a.putImageData(l,0,0)}};vh.prototype.availableOptions={lookupTable:{type:"number",default:1,uniformType:"i"},lookupTableData:{type:"array",default:[]}};Uf=class extends ae{constructor(...e){super(...e);this._filter=new vh({lookupTable:this._options.textureGLUnit}),this._textures={},this._renderers={}}update(e){let t=e.getRenderer();t.isOfType("webgl")?this._updateWebGLTexture(e):t.isOfType("canvas")&&this._filter.setLookupTableData(this._options.data)}_updateWebGLTexture(e){if(typeof this._options.data=="undefined")throw new Error("LookupTable: No data specified.");let t=new Uint8Array(this._options.data),i=e.getRenderer(),{id:r}=i;this._renderers[r]=i,this._textures[r]||(this._textures[r]=new R.BaseTexture);let s=this._textures[r],n=new R.PixelArrayImage(256,1,t);s.setSource(n),s.setGLUnit(this._options.textureGLUnit),i.isOfType("webgl")&&i.updateTexture(s)}dispose(){super.dispose();for(let e in this._textures)this._textures[e].dispose(),delete this._textures[e];delete this._options.data}},Fn=Uf});var Wf,Gf=_(()=>{Wf=`/**
 * Based off of GPUImage's LookupFilter:
 * https://github.com/BradLarson/GPUImage/blob/master/framework/Source/GPUImageLookupFilter.m
 */

varying vec2 v_texCoord;
uniform sampler2D u_image;
uniform sampler2D u_lookupTable;

void main() {
  vec4 texColor = texture2D(u_image, v_texCoord);
  float blueColor = texColor.b * 63.0;

  vec2 quad1;
  quad1.y = floor(floor(blueColor) / 8.0);
  quad1.x = floor(blueColor) - (quad1.y * 8.0);

  vec2 quad2;
  quad2.y = floor(ceil(blueColor) / 8.0);
  quad2.x = ceil(blueColor) - (quad2.y * 8.0);

  vec2 texCoord1;
  texCoord1.x = (quad1.x * 0.125) + 0.5/512.0 + ((0.125 - 1.0/512.0) * texColor.r);
  texCoord1.y = (quad1.y * 0.125) + 0.5/512.0 + ((0.125 - 1.0/512.0) * texColor.g);

  vec2 texCoord2;
  texCoord2.x = (quad2.x * 0.125) + 0.5/512.0 + ((0.125 - 1.0/512.0) * texColor.r);
  texCoord2.y = (quad2.y * 0.125) + 0.5/512.0 + ((0.125 - 1.0/512.0) * texColor.g);

  vec4 newColor1 = texture2D(u_lookupTable, texCoord1);
  vec4 newColor2 = texture2D(u_lookupTable, texCoord2);

  vec4 newColor = mix(newColor1, newColor2, fract(blueColor));
  gl_FragColor = mix(texColor, vec4(newColor.rgb, texColor.w), texColor.a);
}
`});var Vf,Hf,Th,Rh,En,jf=_(()=>{O();Gf();We();({Vector2:Vf}=B),Hf=3,Th=class extends R.Filter{constructor(){super();this._precomputeQuads(),this._fragmentSource=Wf}_precomputeQuads(){this._quads=[];for(let e=0;e<256;e++){let t=e/255*63,i=new Vf;i.y=(t|0)*.125|0,i.x=(t|0)-i.y*8,this._quads.push(i)}}_applyCanvas(e,t,i,r=!1){let s=t.getCanvas(),n=t.getContext(),a=i.getContext(),l=this._options.lookupTableImage,c=this._createImageCanvas(l).getContext("2d"),m=n.getImageData(0,0,s.width,s.height),d=c.getImageData(0,0,l.width,l.height),u=new Vf;for(let f=0;f<s.width*s.height*4;f+=4){let y=m.data[f],g=m.data[f+1],p=m.data[f+2],v=m.data[f+3]/255,x=this._quads[p],T=64;u.x=x.x*T,u.y=x.y*T,u.x+=Math.floor(y/4),u.y+=Math.floor(g/4);let D=(l.width*u.y+u.x)*4|0,b=d.data[D];b=y*(1-v)+b*v;let w=d.data[D+1];w=g*(1-v)+w*v;let G=d.data[D+2];G=p*(1-v)+G*v,m.data[f]=b,m.data[f+1]=w,m.data[f+2]=G}a.putImageData(m,0,0)}_createImageCanvas(e){let t=k.createCanvas();return t.width=e.width,t.height=e.height,t.getContext("2d").drawImage(e,0,0),t}};Th.prototype.availableOptions={lookupTable:{type:"number",default:Hf,uniformType:"i"},lookupTableImage:{type:"image",uniformType:null}};Rh=class extends ae{constructor(...e){super(...e);this._filter=new Th,this._textures={}}update(e){let t=e.getRenderer();t.isOfType("webgl")?this._updateWebGLTexture(e):t.isOfType("canvas")&&this._filter.setLookupTableImage(this._options.image)}_updateWebGLTexture(e){let t=e.getRenderer(),{id:i}=t;this._textures[i]||(this._textures[i]=new R.BaseTexture);let r=this._textures[i];r.setSource(this._options.image),r.setGLUnit(Hf),t.updateTexture(r)}dispose(){super.dispose();for(let e in this._textures)delete this._textures[e]}};Rh.prototype.availableOptions={image:{type:"image"}};En=Rh});var Xf,qf=_(()=>{Xf=`varying vec2 v_texCoord;
uniform sampler2D u_image;
uniform float u_saturation;

const vec3 luminanceWeighting = vec3(0.2125, 0.7154, 0.0721);

void main() {
  vec4 texColor = texture2D(u_image, v_texCoord);
  float luminance = dot(texColor.rgb, luminanceWeighting);

  vec3 greyScaleColor = vec3(luminance);

  gl_FragColor = vec4(mix(greyScaleColor, texColor.rgb, u_saturation) * texColor.a, texColor.a);
}
`});var In,Ch,ot,Yf=_(()=>{O();qf();We();In=class extends R.Filter{constructor(){super();this._fragmentSource=Xf}_applyCanvas(e,t,i,r=!1){let s=t.getCanvas(),n=t.getContext(),a=i.getContext(),l=n.getImageData(0,0,s.width,s.height),{saturation:h}=this._options;for(let c=0;c<s.width;c++)for(let m=0;m<s.height;m++){let d=(s.width*m+c)*4,u=l.data[d]*.2125+l.data[d+1]*.7154+l.data[d+2]*.0721;l.data[d]=u*(1-h)+l.data[d]*h,l.data[d+1]=u*(1-h)+l.data[d+1]*h,l.data[d+2]=u*(1-h)+l.data[d+2]*h}a.putImageData(l,0,0)}};In.prototype.availableOptions={saturation:{type:"number",default:0,uniformType:"f"}};Ch=class extends ae{constructor(...e){super(...e);this._filter=new In}update(){this._filter.setSaturation(this._options.saturation)}};Ch.prototype.availableOptions=In.prototype.availableOptions;ot=Ch});var Jf,Kf=_(()=>{Jf=`varying vec2 v_texCoord;
uniform sampler2D u_image;
uniform vec3 u_color;

void main() {
  vec4 texColor = texture2D(u_image, v_texCoord);
  vec4 overlayVec4 = vec4(u_color, texColor.a);
  gl_FragColor = max(overlayVec4 * texColor.a, texColor);
}
`});var Mn,kh,Bn,Zf=_(()=>{O();Kf();We();Mn=class extends R.Filter{constructor(){super();this._fragmentSource=Jf}_applyCanvas(e,t,i,r=!1){let s=t.getCanvas(),n=t.getContext(),a=i.getContext(),l=n.getImageData(0,0,s.width,s.height);for(let h=0;h<s.width;h++)for(let c=0;c<s.height;c++){let m=(s.width*c+h)*4;l.data[m]=Math.max(this._options.color.r*255,l.data[m]),l.data[m+1]=Math.max(this._options.color.g*255,l.data[m+1]),l.data[m+2]=Math.max(this._options.color.b*255,l.data[m+2])}a.putImageData(l,0,0)}};Mn.prototype.availableOptions={color:{type:"color",default:S.WHITE,uniformType:"3f"}};kh=class extends ae{constructor(...e){super(...e);this._filter=new Mn}update(){this._filter.setColor(this._options.color)}};kh.prototype.availableOptions=Mn.prototype.availableOptions;Bn=kh});var Sh,X,Qf=_(()=>{O();wh();Sh=class extends Fn{constructor(...e){super(...e);this._options.rgbControlPoints||(this._options.rgbControlPoints={red:this._options.controlPoints,green:this._options.controlPoints,blue:this._options.controlPoints}),this._updateLookupTable()}_updateLookupTable(){let e=this._calculateSplineCurve(this._options.rgbControlPoints.red),t=this._calculateSplineCurve(this._options.rgbControlPoints.green),i=this._calculateSplineCurve(this._options.rgbControlPoints.blue);this._options.data=this._buildLookupTable(e,t,i)}_buildLookupTable(e,t,i){let r=[];for(let s=0;s<256;s++)r.push(Math.min(Math.max(s+e[s],0),255)),r.push(Math.min(Math.max(s+t[s],0),255)),r.push(Math.min(Math.max(s+i[s],0),255)),r.push(255);return r}_calculateSplineCurve(e){e=e.sort(function(n,a){return n[0]>a[0]});let t=this._getSplineCurve(e),i=t[0],r;if(i[0]>0)for(r=0;r<i[0];r++)t.unshift([0,0]);let s=[];for(r=0;r<t.length;r++){let n=t[r],a=[n[0],n[0]],l=Math.sqrt(Math.pow(a[0]-n[0],2)+Math.pow(a[1]-n[1],2));a[1]>n[1]&&(l=-l),s.push(l)}return s}_getSplineCurve(e){let t=this._secondDerivative(e),i=t.length,r=[],s;for(s=0;s<i;s++)r[s]=t[s];let n=[];for(s=0;s<i-1;s++){let a=e[s],l=e[s+1];for(let h=a[0];h<l[0];h++){let c=(h-a[0])/(l[0]-a[0]),m=1-c,d=c,u=l[0]-a[0],f=m*a[1]+d*l[1]+u*u/6*((m*m*m-m)*r[s]+(d*d*d-d)*r[s+1]);f>255?f=255:f<0&&(f=0),n.push([h,f])}}return n.length===255&&n.push(e[e.length-1]),n}_secondDerivative(e){let t=e.length;if(t<=0||t===1)return null;let i=[],r=[],s,n;for(i[0]=[0,1,0],s=1;s<t-1;s++){let l=e[s-1],h=e[s],c=e[s+1];i[s]=i[s]||[],i[s][0]=(h[0]-l[0])/6,i[s][1]=(c[0]-l[0])/3,i[s][2]=(c[0]-h[0])/6,r[s]=(c[1]-h[1])/(c[0]-h[0])-(h[1]-l[1])/(h[0]-l[0])}for(r[0]=0,r[t-1]=0,i[t-1]=[0,1,0],s=1;s<t;s++)n=i[1][0]/i[s-1][1],i[s][1]-=n*i[s-1][2],i[s][0]=0,r[s]-=n*r[s-1];for(s=t-2;s>0;s--)n=i[s][2]/i[s+1][1],i[s][1]-=n*i[s+1][0],i[s][2]=0,r[s]-=n*r[s+1];let a=[];for(s=0;s<t;s++)a[s]=r[s]/i[s][1];return a}};Sh.prototype.availableOptions={rgbControlPoints:{type:"object"},controlPoints:{type:"array",default:[]},textureGLUnit:{type:"number",default:1}};X=Sh});var ep,$f=_(()=>{ep=`varying vec2 v_texCoord;
uniform sampler2D u_image;

void main() {
  vec4 texColor = texture2D(u_image, v_texCoord);
  float gray = texColor.r * 0.3 + texColor.g * 0.3 + texColor.b * 0.3;
  gray -= 0.2;
  gray = clamp(gray, 0.0, 1.0);
  gray += 0.15;
  gray *= 1.4;
  gl_FragColor = vec4(vec3(gray) * texColor.a, texColor.a);
}
`});var tp,ip,Dn,rp=_(()=>{O();$f();We();tp=class extends R.Filter{constructor(){super();this._fragmentSource=ep}_applyCanvas(e,t,i,r=!1){let s=t.getCanvas(),n=t.getContext(),a=i.getContext(),l=n.getImageData(0,0,s.width,s.height);for(let h=0;h<s.width;h++)for(let c=0;c<s.height;c++){let m=(s.width*c+h)*4,d=l.data[m]/255*.3+l.data[m+1]/255*.3+l.data[m+2]/255*.3;d-=.2,d=Math.max(0,Math.min(1,d)),d+=.15,d*=1.4,d*=255,l.data[m]=d,l.data[m+1]=d,l.data[m+2]=d}a.putImageData(l,0,0)}},ip=class extends ae{constructor(...e){super(...e);this._filter=new tp}},Dn=ip});var op,sp=_(()=>{op=`precision highp float;

uniform sampler2D u_image;

uniform sampler2D u_lookupTable;

uniform float u_resolution;     // Texture-Resolution, must be power of 2: 64, 128, 256, 512, 1024, 2048, 4096
uniform float u_horizontalTileCount; // Horizontal Blue Tiles
uniform float u_verticalTileCount; // Vertical Blue Tiles

varying vec2 v_texCoord;

const float EPSILON = 0.000001;

// Try to get the exact pixel of the lut map image
vec3 lutColor(int texPosX, int texPosY) {
    return texture2D(u_lookupTable, (0.5 / u_resolution) + vec2(float(texPosX), float(texPosY)) / u_resolution).rgb;
}

vec3 bilinearInterpolate(vec3 cRfGf, vec3 cRfGc, vec3 cRcGf, vec3 cRcGc, float redFract, float greenFract) {
    return mix(mix(cRfGf, cRcGf, redFract), mix(cRfGc, cRcGc, redFract), greenFract);
}

void main() {
    vec4 inputColor = clamp(texture2D(u_image, v_texCoord.xy), 0.0, 1.0);

    vec3 sourceColor = vec3(inputColor.rgb / max(inputColor.a, EPSILON)); 

    vec3 ranges = vec3(
        floor(u_resolution / u_horizontalTileCount - 1.0),
        floor(u_resolution / u_verticalTileCount - 1.0),
        floor(u_horizontalTileCount * u_horizontalTileCount - 1.0)
    );
    
    vec3 tmp = sourceColor * ranges;
    ivec3 floors = ivec3(tmp);
    ivec3 ceils = ivec3(ceil(tmp));
    vec3 fracts = fract(tmp);

    // Map tile index to tile pixel pos.
    ivec2 pixelsPerTile = ivec2(
        u_resolution / u_horizontalTileCount, 
        u_resolution / u_verticalTileCount
      );

    ivec2 tileFloor; // Blue tile index
    tileFloor.y = floors.z / int(u_horizontalTileCount);
    tileFloor.x = (floors.z - (tileFloor.y * int(u_horizontalTileCount)));

    ivec2 tileCeil; // Blue tile index
    tileCeil.y = ceils.z / int(u_horizontalTileCount);
    tileCeil.x = (ceils.z - (tileCeil.y * int(u_horizontalTileCount)));
    
    tileFloor *= pixelsPerTile;
    tileCeil *= pixelsPerTile; 
    
    
    // Interpolate between red and green
    vec3 lutColorFB = bilinearInterpolate(
        lutColor(tileFloor.x + floors.x, tileFloor.y + floors.y),
        lutColor(tileFloor.x + floors.x, tileFloor.y + ceils.y),
        lutColor(tileFloor.x + ceils.x,  tileFloor.y + floors.y),
        lutColor(tileFloor.x + ceils.x,  tileFloor.y + ceils.y),
        fracts.x, fracts.y
    );
    vec3 lutColorCB = bilinearInterpolate(
        lutColor(tileCeil.x + floors.x, tileCeil.y + floors.y),
        lutColor(tileCeil.x + floors.x, tileCeil.y + ceils.y),
        lutColor(tileCeil.x + ceils.x,  tileCeil.y + floors.y),
        lutColor(tileCeil.x + ceils.x,  tileCeil.y + ceils.y),
        fracts.x, fracts.y
    );

    // Interpolate between the blue values
    vec3 interpolation = mix(lutColorFB, lutColorCB, fracts.z);

    // Round Color Values to prevent that for ex. 254.999999 is cutting to 254 instead of 255;
    interpolation = clamp(floor(interpolation * 255. + .5) / 255., 0.0, 1.0);

    gl_FragColor = vec4(interpolation.rgb * inputColor.a, inputColor.a);
}
`});var Pn,np,ap,Oh,Fh,An,lp=_(()=>{O();sp();We();({Vector2:Pn,Vector3:np}=B),ap=3,Oh=class extends R.Filter{constructor(){super();this._precomputeQuads(),this._fragmentSource=op}_precomputeQuads(){this._quads=[];for(let e=0;e<256;e++){let t=e/255*63,i=new Pn;i.y=(t|0)*.125|0,i.x=(t|0)-i.y*8,this._quads.push(i)}}_applyCanvas(e,t,i,r=!1){let{resolution:s,horizontalTileCount:n,verticalTileCount:a}=this._options,l=t.getCanvas(),h=t.getContext(),c=i.getContext(),m=this._options.lookupTableImage,u=this._createImageCanvas(m).getContext("2d"),f={width:128,height:128};s?f={width:s,height:s}:m.width&&m.height&&(f={width:m.width,height:m.height});let y=h.getImageData(0,0,l.width,l.height),g=u.getImageData(0,0,f.width,f.height),p=new np(f.width/n-1|0,f.height/a-1|0,n*a-1|0),v=new S,x=new S,T=new S,D=new S,b=new S,w=new S,G=new S,N=new S,j=new Pn,K=new Pn,Y=(J,be,me,de)=>{J.r=be.r*(1-de)+me.r*de,J.g=be.g*(1-de)+me.g*de,J.b=be.b*(1-de)+me.b*de},W=(J,be,me)=>{be=.5+be|0,me=.5+me|0;let de=(me*f.width+be)*4;J.r=g.data[de]/255,J.g=g.data[de+1]/255,J.b=g.data[de+2]/255,J.a=g.data[de+3]/255},he=new S,He=new S,De=(J,be,me,de,$,ge,ze)=>{Y(he,be,de,ge),Y(He,me,$,ge),Y(J,he,He,ze)},It=new Pn(f.width,f.height).divide(n,a).floor();for(let J=0;J<l.width*l.height*4;J+=4){v.set(y.data[J]/255,y.data[J+1]/255,y.data[J+2]/255,y.data[J+3]/255);let be=new np(v.r*p.x,v.g*p.y,v.b*p.z),me=be.clone().floor().toInt(),de=be.clone().ceil().toInt(),$=be.clone().fract();j.y=me.z/n|0,j.x=me.z-j.y*n|0,K.y=de.z/n|0,K.x=de.z-K.y*n|0,j.multiply(It),K.multiply(It),W(b,j.x+me.x,j.y+me.y),W(w,j.x+me.x,j.y+de.y),W(G,j.x+de.x,j.y+me.y),W(N,j.x+de.x,j.y+de.y),De(T,b,w,G,N,$.x,$.y),W(b,K.x+me.x,K.y+me.y),W(w,K.x+me.x,K.y+de.y),W(G,K.x+de.x,K.y+me.y),W(N,K.x+de.x,K.y+de.y),De(D,b,w,G,N,$.x,$.y),Y(x,T,D,$.z),y.data[J]=Math.ceil(x.r*255),y.data[J+1]=Math.ceil(x.g*255),y.data[J+2]=Math.ceil(x.b*255)}c.putImageData(y,0,0)}_createImageCanvas(e){let t=k.createCanvas();return t.width=e.width,t.height=e.height,t.getContext("2d").drawImage(e,0,0),t}};Oh.prototype.availableOptions={lookupTable:{type:"number",default:ap,uniformType:"i"},lookupTableImage:{type:"image",uniformType:null},resolution:{type:"number",uniformType:"f"},horizontalTileCount:{type:"number",default:5,uniformType:"f"},verticalTileCount:{type:"number",default:5,uniformType:"f"}};Fh=class extends ae{constructor(...e){super(...e);this._filter=new Oh,this._textures={}}update(e){let t=e.getRenderer();t.isOfType("webgl")?this._updateWebGLTexture(e):t.isOfType("canvas")&&this._filter.setLookupTableImage(this._options.image);let{resolution:i,verticalTileCount:r,horizontalTileCount:s,image:n}=this._options;this._filter.set({resolution:i||n.width,verticalTileCount:r,horizontalTileCount:s})}_updateWebGLTexture(e){let t=e.getRenderer(),{id:i}=t;this._textures[i]||(this._textures[i]=new R.BaseTexture);let r=this._textures[i];r.setSource(this._options.image),r.setGLUnit(ap),r.setMinFilter(R.BaseTexture.NearestFilter),t.updateTexture(r)}dispose(){super.dispose();for(let e in this._textures)delete this._textures[e]}};Fh.prototype.availableOptions={image:{type:"image"},resolution:{type:"number"},horizontalTileCount:{type:"number",default:5},verticalTileCount:{type:"number",default:5}};An=Fh});var ie={};Te(ie,{Brightness:()=>Zi,ColorMatrixPrimitive:()=>vn,Contrast:()=>st,Desaturation:()=>Ut,DuoTone:()=>Rn,Gamma:()=>kn,Glow:()=>ps,Gobblin:()=>On,Grayscale:()=>_s,LookupTable:()=>Fn,LookupTableImage:()=>En,Saturation:()=>ot,SoftColorOverlay:()=>Bn,ThreeDLookupTableImage:()=>An,ToneCurve:()=>X,X400:()=>Dn});var oe=_(()=>{hf();df();pf();yf();vf();Rf();Sf();Mf();Lf();wh();jf();Yf();Zf();Qf();rp();lp()});var Ln,zn,Eh=_(()=>{se();oe();Ln=class extends z{constructor(...e){super(...e);this._stack.push(new Zi({brightness:0}))}render(e,t,i){return this._stack.isEmpty()&&this._stack.push(new Zi({brightness:0})),super.render(e,t,i)}};Ln.isIdentity=!0;Ln.identifier="identity";zn=Ln});var Ih,hp,cp=_(()=>{se();oe();Ih=class extends z{constructor(...e){super(...e);this._stack.push(new st({contrast:.63})),this._stack.push(new Zi({brightness:.12})),this._stack.push(new X({rgbControlPoints:{red:[[0,38],[94,94],[148,142],[175,187],[255,255]],green:[[0,0],[77,53],[171,190],[255,255]],blue:[[0,10],[48,85],[174,228],[255,255]]}}))}};Ih.identifier="a15";hp=Ih});var Mh,up,dp=_(()=>{se();oe();Mh=class extends z{constructor(...e){super(...e);this._stack.push(new Ut({desaturation:.5})),this._stack.push(new X({rgbControlPoints:{red:[[0,0],[170,170],[212,219],[234,242],[255,255]],green:[[0,0],[170,168],[234,231],[255,255]],blue:[[0,0],[170,170],[212,208],[255,255]]}}))}};Mh.identifier="breeze";up=Mh});var Bh,mp,fp=_(()=>{se();oe();Bh=class extends z{constructor(...e){super(...e);this._stack.push(new _s)}};Bh.identifier="bw";mp=Bh});var Dh,pp,_p=_(()=>{se();oe();Dh=class extends z{constructor(...e){super(...e);this._stack.push(new _s),this._stack.push(new st({contrast:1.5}))}};Dh.identifier="bwhard";pp=Dh});var Ph,gp,yp=_(()=>{se();oe();Ph=class extends z{constructor(...e){super(...e);this._stack.push(new X({rgbControlPoints:{red:[[0,69],[55,110],[202,230],[255,255]],green:[[0,44],[89,93],[185,141],[255,189]],blue:[[0,76],[39,82],[218,138],[255,171]]}}))}};Ph.identifier="celsius";gp=Ph});var Ah,xp,bp=_(()=>{se();oe();Ah=class extends z{constructor(...e){super(...e);this._stack.push(new X({rgbControlPoints:{red:[[0,0],[44,44],[124,143],[221,204],[255,255]],green:[[0,0],[130,127],[213,199],[255,255]],blue:[[0,0],[51,52],[219,204],[255,255]]}}))}};Ah.identifier="chest";xp=Ah});var Nn,vp,wp=_(()=>{O();se();oe();Nn=class extends z{constructor(...e){super(...e,{intensity:{type:"number",default:.5,required:!0,setter(t){return this._filterPrimitive&&(this._filterPrimitive.setIntensity(t),this._stack.setIntensity(1)),this._dirty=!0,t}}});this._filterPrimitive=new Rn({lightColor:this._options.lightColor||S.WHITE,darkColor:this._options.darkColor||S.BLACK,intensity:this._options.intensity||.5}),this._stack.push(this._filterPrimitive)}};Nn.prototype.availableOptions={lightColor:{type:"color",default:S.WHITE,required:!0,setter(o){return this._filterPrimitive&&this._filterPrimitive.setLightColor(o),this.setDirty&&this.setDirty(!0),o}},darkColor:{type:"color",default:S.BLACK,required:!0,setter(o){return this._filterPrimitive&&this._filterPrimitive.setDarkColor(o),this.setDirty&&this.setDirty(!0),o}},intensity:{type:"number",default:.5,required:!0}};Nn.identifier="duotone";vp=Nn});var Lh,Tp,Rp=_(()=>{se();oe();Lh=class extends z{constructor(...e){super(...e);this._stack.push(new X({rgbControlPoints:{red:[[0,0],[44,28],[63,48],[128,132],[235,248],[255,255]],green:[[0,0],[20,10],[60,45],[190,209],[211,231],[255,255]],blue:[[0,31],[41,62],[150,142],[234,212],[255,224]]}}))}};Lh.identifier="fixie";Tp=Lh});var zh,Cp,kp=_(()=>{se();oe();zh=class extends z{constructor(...e){super(...e);this._stack.push(new ot({saturation:1.35})),this._stack.push(new st({contrast:1.1}))}};zh.identifier="food";Cp=zh});var Nh,Sp,Op=_(()=>{se();oe();Nh=class extends z{constructor(...e){super(...e);this._stack.push(new X({rgbControlPoints:{red:[[0,9],[21,11],[45,24],[255,220]],green:[[0,12],[21,21],[42,42],[150,150],[170,173],[255,210]],blue:[[0,28],[43,72],[128,185],[255,220]]}}))}};Nh.identifier="fridge";Sp=Nh});var Uh,Fp,Ep=_(()=>{se();oe();Uh=class extends z{constructor(...e){super(...e);this._stack.push(new X({rgbControlPoints:{red:[[0,65],[28,67],[67,113],[125,183],[187,217],[255,229]],green:[[0,52],[42,59],[104,134],[169,209],[255,240]],blue:[[0,52],[65,68],[93,104],[150,153],[255,198]]}}))}};Uh.identifier="front";Fp=Uh});var Gh,Ip,Mp=_(()=>{se();oe();Gh=class extends z{constructor(...e){super(...e);this._stack.push(new st({contrast:1.1})),this._stack.push(new X({rgbControlPoints:{red:[[0,0],[94,74],[181,205],[255,255]],green:[[0,0],[127,127],[255,255]],blue:[[0,0],[102,73],[227,213],[255,255]]}}))}};Gh.identifier="glam";Ip=Gh});var Wh,Bp,Dp=_(()=>{se();oe();Wh=class extends z{constructor(...e){super(...e);this._stack.push(new On)}};Wh.identifier="gobblin";Bp=Wh});var Vh,Pp,Ap=_(()=>{se();oe();Vh=class extends z{constructor(...e){super(...e);this._stack.push(new X({controlPoints:[[0,0],[53,32],[91,80],[176,205],[255,255]]})),this._stack.push(new ot({saturation:.9}))}};Vh.identifier="k1";Pp=Vh});var Hh,Lp,zp=_(()=>{O();se();oe();Hh=class extends z{constructor(...e){super(...e);this._stack.push(new X({controlPoints:[[0,0],[54,33],[77,82],[94,103],[122,126],[177,193],[229,232],[255,255]]})),this._stack.push(new Bn({color:new S(40/255,40/255,40/255)}))}};Hh.identifier="k2";Lp=Hh});var jh,Np,Up=_(()=>{se();oe();jh=class extends z{constructor(...e){super(...e);this._stack.push(new ot({saturation:.5}))}};jh.identifier="k6";Np=jh});var qh,Gp,Wp=_(()=>{se();oe();qh=class extends z{constructor(...e){super(...e);this._stack.push(new X({controlPoints:[[0,0],[17,27],[46,69],[90,112],[156,200],[203,243],[255,255]]})),this._stack.push(new ot({saturation:.7}))}};qh.identifier="kdynamic";Gp=qh});var Xh,Vp,Hp=_(()=>{se();oe();Xh=class extends z{constructor(...e){super(...e);this._stack.push(new Ut({desaturation:.4})),this._stack.push(new X({rgbControlPoints:{red:[[0,20],[40,20],[106,111],[129,153],[190,223],[255,255]],green:[[0,20],[40,20],[62,41],[106,108],[132,159],[203,237],[255,255]],blue:[[0,40],[40,40],[73,60],[133,160],[191,297],[203,237],[237,239],[255,255]]}}))}};Xh.identifier="lenin";Vp=Xh});var Yh,jp,qp=_(()=>{se();oe();Yh=class extends z{constructor(...e){super(...e);this._stack.push(new X({controlPoints:[[0,0],[87,20],[131,156],[183,205],[255,200]]}))}};Yh.identifier="lomo";jp=Yh});var Kh,Xp,Yp=_(()=>{se();oe();Kh=class extends z{constructor(...e){super(...e);this._stack.push(new X({rgbControlPoints:{red:[[0,0],[41,84],[87,134],[255,255]],green:[[0,0],[255,216]],blue:[[0,0],[255,131]]}}))}};Kh.identifier="mellow";Xp=Kh});var a1,Jh,Kp,Jp=_(()=>{O();se();oe();({ColorMatrix:a1}=B),Jh=class extends z{constructor(...e){super(...e);let t=new a1(.8158218291630716,0,0,0,-.01779810181190647,0,.8098360655737704,0,0,.0916393442622953,0,0,.4596336773932402,0,.12760574782432707,0,0,0,1,0);this._stack.push(new vn({colorMatrix:t}));let i=new S(.8,.6,.9);this._stack.push(new kn({gamma:i}))}};Jh.identifier="metal";Kp=Jh});var Zh,Zp,Qp=_(()=>{se();oe();Zh=class extends z{constructor(...e){super(...e);this._stack.push(new X({rgbControlPoints:{red:[[0,40],[255,230]],green:[[0,10],[255,225]],blue:[[0,20],[255,181]]}})),this._stack.push(new ps)}};Zh.identifier="morning";Zp=Zh});var Qh,$p,e_=_(()=>{se();oe();Qh=class extends z{constructor(...e){super(...e);this._stack.push(new X({rgbControlPoints:{red:[[0,0],[115,130],[195,215],[255,255]],green:[[0,0],[148,153],[172,215],[255,255]],blue:[[0,46],[58,75],[178,205],[255,255]]},textureGLUnit:2})),this._stack.push(new X({controlPoints:[[0,0],[117,151],[189,217],[255,255]],textureGLUnit:3})),this._stack.push(new Ut({desaturation:.65}))}};Qh.identifier="orchid";$p=Qh});var $h,t_,i_=_(()=>{se();oe();$h=class extends z{constructor(...e){super(...e);this._stack.push(new X({rgbControlPoints:{red:[[0,0],[94,74],[181,205],[255,255]],green:[[0,0],[34,34],[99,76],[176,190],[255,255]],blue:[[0,0],[102,73],[227,213],[255,255]]}})),this._stack.push(new ot({saturation:.8})),this._stack.push(new st({contrast:1.5}))}};$h.identifier="pola";t_=$h});var ec,r_,s_=_(()=>{se();oe();ec=class extends z{constructor(...e){super(...e);this._stack.push(new X({rgbControlPoints:{red:[[0,0],[56,18],[196,209],[255,255]],green:[[0,38],[71,84],[255,255]],blue:[[0,0],[131,133],[204,211],[255,255]]}})),this._stack.push(new ot({saturation:.8})),this._stack.push(new st({contrast:1.5}))}};ec.identifier="pola669";r_=ec});var tc,o_,n_=_(()=>{se();oe();tc=class extends z{constructor(...e){super(...e);this._stack.push(new Ut({desaturation:.65})),this._stack.push(new X({rgbControlPoints:{red:[[0,50],[40,78],[118,170],[181,211],[255,255]],green:[[0,27],[28,45],[109,157],[157,195],[179,208],[206,212],[255,240]],blue:[[0,50],[12,55],[46,103],[103,162],[194,182],[241,201],[255,219]]}}))}};tc.identifier="quozi";o_=tc});var ic,a_,l_=_(()=>{se();oe();ic=class extends z{constructor(...e){super(...e);this._stack.push(new X({rgbControlPoints:{red:[[0,129],[75,153],[181,227],[255,255]],green:[[0,8],[111,85],[212,158],[255,226]],blue:[[0,5],[75,22],[193,90],[255,229]]}})),this._stack.push(new ps)}};ic.identifier="semired";a_=ic});var rc,h_,c_=_(()=>{se();oe();rc=class extends z{constructor(...e){super(...e);this._stack.push(new X({rgbControlPoints:{red:[[0,0],[62,82],[141,154],[255,255]],green:[[0,39],[56,96],[192,176],[255,255]],blue:[[0,0],[174,99],[255,235]]},textureGLUnit:2})),this._stack.push(new X({controlPoints:[[0,0],[55,20],[158,191],[255,255]],textureGLUnit:3}))}};rc.identifier="sunny";h_=rc});var sc,u_,d_=_(()=>{se();oe();sc=class extends z{constructor(...e){super(...e);this._stack.push(new X({rgbControlPoints:{red:[[0,72],[89,99],[176,212],[255,237]],green:[[0,49],[255,192]],blue:[[0,72],[255,151]]}}))}};sc.identifier="texas";u_=sc});var oc,m_,f_=_(()=>{se();oe();oc=class extends z{constructor(...e){super(...e);this._stack.push(new Dn)}};oc.identifier="x400";m_=oc});var Un,p_,__=_(()=>{O();se();oe();Un=class extends z{constructor(...e){super(...e);this._lutPrimitive=new En({image:this._options.image}),this._stack.push(this._lutPrimitive)}};Un.prototype.availableOptions={image:{type:"image",required:!0,setter(o){return this._lutPrimitive&&this._lutPrimitive.setImage(o),this.setDirty(!0),o}}};Un.identifier="lut";p_=Un});var Gn,g_,y_=_(()=>{O();se();oe();Gn=class extends z{constructor(...e){super(...e);let{image:t,resolution:i,verticalTileCount:r,horizontalTileCount:s}=this._options;this._lutPrimitive=new An({image:t,resolution:i,verticalTileCount:r,horizontalTileCount:s}),this._stack.push(this._lutPrimitive)}};Gn.prototype.availableOptions={image:{type:"image",required:!0,setter(o){return this._lutPrimitive&&this._lutPrimitive.setImage(o),this.setDirty(!0),o}},resolution:{type:"number"},horizontalTileCount:{type:"number",default:5},verticalTileCount:{type:"number",default:5}};Gn.identifier="3d-lut";g_=Gn});var nc={};Te(nc,{A15Filter:()=>hp,BWFilter:()=>mp,BWHardFilter:()=>pp,BreezeFilter:()=>up,CelsiusFilter:()=>gp,ChestFilter:()=>xp,DuoToneFilter:()=>vp,FixieFilter:()=>Tp,FoodFilter:()=>Cp,FridgeFilter:()=>Sp,FrontFilter:()=>Fp,GlamFilter:()=>Ip,GobblinFilter:()=>Bp,IdentityFilter:()=>zn,K1Filter:()=>Pp,K2Filter:()=>Lp,K6Filter:()=>Np,KDynamicFilter:()=>Gp,LUTFilter:()=>p_,LeninFilter:()=>Vp,LomoFilter:()=>jp,MellowFilter:()=>Xp,MetalFilter:()=>Kp,MorningFilter:()=>Zp,OrchidFilter:()=>$p,Pola669Filter:()=>r_,PolaFilter:()=>t_,QuoziFilter:()=>o_,SemiredFilter:()=>a_,SunnyFilter:()=>h_,TexasFilter:()=>u_,ThreeDLUTFilter:()=>g_,X400Filter:()=>m_});var x_=_(()=>{Eh();cp();dp();fp();_p();yp();bp();wp();Rp();kp();Op();Ep();Mp();Dp();Ap();zp();Up();Wp();Hp();qp();Yp();Jp();Qp();e_();i_();s_();n_();l_();c_();d_();f_();__();y_()});var vi,b_,v_=_(()=>{O();x_();se();Eh();oe();vi=class extends te{_render(e){return this._selectedFilter.render(this._sdk,e,this._renderTexture)}render(e){return this._selectedFilter.getDirty()&&this.setDirty(!0),this.getEnabled()?super.render(e):(this.setDirtyForRenderer(!1,this._sdk.getRenderer()),Promise.resolve(e))}setDirtyForRenderer(e,t){super.setDirtyForRenderer(e,t),this._selectedFilter.setDirtyForRenderer(e,t)}disposeRenderTextures(){super.disposeRenderTextures(),this._selectedFilter&&this._selectedFilter.disposeRenderTextures()}dispose(){super.dispose(),this._selectedFilter&&this._selectedFilter.dispose()}restoreSnapshot(e){let t=C({},e);if(delete t.filter,e.filter){let i=e.filter.constructor;i.identifier==="3d-lut"?this.setFilter(new i({image:e.filter.getImage(),resolution:e.filter.getResolution(),horizontalTileCount:e.filter.getHorizontalTileCount(),verticalTileCount:e.filter.getVerticalTileCount()})):i.identifier==="duotone"?this.setFilter(new i({lightColor:e.filter.getLightColor(),darkColor:e.filter.getDarkColor(),intensity:e.filter.getIntensity()})):this.setFilter(new i)}this.set(t)}resetToDefaultFilterIntensity(){let e=this._selectedFilter&&this._selectedFilter.availableOptions,t=e&&e.intensity.default;this.setIntensity(t||1)}};vi.identifier="filter";vi.prototype.availableOptions={identifier:{type:"string",default:"identity"},intensity:{type:"number",default:1,setter(o){return this._selectedFilter&&this._selectedFilter.setIntensity(o),o}},filter:{type:"object",default:new zn,setter(o){return this._selectedFilter&&(this._selectedFilter.dispose(),this._selectedFilter=null),this._selectedFilter=o,typeof this._options.intensity!="undefined"&&this._selectedFilter.set({intensity:this._options.intensity}),o}}};vi.FilterPrimitives=ie;vi.Filters=nc;vi.Filter=z;P.Operations.FilterOperation=vi;b_=vi});var fE,mo,w_,T_=_(()=>{O();({Vector2:fE}=B),mo=class extends te{constructor(...e){super(...e);this._flipContainer=new R.Container}_render(e){let{outputResolution:t,flipHorizontally:i,flipVertically:r}=this._options;if(i||r){let s=e.getDimensions();this._flipRenderTexture?this._flipRenderTexture.resizeTo(s):(this._flipRenderTexture=new R.RenderTexture(this._sdk.getRenderer(),s.x,s.y),this._flipSprite=new R.Sprite(this._flipRenderTexture),this._flipContainer.addChild(this._flipSprite));let n=i?-1:1,a=r?-1:1;this._flipSprite.setScale(n,a),this._flipSprite.setPivot(0,0),this._flipSprite.setPosition(s.x*(1-n)*.5,s.y*(1-a)*.5),this._flipRenderTexture.clear(),this._flipRenderTexture.render(this._container),this._renderTexture.render(this._flipContainer)}else this._renderTexture.render(this._container);return Promise.resolve()}};mo.identifier="flip";mo.prototype.availableOptions={flipHorizontally:{type:"boolean",default:!1},flipVertically:{type:"boolean",default:!1}};P.Operations.FlipOperation=mo;w_=mo});var gs,ys,R_,C_=_(()=>{O();({Vector2:gs}=B),ys=class extends te{constructor(...e){super(...e);this._colorOverlayFilter=new R.Filters.ColorOverlayFilter({color:this.getTintColor()}),this._frameContainer=new R.Container,this._resetSprites(),this._options.frame&&this._createSpritesForFrame(this._options.frame)}_resetSprites(){this._spriteGroups={top:{},left:{},right:{},bottom:{}},this._sprites=[],this._repeatSprites={top:[],left:[],right:[],bottom:[]}}_createSpritesForFrame(e){if(!e)return this._disposeSprites();let{imageGroups:t,layoutMode:i}=e;this._layoutMode=i||"horizontal-inside",this._disposeSprites(),["top","left","right","bottom"].forEach(r=>{typeof t[r]!="undefined"&&["start","mid","end"].forEach(s=>{if(typeof t[r][s]=="undefined")return;let n=t[r][s];"image"in n&&(n=n.image);let a=R.Texture.fromImage(n),l=new R.Sprite(a);this._spriteGroups[r][s]=l,this._sprites.push(l),this._frameContainer.addChild(l)})})}_render(e){let t=this._renderTexture.getDimensions();return this._options.frame&&(this._colorOverlayFilter.setColor(this.getTintColor()),this._updateSprites(e)),this._frameRenderTexture?this._frameRenderTexture.resizeTo(t):(this._frameRenderTexture=new R.RenderTexture(this._sdk.getRenderer(),t.x,t.y),this._frameSprite=new R.Sprite(this._frameRenderTexture),this._container.addChild(this._frameSprite)),this._frameSprite.setAlpha(this._options.alpha),this._options.frame&&this._options.frame.tintable?this._frameSprite.setFilters([this._colorOverlayFilter]):this._frameSprite.setFilters([]),this._frameRenderTexture.clear(),this._frameRenderTexture.render(this._frameContainer),this._renderTexture.render(this._container),Promise.resolve()}_updateSprites(e){let t=e.getDimensions();this._frameWidth=Math.ceil(e.getDimensions().min()*this._options.scale),this._updateHorizontalSpriteGroup(e,"top",0),this._updateHorizontalSpriteGroup(e,"bottom",t.y-this._frameWidth),this._updateVerticalSpriteGroup(e,"left",0),this._updateVerticalSpriteGroup(e,"right",t.x-this._frameWidth)}_updateHorizontalSpriteGroup(e,t,i=0){let r=e.getDimensions(),s=this._layoutMode==="vertical-inside",n=this._spriteGroups[t].start,a=this._spriteGroups[t].mid,l=this._spriteGroups[t].end,h=0,c=0,m,d;if(n){m=n.getTexture().getDimensions(),d=m.y/m.x,h=Math.floor(this._frameWidth/d);let u=new gs(0,i);u.x=s?this._frameWidth:0,n.setPosition(u),n.setHeight(this._frameWidth),n.setWidth(h)}if(l){m=l.getTexture().getDimensions(),d=m.y/m.x,c=Math.floor(this._frameWidth*d);let u=new gs(r.x-c,i);u.x-=s?this._frameWidth:0,l.setPosition(u),l.setHeight(this._frameWidth),l.setWidth(c)}if(a){m=a.getTexture().getDimensions(),d=m.y/m.x;let u=new gs(h,i),f=r.x-h-c;if(s&&(u.x+=this._frameWidth,f-=this._frameWidth*2),a.setPosition(u),a.setWidth(f),a.setHeight(this._frameWidth),a._canvasSmoothingEnabled=!1,this._options.frame.imageGroups[t].mid.mode==="repeat"){let y=this._frameWidth/d,g=Math.ceil(f/y),p=0;if(g!==-1){let v=Math.round(f/g);a.setWidth(v),p+=v,this._ensureRepeatSpritesExist(g-1,t,a);for(let x=0;x<g-1;x++){v=Math.round((f-p)/(g-x-1));let T=this._repeatSprites[t][x],D=u.clone().add(p,0).floor();T.setPosition(D),T.setWidth(v),T.setHeight(this._frameWidth),p+=v}}}}}_ensureRepeatSpritesExist(e,t,i){i.getTexture().setMaxListeners(e+1);let r=this._repeatSprites[t].length;if(e>r){let s=e-r;for(let n=0;n<s;n++){let a=new R.Sprite(i.getTexture());this._repeatSprites[t].push(a),this._frameContainer.addChild(a),this._sprites.push(a)}}else e<r&&this._repeatSprites[t].splice(e).forEach(n=>{let a=this._sprites.indexOf(n);a!==-1&&(this._sprites.splice(a,1),this._frameContainer.removeChild(n),n.dispose())})}_updateVerticalSpriteGroup(e,t,i=0){let r=e.getDimensions(),s=this._layoutMode==="horizontal-inside",n=this._spriteGroups[t].start,a=this._spriteGroups[t].mid,l=this._spriteGroups[t].end,h=0,c=0,m,d;if(n){m=n.getTexture().getDimensions(),d=m.y/m.x,h=Math.floor(this._frameWidth*d);let u=new gs(i,0);u.y=s?this._frameWidth:0,n.setPosition(u),n.setWidth(this._frameWidth),n.setHeight(h)}if(l){m=l.getTexture().getDimensions(),d=m.y/m.x,c=Math.floor(this._frameWidth*d);let u=new gs(i,r.y-c);u.y-=s?this._frameWidth:0,l.setPosition(u),l.setWidth(this._frameWidth),l.setHeight(c)}if(a){m=a.getTexture().getDimensions(),d=m.y/m.x;let u=new gs(i,h),f=r.y-h-c;if(s&&(u.y+=this._frameWidth,f-=this._frameWidth*2),a.setPosition(u),a.setHeight(f),a.setWidth(this._frameWidth),a._canvasSmoothingEnabled=!1,this._options.frame.imageGroups[t].mid.mode==="repeat"){let y=this._frameWidth*d,g=Math.ceil(f/y),p=0;if(g!==-1){let v=Math.round(f/g);a.setHeight(v),p+=v,this._ensureRepeatSpritesExist(g-1,t,a);for(let x=0;x<g-1;x++){v=Math.round((f-p)/(g-x-1));let T=this._repeatSprites[t][x],D=u.clone().add(0,p).floor();T.setPosition(D),T.setHeight(v),T.setWidth(this._frameWidth),p+=v}}}}}_disposeSprites(){this._sprites.forEach(e=>{this._frameContainer.removeChild(e),e.getTexture().dispose(),e.dispose()}),this._resetSprites()}dispose(){super.dispose(),this._disposeSprites(),this._colorOverlayFilter&&this._colorOverlayFilter.dispose(),this._frameRenderTexture&&this._frameRenderTexture.dispose()}static validateFrame(e){if(!e)return;let{imageGroups:t,layoutMode:i}=e;if(typeof e.identifier!="string")throw new Error("Frame needs a property `identifier` of type String.");if(typeof e.imageGroups!="object")throw new Error("Frame needs a property `imageGroups` of type Object.");let r=s=>{let{start:n,end:a,mid:l}=t[s];if(typeof t[s]!="undefined"){if(typeof t[s]!="object")throw new Error(`Frame: \`imageGroups.${s}\` needs to be of type Object.`);if(typeof n!="undefined"&&!(n instanceof Ge||typeof HTMLImageElement!="undefined"&&n instanceof HTMLImageElement))throw new Error(`Frame: \`imageGroups.${s}.start\` needs to be of type Image.`);if(typeof l!="undefined"&&!(n instanceof Ge||typeof HTMLImageElement!="undefined"&&n instanceof HTMLImageElement)&&typeof l!="object")throw new Error(`Frame: \`imageGroups.${s}.mid\` needs to be of type Image or Object.`);if(typeof a!="undefined"&&!(a instanceof Ge||typeof HTMLImageElement!="undefined"&&a instanceof HTMLImageElement))throw new Error(`Frame: \`imageGroups.${s}.end\` needs to be of type Image.`)}};if(typeof i!="undefined"&&["vertical-inside","horizontal-inside"].indexOf(i)===-1)throw new Error("Frame: `layoutMode` must be one of vertical-inside, horizontal-inside");if(typeof tintable!="undefined"&&typeof tintable!="boolean")throw new Error("Frame: `tintable` needs to be of type Boolean.");r("top"),r("left"),r("right"),r("bottom")}};ys.identifier="frame";ys.prototype.availableOptions={frame:{type:"object",validation:ys.validateFrame,setter(o,e){return e||this._createSpritesForFrame(o),o},default:null},alpha:{type:"number",default:1},tintColor:{type:"color",default:new S(1,1,1,0)},scale:{type:"number",default:.1}};P.Operations.FrameOperation=ys;R_=ys});var k_,S_=_(()=>{k_="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIACAAAAADRE4smAAAsTElEQVR4Ae1d4bHjOM5ECAgBISgEZLDOwMrAysDMwMpAzkCTAUNQCAyBIfCr2ifI1DNh+c1tfTMg3b9udtZXC7tJdgMgCP8foJAUBIJx92eoEy5puAKkHH1jX0AchqoJcLwGlv1fDVAnyKtfQMoB1WLQKBBCyuCgVvQhvQGoF3RPb2Bs/AsgEDS6BqbGvwACaHsT+AV1AK/4W18AQy3gCxTAR2vAQxW4xHSD3/kC/qlI9NK7hqg6H8SLspiPv4C+kv0v6ouZQuUEEMfndUtcOQH6qJ9nR2sg1kD+FSdQ4GLS4MA82B+uZvJJRQXkFwT8uRp2VQl99xuGiOyTX4//+AuYqtj/BBGPiVITATjtEel4pdRFAJ/2uP08K9KBYXwPaT5OC9Vlg/kneQ0cUwHcQvz6F7BAXVuA/3GNsG8ofqBQmw3uUg7dCglcZQSgJHizvO1qy4OM3wPCH64BV1fnR8QfdkqAcWD86Q86KP9+o/EjGMfwrhVSpPPUWvy9YoMbsEIqAVrSgXBSCFC3FdK/sV+txc/Kv93OEpgrawiYfybsSWkIaMcK3SurB1P8Ufyk2OB2rNCoEKCV+BW2tGOFXG2N0RiUkkgZUfmumrFCfW0EgNOPKlxB6YtvQAcqRrix+BfFBjdjhVgnQL3xk+cyWwYQVG6FLjOs6PTjotaSCF5T8iUXJLSo3gqxT4kLPig6BKheB1/+/dvzEwGi/KParSDN+arAtMFTA/Gz3+8KTiF/tVZoaxx034zwwlAPvsc/7cifx+8U8tdqhfqwXxVihOMAgnp1sJA/lzu9Tv4KrRD7fFVki2VE+IuB3anvT0z/Y/x9KBRKexPkJ+77njv835YA3kvuaPm79z+6zDGtiP5Mv1sSObMv7gr8l5MfkMclCZaJf9sK0TUWd4U58N8b/NWnb5jo9+KPShM4EvzN4DGmPcL5p1ZIgVghhr8VNBZjuP4P8Rsr/fReGW72UyukIKDJeRYz/rQkoiAYHWkSTz+2QgrOVq657bG8xYAlHWBEQzcdf+OH43SAcPp7o3/N3un34zeS98Vbeonu51ZIYCHve/tPhvl4e+QXdP/JMB9KOkRN/42gJf0ni5eiNfILzjH9J4t3NLn/0QH737etzhj5Bdf0GhP9XlXMRt2Lwu+TX4/fUtH3+t+Jl0H/Co3+/hPmQomPjJQV8iu//9Hi5fk3rJAnU3VMnfyXeJzI8HbIL7i8vf+RT8m9a4WsFH3vzzFPzo3LM/mXlN6P3wT5NeXqJ+fmIP/9+0xJfHsJ2Cj69tqap/BE/lILG49z8CMXCGWl6Bu0Ne/2//19LDa942lalvlMZUKNaOBhA0Xw4578xZQQzvJT0y5+Qx0PFz1b2ZXThFxMoF0LVsh3IDCSALqjPg1QwEX6hC1Wp5DfxAqIp+MyiS/rx+m7FQps7l7j+E6O3Jf1Y8DdPxXy23IAsXunTHIqH6BD/k/lJDGlABaN/Epd5FpuBD5ZIL8gHJd8TkGr6VIoN8J6cc/Gwqf3aoRz+dMRBLNDm62c03s1wshlBe0en2GLQ84mhfyaTOQKZl7e9RWg1ggnVO4D/TJ+q5UV8mstLX0Fjz/E1wW/Uo/EoGb9gu1O5vhWgTzqBGAwAER9C3RKj4SqlIO5sacEpPNfJ38OBstHAIdJlwD/vDXk3wNYPQLwFmHO/6wE9rKwPWilv2DkcRNWy9esng45olr9PhuYbQ+JtQ3Qq4VdTSo6S+FvZ5pXNSC/1+NL2ZdkpuNXDjTI42f9BNPj90ohMRh42UyYqhRuemUJ6GJ3MLMC5ECDlAaFAPG9MnEoN9IFMvCymaxUhQCjniXL0ZeXiTPR8Qqi449nNnL5ik8oCqURDb1l7RQCeM0kRX2jGIKBxP8lJgHk8XdpB1eO32F8ofV49H6+oKWXfVIkpRkCi0sgcP/qpOhn7ye2sfmlBLmKobK8FbB0RATbo037qCazx9dL4L4WtXtrCS/dzcLuN4yvbcy4bmzRMgHQv0hmDOoSEB044pMaYMvsh10I/nUqE4fCRjFazfaWWNwdXF7tu8JGgXbHdwkBgvK3DgowvQFq15WGstWLeFw0DaYn14DEf/zwn1ozNoZRKWm8//Bfb3i0JZYJIPHHN24BX5NxDfjqzdrhjQkGFCxvgaFIgHRTVsd01DR5tj7OX0D7M0CXeLiYrvneiwSQ0h0fzoK4Ku0AhhBfpbTno1kQtNh+7HZQCOA1hRToVUnU2Z/jK2BtpsFVSaLZ1ECsEECPP02kNgQGsj/NXxBUkxDOek+UA2NAjQABdZPkXX/qR68PSrG8BjYM+t+G+XLq+zEqrDGFRSFAcppE0jGBRWAqI6JmE3WQ9Unu8BS/SwewpADZB3p/eNdNqXtbHXOHt3Q9ssHwvJ6X9CYCWah7BDq+AK1YoUO4v7/j5Xpgg+FZB1Os4/cXyRo6RQWqVnCs4fdnr031jBoBJH6u4vfvo+bks5KPL2d9vPXfP/frE2rFkCWmBCVR36djeAQ7Qx4HbXKRi0VVg0s6RBysdLwspKjA6FKCoqrrjZ9+eE97XBUn5IdyXMcMCJ2dmn8gpSDIIUH5dz2F4zlxpobcXpU1AF6p/45mh9yyks0tqMChT6DUfynYnHCqXuCasOiEmLXUxhBNDrnFosWJXdEG/wIPapf/EEwOeew0AbdQcQ08VQb4cFh6OMNfC3XC97lUDInAcNfiB3IFCsSRrOV5BYEKTsg/uV5/MC7cn420O+mH4JAnPlCLv/BcQvQXNFbvVhiQrQFwL9YK3UPKEUa2NOFBYQDv7JF7md1EdrMPIYRlujDaerNSV+5Z0AwYXia4u370SwghzGNPxjL9Snsb7u4vY1B0sFW4N6a8nnK+99YrvDr/leaeZdf3zjXEj1d+a9bt9fsa8HJwmn6+mafCAa8L4fu++uHtlzgvMS1lHagwIORrgBUrZAXkc/EejvP3w/7A72zHL2p9KEhh9SS857ZHt0I2Nr+9cuHjCk73Le0xWo4faM7Fi8SnY8anNaBbIRObn3bFWU8JbfFGoEL8wRT/47a2VSnsn05CzoTwgRUyUvSKqPW9h+fhlz4JYJAzwaYO7PPgOk0KB/d9H8QkiGDXCtFccHmFzMY+umu+QmASX2AvfmVqcYnRw/CNAVnEnS0rpBe9WOV/950BfRJALAoHYZOxtJcqhSP2307CMd/ubVohWf7H/Hffyts3SgJYI/UmdeC91KWqMLqLiiz4VSSTN8j/k6YDI+KeLXNGgKHUCBjPNtNeuhRm9SnIWBSOHu2lfXX+T2qNBNJUEA4zGU376lLY6z0O3TOZ4mCc/4Uit1MIEOX/TG93MPTEmS6FWWOAeL7BzstmgkGb51AocisMgE3uDAr5jZX/dSmMGgN+fSuReDJ3zUsw61ZQYUA2KNIL+U3Bvy+FtUeR445Mgc3zX81suCIBpJDEOvkrkcLajLDu8YE41ML/U0kf9CUCxE04LDr565DCYh2VxC/FEcEWKCqxKEVujs8E2HIeevD1SOHiPvgL7H4Dig9Si9xdeCZADzoqk8JlBkQQVMN/vchL4YkAE+ioTAorDOgq4n8ijRsLFBgAevW3Vil8XP21rwOVMAsMAL32V6UUVh74a4v/uRkG/U3LOqWwMCPqN32sTz0LKjduz6MOQc/7ViqFV3RRz/tWy//0/DAC6KhZCstJeFz3qq0kJhiVza8RKSwMsL//6SUxhf8Cp2x+DUhhAS0D1IGT4mtf9vs6ZfNrRQofo9KSmIrWpDA0wf/3+30blMI6Ki6JKfxvUwq/j6q6IxW0I4W7tvgfj940b0wK+w5qRFAHeTtlvGGbUjgw6KjUB0VlvF2DUjg6bJD/vbL5tSeFp5r5T/pkOK9sfo1JYc/N8l/Z/JqSwvHcMP/vyubXkBRmhHpx3B3JoKANHdgAlO5IDQ1JYQUf/rcmhQUf/rcqhVsAxWb5r0hhT9AU3NGzNm1J4cAN8l/J+zYohaOD9tD/DZvfnyUe/3n+I8Ifg//jmx/58Oel8B/N+/Z/cu/hP7z54e2Pdx5STOEEfwzs/2zn3f3PHv7zX9B5ODj80zJs+pPzY/nPZ2Ju0CrEifEn/laBsc0cHLYXv/IN9E3m4Pp43WViTtAY8Ba3aWON5aBlbvuMz/ETNIJrfFxG4awdA7GJ6LNHqfL4Ox8RWgCG3ZNU960d4xKnlkpwgTIrSHhrxw/E7DaK6KD5a2PklhLQoXsUJZfYkB9Y8iepxAr5NmryMq81PMSvU14eqBf37QsI9O2emkeoFnilx0Ocp7AdgxhaqUjy7WF9fP9gADexAK4xzY8dcKAHA06///KAwSc7ZQ/E/nEO+tpvIsmUJd52QL/NXcKv+MOp+txHSml57IH/iBgaVkZ4qt/6+G0HjCgMWAi4bvLnfn/Y9sARoM+e5lu4kfhlB2S4xM0O9tRKE27ETQUC3pMwAIdm4pcdcPZJMEETkNKnJMBvMQn+qTrvG1OcSF7rcPtGvFC/9cOrT2m5kGTAut3LJUvlhz/N35+gpWz06Ii01H74c5CDLit94sP29YFrJn9MgnMW/yC2r3p0Pr90MmzZzlCr7dMf645Z/Czjh6ov+n67f71I6fMuJ38D5J8uX0d+v/I+rDtggMohNic697Xgs9LnIJaoWuD2sJ4YgCmLP3z54KpB4FehIwWvTqzQ15dT+eE/SLCS650yK3iv/hoe+Yji+0T2sjBhAqxXAIjyjbj6PiHAmFnhE9du/f4N8+H7vPwP6YJ1VP3hL/HTVgeQ+CO1cfh3m+85i+hZrdDYgvL14vtWLzjRGn/1RV8vJn/1PYPPHtzoK099bQl+3l++li9gEPdfd+pLCL8kwfbizFz34S+hFudwTQSC6lNfJymBtTSD4ZYEAfP4fWil4yskgcvvX8dx/Yula2XulNuXAF1sYgOA8fvYPfF9dK99A5D4w2nO4xcrTN5zI1f9PIv4391+7MOI9ccfHK6kn9+4/VkhJYaFt6CPbz8i16J888O9EP8vRS8PUAl4waf+t+Xw9ieHiJUo3/Acv89aoEnRyxGrSX255/dIhk0HRYdKwuxWS9F3F3+/i39hvVTsqkl9RVL6/4DTiHrCrKsj7RUH0OLHF59yWE3qy3dPfkiWd/fiU1xH3nfCkh90x58yD17KGR6pg+gJsypsYU5jhAx3PX4RhvHfT3FXw0VXh/IFvDf6xT0WAF7R8JAT9+hz9f4p/tAdTQbqvOXZGLj7nS9xeIpx1oLbbMIlJmdV+fot/q9N/Vv8+gEvNgFvpnXgJQ6yBZwK8/5C8nx0TYa9yEeTh/9Z6n1TfJr3h8W0FxLhI/5oeEjc+ovLiJv5WfTwAOVvQGSyIJ6sKt8t/jcFbf81lvUs8RuWwXSXXzyvf+BhxiSk9HVNhvRP2VK+nBf7jz8ldyS6/FNosugr7L2r87aVT8k1GfmUtS+A/I6582O0Q3c7/pQwYFTkowWcQj5imzJPc+GDTwmmVT4tIiYMYc74fpL4py9ZwMfk37eLiZiwBIyZ9esyT8OKpxHJkGOQazIiJuyAokg39om3+C9Rv+zRxfV37/u7XBTL5WNAm/Nt8RrD5mlo1j2NNMdF11+CXJRaFPloJf5/A172I45id5j56cQ5B7ONUlLs4vBlfk+Zp5mV/f9pKNgAbPCRenfakh8hyineHwpaKYlmi4GA7clgvjjHWzhLklPcK88OKdURvy4Bb+uxIuwdpBTE/GdKwB/L4HwgbFwvRnr5lC31u9AWsZSzOP+DQKmOyP8Om3x0aGa8LaxVXr9nLms05svk5wt9i19uxpJ8ythN3yC716OcNWq1LR5nP55R/pVI24youB4GExrq94Z11+e0tfmwJ4B7isML4TtRPhAXZukXcnEwlfoSeDH/538NzgyAMXnWPxSuu6oBytGB0bMp6w8Sv/R90vzvH9Gh1iMu2lAG4kohBE3NxpYk1ipc+REOh6+Oz4KTpSVtWDBrlOu3wUhkavOLad3HNvN/jXrH55QyxO4R/1XCN1f09bxecxw3KS/aRp2MKBDbs2QjE60giFeTfYwkfhl1qc+EFwTxTp1fTYAZIEmT5+bn/N78zqT//hucVAAvsnnYwJbp+ueh5kni1zUsbbnyPmTxC5ylAZ9LbmM7Ocn5oJx1F4tLd8n8+DwZbsb5cN7kS1u677TJYD38WTKHYnsFg62WxyGzsZeNv/5lEgtlLE6W+SFTv79k8ANmQz6zfm+vkR+3Y4PyE5SAraW9HotXbOwqhxhkL3CofAGn/DqEX/8w2kp99WvRY0tjMWT85fJVT1688D/sOgdZrPDZ3E3fEcXGbk99fDl75b7DWVa9yxPBYbOCZGrMwcIy2DKsNlCGvKPiF3mVABFWeKmdREuN4FK+9ZSVAPOcL7LyqSDdkmOuiMJXGjywpc1PjrgxzwPozucqtT2UnXJHAHCewAzu+zy9S3uMimbK58B5UdKbifDO1kXvEXclcJi6+yvlG5LEL1bn4QjAGih71pe7VQpHpiDfjP61RQLOloBkfkwhT10PUv8BD8BBL9/KtoEwbicF4GIsfKV5fZPCTu9kRMkMSMmUHhVwNvqmLV5jOq2LG9IZAHsEBYMk/8XxTMyXYC3zozWvbxVd4sMJIbzSJ1z4tJ4lRvnPIT2sIKSIr56D4rTFP37PgxlE3ugRsnn3BZDb7YHJ56lCo6PxwiP6dP7iP5QzGBzWfDBmme/F/O+fp65G3Iq+xQUg3T6DeMUBurgvhhge+BN4lXLgFL8o9n5JaZLh8LP92VicZ3ul6KtVfRda9f64HhVdSAJPhvkfnZwJUd0nRfGNKXknR2UfzN8BH/eZ6+GstkmL4ospDXHd9Ogek1yFsQiSSrZc9iJVLQoD+pQiSfwAXe8ujGAXIoVfYsgz/D6lsd9kL/LF9WSc/x28GX+6/ssZHlTRY9cKvoTPTvoxpQBeoU1l/BcsW5p8wpiSsxu/fo/7JfjRJDz0KSWULJB5DBLIYfzrybeElDxYjl8J7o3LUotL6UsD93Cv5EkUeePmHbXopQUmAsxS9K0AXkzgYdZ4cFuZgGIlM+F5LQe+Fb8wgIFiPVOB6R0PtzoflyRp5ORT1uFVD1+In4Lsl4xQDbq3s8Y3EcQIyLXwH99Xiw5oEfnXGsT59dI/2Wj8uMiR0RrE+XRRJEOb8cM4QJPgrXY8c8vxtwtxfk3HP0G7wCgjENoExRQYWoaTJ1EaxeCgbaCBw98KPvjggw8++OCDDz744IMPPvjggw8++OCDDz744IMP8NZD22APDeMaU9sEIN9w+4k81dAu8CpjdxqAPoqpVcgYcmyY/A01oOlz+Klh8rdLAJqTgNokv+AXtAH9AT5ul/zN3kAKSdDiDaQh5QjQHkLK0TfH/+YJsKQcAzSGLuWIrd6/EbRnhCntAO1hVAZWt4KYchBA2yqoPSMcWifAqXECzClHB82hS40ZYTzrGqiNPAjvosSUY2kh7xsIHnAt2WCpe11VFRQaKPru3W7fFAGk7hVIUUGxhaJvyq/dc8rhWql7hbOigmonvyB0xUSAa6bulW5YVEFYPfkFcg4244Kk7iUIVFJBVD/5BQs9H4FTE0VfwbWggromyJ+fg0vK4Nso+u6kUFe/ERbyP+EmR2DlBOh8KiMwANXvgygkBYFgbMEGu6ThCqAQoI0vIA6DToAm1sBCoYWGAPLqF9CIDR40CoTQhhHuQ3oDUC/ont7A2PgXQCBodA1MjX8BBND2JvCrmrwHvvsFVGqD+aJUw17DV5P3vcHvfAH/VCR66V1DVJ0P4kVZzMdfQF9R3tfrjlBHqMfxedUS106APurn2dEaiBUVPU6gwMWkwdVU9wov14iCCsgvCPhzNTxWJfTdbxgiqqjo637uCKeqir4RD4hSGQE47RHpYKVURwBfKHf+cA10NdzyEMwHaaHqbDD/JK+BYyqAW4hf/wIWqGsL8D+uEfYtxK9/AaGqez5ihXS4yghA6RuGHzYKhLou++pWSF0Drq7Oj4g/7JQA48D40x900P/9FuNHMI7hXSukSOeptfh73QY3YIV0ArSiA+GkEKBuK6R/Y79ai5/1f7uRJTBX1hAw/0zYk94Q0IgVuldWD6b4o/hJt8GNWKFRJ0AT8etsacQKudoaozHoJZECov5dtWGF+toIAKcfVbiC3hDQhg7UjXAb8S+6DW7DCrFCgKrjJ89ltgwgqNwKXWZlXK4QoNaSiEyL8SUXJLSo3gqxT4kLPig6BKhcB8u0mPMTAaL8o9qtIM35qsC0wVMD8bPf7wpOIX+1VmhrHHTfjPDCFc4AFkw5+XfxO4X8tVqhPuxXhRjhOICgXh0s5M/lTq+Qv04rxD5fFdliGRH+YmB36vsT0/8Yfx8KhdLeBPmJ+77nDv+3JYD3kjta/u79jy5zTCuiP9PvlkTO7Iu7Av/l5AfkcUmCZeLftkJ0jcVdYQ789wZ/9YXZZr8Vf1SawJHgbwaPsTje7n0rpEKsEMPfChqLMVz/h/iNlX56rww3+6kVUhDQ5DyLGX9aElEQjI40iacfWyEFZ1OzTTcs+LMX0RSMaGm87c9/OE4HCKe/fbK/hun34zeS98Vbeonu51ZIYCHve/tPhvl4e+QXdP/JMB9KOkRN/42gJf0ni5eiNfILzjH9J4t3NLn/0QH737etzhj5Bdf0GhP9XlXMRt2Lwu+TX4/fUtH3+t+Jl0H/Co3+/hPmQomPjJQJ8uu//9Hi5fk3rJAnU3VMnfyXeJzI8HbIL7i8vf+RT8m9a4WsFH3vzzFPzo3LM/mXlN6I3xL5NeXqJ+fmIP/9+0xJfHsJ2Cj69tqap/BE/lILG49z8CMXCGWl6Bu0Ne/2//19LDa942lalvlMZUKNaOBhA0Xw4578xZQQzvsXoSR+Qx0PFz1b2ZXThFxMoF0LVsh3IDCSALqjPg1QwEX6hC1WZ4L8ygqIp+MyiS/rx+m7FQps7l7j+E6O3Jf1Y8DdPxXy23IAsXunTHIqH6BD/k/lJDGlABaN/Epd5FpuBD4J+S0gHJd8TkGr6VIoN8J6cc/Gwqf3aoRz+dMRBLNDm62c03s1wshlBe0en2GLQ84mjfyKTOQKZl7e9RWg1ggnVO4D/TJ+q5U18istLX0Fjz9EreCnP4E5qFm/YLuTOb5VII86ARgMAFHfAp3aI6Eo5WBu7CkB6fzXyZ+DwfIRwGHSJcA/bw359wBWjwC8RZjzP2uBvSpsD1rpLxh53ITV8jWrp0OOqFa/zwZm20NibQP0emFXkYrOUvjbmeZVDcjv9fhS9iWZ6fiVAw3y+Fk/wfT4vVJIDAZeNhOmKoWbXlsCqtgdzKwAOdAgpUEhQHyvTBzKjXSBDLxsJitVIcCoZ8ly9OVl4kx0vILo+OOZjVy+4hOKQmlEQ29ZO4UAXjNJUd8ohmAg8X+JSQB5/F3awZXjdxhfaD0evZ8vaOllnxRJaYbA4hII3L86KfrZ+4ltbH4pQa5iqCxvBSwdEcH2aNM+qsns8fUSuK9F7d5gwktxs7D7DeNrGzOuG1u0TAD0L5IZg7oERAeO+KQG2DL7YReCf53KxKGwUYxWs70lFncHl1f7rrBRoN3xXUKAoPytgwIMb4D6daWhbPUiHhdNg+nJNSDxHz/8p9aMjWFUShrvP/zXGx5tiWUCSPzxjVvA12RcA756tHh4Y4IBBctbYCgSIN2U1TEdNU2erY/zF9D+DNAlHi6ma773IgGkdMeHsyCuSjuAIcRXKe35aBYELbYfux0UAnhNIQV6VRJ19uf4ClibaXBVkmg2NRArBNDjTxOpDYGB7E/zFwTVJISz3hPlwBhQI0BA3SR515/60WuDUmyvgQ2D/rdhvpz6fowKa0xhUQiQnC6RNExgEZjKiKjbRA1kfZI7PMXv0gEsKUD2gd4f3nXT694mx9zhLV2PbDA8r+clvYlAFuoegY4vQCtW6BDu7+94uR7YYHjWwRTr+P1FsoZOVYGKFRxr+P3Za1M9o0YAiZ+r+P37qDj5vOTjy1kfb/33z/36hFoxZIkpQUnU9+kYHsHOkMdBm1zkYlHV4JIOEQcrHS8LKSowupSgqOp646cf3tMeV8UJ+aEc1zEDQmen5h9IKQhySFD+XU/heE6cqSG3V2UNgFfqv6PZIbesZHMLKnDoEyj1XwomJ5zqF7gmLDohZi21MUSTQ26xaHFiV7TBv8CD2uU/BJNDHjtNwC1UXANPlQE+HJYezvDXQp3wfS4VQyIw3LX4gVyBAnEka3leQaCCE/JPrtcfjAv3ZyPtTvohOOSJDyzErz2XEP0FbdW7FQbkawDci7VC95ByhJEtTXhQGMA7e+ReZjeR3exDCGGZLozW3qxUlHseNAOGlwnurh/9EkII89iTsUy/0t6Gu/vLGBQdbBXujSmvp5zvvfUKr85/pbln2fW9cw3x45XfmnV7/b4GvBycpp9v5qlwwOtC+L6vfnj7Jc5LTEtZByoMCPkaYMUKWQH5XLyH4/z9sD/wO9vxi1ofClJYPQnvue1RrJCZzW+vXPi4gtN9S3uMluMHmnPxIvHpmPFpDShWyMjmp15x1lNCW7wRqBB/MMX/uK1tVQr7p5OQMyF8YIWMFL0ian3v4Xn4pU8CGORMsKkD+zy4TpPCwX3fBzEJIti1QjQXXF4hs7GP7pqvEJjEFxiLX59aXGL0MHxjQBZxZ84KKUUvVvnffWdAnwQQi8JB2GQs7aVK4Yj9t5NwzLZ7o1ZIlv8x/9238vaNkgDWSL1JHXgvdakqjO6iIgt+FcnkDfL/pOnAiLhny5wRYCg1AsazzbSXLoVZfQoyFoWjR3tpX53/k1ojgTQVhMNMRtO+uhT2eo9D90ymOBjnf6HI7RQCRPk/09odTD1xpkth1hggnm+w87KZYNDmORSK3AoDYJM7g0J+Y+V/XQqjxoBf30oknsxd8xLMuhVUGJANivRCflPw70th7VHkuCNTYPP8VzMbrkgAKSSxQv56pLA2I6x7fCAOtfD/VNIHfYkAcRMOi0L+aqSwWEcl8UtxRLAFikosSpGb4zMBtpyHEnxVUri4D/4C5Ruw7IOUIncXngnQg4L6pHCZAREENfFfKfJSeCLABDoqk8IKA7qK+J9I48YCBQaAXv2tVQofV3/t60AlzAIDQK/9VSuF9Qf+GuF/boZBf9OyTikszIjaTR/7U8+Cyo3b86hD0PO+lUrhFV1U8r418z89P4wAOqqVwnISHte9KiyJCUZl82tECgsD7O9/eklM4b/AKZtfA1JYQMsAdeCk+NqX/b5O2fxakcIHqLckpqI1KQxN8P/9ft/mpLCOqktiCv/blMLvo6ruSAXtSOGuLf7HozfNG5PCvoMaEdRB3k4Zb9imFA4MCur1QVEZb9egFI4OG+R/r2x+7UnhqWb+kz4ZziubX2NS2HOz/Fc2v6akcDw3zP+7svk1JIUZoWocdEcyKGhABzYAvTtSQ0NSWMGH/61J4Q//Bc1J4YZAsU3+61LYEzQFd/SsTVtSOHCD/Ffyvg1K4eigPfTK5tcQuG3++9Y2P+Ur8Nwy/6ODhkExhRM0i7tsfu1icNgy/2eGD+zDMhAaByI0DPIB2kbfsgbDmxSiWwV7aURoErNy/aSxXNwErYKU6yetpeP5E3/bW4BvL+724le+gb7JQmwfr7ty3Kk99Ru7PBcdsDXlm2Z8jp+gBci77UNejnINpQSu2cukefydb8QPYNi9S3rfenIvcWqpDytQZgUJb+34gZhdSRYdNH9tjNxSF0LoHp1pS2zIDyz5u6RihXwbjZkytD88xK/Tn5+qFPftCwj0bViBR6gWeKXHa+ynsB2DGFppS+Pbw/r4/sEAbmIBXGOaHzvgQA8GnH7/+SmD77bLHoj94xz0tV9Hl1GbvO2Afhu+iV/xh1P1uY+U0vLYA/8RMTSsjPBUv/Xx2w4YURiwEHDd5M/9/rDtgSNAn73PvHAj8csOyHCJmx3sqZX204ibCgS8J2EADs3ELzvg7JNgaqv0KQnwW0yCf6rO+8YUJ5In29z+Nkao3/rh1ae0XEgyYN3u+bql8sOfZtnlJH7K5s+PSEvthz8HOeiy0ic+bF8fuGbyxyQ4Z/EP1ds+Qefzm8fDlu0MVds+QR/SAzGLn2UGZQstjxscwCKlz7uc/A2Qf7p8Hfn9yvuw7oABKofYnOjc14LPSp+DWKJqgdvrymIApiz+8OWDqwaBX4WOFLw6sUJfX07lh/8gwUqud8qs4L3668jkI4rvE9nLwoQJsF4BIMo3ovi+lQBjZoVPXLv1+zfMh+/z8j+kC9ZR9Ye/xE9bHUDij9TG4d9tvucsome1QmMLyteL71u94ERr/NUXfb2Y/NX3DD57da2vPPW1Jfh5P4FHvoChbvcvqS8h/JI2yLODc92Hv4RaHMY6EQiqT32dpATW0iCuWxIEzOP3oZWOr5AELh/CE8f1L5auleGjbl8CdLGJDQDG77OXxffRvfYNQOIPpzmPX6wwec+NXPXzLOJ/d/uxDyPWH39wuJJ+fuP2Z4WUGBbegj6+/Yhci/LND/dC/L8UvTxAJeAFn/rflsPbnxwiVqJ8w3P8PmuBJkUvR6wm9eWeH6UbNh0UHSoJs1stRd9d/P0u/oX1UrGrJvUVSen/A04j6gmzro60VxxAix9ffMphNakv3z35IVne3YtPcR153wlLftAdf8o8eClneKQOoifMqrCFOY0RMtz1+EUYxn8/xV0NF10dyhfw3ugX91gAeEXDQ07co8/V+6f4Q3c0Gajzlmdj4O53vsThKcZZC26zCZeYnFXl67f4vzb1b/HrB7zYBLyZ1oGXOMgWcCrM+wvJ89E1GfYiH00e/mep903xad4fFtNeSISP+KMoJbsTHmXEzfwseniA8jcgMlkQT1aV7xb/m4K2/5rNf5b4Dctgussvntc/8DBjElL6uiZD+qdsKV/Oi/3Hn5I7El3+KTRZ9BX23oXK9Oan5JqMfMraF0B+x9z5Mdqhux1/ShgwavLRAE4hf2eFMk9z4YNPCaZVPi0iJgxhzvh+kvinL1nAx+Tft4uJmLAEjJn16zJPw+JpFMmQY5BrMvbGRVMU6cY+8Rb/JeqXPbq4/u59f5eLYrl8DGhzvi1eY9g8Dc26p5HmuOj6S5CLUosmH43E/2/Ay37EUewOMz+dOOdgtlFKil0cvszvKfM0s7L/Pw0FG3L56DuwAXfakh8hyineHwpaKYlmi4GA7clgvjjHWzhLklPcK29PKtURvy4Bb+vFSuwdpBTE/GdKwB/L4HwgbFwvRnr5lC31u9AWsZSzOP+DQKmOyP8Om3x0aGa8LaxVXr9nLms05svk5wt9i19uxpJ8ythN3yC716OcNWq1LR5nP55R/pVI24youB4GExrq94Z11+e0tfmwJ4B7isML4TtRPhAXZukXcnEwlfoSeDH/538NzgyAMXnWPxSuu6oBytGB0bMp6w8Sv/R90vzvH9Gh1iMu2lAG4kohBE3NxpYk1ipc+REOh6+Oz4KTpSVtWDBrlOu3wUhkavOLad3HNvN/jXrH55QyxO4R/1XCN1f09bxecxw3KS/aRp2MKBDbs+QjE40giFeTfYwkfhl1qc+EFwTxTp1fTYAZIEmT5+bn/N78zqT//hucVAAvsnnYwJbp+ueh5kni1zUsbbnyPmTxC5ylAZ9LbmM7Ocn5oJx1F4tLd8n8+DwZbsb5cN7kS1u677TJYD38WTKHYnsFg62WxyGzsZeNv/5lEgtlLE6W+SFTv79k8ANmQz6zfm+vkR+3Y4PyE5SAraW9HotXbOwqhxhkL3CofAGn/DqEX/8w2kp99WvRY0tjMWT85fJVT1688D/sOgdZrPDZ3E3fEcXGbk99fDl75b7DWVa9yxPBYbOCZGrMwcIy2DKsNlCGvKPiF3mVABFWeKmdREuN4FK+9ZSVAPOcL7LyqSDdkmOuiMJXGjywpc1PjrgxzwPozucqtT2UnXJHAHCewAzu+zy9S3uMimbK58B5UdKbifDO1kXvEXclcJi6+yvlG5LEL1bn4QjAGih71pe7VQpHpiDfjP61RQLOl4BkfiwhT10PUv8BD8BBL9/KtoEwbicF4GIpfL15fZPCTu9kRMkMSMmUHhVwNvqmLV5jOq2LG9IZAHsEBYMk/8XxTMyXYCvzozevbxVd4sMJIbzSJ1z4tJ4lRvnPIT2sIKSIr56D4rTFP37PgxlE3ugRsnn3BZDb7YHJ56lCo6PxwiP6dP7iP5QzGBzWfDBmme/F/O+fp65G3Iq+xQUg3T6DeMUBurgrhlge+BN4lXLgFL8o9n5JaZLh8LP92VicZ3ul6KtVfRda9f64HhVdSAJPhvkfnZwJUd0nRfGNKXknR2UfzN8BH/eZ6+GstkmL4ospDXHd9Ogek1yFsQiSSrZc9iJVLQoD+pQiSfwAXe8ujGAXIoVfYsgz/D6lsd9kL/LF9WSc/x28GX+6/ssZHlTRY9cKvoTPTvoxpQBeoU1l/BcsW5p8wpiSMx2/co/7JfjRJDz0KSWULJB5DIeBSPzrybeElDyYjV8P7o3LUotL6UsD93Cv5EkUeePmHbXopQUmAsxS9K0AXkzgYdZ4cFuZgGIlM+F5LQe+Fb8wgIFiPVOB6R0PtzoflyRp5ORT1uFVD1+In4Lsl4xQDbq3s8Y3EcQIyLXwH99Xiw5oEfnXGsT59dI/2Wj8uMiR0RrE+XRRJEOb8cM4QJPgrXY8c8vxNwtxfm3HP0G7wCgjENoExRQYWoaTJ1EaxeCgbaC5w/+DDz744IMPPvjggw8++OCDDz744IMPDABvPbQN9tAwrjG1TQDyDdceZU53u8CrzFxoAPocjlYhM2ixXfK31H2gD2GmhsnfLgFoTgJqk/yCX9AMlNeXuF3yN9t+HpKgxfbzIeUI0B5CytE3x//mCbCkHAM0hi7liK02XwvaM8KUdoD2MCrTSltBTDkIoG0V1J4RDq0T4NQ4AeaUo4Pm0KXGjDCeFQ3UTB6Ed1FiyrG0kPcNBA+4lmyw1L2uqgoKLRR9d263b4oAUvcKpKig2ELRN+V3LjnlcK3UvcJZUUG1k18QumIiwDVT90o3LKogrJ78AjkHm3FBUvcSBCqpIKqf/IKFno/AqYmir+BaUEFdE+TPz8ElZfBtFH13Uqir3wgL+Z9wkyOwcgJ0PpURGID+qA/6P9HpZtdg1QgHAAAAAElFTkSuQmCC"});var F_,O_=_(()=>{F_=`uniform sampler2D u_image;
uniform sampler2D u_watermarkTex;

varying vec2 v_texCoord;


void main() {
  vec4 color = texture2D(u_image, v_texCoord);
  vec4 watermarkColor = texture2D(u_watermarkTex, v_texCoord);

  if (watermarkColor.r > 0.8) {
    gl_FragColor = mix(color, watermarkColor, 0.3);
  } else {
    gl_FragColor = color;
  }
}
`});var Wn,E_=_(()=>{O();O_();Wn=class extends R.Filter{constructor(...e){super(...e);this._fragmentSource=F_}_applyWebGL(e,t,i,r=!1){let s=e.getContext(),{canvas:n}=s,a=this.getShaderForRenderer(e),l=t.getFrame(),h=this._watermarkCanvas;(!h||l.width!==h.width||l.height!==h.height)&&this._createWatermarkCanvas(l.width,l.height);let c=R.Texture.fromCanvas(this._watermarkCanvas),m=c.getBaseTexture();e.updateTexture(m),m.setGLUnit(1),e.setRenderTarget(i),r&&i.clear(),e.setShader(a);let d=e.getCurrentRenderTarget().getProjectionMatrix().toArray();a.setUniform("u_projMatrix",d),a.syncUniforms(),s.uniform1i(s.getUniformLocation(a.getProgram(),"u_watermarkTex"),1),s.activeTexture(s.TEXTURE0),s.bindTexture(s.TEXTURE_2D,t.getTexture()),s.activeTexture(s.TEXTURE1),s.bindTexture(s.TEXTURE_2D,m.getGLTextureForRenderer(e)),s.drawElements(s.TRIANGLES,6,s.UNSIGNED_SHORT,0),c.dispose()}_createWatermarkCanvas(e,t){let i=this._options.watermarkImage,r=k.createCanvas();r.width=e,r.height=t;let s=r.getContext("2d"),n=s.createPattern(i,"repeat");s.fillStyle=n,s.fillRect(0,0,r.width,r.height),this._watermarkCanvas=r,this._watermarkContext=s}_applyCanvas(e,t,i,r=!1){let s=t.getCanvas(),n=t.getContext(),a=i.getContext(),l=this._options.watermarkImage;this._createWatermarkCanvas(s.width,s.height);let h=n.getImageData(0,0,s.width,s.height),c=this._watermarkContext.getImageData(0,0,s.width,s.height),m=new S,d=new S,u=new S;for(let f=0;f<s.width*s.height*4;f+=4)m.set(h.data[f]/255,h.data[f+1]/255,h.data[f+2]/255,h.data[f+3]/255),d.set(c.data[f]/255,c.data[f+1]/255,c.data[f+2]/255,c.data[f+3]/255),d.r>.8?u.copy(m.clone().mix(d,.3)):u.copy(m),h.data[f]=u.r*255,h.data[f+1]=u.g*255,h.data[f+2]=u.b*255,h.data[f+3]=u.a*255;a.putImageData(h,0,0)}};Wn.prototype.availableOptions={watermarkImage:{type:"object",required:!0}}});var fo,I_,M_=_(()=>{O();S_();E_();fo=class extends te{constructor(...e){super(...e);M(this,"_applyWatermarkFilter",()=>(this._watermarkFilter||(this._watermarkFilter=new Wn({watermarkImage:this._watermarkImage})),this._sprite.setFilters([this._watermarkFilter]),this._renderTexture.render(this._container),Promise.resolve()));M(this,"_loadWatermarkImage",()=>this._watermarkImage?Promise.resolve():new Promise((e,t)=>{this._watermarkImage=new Ge,this._watermarkImage.onload=e,this._watermarkImage.src=k_}));this._watermarkFilter=null,this._watermarkImage=null}_render(e){return this._loadWatermarkImage().then(this._applyWatermarkFilter)}dispose(){this._watermarkFilter&&this._watermarkFilter.dispose(),super.dispose()}};fo.identifier="license-watermark";fo.prototype.availableOptions={};P.Operations.LicenseWatermarkOperation=fo;I_=fo});var D_,B_=_(()=>{D_=`/*!
 * Based on evanw's glfx.js tilt shift shader:
 * https://github.com/evanw/glfx.js/blob/master/src/filters/blur/tiltshift.js
 */

uniform sampler2D u_image;
uniform float u_blurRadius;
uniform vec2 u_controlPoint1;
uniform vec2 u_controlPoint2;
uniform vec2 u_delta;
uniform vec2 u_texSize;
varying vec2 v_texCoord;

float random(vec2 co)
{
    highp float a = 12.9898;
    highp float b = 78.233;
    highp float c = 43758.5453;
    highp float dt = dot(co.xy,vec2(a,b));
    highp float sn = mod(dt, 3.14);
    return fract(sin(sn) * c);
}

void main() {
    vec4 color = vec4(0.0);
    float total = 0.0;

    vec2 vector = u_controlPoint2 - u_controlPoint1;
    float offset = random(gl_FragCoord.xy / u_texSize.xy);

    float radius = smoothstep(0.0, 1.0,
      abs(
        clamp(dot(v_texCoord - u_controlPoint1, vector) / dot(vector, vector), 0.0, 1.0)
      )
    ) * u_blurRadius;

    for (float t = -30.0; t <= 30.0; t++) {
      float percent = (t + offset - 0.5) / 30.0;
      float weight = 1.0 - abs(percent);
      vec4 _sample = texture2D(u_image, v_texCoord + u_delta * percent * radius / u_texSize);

      color += _sample * weight;
      total += weight;
    }

    gl_FragColor = color / total;
}
`});var ti,ac,Vn,P_=_(()=>{O();ms();B_();({Vector2:ti}=B),ac=class extends R.Filter{constructor(...e){super(...e);this._fragmentSource=D_,this._lastBlurRadius=null,this._lastControlPoint1=new ti,this._lastControlPoint2=new ti,this._blurFilter=new rt,this._blurredRenderTarget=new R.CanvasRenderTarget(100,100,1),this._maskRenderTarget=new R.CanvasRenderTarget(100,100,1)}_applyCanvas(e,t,i,r=!1){if(this._options.blurQuality==="low"){this._renderLQBlur(e,t,i,r);return}let s=t.getDimensions(),n=!i.getDimensions().equals(s);if(t.getBaseTexture().isDirty()||this._lastBlurRadius!==this._options.blurRadius||n){let l=new ti(this._options.delta.x,this._options.delta.y);this._blurFilter.setDelta(l);let h={blurRadius:this._options.blurRadius,texSize:s},c=(y,g,p)=>Math.min(Math.max(y,g),p),m=(y,g,p)=>{let v=c((p-y)/(g-y),0,1);return v*v*(3-2*v)},d=this._options.controlPoint2.clone().subtract(this._options.controlPoint1.clone()),{blurRadius:u}=this._options,f=(y,g)=>m(0,1,Math.abs(c(new ti(y,g).subtract(this._options.controlPoint1).dot(d)/d.dot(d),0,1)))*u;this._blurFilter.set(h),this._blurFilter._applyCanvas(e,t,i,r,f),this._lastBlurRadius=this._options.blurRadius}}_renderLQBlur(e,t,i,r=!1){let s=t.getDimensions(),n=!this._blurredRenderTarget.getDimensions().equals(s);this._blurredRenderTarget.setPixelRatio(t.getPixelRatio()),this._blurredRenderTarget.resizeTo(t.getDimensions()),this._maskRenderTarget.setPixelRatio(t.getPixelRatio()),this._maskRenderTarget.resizeTo(t.getDimensions());let a=!this._lastControlPoint1.equals(this._options.controlPoint1)||!this._lastControlPoint2.equals(this._options.controlPoint2)||n,l=t.getBaseTexture().isDirty()||this._lastBlurRadius!==this._options.blurRadius||n;a&&(this._renderMask(),this._lastControlPoint1=this._options.controlPoint1.clone(),this._lastControlPoint2=this._options.controlPoint2.clone()),l&&(this._blurImage(t,this._blurredRenderTarget,this._options.blurRadius),this._lastBlurRadius=this._options.blurRadius),this._applyMask(t,i)}_renderMask(){let e=this._maskRenderTarget.getCanvas(),t=this._maskRenderTarget.getContext(),i=new ti(e.width,e.height),r=this._options.controlPoint1.clone().multiply(i),s=this._options.controlPoint2.clone().multiply(i),n=t.createLinearGradient(r.x,r.y,s.x,s.y);n.addColorStop(0,"#FFFFFF"),n.addColorStop(1,"#000000"),t.fillStyle=n,t.fillRect(0,0,e.width,e.height)}_applyMask(e,t){let i=t.getContext(),r=e.getCanvas(),s=e.getContext(),n=this._blurredRenderTarget.getContext(),a=this._maskRenderTarget.getContext(),l=s.getImageData(0,0,r.width,r.height),h=l.data,c=n.getImageData(0,0,r.width,r.height).data,m=a.getImageData(0,0,r.width,r.height).data,d;for(let u=0;u<r.width*r.height*4;u+=4)d=m[u]/255,h[u]=d*h[u]+(1-d)*c[u],h[u+1]=d*h[u+1]+(1-d)*c[u+1],h[u+2]=d*h[u+2]+(1-d)*c[u+2];i.putImageData(l,0,0)}dispose(){super.dispose(),this._blurFilter.dispose(),this._blurredRenderTarget.dispose(),this._maskRenderTarget.dispose()}};ac.prototype.availableOptions={blurRadius:{type:"number",default:30,uniformType:"f"},controlPoint1:{type:"vector2",default:new ti(0,.5),uniformType:"2f"},controlPoint2:{type:"vector2",default:new ti(1,.5),uniformType:"2f"},delta:{type:"vector2",default:new ti(1,1),uniformType:"2f"},texSize:{type:"vector2",default:new ti(100,100),uniformType:"2f"}};Vn=ac});var Hn,po,A_,L_=_(()=>{O();P_();({Vector2:Hn}=B),po=class extends te{constructor(...e){super(...e);this._lastBlurRadius=this._options.blurRadius,this._lastControlPoint1=this._options.controlPoint1.clone(),this._lastControlPoint2=this._options.controlPoint2.clone();let t={blurQuality:{type:"string"}};this._horizontalFilter=new Vn({},t),this._verticalFilter=new Vn({},t),this._sprite.setFilters([this._horizontalFilter,this._verticalFilter]),this._horizontalFilter.setDelta(new Hn(.5,.5)),this._verticalFilter.setDelta(new Hn(-.5,.5)),this._filter=new Vn({},t)}rotate(e){let{controlPoint1:t}=this._options,{controlPoint2:i}=this._options;e===90?(t.flip(),t.x=1-t.x,i.flip(),i.x=1-i.x):e===-90&&(t.flip(),t.y=1-t.y,i.flip(),i.y=1-i.y),this.set({controlPoint1:t,controlPoint2:i})}flip(e){let{controlPoint1:t}=this._options,{controlPoint2:i}=this._options;switch(e){case"horizontal":t.x=1-t.x,i.x=1-i.x;break;case"vertical":t.y=1-t.y,i.y=1-i.y;break}this.set({controlPoint1:t,controlPoint2:i})}transform(e){let t={};["controlPoint1","controlPoint2"].forEach(i=>{let r=this.getOption(i);t[i]=e.applyToRelativePoint(r)}),["blurRadius"].forEach(i=>{let r=this.getOption(i);t[i]=e.applyToRelativeSize(r)}),this.set(t,!1)}_renderWebGL(e){return this._renderBlur(e)}_renderCanvas(e){return this._options.highQualityCanvasBlur?this._renderBlur(e):this._renderLQCanvasBlur(e)}_renderBlur(e){let t=e.getDimensions(),i=t.min(),{blurRadius:r,controlPoint1:s,controlPoint2:n}=this._options,a={blurRadius:r*i,controlPoint1:s.clone(),controlPoint2:n.clone(),texSize:t,blurQuality:"high"};return this._horizontalFilter.set(a),this._verticalFilter.set(a),this._renderTexture.render(this._container),Promise.resolve()}_renderLQCanvasBlur(e){let t=e.getDimensions(),{blurRadius:i,controlPoint1:r,controlPoint2:s}=this._options;return this._filter.set({blurRadius:i,controlPoint1:r.clone(),controlPoint2:s.clone(),texSize:t,blurQuality:"low"}),this._sprite.setFilters([this._filter]),this._renderTexture.render(this._container),Promise.resolve()}dispose(){super.dispose(),this._filter.dispose(),this._verticalFilter.dispose(),this._horizontalFilter.dispose()}hasChanges(){return!0}};po.identifier="linear-focus";po.prototype.availableOptions={controlPoint1:{type:"vector2",default:new Hn(0,.5)},controlPoint2:{type:"vector2",default:new Hn(1,.5)},blurRadius:{type:"number",default:.025},highQualityCanvasBlur:{type:"boolean",default:!1}};P.Operations.LinearFocusOperation=po;A_=po});var N_,z_=_(()=>{N_=`/*
 * Based on evanw's glfx.js tilt shift shader:
 * https://github.com/evanw/glfx.js/blob/master/src/filters/blur/tiltshift.js
 * @license
 */

uniform sampler2D u_image;
uniform float u_blurRadius;
uniform float u_gradientSize;
uniform float u_size;
uniform vec2 u_start;
uniform vec2 u_end;
uniform vec2 u_delta;
uniform vec2 u_texSize;
varying vec2 v_texCoord;

float random(vec2 co)
{
    highp float a = 12.9898;
    highp float b = 78.233;
    highp float c = 43758.5453;
    highp float dt = dot(co.xy,vec2(a,b));
    highp float sn = mod(dt, 3.14);
    return fract(sin(sn) * c);
}

void main() {
    vec4 color = vec4(0.0);
    float total = 0.0;

    float offset = random(gl_FragCoord.xy / u_texSize.xy);

    vec2 normal = normalize(vec2(u_start.y - u_end.y, u_end.x - u_start.x));
    float radius = smoothstep(0.0, 1.0,
      (abs(
        dot(v_texCoord * u_texSize - u_start, normal)
      ) - u_size) / u_gradientSize
    ) * u_blurRadius;

    for (float t = -30.0; t <= 30.0; t++) {
        float percent = (t + offset - 0.5) / 30.0;
        float weight = 1.0 - abs(percent);
        vec4 _sample = texture2D(u_image, v_texCoord + u_delta * percent * radius / u_texSize);

        color += _sample * weight;
        total += weight;
    }

    gl_FragColor = color / total;
}
`});var ii,lc,jn,U_=_(()=>{O();ms();z_();({Vector2:ii}=B),lc=class extends R.Filter{constructor(...e){super(...e);this._fragmentSource=N_,this._lastBlurRadius=null,this._lastGradientRadius=null,this._lastStart=new ii,this._lastEnd=new ii,this._blurFilter=new rt,this._blurredRenderTarget=new R.CanvasRenderTarget(100,100,1),this._maskRenderTarget=new R.CanvasRenderTarget(100,100,1)}_applyCanvas(e,t,i,r=!1){if(this._options.blurQuality==="low"){this._renderLQBlur(e,t,i,r);return}let s=t.getDimensions(),n=!i.getDimensions().equals(s);if(t.getBaseTexture().isDirty()||this._lastBlurRadius!==this._options.blurRadius||n){let l=new ii(this._options.delta.x,this._options.delta.y);this._blurFilter.setDelta(l);let h={blurRadius:this._options.blurRadius,texSize:s},c=(T,D,b)=>Math.min(Math.max(T,D),b),m=(T,D,b)=>{let w=c((b-T)/(D-T),0,1);return w*w*(3-2*w)},{blurRadius:d,gradientSize:u,size:f,start:y,end:g,texSize:p}=this._options,v=new ii(y.y-g.y,g.x-y.x);v.divide(v.len());let x=(T,D)=>m(0,1,(Math.abs(p.clone().multiply(T,D).subtract(y).dot(v))-f)/u)*d;this._blurFilter.set(h),this._blurFilter._applyCanvas(e,t,i,r,x),this._lastBlurRadius=this._options.blurRadius}}_renderLQBlur(e,t,i,r=!1){let s=t.getDimensions(),n=!this._blurredRenderTarget.getDimensions().equals(s);this._blurredRenderTarget.setPixelRatio(t.getPixelRatio()),this._blurredRenderTarget.resizeTo(t.getDimensions()),this._maskRenderTarget.setPixelRatio(t.getPixelRatio()),this._maskRenderTarget.resizeTo(t.getDimensions());let a=!this._lastStart.equals(this._options.start)||!this._lastEnd.equals(this._options.end)||this._lastGradientRadius!==this._options.size||n,l=t.getBaseTexture().isDirty()||this._lastBlurRadius!==this._options.blurRadius||n;a&&(this._renderMask(),this._lastStart=this._options.start.clone(),this._lastEnd=this._options.end.clone(),this._lastGradientRadius=this._options.size),l&&(this._blurImage(t,this._blurredRenderTarget,this._options.blurRadius),this._lastBlurRadius=this._options.blurRadius),this._applyMask(t,i)}_renderMask(){let e=this._maskRenderTarget.getCanvas(),t=this._maskRenderTarget.getContext(),i=this._maskRenderTarget.getPixelRatio(),r=new ii(e.width,e.height),s=this._options.size*r.min()*i,n=this._options.gradientSize*r.min()*i,a=this._options.start.clone().multiply(r),h=this._options.end.clone().multiply(r).clone().subtract(a),c=a.clone().add(h.clone().divide(2)),m=h.len(),d=h.clone().divide(m),u=c.clone().add((s+n)*d.y,-(s+n)*d.x),f=c.clone().add(-(s+n)*d.y,(s+n)*d.x),y=t.createLinearGradient(u.x,u.y,f.x,f.y),g=f.clone().subtract(u).len();y.addColorStop(0,"#000000"),y.addColorStop(n/2/g,"#FFFFFF"),y.addColorStop(1-n/2/g,"#FFFFFF"),y.addColorStop(1,"#000000"),t.fillStyle=y,t.fillRect(0,0,e.width,e.height)}_applyMask(e,t){let i=t.getContext(),r=e.getCanvas(),s=e.getContext(),n=this._blurredRenderTarget.getContext(),a=this._maskRenderTarget.getContext(),l=s.getImageData(0,0,r.width,r.height),h=l.data,c=n.getImageData(0,0,r.width,r.height).data,m=a.getImageData(0,0,r.width,r.height).data,d;for(let u=0;u<r.width*r.height*4;u+=4)d=m[u]/255,h[u]=d*h[u]+(1-d)*c[u],h[u+1]=d*h[u+1]+(1-d)*c[u+1],h[u+2]=d*h[u+2]+(1-d)*c[u+2];i.putImageData(l,0,0)}dispose(){super.dispose(),this._blurFilter.dispose()}};lc.prototype.availableOptions={blurRadius:{type:"number",default:30,uniformType:"f"},size:{type:"number",default:50,uniformType:"f"},gradientSize:{type:"number",default:50,uniformType:"f"},start:{type:"vector2",default:new ii(0,.5),uniformType:"2f"},end:{type:"vector2",default:new ii(1,.5),uniformType:"2f"},delta:{type:"vector2",default:new ii(1,1),uniformType:"2f"},texSize:{type:"vector2",default:new ii(100,100),uniformType:"2f"}};jn=lc});var qn,_o,G_,W_=_(()=>{O();U_();({Vector2:qn}=B),_o=class extends te{constructor(...e){super(...e);this._lastBlurRadius=this._options.blurRadius,this._lastSize=this._options.size,this._lastGradientSize=this._options.gradientSize;let t={blurQuality:{type:"string"}};this._horizontalFilter=new jn({},t),this._verticalFilter=new jn({},t),this._sprite.setFilters([this._horizontalFilter,this._verticalFilter]),this._horizontalFilter.setDelta(new qn(.5,.5)),this._verticalFilter.setDelta(new qn(-.5,.5)),this._filter=new jn({},t),this._renderBlur.bind(this)}rotate(e){let{start:t}=this._options,{end:i}=this._options;e===90?(t.flip(),t.x=1-t.x,i.flip(),i.x=1-i.x):e===-90&&(t.flip(),t.y=1-t.y,i.flip(),i.y=1-i.y),this.set({start:t,end:i})}flip(e){let{start:t}=this._options,{end:i}=this._options;switch(e){case"horizontal":t.x=1-t.x,i.x=1-i.x;break;case"vertical":t.y=1-t.y,i.y=1-i.y;break}this.set({start:t,end:i})}transform(e){let t={};["start","end"].forEach(i=>{let r=this.getOption(i);t[i]=e.applyToRelativePoint(r)}),["blurRadius","size","gradientSize"].forEach(i=>{let r=this.getOption(i);t[i]=e.applyToRelativeSize(r)}),this.set(t,!1)}_renderWebGL(e){return this._renderBlur(e)}_renderCanvas(e){return this._options.highQualityCanvasBlur?this._renderBlur(e):this._renderLQCanvasBlur(e)}_renderBlur(e){let t=e.getDimensions(),i=t.min(),r=this._options.start.clone(),s=this._options.end.clone(),{blurRadius:n,size:a,gradientSize:l}=this._options,h={blurRadius:n*i,size:a*i,gradientSize:l*i,start:r.clone().multiply(t),end:s.clone().multiply(t),texSize:t,blurQuality:"high"};return this._horizontalFilter.set(h),this._verticalFilter.set(h),this._renderTexture.render(this._container),Promise.resolve()}_renderLQCanvasBlur(e){let t=e.getDimensions(),{blurRadius:i,size:r,gradientSize:s,start:n,end:a}=this._options;return this._filter.set({blurRadius:i,gradientSize:s,size:r,start:n.clone(),end:a.clone(),texSize:t,blurQuality:"low"}),this._sprite.setFilters([this._filter]),this._renderTexture.render(this._container),Promise.resolve()}dispose(){super.dispose(),this._filter.dispose(),this._verticalFilter.dispose(),this._horizontalFilter.dispose()}hasChanges(){return!0}};_o.identifier="mirrored-focus";_o.prototype.availableOptions={start:{type:"vector2",default:new qn(0,.5)},end:{type:"vector2",default:new qn(1,.5)},blurRadius:{type:"number",default:.025},size:{type:"number",default:.1},gradientSize:{type:"number",default:.1},highQualityCanvasBlur:{type:"boolean",default:!1}};P.Operations.MirroredFocusOperation=_o;G_=_o});var u1,go,V_,H_=_(()=>{O();({Vector2:u1}=B),go=class extends te{_render(e){let t=this._options.rotation%360,i=t*(Math.PI/180),r=t===90||t===270,s=this._options.flipHorizontally!==this._options.flipVertically,n=r&&s?!this._options.flipVertically:this._options.flipVertically,a=r&&s?!this._options.flipHorizontally:this._options.flipHorizontally;this._sprite.setScale(a?-1:1,n?-1:1),this._sprite.setRotation(i),this._sprite.setAnchor(.5,.5),this._sprite.updateTransform();let l=this._sprite.getBounds();return this._renderTexture.resizeTo(new u1(l.width,l.height)),this._sprite.setPosition(this._renderTexture.getDimensions().divide(2).round()),this._renderTexture.render(this._container),Promise.resolve()}getNewDimensions(e){return e=e.clone(),this._options.rotation%180&&e.flip(),e}flip(e){let{rotation:t}=this._options;switch((t===90||t===270)&&(e==="vertical"?e="horizontal":e="vertical"),e){case"vertical":this.setFlipVertically(!this.getFlipVertically());break;case"horizontal":this.setFlipHorizontally(!this.getFlipHorizontally());break}}};go.identifier="orientation";go.prototype.availableOptions={rotation:{type:"number",default:0,validation(o){if(o%90!==0)throw new Error("OrientationOperation: `rotation` has to be a multiple of 90.")},setter:o=>(o+360)%360},flipVertically:{type:"boolean",default:!1},flipHorizontally:{type:"boolean",default:!1}};P.Operations.OrientationOperation=go;V_=go});var Xn,yo,j_,q_=_(()=>{O();({Vector2:Xn}=B),yo=class extends te{constructor(...e){super(...e);this._flipContainer=new R.Container}_render(e){let{position:t,rotation:i,scale:r,pivot:s,outputResolution:n}=this._options,a=this._sdk.getTextureScale(),l=n.clone().multiply(a).ceil();return this._renderTexture.resizeTo(l),this._sprite.setRotation(i),this._sprite.setPosition(t),this._sprite.setPivot(s),this._sprite.setScale(r),this._renderTexture.render(this._container),Promise.resolve()}getNewDimensions(e){let t=this._sdk.getTextureScale();return this._options.outputResolution.clone().multiply(t).ceil()}};yo.identifier="output";yo.prototype.availableOptions={position:{type:"vector2",default:new Xn(0,0)},rotation:{type:"number",default:0},scale:{type:"vector2",default:new Xn(1,1)},pivot:{type:"vector2",default:new Xn(0,0)},outputResolution:{type:"vector2",default:new Xn(100,100)}};P.Operations.OutputOperation=yo;j_=yo});var Yn,X_,d1,xs,Y_,K_=_(()=>{O();({OverlayFilter:Yn}=R.Filters),{Vector2:X_}=B,d1=4,xs=class extends te{constructor(...e){super(...e);this._overlayTexture=R.Texture.fromImage(this._options.image),this._overlayContainer=new R.Container,this._overlaySprite=new R.Sprite,this._overlaySprite.setTexture(this._overlayTexture),this._overlaySprite.setAnchor(0,0),this._overlayContainer.addChild(this._overlaySprite),this._overlayFilter=new R.Filters.OverlayFilter({overlayImage:this._overlayTexture.getBaseTexture().getGLUnit(),overlayTexture:this._overlayTexture}),this._sprite.setFilters([this._overlayFilter]),this._renderedOverlaySprite=new R.Sprite,this._renderedOverlayContainer=new R.Container,this._renderedOverlayContainer.addChild(this._renderedOverlaySprite),this._overlayRendered=!1,this._lastInputDimensions=new X_(0,0)}setOption(e,t){if(super.setOption(e,t),e==="image"&&t&&this._sdk){let i=this._sdk.getRenderer(),r=this._overlayTexture.getBaseTexture();r.setSource(t),i.isOfType("webgl")&&i.updateTexture(r),this._overlayRendered=!1}}_render(e){let t=e.getDimensions(),{image:i,alpha:r,blendMode:s}=this._options;return i?((!this._overlayRendered||!this._lastInputDimensions.equals(t))&&(this._renderOverlayToRenderTexture(e),this._overlayRendered=!0,this._lastInputDimensions.copy(t)),this._overlayFilter.set({blendMode:s,overlayImage:this._overlayRenderTexture.getBaseTexture().getGLUnit(),overlayTexture:this._overlayRenderTexture,alpha:r}),this._sprite.setFilters([this._overlayFilter]),this._renderTexture.render(this._container),Promise.resolve()):(this._sprite.setFilters([]),this._renderTexture.render(this._container),Promise.resolve())}_renderOverlayToRenderTexture(e){let t=this._sdk.getRenderer(),i=e.getDimensions();this._overlayRenderTexture||(this._overlayRenderTexture=new R.RenderTexture(t,i.x,i.y),this._renderedOverlaySprite.setTexture(this._overlayRenderTexture));let{width:r,height:s}=this._options.image,n=k.resizeVectorToFill(new X_(r,s),i),{flipHorizontally:a,flipVertically:l}=this._options,h=a?-1:1,c=l?-1:1;this._overlaySprite.setWidth(n.x*h),this._overlaySprite.setHeight(n.y*c),this._overlaySprite.setPosition(i.x*(1-h)*.5,i.y*(1-c)*.5);let m=this._overlayRenderTexture.getBaseTexture();this._overlayRenderTexture.resizeTo(i),t.isOfType("webgl")&&(m.setGLUnit(d1),t.updateTexture(m,!1)),this._overlayRenderTexture.render(this._overlayContainer)}dispose(){super.dispose(),this._overlaySprite&&this._overlaySprite.dispose(),this._overlayRenderTexture&&this._renderedOverlaySprite.dispose(),this._overlayFilter&&this._overlayFilter.dispose(),this._overlayTexture&&this._overlayTexture.dispose(),this._overlayRenderTexture&&this._overlayRenderTexture.dispose(),this._renderedOverlaySprite&&this._renderedOverlaySprite.dispose()}};xs.identifier="overlay";xs.BLEND_MODES=Yn.BLEND_MODES;xs.prototype.availableOptions={identifier:{type:"string"},image:{type:"image"},blendMode:{type:"number",default:Yn.BLEND_MODES.MULTIPLY,available:Object.keys(Yn.BLEND_MODES).map(o=>Yn.BLEND_MODES[o])},alpha:{type:"number",default:1},flipHorizontally:{type:"boolean",default:!1},flipVertically:{type:"boolean",default:!1}};P.Operations.OverlayOperation=xs;Y_=xs});var Z_,J_=_(()=>{Z_=`/*
 * Based on evanw's glfx.js tilt shift shader:
 * https://github.com/evanw/glfx.js/blob/master/src/filters/blur/tiltshift.js
 * @license
 */

uniform sampler2D u_image;
uniform float u_radius;
uniform float u_blurRadius;
uniform float u_gradientRadius;
uniform vec2 u_position;
uniform vec2 u_delta;
uniform vec2 u_texSize;
varying vec2 v_texCoord;

const float blurSteps = 30.0;
const float EPSILON = 0.000000001;

float random(vec2 co)
{
    highp float a = 12.9898;
    highp float b = 78.233;
    highp float c = 43758.5453;
    highp float dt = dot(co.xy,vec2(a,b));
    highp float sn = mod(dt, 3.14);
    return fract(sin(sn) * c);
}

void main() {
    vec4 color = vec4(0.0);
    float total = 0.0;

    vec2 coord = v_texCoord * u_texSize;
    vec2 diff = coord - u_position;
    float dist = sqrt(diff.x * diff.x + diff.y * diff.y);

    float blurPercentage = smoothstep( 
      0.0, 1.0,
      (abs(dist) - u_radius) / u_gradientRadius
    );

    float radius = blurPercentage * u_blurRadius;
    float offset = random(gl_FragCoord.xy / u_texSize.xy);

    for (float t = -blurSteps; t <= blurSteps; t++) {
        float percent = (t + offset - 0.5) / blurSteps;
        float weight = 1.0 - abs(percent);
        vec4 _sample = texture2D(u_image, v_texCoord + u_delta * percent * radius / u_texSize);

        color += _sample * weight;
        total += weight;
    }

    gl_FragColor = color / max(total, EPSILON);
}
`});var bs,hc,Kn,Q_=_(()=>{O();ms();J_();({Vector2:bs}=B),hc=class extends R.Filter{constructor(...e){super(...e);this._fragmentSource=Z_,this._lastBlurRadius=null,this._lastGradientRadius=null,this._lastPosition=new bs,this._blurFilter=new rt,this._blurredRenderTarget=new R.CanvasRenderTarget(100,100,1),this._maskRenderTarget=new R.CanvasRenderTarget(100,100,1)}_applyCanvas(e,t,i,r=!1){if(this._options.blurQuality==="low"){this._renderLQBlur(e,t,i,r);return}let s=t.getDimensions(),n=!i.getDimensions().equals(s),{blurRadius:a,position:l,texSize:h,gradientRadius:c}=this._options;if(t.getBaseTexture().isDirty()||this._lastBlurRadius!==a||n){let d=new bs(this._options.delta.x,this._options.delta.y);this._blurFilter.setDelta(d);let u={blurRadius:a,texSize:s},f=(p,v,x)=>Math.min(Math.max(p,v),x),y=(p,v,x)=>{let T=f((x-p)/(v-p),0,1);return T*T*(3-2*T)},g=(p,v)=>y(0,1,(Math.abs(h.clone().multiply(p,v).subtract(l).len())-this._options.radius)/(c*2))*a;this._blurFilter.set(u),this._blurFilter._applyCanvas(e,t,i,r,g),this._lastBlurRadius=a}}_renderLQBlur(e,t,i,r=!1){let s=t.getDimensions(),n=!this._blurredRenderTarget.getDimensions().equals(s);this._blurredRenderTarget.setPixelRatio(t.getPixelRatio()),this._blurredRenderTarget.resizeTo(t.getDimensions()),this._maskRenderTarget.setPixelRatio(t.getPixelRatio()),this._maskRenderTarget.resizeTo(t.getDimensions());let a=!this._lastPosition.equals(this._options.position)||this._lastGradientRadius!==this._options.gradientRadius||n,l=t.getBaseTexture().isDirty()||this._lastBlurRadius!==this._options.blurRadius||n;a&&(this._renderMask(),this._lastPosition=this._options.position.clone(),this._lastGradientRadius=this._options.gradientRadius),l&&(this._blurImage(t,this._blurredRenderTarget,this._options.blurRadius),this._lastBlurRadius=this._options.blurRadius),this._applyMask(t,i)}_renderMask(){let e=this._maskRenderTarget.getCanvas(),t=this._maskRenderTarget.getContext(),i=new bs(e.width,e.height),r=this._maskRenderTarget.getPixelRatio(),s=this._options.position.clone().multiply(i),{radius:n,gradientRadius:a}=this._options;n*=e.height,a*=e.height;let l=t.createRadialGradient(s.x,s.y,0,s.x,s.y,(n+a)*r);l.addColorStop(0,"#FFFFFF"),l.addColorStop(n/(n+a),"#FFFFFF"),l.addColorStop(1,"#000000"),t.fillStyle=l,t.fillRect(0,0,i.x,i.y)}_applyMask(e,t){let i=t.getContext(),r=e.getCanvas(),s=e.getContext(),n=this._blurredRenderTarget.getContext(),a=this._maskRenderTarget.getContext(),l=s.getImageData(0,0,r.width,r.height),h=l.data,c=n.getImageData(0,0,r.width,r.height).data,m=a.getImageData(0,0,r.width,r.height).data,d;for(let u=0;u<r.width*r.height*4;u+=4)d=m[u]/255,h[u]=d*h[u]+(1-d)*c[u],h[u+1]=d*h[u+1]+(1-d)*c[u+1],h[u+2]=d*h[u+2]+(1-d)*c[u+2];i.putImageData(l,0,0)}dispose(){super.dispose(),this._blurFilter.dispose(),this._blurredRenderTarget.dispose(),this._maskRenderTarget.dispose()}};hc.prototype.availableOptions={blurRadius:{type:"number",default:30,uniformType:"f"},radius:{type:"number",default:50,uniformType:"f"},gradientRadius:{type:"number",default:25,uniformType:"f"},position:{type:"vector2",default:new bs(.5,.5),uniformType:"2f"},delta:{type:"vector2",default:new bs(1,1),uniformType:"2f"},texSize:{type:"vector2",default:new bs(100,100),uniformType:"2f"}};Kn=hc});var cc,xo,$_,eg=_(()=>{O();Q_();({Vector2:cc}=B),xo=class extends te{constructor(...e){super(...e);this._lastBlurRadius=this._options.blurRadius,this._lastGradientRadius=this._options.gradientRadius;let t={blurQuality:{type:"string"}};this._horizontalFilter=new Kn({},t),this._verticalFilter=new Kn({},t),this._sprite.setFilters([this._horizontalFilter,this._verticalFilter]),this._horizontalFilter.setDelta(new cc(.5,.5)),this._verticalFilter.setDelta(new cc(-.5,.5)),this._filter=new Kn({},t)}rotate(e){let{position:t}=this._options;e===90?(t.flip(),t.x=1-t.x):e===-90&&(t.flip(),t.y=1-t.y),this.set({position:t})}flip(e){let{position:t}=this._options;switch(e){case"horizontal":t.x=1-t.x;break;case"vertical":t.y=1-t.y;break}this.set({position:t})}transform(e){let t={},i=this.getPosition();t.position=e.applyToRelativePoint(i),["radius","blurRadius","gradientRadius"].forEach(r=>{let s=this.getOption(r);t[r]=e.applyToRelativeSize(s)}),this.set(t,!1)}_renderWebGL(e){return this._renderBlur(e)}_renderCanvas(e){return this._options.highQualityCanvasBlur?this._renderBlur(e):this._renderLQCanvasBlur(e)}_renderBlur(e){let t=e.getDimensions(),i=t.min(),{position:r,blurRadius:s,radius:n,gradientRadius:a}=this._options,l={blurRadius:s*i,radius:n*i,gradientRadius:a*i,position:r.clone().multiply(t),texSize:t,blurQuality:"high"};return this._horizontalFilter.set(l),this._verticalFilter.set(l),this._renderTexture.render(this._container),Promise.resolve()}_renderLQCanvasBlur(e){let{blurRadius:t,radius:i,gradientRadius:r,position:s}=this._options,n=e.getDimensions();return this._filter.set({blurRadius:t,radius:i,gradientRadius:r,position:s,texSize:n,blurQuality:"low"}),this._sprite.setFilters([this._filter]),this._renderTexture.render(this._container),Promise.resolve()}dispose(){super.dispose(),this._filter.dispose(),this._verticalFilter.dispose(),this._horizontalFilter.dispose()}hasChanges(){return!0}};xo.identifier="radial-focus";xo.prototype.availableOptions={position:{type:"vector2",default:new cc(.5,.5)},radius:{type:"number",default:.25},gradientRadius:{type:"number",default:.125},blurRadius:{type:"number",default:.025},highQualityCanvasBlur:{type:"boolean",default:!1}};P.Operations.RadialFocusOperation=xo;$_=xo});var ig,tg=_(()=>{ig=`varying vec2 v_texCoord;
uniform sampler2D u_image;
uniform sampler2D u_filterImage;
uniform sampler2D u_maskImage;

void main() {
  vec4 color0 = texture2D(u_image, v_texCoord);
  vec4 color1 = texture2D(u_filterImage, v_texCoord);
  vec4 mask = texture2D(u_maskImage, v_texCoord);
  gl_FragColor = mix(color0, color1, mask);
}
`});var uc,rg,sg=_(()=>{O();tg();uc=class extends R.Filter{constructor(){super();this._fragmentSource=ig}_applyCanvas(e,t,i,r=!1){let s=t.getCanvas(),n=t.getContext(),a=i.getContext(),{maskCanvas:l,filterCanvas:h}=this._options,c=l.getContext("2d"),m=h.getContext("2d"),d=c.getImageData(0,0,s.width,s.height).data,u=n.getImageData(0,0,s.width,s.height),f=u.data,y=m.getImageData(0,0,s.width,s.height).data,g;for(let p=0;p<s.width*s.height*4;p+=4)g=d[p]/255,f[p]=g*y[p]+(1-g)*f[p],f[p+1]=g*y[p+1]+(1-g)*f[p+1],f[p+2]=g*y[p+2]+(1-g)*f[p+2];a.putImageData(u,0,0)}};uc.prototype.availableOptions={maskImage:{type:"number",default:1,uniformType:"i"},maskCanvas:{type:"object",default:null},filterImage:{type:"number",default:2,uniformType:"i"},filterCanvas:{type:"object",default:null}};rg=uc});var Jn,og,Gt,vs=_(()=>{O();({Vector2:Jn}=B),og=class extends V{constructor(e,t){super(t);this._isDisposed=!1,this._operation=e,this._dirtiness={},this.id=k.getUUID(),this._renderTextures={},this._identitySprite=new R.Sprite,this._sprite=new R.Sprite,this._hitTestSprite=new R.Sprite,this._renderers=[]}applyScale(e){}applyRotation(e){let t=this._operation.getInputDimensions(),i=this.getRotation()*180/Math.PI;i+=e,this.setRotation(i*Math.PI/180);let s=(e+360)%360*Math.PI/180,n=Math.cos(s),a=Math.sin(s),l=this._options.position.clone().subtract(.5).multiply(t),h=new Jn(l.x*n-l.y*a,l.x*a+l.y*n).divide(t.clone().flip());this.setPosition(new Jn(.5,.5).add(h))}applyFlip(e){let t=this.getPosition().clone();switch(e){case"horizontal":t.x=1-this._options.position.x;break;case"vertical":t.y=1-this._options.position.y;break}this.setPosition(t)}applyTransform(e){let t={};t.rotation=e.applyToRotation(this.getRotation()),t.position=e.applyToRelativePoint(this.getPosition()),this._options.dimensions&&(t.dimensions=e.applyToDimensions(this.getDimensions())),this.set(t,!1)}getDisplayObject(){return this._sprite}getHitTestDisplayObject(){return this._sprite}_getTexture(){throw new Error("Sprite#_getTexture is abstract and not implemented in child class.")}_prepareRenderTexture(e){if(this._renderTexture)this._renderTexture.clear();else{let t=this._getTexture();this._renderTextureContainer=new R.Container,this._renderTextureSprite=new R.Sprite(t),this._renderTextureContainer.addChild(this._renderTextureSprite),this._renderTexture=this._getRenderTexture(e.getRenderer(),t.getDimensions())}}_rendersToRenderTexture(e){return e.getOptions().smoothDownscaling&&e.getRenderer().isOfType("webgl")}_optionEquals(e,t){return e==="type"?!0:super._optionEquals(e,t)}update(e,t){this._isDisposed||(this._rendersToRenderTexture(e)&&(this._prepareRenderTexture(e),this._renderToRenderTexture(e)),this._updateSprite(t))}_updateSprite(e){[this._sprite,this._hitTestSprite].forEach(i=>{if(!i.getTexture())return;i.setAnchor(this._options.anchor),i.setPosition(this._options.position.clone().multiply(e)),typeof this._options.alpha!="undefined"&&i.setAlpha(this._options.alpha);let{dimensions:r}=this._options;r&&(r=r.clone().multiply(this._operation.getSDK().getTextureScale()),i.setWidth(r.x),i.setHeight(r.y)),i.updateTransform();let s=i.getTexture().getFrame(),n=new Jn(s.width,s.height);i.setPivot(this._options.pivot.clone().multiply(n)),i.setRotation(this._options.rotation),i.updateTransform()})}_renderToRenderTexture(e){let t=this._getTexture().getDimensions(),i=this._getRenderTexture(e.getRenderer(),t),r=t.clone();if(this._options.smoothDownscaling&&(r.x=k.nextHighestPOT(r.x),r.y=k.nextHighestPOT(r.y)),this._renderTexture.resizeTo(r),this._renderTexture.render(this._renderTextureContainer),this._options.smoothDownscaling){let s=r.clone().subtract(t.x,t.y).divide(r),n=i.getUVs().getUVs();n[0].x=n[3].x=0,n[1].x=n[2].x=1-s.x,n[0].y=n[1].y=0,n[2].y=n[3].y=1-s.y}this._sprite.setTexture(i)}isDirtyForRenderer(e){return e.id in this._dirtiness||(this._dirtiness[e.id]=!0),this._dirtiness[e.id]}setDirtyForRenderer(e,t){this._renderers[t.id]=t,this._dirtiness[t.id]=e}setDirty(e){for(let t in this._dirtiness)this.setDirtyForRenderer(e,this._renderers[t])}_getRenderTexture(e,t=new Jn(100,100)){return this._renderTextures[e.id]||(this._renderTextures[e.id]=new R.RenderTexture(e,t.x,t.y,1)),this._renderTextures[e.id]}dispose(){this._isDisposed=!0;for(let e in this._renderTextures)this._renderTextures[e].dispose()}canBeDuplicated(){return!0}canBeDeleted(){return!0}canMaskCanvas(){return!1}canAdjustPadding(){return!1}canBeTakenToFront(){return!0}canBeFlippedHorizontally(){return!0}},Gt=og});var p1,wi,dc=_(()=>{O();({Vector2:p1}=B),wi=class extends V{constructor(...e){super(...e);this._lastOptions={},this._lastInputDimensions=new p1(0,0),this._brush=null}getBrushImage(e){if(this._brush&&this.optionsEqual(this._lastOptions)&&e.equals(this._lastInputDimensions))return this._brush;let{image:t,size:i}=this._options;t.width=t.height=Math.ceil(i*e.min());let r=k.createCanvas();r.width=t.width,r.height=t.height;let s=r.getContext("2d");s.drawImage(t,0,0,r.width,r.height);let n=this._tintImageData(s.getImageData(0,0,r.width,r.height),r.width,r.height);return s.putImageData(n,0,0),this._lastOptions=this.serializeOptions(["size","color"]),this._brush=r,this._lastInputDimensions=e.clone(),r}_tintImageData(e){let{color:t}=this._options;for(let i=0;i<e.data.length;i+=4)e.data[i]+=(t.r*255-e.data[i])*t.a,e.data[i+1]+=(t.g*255-e.data[i+1])*t.a,e.data[i+2]+=(t.b*255-e.data[i+2])*t.a;return e}clone(){let e=this.constructor;return new e(this._options)}};wi.prototype.availableOptions={identifier:{type:"string"},image:{type:"image"},size:{type:"number",default:.05},color:{type:"color",default:S.RED}}});var Qi,ng=_(()=>{O();dc();Qi=class extends wi{getBrushImage(e){if(this._brush&&this.optionsEqual(this._lastOptions)&&e.equals(this._lastInputDimensions))return this._brush;let{size:t,hardness:i,color:r}=this._options,s=k.createCanvas();s.width=s.height=Math.ceil(t*e.min());let n=s.getContext("2d");if(r=r.clone(),r.a=1,s.width===1)n.fillStyle=r.toRGBA(),n.fillRect(0,0,1,1);else{let a=n.createRadialGradient(s.width/2,s.height/2,Math.min(s.width/2-1,s.width/2*i),s.width/2,s.height/2,s.width/2);a.addColorStop(0,r.toRGBA());let l=r.clone();l.a=0,a.addColorStop(1,l.toRGBA()),n.fillStyle=a,n.fillRect(0,0,s.width,s.height)}return this._lastOptions=this.serializeOptions(["size","color","hardness"]),this._brush=s,this._lastInputDimensions=e.clone(),s}};Qi.identifier="imgly_brush_radial";Qi.prototype.availableOptions=L(C({},wi.prototype.availableOptions),{hardness:{type:"number",default:1}})});var _1,g1,ag,lg,hg=_(()=>{O();({Vector2:_1,CubicBezierCurve:g1}=B),ag=class{constructor(e,t,i=3){this._path=e,this._drawnCanvases=[],this._position=t,this._smooth=i}getBezierCurve(e,t,i,r){if(!t)return null;let s,n;r?(s=(r.x-t.x)/this._smooth,n=(r.y-t.y)/this._smooth):(s=(i.x-t.x)/this._smooth,n=(i.y-t.y)/this._smooth);let a,l;e?(a=(i.x-e.x)/this._smooth,l=(i.y-e.y)/this._smooth):(a=(i.x-t.x)/this._smooth,l=(i.y-t.y)/this._smooth);let h=t.clone().add(a,l),c=i.clone().subtract(s,n);return new g1(t,h,c,i)}renderToCanvas(e,t,i,r,s,n=1){if(this._drawnCanvases.indexOf(t)!==-1)return;let a=new _1(t.width,t.height),l=t.getContext("2d"),h=this._position.clone().multiply(a),c=r?r.getPosition().clone().multiply(a):null,m=i?i.getPosition().clone().multiply(a):null,d=s?s.getPosition().clone().multiply(a):null,u=h.clone().subtract(c).len(),f=e.width/10,y=this.getBezierCurve(m,c,h,d),g;if(!y)g=[h];else{y.calculateSegments(20);let p=y.getLength();g=y.arcLengthApproxSample(Math.ceil(p/f))}for(let p=0;p<g.length;p++){let v=g[p],x=e.width*.5/(f*2);x*=1-n,x=1/(1+x),l.globalAlpha=x,l.drawImage(e,v.x-e.width/2,v.y-e.height/2,e.width,e.height)}l.globalAlpha=1,this._drawnCanvases.push(t)}setPosition(e){this._position=e}getPosition(){return this._position.clone()}setDirty(){this._drawnCanvases=[]}},lg=ag});var mc,bo,cg=_(()=>{O();hg();mc=class extends V{constructor(e,t,i){super(t);this._operation=e,this._canvas=i||k.createCanvas(),this._context=this._canvas.getContext("2d")}serializeOption(e,t=!1){return e==="controlPoints"?this._options.controlPoints.map(i=>{let r=i.getPosition();return t?r.toObject():r.clone()}):super.serializeOption(e,t)}_optionEquals(e,t){if(e==="controlPoints"){let{controlPoints:i}=this._options;for(let r=0,s=i.length;r<s;r++)if(!i[r].getPosition().equals(t[r]))return!1;return!0}return super._optionEquals(e,t)}render(e){let{controlPoints:t,size:i}=this._options;if(t.length<2)return;let r=this.getBrush(),s=r&&r.getHardness?r.getHardness():1;k.ensureCanvasDimensions(this._canvas,e),(!this._brush||this._lastBrushSize!==i||!e.equals(this._brushInputDimensions))&&(this._brushInputDimensions=e.clone(),this._lastBrushSize=i);let n,a,l,h;for(let c=0;c<t.length;c++)n=t[c-2],a=t[c-1],l=t[c],h=t[c+1],l.renderToCanvas(this._options.brush.getBrushImage(e),this._canvas,n,a,h,s)}_createBrush(e){let{size:t,hardness:i,color:r}=this._options,s=k.createCanvas();s.width=s.height=Math.ceil(t*e.min());let n=s.getContext("2d");if(r=r.clone(),r.a=1,s.width===1)n.fillStyle=r.toRGBA(),n.fillRect(0,0,1,1);else{let a=n.createRadialGradient(s.width/2,s.height/2,Math.min(s.width/2-1,s.width/2*i),s.width/2,s.height/2,s.width/2);a.addColorStop(0,r.toRGBA());let l=r.clone();l.a=0,a.addColorStop(1,l.toRGBA()),n.fillStyle=a,n.fillRect(0,0,s.width,s.height)}return s}addControlPoint(e){let t=new lg(this,e);this._options.controlPoints.push(t),this.emit("update",this)}getCanvas(){return this._canvas}setCanvas(e){this._canvas=e,this._context=e.getContext("2d")}setDirty(){this._context.clearRect(0,0,this._canvas.width,this._canvas.height),this._options.controlPoints.forEach(e=>{e.setDirty()})}forEachControlPoint(e){this._options.controlPoints.forEach(e)}renderToCanvas(e){let t=e.getContext("2d");t.save(),t.globalAlpha=this._options.brush.getColor().a,t.drawImage(this._canvas,0,0),t.restore()}getCanvasDimensions(){return this._canvasDimensions}};mc.prototype.availableOptions={id:{type:"string",default:()=>k.getUUID()},brush:{type:"object",required:!0},controlPoints:{type:"array",default:[]},closed:{type:"boolean",default:!1}};bo=mc});var Zn,$i,er,fc=_(()=>{O();vs();dc();ng();cg();({Vector2:Zn}=B),$i=class extends Gt{constructor(...e){super(...e);this._persistedPaths=[],this._outputCanvasDirty=!0,this._outputCanvas=k.createCanvas(),this._outputContext=this._outputCanvas.getContext("2d"),this._persistCanvas=k.createCanvas(),this._persistContext=this._persistCanvas.getContext("2d"),this._nextCanvas=k.createCanvas(),this._texture=R.Texture.fromCanvas(this._outputCanvas),this._sprite.setTexture(this._texture),this._onPathUpdate=this._onPathUpdate.bind(this)}applyFlip(e){this._options.paths.forEach(t=>{t.forEachControlPoint(i=>{let r=i.getPosition().clone();switch(e){case"horizontal":r.x=1-r.x;break;case"vertical":r.y=1-r.y;break}i.setPosition(r)}),t.setDirty(!0)}),this._reset()}applyRotation(e){this._options.paths.forEach(t=>{t.forEachControlPoint(i=>{let r=i.getPosition().clone();e===90?(r.flip(),r.x=1-r.x):e===-90&&(r.flip(),r.y=1-r.y),i.setPosition(r)}),t.setDirty(!0)}),this._reset()}applyTransform(e){let t=null;this._options.paths.forEach(i=>{i.forEachControlPoint(s=>{s.setPosition(e.applyToRelativePoint(s.getPosition()))});let r=i.getBrush();r!==t&&(r.setSize(e.applyToRelativeSize(r.getSize())),t=r),i.setDirty(!0)}),this._reset()}clearCanvas(){if(!this._outputCanvas)return;this._outputCanvasDirty=!0;let{width:e,height:t}=this._outputCanvas;this._outputContext.clearRect(0,0,e,t)}clearPersistCanvas(){if(!this._persistCanvas)return;let{width:e,height:t}=this._persistCanvas;this._persistContext.clearRect(0,0,e,t)}serializeOptions(e,t=!1){let i=super.serializeOptions(e,t);return e||(i.type="brush"),i}serializeOption(e,t=!1){return e==="paths"?this._options.paths.map(i=>i.serializeOptions(void 0,t)):super.serializeOption(e,t)}createPath(e){let t=new bo(this._operation,{brush:e},this._nextCanvas);return t.on("update",this._onPathUpdate),this._options.paths.push(t),this.setDirty(!0),t}_onPathUpdate(){this._operation.setDirty(!0),this.setDirty(!0)}_onPathPersist(e){e.renderToCanvas(this._persistCanvas),this._nextCanvas=e.getCanvas(),this._nextCanvas.getContext("2d").clearRect(0,0,this._nextCanvas.width,this._nextCanvas.height),this._persistedPaths.push(e)}_getTexture(){return this._texture}setDirtyForRenderer(e,t,i=!1){super.setDirtyForRenderer(e,t,i),e&&i&&(this._persistedPaths=[],this.clearPersistCanvas(),this._options.paths.forEach(r=>{r.setDirty(!0)}))}setDirty(e,t=!1){for(let i in this._dirtiness)this.setDirtyForRenderer(e,this._renderers[i],t)}render(e){let t=this._operation.getSDK().getRenderer();!this.isDirtyForRenderer(t)||(k.ensureCanvasDimensions(this._outputCanvas,e),k.ensureCanvasDimensions(this._persistCanvas,e),this._options.paths.forEach(i=>{i.render(e),i.getClosed()&&this._persistedPaths.indexOf(i)===-1&&this._onPathPersist(i)}),this.clearCanvas(),this._outputContext.drawImage(this._persistCanvas,0,0),this._options.paths.forEach(i=>{i.getClosed()||i.renderToCanvas(this._outputCanvas)}),this.setDirtyForRenderer(!1,t))}update(e,t){t&&(k.ensureCanvasDimensions(this._outputCanvas,t),k.ensureCanvasDimensions(this._persistCanvas,t),this._texture.getBaseTexture().update()),this.render(t);let i=e.getRenderer();i.isOfType("webgl")&&i.updateTexture(this._texture.getBaseTexture()),super.update(e,t)}_reset(){this._persistedPaths=[],this._operation&&this._operation.setDirty(!0),this.setDirty(!0),this.clearCanvas(),this.clearPersistCanvas()}getCanvas(){return this._outputCanvas}_createRadialBrush(){return new Qi}_getTempCanvas(){return this._nextCanvas}dispose(){super.dispose(),this._texture&&this._texture.getBaseTexture().dispose()}};$i.prototype.availableOptions={id:{type:"string",default:()=>k.getUUID()},position:{type:"vector2",default:new Zn(0,0)},scale:{type:"vector2",default:new Zn(1,1)},anchor:{type:"vector2",default:new Zn(0,0)},pivot:{type:"vector2",default:new Zn(0,0)},rotation:{type:"number",default:0},paths:{type:"array",default:[],setter(o){return o=o.map(e=>{if(e instanceof bo)return e;let{brush:t,closed:i}=e,r=new bo(this._operation,{brush:t,closed:i},this._nextCanvas);return e.controlPoints.forEach(s=>{r.addControlPoint(s)}),r}),this._reset(),o}}};$i.type="brush";$i.Brush=wi;$i.Path=bo;$i.Brushes={RadialBrush:Qi};er=$i});var ug,vo,dg,mg=_(()=>{O();ms();sg();fc();({Vector2:ug}=B),vo=class extends te{constructor(...e){super(...e);let t=this._sdk.getRenderer();this._lastBlurRadius=null,this._blurredRenderTexture=new R.RenderTexture(t,100,100,1),this._maskRenderTexture=new R.RenderTexture(t,100,100,1),this._brushSprite=new er(this),this._brushSpriteContainer=new R.Container;let i=this._brushSprite.getDisplayObject();if(this._brushSpriteContainer.addChild(i),this._outputSprite=new R.Sprite,this._outputContainer=new R.Container,this._outputContainer.addChild(this._outputSprite),this._maskFilter=new rg,t.isOfType("webgl")){this._horizontalFilter=new rt,this._verticalFilter=new rt,this._sprite.setFilters([this._horizontalFilter,this._verticalFilter]),this._horizontalFilter.setDelta(new ug(1,1)),this._verticalFilter.setDelta(new ug(-1,1));let r=this._maskRenderTexture.getBaseTexture();r.setGLUnit(this._maskFilter.getMaskImage()),t.updateTexture(r,!1),r=this._blurredRenderTexture.getBaseTexture(),r.setGLUnit(this._maskFilter.getFilterImage()),t.updateTexture(r,!1)}else t.isOfType("canvas")&&(this._blurFilter=new rt,this._sprite.setFilters([this._blurFilter]),this._maskFilter.setMaskCanvas(this._maskRenderTexture.getRenderTarget().getCanvas()),this._maskFilter.setFilterCanvas(this._blurredRenderTexture.getRenderTarget().getCanvas()));this._outputSprite.setFilters([this._maskFilter])}flip(e){this._brushSprite.applyFlip(e),this.setDirty(!0,!0),this._lastBlurRadius=null}rotate(e){this._brushSprite.applyRotation(e),this.setDirty(!0,!0),this._lastBlurRadius=null}transform(e,t){this._brushSprite.applyTransform(e,t),this.setDirty(!0,!0),this._lastBlurRadius=null}_render(e){return this._renderBlur(e),this._renderMask(e),this._outputSprite.setTexture(e),this._renderTexture.render(this._outputContainer),Promise.resolve()}_renderMask(e){let t=e.getDimensions();this._maskRenderTexture.getDimensions().equals(t)||this._maskRenderTexture.resizeTo(t),this._brushSprite.update(this._sdk,t),this._maskRenderTexture.clear(S.BLACK),this._maskRenderTexture.render(this._brushSpriteContainer);let r=this._sdk.getRenderer();r.isOfType("webgl")&&r.updateTexture(this._maskRenderTexture.getBaseTexture(),!1)}_renderBlur(e){let t=e.getDimensions(),i=this._blurredRenderTexture.getDimensions();i.equals(t)||this._blurredRenderTexture.resizeTo(t);let{blurRadius:r}=this._options;if(this._lastBlurRadius!==r||!i.equals(t)){let n=this._sdk.getRenderer(),a;if(n.isOfType("webgl")){let l=t.min();a={blurRadius:r*l,texSize:t},this._horizontalFilter.set(a),this._verticalFilter.set(a)}else n.isOfType("canvas")&&(a={blurRadius:r},this._blurFilter.set(a));this._blurredRenderTexture.render(this._container),this._lastBlurRadius=r}let s=this._sdk.getRenderer();s.isOfType("webgl")&&s.updateTexture(this._blurredRenderTexture.getBaseTexture(),!1)}getBrush(){return this._brushSprite}createPath(e,t=1){let i=new er.Brushes.RadialBrush({size:e,hardness:t,color:S.WHITE}),r=this._brushSprite.createPath(i);return this._options.paths.push(r),this.setDirty(!0),r}setDirtyForRenderer(e,t,i){super.setDirtyForRenderer(e,t,i),this._brushSprite.setDirtyForRenderer(e,t,i)}dispose(){super.dispose(),this._sdk.getRenderer().isOfType("webgl")?(this._verticalFilter.dispose(),this._horizontalFilter.dispose()):this._blurFilter.dispose(),this._brushSprite.dispose(),this._maskFilter.dispose(),this._blurredRenderTexture.dispose(),this._maskRenderTexture.dispose()}hasChanges(){return!0}};vo.identifier="selective-blur";vo.prototype.availableOptions={blurRadius:{type:"number",default:.05},paths:{type:"array",default:[],setter(o){return this._brushSprite&&this._brushSprite.setPaths(o),o}}};P.Operations.SelectiveBlurOperation=vo;dg=vo});var tr,Qn,$n,ea,fg=_(()=>{O();ah();vs();({Vector2:tr,ColorMatrix:Qn}=B),$n=class extends Gt{constructor(...e){super(...e);let{image:t}=this._options,i=t.src||t.filePath||t.toDataUrl&&t.toDataURL();this._isSVG=i&&(!!i.match(/\w+\.svg(?=\?|$)/i)||i.match(/data:image\/svg/i)),this._isSVG&&(this._canvas=k.createCanvas(),this._context=this._canvas.getContext("2d"),this._options.smoothDownscaling=!1),t&&this._onImageUpdate(),this._tintFilter=new R.Filters.TintFilter,this._adjustmentsFilter=new _n,this._lastRenderedDimensions=tr.NULL,this._lastRenderedInputDimensions=tr.NULL,this._onOptionsChange=this._onOptionsChange.bind(this),this._options.adjustments.on("update",this._onOptionsChange)}applyScale(e){this.setDimensions(this.getDimensions().multiply(e))}serializeOptions(e,t=!1){let i=super.serializeOptions(e,t);return e||(i.type="sticker"),i}_rendersToRenderTexture(e){return this._options.smoothDownscaling&&!this._isSVG&&e.getRenderer().isOfType("webgl")||this._hasAdjustments()||this._options.tintMode!=="none"}_getTexture(){return this._inputTexture}update(e,t){let{dimensions:i,image:r}=this._options;if(i.equals(tr.NULL)&&i.set(r.width,r.height),this._sprite.setSmoothDownscaling(this._isSVG?!1:this.getSmoothDownscaling()),(!this._lastRenderedInputDimensions.equals(t)||!this._lastRenderedDimensions.equals(i)||this._lastRenderedImage!==r)&&this._isSVG&&e.getRenderer().isOfType("webgl")){r.width=Math.round(i.x),r.height=Math.round(i.y);let a=4096,l=r.width/r.height;r.width>a&&(r.width=a,r.height=Math.round(r.width/l)),r.height>a&&(r.height=a,r.width=Math.round(r.height*l)),this._canvas.width=r.width,this._canvas.height=r.height,this._context.clearRect(0,0,r.width,r.height),this._context.drawImage(r,0,0,r.width,r.height),this._inputTexture.getBaseTexture().update()}this._rendersToRenderTexture(e)&&this._prepareRenderTexture(e);let n=[];if(this._rendersToRenderTexture(e)){if(this._hasAdjustments()){n.push(this._adjustmentsFilter);let{adjustments:a}=this._options,l=new Qn;l.multiply(Qn.createBrightnessMatrix(a.getBrightness())),l.multiply(Qn.createSaturationMatrix(a.getSaturation())),l.multiply(Qn.createContrastMatrix(a.getContrast())),this._adjustmentsFilter.set({colorMatrix:l})}this._options.tintMode&&this._options.tintMode!=="none"&&(n.push(this._tintFilter),this._tintFilter.set({mode:R.Filters.TintFilter.MODES[this._options.tintMode.toUpperCase()],color:this._options.tintColor}),this._sprite.getTexture()&&this._sprite.getTexture()._baseTexture&&this._sprite.getTexture()._baseTexture.setDirty(!0)),this._renderTextureSprite.setFilters(n)}this._rendersToRenderTexture(e)?this._renderToRenderTexture(e):this._sprite.setTexture(this._inputTexture),this._updateSprite(t),this._applyFlip(),this._lastRenderedDimensions.copy(i),this._lastRenderedInputDimensions.copy(t),this._lastRenderedImage=r}_applyFlip(){let e=this._sprite.getScale(),{flipHorizontally:t,flipVertically:i}=this._options;(t&&e.x>0||!t&&e.x<0)&&(e.x*=-1),(i&&e.y>0||!i&&e.y<0)&&(e.y*=-1),this._sprite.setScale(e)}applyFlip(e){super.applyFlip(e);let t={rotation:this._options.rotation},r=t.rotation/Math.PI*180*-1;switch(t.rotation=r*Math.PI/180,e){case"horizontal":t.flipHorizontally=!this._options.flipHorizontally,this.set(t);break;case"vertical":t.flipVertically=!this._options.flipVertically,this.set(t);break}}_hasAdjustments(){let{adjustments:e}=this._options;return e.getBrightness()!==0||e.getSaturation()!==1||e.getContrast()!==1}_onImageUpdate(){let e=this._options.image,t=this._operation.getSDK().getRenderer();this._isSVG&&t.isOfType("webgl")&&(e=this._canvas),this._inputTexture&&(this._inputTexture.dispose(),this._inputTexture=null),this._inputTexture=R.Texture.fromImage(e),this._identitySprite.setTexture(this._inputTexture),this._sprite.setTexture(this._inputTexture),this._renderTexture&&(this._renderTextureSprite.setTexture(this._inputTexture),this._renderTexture.resizeTo(this._inputTexture.getDimensions())),this.setDirty(!0)}scalesUniformly(){return this._options.resizeMode==="keepAspect"}setOption(e,t,i=!0){super.setOption(e,t,i),e==="image"&&this._identitySprite&&this._onImageUpdate()}_onOptionsChange(){let e=this._dirtiness;for(let t in e)e[t]=!0}dispose(){super.dispose(),this._inputTexture&&(this._inputTexture.dispose(),this._inputTexture=null),this._tintFilter.dispose(),this._adjustmentsFilter.dispose(),this._options.adjustments.off("updated",this._onOptionsChange)}};$n.prototype.availableOptions={id:{type:"string",default:()=>k.getUUID()},identifier:{type:"string",default:""},image:{type:"image",required:!0},position:{type:"vector2",default:tr.NULL},dimensions:{type:"vector2",default:tr.NULL},anchor:{type:"vector2",default:new tr(0,0)},pivot:{type:"vector2",default:new tr(.5,.5)},rotation:{type:"number",default:0},flipHorizontally:{type:"boolean",default:!1},flipVertically:{type:"boolean",default:!1},smoothDownscaling:{type:"boolean",default:!1},tintColor:{type:"color",default:S.WHITE},tintMode:{type:"string",default:"none",available:["none","solid","colorized"]},resizeMode:{type:"string",default:"keepAspect",available:["keepAspect","unrestricted"]},alpha:{type:"number",default:1},adjustments:{type:"configurable",structure:{brightness:{type:"number",default:0},saturation:{type:"number",default:1},contrast:{type:"number",default:1}}}};$n.type="sticker";ea=$n});var Wt,Q,mt=_(()=>{Wt=class{constructor(e){this._seed=e===void 0?Wt.TimeSeed():e}seed(e){this._seed=e===void 0?Wt.TimeSeed():e}next(){let e=this._seed|0,t=e/Wt.SEED_DIVIDER|0,i=e%Wt.SEED_DIVIDER|0;return e=Wt.SEED_LOW_MULTIPLY*i-Wt.SEED_HIGH_MULTIPLY*t,e<=0&&(e+=Wt.MAX),e===-1&&(e=Wt.MAX-1),this._seed=e,e}nextInRange(e,t){return t===void 0&&(t=e,e=0),e+this.next()%(t-e+1)}nextBool(e=1,t=1){return this.nextInRange(e+t-1)>=e}static TimeSeed(){return Date.now()}pickNext(e){return Array.isArray(e)?e[this.next()%e.length]:null}},Q=Wt;M(Q,"MAX",2147483647),M(Q,"SEED_DIVIDER",127773),M(Q,"SEED_LOW_MULTIPLY",16807),M(Q,"SEED_HIGH_MULTIPLY",2836)});var y1,_e,Vt=_(()=>{O();({Rectangle:y1}=B),_e=class{constructor(e=0,t=0){this.width=e,this.height=t}set(e,t){this.width=e,this.height=t}aspect(){return this.width/this.height}rectangle(e,t){return new y1(e,t,this.width,this.height)}clone(){return new _e(this.width,this.height)}scale(e,t){return t===void 0&&(t=e),this.width*=e,this.height*=t,this}copy(e){return this.width=e.width,this.height=e.height,this}fitInWidthWithOther(e,t=new _e){return this.copy(_e.fitTwoInWidth(e,this,t)[0]),this}static fitTwoInWidth(e,t,i){let r=t.width*i.height+t.height*i.width,s=i.height*e/r,n=t.width*s,a=t.height*s;return[new _e(n,a),new _e(e-n,a)]}}});var pg,pc,ne,wt=_(()=>{O();pg=Ws(require("p-map")),pc=class extends V{loadImages(e){return Gr(this,null,function*(){return(0,pg.default)(e,t=>Gr(this,null,function*(){return this.addImage(t.path,t.fullPath,t.image)}))})}addImage(e,t,i,r="anonymous"){let s=this.getImages();return i?(s[e]={fullPath:t,image:i},Promise.resolve({fullPath:t,image:i})):new Promise((n,a)=>{i=new Ge,i.onload=()=>{s[e]={fullPath:t,image:i},n({fullPath:t,image:i})},i.crossOrigin=k.getCrossOriginValue(r),i.onerror=a,i.src=t})}getImage(e){let i=this.getImages()[e];return i?i.image:null}getVariation(e){return this.getFonts()[e]}addFont(e,t){let i=this.getFonts();return i[e]=t,t}};pc.prototype.availableOptions={images:{type:"object",default:{}},fonts:{type:"object",default:{}}};ne=new pc});var x1,b1,_g,v1,w1,T1,R1,C1,$e,ws=_(()=>{O();Vt();wt();x1=(o,e,t,i)=>{let r=t*(i*4)+e*4;return{r:o[r],g:o[r+1],b:o[r+2],a:o[r+3]}},b1=o=>o.a<=254,_g=(o,e,t)=>{let i=!0;for(let r=0;r<t;r++){let s=x1(o,r,e,t);if(!b1(s)){i=!1;break}}return i},v1=(o,e,t,i,r=!1)=>{let s=0;for(let n=i+1;n<t;n++)if(!_g(o,n,e))s=n-i+1;else if(r)break;return s},w1=(o,e,t,i,r=!1)=>{let s=0;for(let n=i-1;n>=0;n--)if(!_g(o,n,e))s=i-n;else if(r)break;return s},T1=(o,e,t,i,r)=>{o.beginPath(),o.moveTo(e,t),o.lineTo(i,r),o.stroke()},R1=(o,e,t,i,r="red")=>{o.save(),o.strokeStyle=r,T1(o,t,e,i,e),o.restore()},C1=(o,e,t,i,r,s="blue")=>{o.save(),o.strokeStyle=s,o.strokeRect(e,t,i,r),o.restore()},$e=class extends V{constructor(e){super(e);let t=ne.getVariation(this.getFontIdentifier());t||I.warn(`TextDesignFont: Unable to find font '${this._fontIdentifier}'`),this.set({fontVariation:t}),this._metrics=null,this._canvas=k.createCanvas(),this._context=this._canvas.getContext("2d"),this._isDirty=!0}_onOptionsChange(){this._isDirty=!0}setOption(e,t,i=!0,r=!1){super.setOption(e,t,i,r),e==="fontIdentifier"&&!r&&this.updateFontVariation()}updateFontVariation(){let e=ne.getVariation(this.getFontIdentifier());return e||I.warn(`TextDesignFont: Unable to find font '${this._fontIdentifier}'`),this.setFontVariation(e),e}setOptions(e={}){this._options=C(C({},this._options),e),this._isDirty=!0}_applyTextOptions(e=this._context,t={}){let{fontSize:i,fontVariation:r,lineHeight:s,textColor:n,alignment:a}=C(C({},this._options),t),{fontStyle:l,fontWeight:h,fontFamily:c}=r.serializeOptions();e.font=`${l} ${h} ${i}px ${c}`,e.fillStyle=n,e.textBaseline="alphabetic",e.textAlign=a||"left"}getTextMetrics(){return(!this._metrics||this._isDirty)&&this._calculateTextMetrics(),C({},this._metrics)}getSizeValue(){return(!this._metrics||this._isDirty)&&this._calculateTextMetrics(),new _e(this._metrics.width,this._metrics.height)}fitWidth(e){if(!this.getFontVariation()){I.warn("TextDesignFont#fitText: missing font variation");return}this._applyTextOptions(this._context,{fontSize:50});let i=this._context.measureText(this.getText()).width,r=e/i,s=Math.floor(r*50);return this.setFontSize(s),this._calculateTextMetrics(),this.getTextMetrics()}fitHeight(e){if(!this.getFontVariation()){I.warn("TextDesignFont#fitText: missing font variation");return}let i=this._calculateTextMetrics({fontSize:50}).height,r=e/i,s=Math.floor(r*50);return this.setFontSize(s),this._calculateTextMetrics(),this.getTextMetrics()}_calculateTextMetrics(e={}){let t=this._canvas,i=this._context,r=C(C({},this._options),e),s=this.getText();this._applyTextOptions(i,r);let n=Math.ceil(i.measureText(s).width),a=Math.floor(n+r.fontSize*2),l=Math.floor(r.fontSize*3);t.width=a,t.height=l;let h=Math.floor(r.fontSize),c=Math.floor(l*(3/5));this._applyTextOptions(i,r),i.fillText(s,h,c);let m=i.getImageData(0,0,t.width,t.height).data,d=w1(m,a,l,c,this._options.excludeAccents),u=v1(m,a,l,c,this._options.excludeAccents),f=n,y=d+u;return this._metrics={width:f,height:y,ascender:d,descender:u},this._isDirty=!1,C({},this._metrics)}draw(e=this._context,t=0,i=0,r,s=!1){e.save(),(!this._metrics||this._isDirty)&&this._calculateTextMetrics(),this._applyTextOptions(e,r),e.fillText(this.getText(),t,i+this._metrics.ascender),s&&(C1(e,t,i,this._metrics.width,this._metrics.height),R1(e,i+this._metrics.ascender,t,t+this._metrics.width)),e.restore()}};$e.prototype.availableOptions={text:{type:"string",default:""},fontIdentifier:{type:"string",default:"imgly_font_open_sans_bold"},fontVariation:{type:"object",default:null},lineHeight:{type:"number",default:1},fontSize:{type:"number",default:22},textColor:{type:"string",default:"black"},strokeStyle:{type:"string",default:"black"},outlineWidth:{type:"number",default:0},textBaseline:{type:"string",default:"alphabetic"},excludeAccents:{type:"boolean",default:!1}}});var et,ir=_(()=>{O();et=class extends V{};et.prototype.availableOptions={text:{type:"string",default:""},frame:{type:"object",default:null},font:{type:"object",default:null}}});var Tt,Ts=_(()=>{O();Tt=class extends V{};Tt.prototype.availableOptions={tintColor:{type:"color",default:S.BLACK},textColor:{type:"color",default:S.BLACK},alignment:{type:"string",default:"left",available:["left","center","right"]},lineSpacing:{type:"number",default:1},fontIdentifier:{type:"string",default:"imgly_font_open_sans_bold"}}});var k1,nt,wo=_(()=>{O();Vt();Ts();({Rectangle:k1}=B),nt=class extends V{constructor(e){super(e);this.setSize(new _e(this.getWidth(),0)),this.serverImageSmoothingFix=!1}_getFrame(){let e=this.getSize();return new k1(0,0,e.width,e.height)}_getTextFrame(){return this._getFrame()}_getTextFrameForElement(e){return e.getFrame().clone()}_calculateLayoutElements(){I.warn("TextDesignRow is an abstract class.")}_getLayoutElements(){return this._options.elements.length<=0&&this.layout(),this.getElements()}_fontSize(e){return I.warn("TextDesignRow#_fontSize not implemented. @TODO: Is it necessary?"),0}layout(){return this.setElements(this._calculateLayoutElements()),this}textFrame(e,t){return e.getFrame().clone()}willRender(e){}didRender(e){}render(e){e.save(),this._getLayoutElements().forEach(t=>{let{text:i,frame:r,font:s}=t.serializeOptions(),n=this.getAttributes();s.draw(e,r.x,r.y,{textColor:n.getTextColor().toRGBA(),alignment:n.getAlignment()})}),e.restore()}};nt.prototype.availableOptions={words:{type:"object",default:null},width:{type:"number",default:100},attributes:{type:"configurable",default:new Tt},shearingAngle:{type:"number",default:0},elements:{type:"array",default:[]},size:{type:"object",default:null}}});var S1,To,Ft,gg=_(()=>{O();ws();ir();wo();({Rectangle:S1}=B),To=class extends nt{_calculateLayoutElements(){if(this.getWords().size()<=0)return[];let{orientation:e,width:t,size:i,relativeRowOffset:r,attributes:s}=this.serializeOptions(),{fontIdentifier:n}=s,a=this.getWords().joined(3),l=e===To.Orientations.Left?[a[0],a[1],a[2]]:[a[1],a[2],a[0]],h=k.Array.range(0,2).map(Y=>new $e({text:l[Y],fontIdentifier:n,fontSize:60})),c=h.map(Y=>Y.getSizeValue()),m=c[0].width>c[1].width?0:1,d=(m+1)%2;h[d].fitWidth(c[m].width),c[d]=h[d].getSizeValue();let u=(c[d].height+c[m].height)/(1-r),f=new $e({text:l[2],fontIdentifier:n});f.fitHeight(u);let y=f.getSizeValue().width,g=c[m].width,p=t/(y+g),v=p*y,x=p*g,T=p*u,D=r*T;i.set(t,T);let b=k.Array.range(0,3).map(Y=>new $e({text:l[Y],fontIdentifier:n}));b[0].fitWidth(x),b[1].fitWidth(x),b[2].fitWidth(v);let w=e===To.Orientations.Left?0:v,G=e===To.Orientations.Left?x:0,N=[w,w,G],j=[0,b[0].getSizeValue().height+D,0],K=b.map((Y,W)=>new S1(N[W],j[W],Y.getSizeValue().width,Y.getSizeValue().height));return b.map((Y,W)=>new et({text:l[W],font:b[W],frame:K[W]}))}},Ft=To;M(Ft,"Orientations",{Right:"RIGHT",Left:"LEFT"});Ft.prototype.availableOptions=L(C({},nt.prototype.availableOptions),{orientation:{type:"string",default:Ft.Orientations.Left,available:[Ft.Orientations.Right,Ft.Orientations.Left]},relativeRowOffset:{type:"number",default:.05}})});var O1,q,ft=_(()=>{O();({Rectangle:O1}=B),q=class{constructor(e=0,t=0,i=0,r=0){this.top=e,this.left=t,this.bottom=i,this.right=r}multiply(e){this.top*=e,this.left*=e,this.bottom*=e,this.right*=e}toObject(){return C({},this)}equals(e,t=0){return Math.abs(e.top-this.top)<=t&&Math.abs(e.left-this.left)<=t&&Math.abs(e.bottom-this.bottom)<=t&&Math.abs(e.right-this.right)<=t}scale(e=1,t){return t===void 0&&(t=e),this.top*=t,this.bottom*=t,this.left*=e,this.right*=e,this}clone(){return new q(this.top,this.left,this.bottom,this.right)}applyToRectangle(e){return new O1(e.x+this.left,e.y+this.top,e.width-this.left-this.right,e.height-this.top-this.bottom)}static get ZERO(){return new q(0,0,0,0)}}});var xe,Rt=_(()=>{O();ws();ft();ir();wo();xe=class extends nt{_calculateLayoutElements(){let{attributes:e,imageInsets:t,size:i,width:r}=this.serializeOptions(),s=this.getWords().joined(1)[0]||"",{fontIdentifier:n}=e,a=new $e({text:s,fontIdentifier:n});a.fitWidth(this._getTextFrame().width);let l=a.getTextMetrics().height+t.top+t.bottom;i.height=l;let h=this._getTextFrame();return[new et({text:s,frame:h,font:a})]}};xe.prototype.availableOptions=L(C({},nt.prototype.availableOptions),{imageInsets:{type:"object",default:new q}})});var ri,Ve,_c,Ct,ta,Rs,gc,yg,xg,si,Ti=_(()=>{O();({Rectangle:ri,Vector2:Ve}=B),_c=(o,e,t,i)=>{o.drawImage(e,t.x,t.y,t.width,t.height,i.x,i.y,i.width,i.height)},Ct=(o,e,t,i="source-over",r=!1)=>{o.save(),o.fillStyle=t.toRGBA(),o.globalCompositeOperation=i,o.fillRect(e.x,e.y,e.width,e.height),r&&(o.strokeStyle=t.toRGBA(),o.strokeWith=1,o.strokeRect(e.x,e.y,e.width,e.height)),o.restore()},ta=(o,e,t,i,r="source-over",s=!1)=>{o.save(),o.fillStyle=i.toRGBA(),o.globalCompositeOperation=r,t=Math.min(Math.max(t,0),Math.min(e.height,e.width)*.5);let n=e.x,a=e.x+e.width,l=e.y,h=e.y+e.height;o.beginPath(),o.moveTo(n+t,l),o.arcTo(a,l,a,h,t),o.arcTo(a,h,n,h,t),o.arcTo(n,h,n,l,t),o.arcTo(n,l,a,l,t),o.closePath(),o.fill(),s&&o.stroke(),o.restore()},Rs=(o,e,t,i=4)=>{o.save(),o.strokeStyle=t.toRGBA(),o.lineWidth=i,o.strokeRect(e.x,e.y,e.width,e.height),o.restore()},gc=(o,e,t,i="source-over")=>{o.save();let r=e.height/2,s=e.y+r,n=e.x+r,a=e.x+e.width;for(o.fillStyle=t.toRGBA(),o.globalCompositeOperation=i;n<a;)o.beginPath(),o.arc(n,s,r,0,2*Math.PI),o.fill(),n+=r*4;o.restore()},yg=(o,e)=>{let t=e.applyToRectangle(o),{x:i,y:r,width:s,height:n}=o,a=[ri.FromDiagonalPoints(new Ve(0,0),new Ve(t.x,t.y)),ri.FromDiagonalPoints(new Ve(0,t.y+t.height),new Ve(t.x,n)),ri.FromDiagonalPoints(new Ve(t.x+t.width,t.y+t.height),new Ve(s,n)),ri.FromDiagonalPoints(new Ve(t.x+t.width,0),new Ve(s,t.y))].map(h=>h.translate(i,r)),l=[ri.FromDiagonalPoints(new Ve(t.x,0),new Ve(t.x+t.width,t.y)),ri.FromDiagonalPoints(new Ve(0,t.y),new Ve(t.x,t.y+t.height)),ri.FromDiagonalPoints(new Ve(t.x,t.y+t.height),new Ve(t.x+t.width,n)),ri.FromDiagonalPoints(new Ve(t.x+t.width,t.y),new Ve(s,t.y+t.height))].map(h=>h.translate(i,r));return{corners:a,bars:l,center:t}},xg=(o,e,t,i)=>{let r=e.naturalWidth||e.width,s=e.naturalHeight||e.height,n=yg(new ri(0,0,r,s),i),a=yg(t,i);_c(o,e,n.center,a.center),k.Array.zip(n.corners,a.corners).forEach(([l,h])=>_c(o,e,l,h)),k.Array.zip(n.bars,a.bars).forEach(([l,h])=>_c(o,e,l,h))},si=(o,e,t,i,r="source-atop")=>{if(o.save(),i&&(o.globalAlpha=i.a),o.drawImage(e,t.x,t.y,t.width,t.height),i&&(o.globalAlpha=1),i){let s=i.clone();s.a=1,Ct(o,t,s,r)}o.restore()}});var oi,ia=_(()=>{O();Ti();ft();Rt();oi=class extends xe{_getTextColor(){return this.getAutoAdjustTextColor()&&!this.getIsMasked()?this.getBackgroundColor().equals(S.WHITE)?S.BLACK:S.WHITE:this.getAttributes().getTextColor().clone()}_getTextFrame(){return this.getImageInsets().applyToRectangle(this._getFrame())}_getTextFrameForElement(e){let t=super._getTextFrameForElement(e),i=this.getImageInsets();return(this.getIsMasked()||this.getIsUsedInInvertedLayout())&&(t.y-=i.top),t}willRender(e){this.serverImageSmoothingFix&&(e.imageSmoothingEnabled=!0),this.getAttributes().setTextColor(this._getTextColor());let i=this.getImage();if(i){let r=this.getCapInsets(),s=this._getFrame();r&&!r.equals(q.ZERO)?xg(e,i,s,r):e.drawImage(i,s.x,s.y,s.width,s.height),Ct(e,s,this.getBackgroundColor(),"source-atop",!0)}(this.getIsMasked()||this.getIsUsedInInvertedLayout())&&i&&(e.save(),e.globalCompositeOperation="destination-out")}didRender(e){super.didRender(e),(this.getIsMasked()||this.getIsUsedInInvertedLayout())&&e.restore()}};oi.prototype.availableOptions=L(C({},xe.prototype.availableOptions),{image:{type:"image",default:null},capInsets:{type:"object",default:new q},backgroundColor:{type:"color",default:S.WHITE},autoAdjustTextColor:{type:"boolean",default:!0},isMasked:{type:"boolean",default:!0},isUsedInInvertedLayout:{type:"boolean",default:!1}})});var pt,ra=_(()=>{O();ft();pt=class extends V{insetsForWidth(e){return this.getRelativeInsets().clone().scale(e)}static get Small(){return new pt({imagePath:"text-design/images/imgly_text_design_asset_banderole_small.png",fontIdentifier:"imgly_font_campton_bold",relativeInsets:new q(.05,.2,.05,.2)})}static get Rectangle(){return new pt({imagePath:"text-design/images/imgly_text_design_asset_black_background.png",fontIdentifier:"imgly_font_campton_bold",relativeInsets:new q(.05,.05,.05,.05),needsImageSmoothingFix:!0})}static get Celebrate1(){return new pt({imagePath:"text-design/images/imgly_text_design_asset_celebrate_01.png",fontIdentifier:"imgly_font_rasa_500",relativeInsets:new q(.05,.2,.05,.2)})}static get Celebrate2(){return new pt({imagePath:"text-design/images/imgly_text_design_asset_celebrate_02.png",fontIdentifier:"imgly_font_rasa_500",relativeInsets:new q(.05,.2,.05,.2)})}};pt.prototype.availableOptions={image:{type:"image",default:null},imagePath:{type:"string",default:null},relativeInsets:{type:"object",default:new q},fontIdentifier:{type:"string",default:"imgly_font_open_sans_bold"},needsImageSmoothingFix:{type:"boolean",default:!1}}});var sa,bg=_(()=>{O();ft();Vt();sa=class extends V{getSize(){let e=this.getRows(),t=this.getWidth(),i=e.length-1,r=e.reduce((n,a)=>n+a.getSize().height,0);r+=(i+1)*this.getRelativeLineSpacing()*t;let s=this.getRelativeInsets().clone().scale(t);return r+=s.top+s.bottom,new _e(t,r)}};sa.prototype.availableOptions={text:{type:"string",default:""},lines:{type:"array",default:[]},relativeInsets:{type:"object",default:new q},relativeLineSpacing:{type:"number",default:0},rows:{type:"object",default:[]},background:{type:"object",default:null},width:{type:"number",default:0}}});var Ae,Ri=_(()=>{O();Ae=class{constructor(e){this.words=[],e&&this.splitIntoWords(e)}splitIntoWords(e){return this.words=e.match(/\S+/g)||[],[...this.words]}get(){return[...this.words]}getWord(e){return this.words[e]}set(e){return this.words=[...e],this}slice(e,t){return Ae.fromWords(this.words.slice(e,t))}getLowerCase(){return this.words.map(e=>e.toLowerCase())}getUpperCase(){return this.words.map(e=>e.toUpperCase())}size(){return this.words.length}countNumberOfCharacters(){return this.words.reduce((e,t)=>e+t.length,0)}joined(e){let t=this.size(),i=Math.floor(t/e),r=t%e,s=0,n=0;return k.Array.range(0,e).map(a=>{s=n;let l=i+(a<r?1:0);return n=Math.min(s+l,t),k.Array.range(s,n).reduce((h,c)=>h+(c===s?"":" ")+this.words[c],"")})}static fromWords(e){let t=new Ae;return t.words=[...e],t}}});var F1,E1,I1,Oe,Cs=_(()=>{O();mt();ft();Rt();Ts();bg();Ri();F1=10,E1=4,I1=.4,Oe=class extends V{constructor(e){super(e);this._relativeInsets=new q,this._background=null,this._fontRandomizer=new Q(0),this._lineNumberRandomizer=new Q(0),this._wordsPerLineRandomizer=new Q(0),this._seedPool=[this._fontRandomizer,this._lineNumberRandomizer,this._wordsPerLineRandomizer]}seed(e){this._seedPool.forEach(t=>t.seed(e))}getImagePaths(){return[]}onImagesLoaded(){}getMaximumNumberOfTries(){return F1}getMinLineCountOfRandom(){return E1}getRandomAdditionalLinePercentage(){return I1}_fontForRow(e,t){return this._fontRandomizer.pickNext(this.getFontIdentifiers())}_modifiedText(e){return e.replace(`
`," ").replace("	"," ")}_minimumNumberOfLines(e){return Math.ceil(Math.sqrt(e.size()))}_maximumNumberOfLines(e){return e.size()}_calculatedNumberOfLines(e){let t=this._minimumNumberOfLines(e);if(e.size()>=this.getMinLineCountOfRandom()){let i=Math.floor(Math.max(1,t*this.getRandomAdditionalLinePercentage()));t+=this._lineNumberRandomizer.nextInRange(0,i)}return Math.min(t,this._maximumNumberOfLines(e))}_randomizedNumberOfWordsPerLine(e,t){if(e>t)return I.warn("TextDesign#_randomizedNumberOfWordsPerLine: Invalid number of lines"),t;let i=k.Array.repeat(1,e);return k.Array.range(e,t).forEach(r=>{let s=this._wordsPerLineRandomizer.nextInRange(0,e-1);i[s]+=1}),i}_textLines(e){let t=new Ae(e),i=this._calculatedNumberOfLines(t);return this._randomizedNumberOfWordsPerLine(i,t.size()).reduce((s,n)=>({index:s.index+n,lines:[...s.lines,t.slice(s.index,Math.min(s.index+n,t.size()))]}),{index:0,lines:[]}).lines}_validTextLines(e){let t=this._textLines(e),i=0;do if(i=k.Array.findIndex(t,r=>r.countNumberOfCharacters()<3),i>=0){let r=t[i-1],s=t[i+1],n=r?r.countNumberOfCharacters():Number.MAX_SAFE_INTEGER,a=s?s.countNumberOfCharacters():Number.MAX_SAFE_INTEGER;n<a&&r?(r.words=[...r.words,...t[i].words],t=[...t.slice(0,i),...t.slice(i+1)]):s&&(s.words=[...t[i].words,...s.words],t=[...t.slice(0,i),...t.slice(i+1)])}while(i>-1&&t.length>1);return t}_modifiedLines(e){return e}_getBackground(){return this._background}generateLayoutData(e,t){let i=this._modifiedText(e),r=this._modifiedLines(this._validTextLines(i)),s=t*(1-this._relativeInsets.left-this._relativeInsets.right),n=this._layoutRows(r,s);return new sa({text:i,relativeInsets:this._relativeInsets.clone(),relativeLineSpacing:this.getRelativeLineSpacing(),background:this._background||this._getBackground(),lines:r,rows:n,width:t})}_layoutRows(e,t){return e.map((i,r)=>this._randomLayoutRow(i,r,t,new Tt({fontIdentifier:this._fontForRow(r,i)})).layout())}_randomLayoutRow(e,t,i,r){return new xe({words:e,width:i,attributes:r})}};M(Oe,"defaultFontIdentifiers",[]),M(Oe,"identifier","textdesign");Oe.prototype.availableOptions={fontIdentifiers:{type:"array",default:[]},relativeLineSpacing:{type:"number",default:0}}});var Me,ks=_(()=>{O();mt();gg();Rt();ia();Ts();ra();wt();Cs();Me=class extends Oe{constructor(...e){super(...e);M(this,"getImagePaths",()=>{let e=this.getBanderoles();return e&&e.map(t=>t.getImagePath())||[]});M(this,"onImagesLoaded",()=>{let e=this.getBanderoles();e&&e.forEach(t=>{let i=ne.getImage(t.getImagePath());if(!i){I.warn(`TextDesignBlocks#onImagesLoaded: Image not found '${t.getImagePath()}'`);return}t.setImage(i)})});this._rowTypeLessThan3WordsRandomizer=new Q(0),this._rowTypeMoreThan3WordsRandomizer=new Q(0),this._banderolesRandomizer=new Q(0),this._seedPool=[...this._seedPool,this._rowTypeLessThan3WordsRandomizer,this._rowTypeMoreThan3WordsRandomizer,this._banderolesRandomizer]}_modifiedText(e){return super._modifiedText(e).toUpperCase()}generateLayoutData(e,t){return this._options.hasMaskedText=!1,super.generateLayoutData(e,t)}_randomLayoutRow(e,t,i,r){if(e.size()<3){let n=this._rowTypeLessThan3WordsRandomizer.nextInRange(0,2)===0;return this._layoutRow(e,i,r,n)}let s=this._rowTypeMoreThan3WordsRandomizer.nextInRange(0,3);switch(s){case 0:return new Ft({words:e,width:i,attributes:r,orientation:Ft.Orientations.Left});case 1:return new Ft({words:e,width:i,attributes:r,orientation:Ft.Orientations.Right});case 2:return this._layoutRow(e,i,r,!0);case 3:return new xe({words:e,width:i,attributes:r});default:throw new Error(`TextDesignBlocks#_randomLayoutRow: Invalid randomValue generated: ${s}.`)}}_layoutRow(e,t,i,r){if(this.getHasMaskedText()&&(r=!1),r){this.setHasMaskedText(!0);let s=this._banderolesRandomizer.pickNext(this.getBanderoles()),n=new oi({words:e,width:t,attributes:new Tt({alignment:"left",fontIdentifier:s.getFontIdentifier()}),image:s.getImage(),imageInsets:s.insetsForWidth(t),capInsets:null,backgroundColor:S.WHITE});return s.getNeedsImageSmoothingFix()&&(n.serverImageSmoothingFix=!0),n}return new xe({words:e,width:t,attributes:i})}};M(Me,"defaultFontIdentifiers",["imgly_font_campton_bold"]),M(Me,"identifier","imgly_text_design_blocks"),M(Me,"defaultBanderoles",[pt.Rectangle,pt.Small]);Me.prototype.availableOptions=L(C({},Oe.prototype.availableOptions),{fontIdentifiers:{type:"array",default:Me.defaultFontIdentifiers},relativeLineSpacing:{type:"number",default:.025/3},hasMaskedText:{type:"boolean",default:!1},banderoles:{type:"array",default:Me.defaultBanderoles}})});var rr,vg=_(()=>{O();Rt();ks();rr=class extends Me{constructor(...e){super(...e);this._exclusiveFont=null}generateLayoutData(e,t){return this._exclusiveFont=this._fontRandomizer.pickNext(this.getFontIdentifiers()),super.generateLayoutData(e,t)}_fontForRow(e,t){return this._exclusiveFont||super._fontForRow(e,t)}_layoutRow(e,t,i,r){return new xe({words:e,width:t,attributes:i})}};M(rr,"defaultFontIdentifiers",["imgly_font_ostrich_sans_heavy","imgly_font_ostrich_sans_bold","imgly_font_ostrich_sans_black"]),M(rr,"identifier","imgly_text_design_blocks_condensed");rr.prototype.availableOptions=L(C({},Me.prototype.availableOptions),{fontIdentifiers:{type:"array",default:rr.defaultFontIdentifiers}})});var Ro,Ci,at,yc=_(()=>{O();Ti();Vt();ir();wo();({Rectangle:Ro}=B),Ci=class extends nt{constructor(...e){super(...e);this.setSize(new _e(this.getWidth(),this.getHeight()))}_calculateLayoutElements(){return[new et({frame:this._getTextFrame()})]}render(e){let t=this._getFrame(),i=this.getType(),s=this.getAttributes().getTextColor(),n=t.height/3,a=new Ro(t.x,t.y,t.width,n),l=new Ro(t.x,t.y+n*2,t.width,n);switch(i){case Ci.FormType.Rect:Ct(e,t,s);break;case Ci.FormType.DoubleRect:Ct(e,a,s),Ct(e,l,s);break;case Ci.FormType.DoubleRectFirstPunctuated:gc(e,a,s),Ct(e,l,s);break;case Ci.FormType.DoubleRectSecondPunctuated:Ct(e,a,s),gc(e,l,s);break;case Ci.FormType.LongLine:{let h=t.height/2,c=new Ro(t.x,t.y,t.width,h);ta(e,c,c.height*.5,s);break}case Ci.FormType.LongAndShortLine:{let h=t.height*.2,c=h*.75;a=new Ro(t.x,t.y+h,t.width,h);let m=t.x+t.width*.25,d=t.y+t.height-c;l=new Ro(m,d,t.width*.5,c),ta(e,a,a.height*.5,s),ta(e,l,l.height*.5,s);break}default:break}}},at=Ci;M(at,"FormType",{Rect:"RECT",DoubleRect:"DOUBLE_RECT",DoubleRectFirstPunctuated:"DOUBLE_RECT_FIRST_PUNCTUATED",DoubleRectSecondPunctuated:"DOUBLE_RECT_SECOND_PUNCTUATED",LongLine:"LONG_LINE",LongAndShortLine:"LONG_AND_SHORT_LINE"});at.prototype.availableOptions=L(C({},nt.prototype.availableOptions),{height:{type:"number",default:100},type:{type:"string",default:at.FormType.Rect,available:k.values(at.FormType)}})});var Ht,xc=_(()=>{O();Rt();yc();ks();Ht=class extends Me{_layoutRow(e,t,i,r){return new xe({words:e,width:t,attributes:i})}_layoutRows(e,t){let i=super._layoutRows(e,t),r=.032*t,s=.08*t,n=new at({width:t,height:r,type:at.FormType.LongLine,shearingAngle:0}).layout(),a=new at({width:t,height:s,type:at.FormType.LongAndShortLine,shearingAngle:0}).layout();return[n,...i,a]}};M(Ht,"defaultFontIdentifiers",["imgly_font_sue_ellen_francisco"]),M(Ht,"identifier","imgly_text_design_blocks_light");Ht.prototype.availableOptions=L(C({},Me.prototype.availableOptions),{fontIdentifiers:{type:"array",default:Ht.defaultFontIdentifiers}})});var sr,wg=_(()=>{O();Rt();Ts();xc();sr=class extends Ht{_layoutRows(e,t){return e.map((i,r)=>this._randomLayoutRow(i,r,t,new Tt({fontIdentifier:this._fontForRow(r,i)})).layout())}_layoutRow(e,t,i,r){return new xe({words:e,width:t,attributes:i})}};M(sr,"defaultFontIdentifiers",["imgly_font_sue_ellen_francisco"]),M(sr,"identifier","imgly_text_design_blocks_light-v3_1_0");sr.prototype.availableOptions=L(C({},Ht.prototype.availableOptions),{fontIdentifiers:{type:"array",default:sr.defaultFontIdentifiers}})});var M1,oa,jt,na=_(()=>{O();ws();Ti();Vt();ir();Rt();({Rectangle:M1}=B),oa=class extends xe{getImageSize(){let e=this.getLeftImage(),t=this.getRightImage(),i=this.getWords(),s=this.getAttributes().getFontIdentifier(),n=e?new _e(e.width,e.height):new _e,a=i.joined(1)[0];if(!a)return n;let h=new $e({text:a,fontIdentifier:s,fontSize:50}).getSizeValue(),c=t?2:1;n.scale(c,1);let m=n.clone().fitInWidthWithOther(this._getFrame().width,h);return m.scale(1/c,1),m}_getTextFrame(){let e=super._getTextFrame().clone(),t=this.getImageSize(),i=this.getRightImage(),r=this.getImagePosition();return i?(e.x+=t.width,e.width-=2*t.width):r===oa.ImagePosition.Left&&(e.x+=t.width),e}_calculateLayoutElements(){let e=super._calculateLayoutElements(),t=this._getFrame(),i=this.getRightImage(),r=this.getImageSize(),s=this.getImagePosition(),n=this._getTextFrame(),l=this.getAttributes().getFontIdentifier(),h=new $e({text:"stickerClock",fontIdentifier:l});h.fitWidth(this._getTextFrame().width);let c=new M1().set(t.x,t.y,r.width,r.height);if(!i&&s===oa.ImagePosition.Right&&(c.x+=n.width),e.push(new et({text:"stickerClock",frame:c,font:h})),i){let m=e[0];if(m){let d=c.clone();d.translate(m.getFrame().width+d.width,0),e.push(new et({text:"stickerClock",frame:d,font:h}))}}return e}render(e){let t=this._getLayoutElements(),i=this.getAttributes(),r=i.getTextColor(),s=this.getLeftImage(),n=this.getRightImage(),a=t[0],l=t[1],{font:h}=a.serializeOptions(),c=this._getTextFrameForElement(a);if(h.draw(e,c.x,c.y,{textColor:i.getTextColor().toRGBA(),alignment:i.getAlignment()}),s){let m=l.getFrame();e.drawImage(s,m.x,m.y,m.width,m.height),Ct(e,m,r,"source-atop")}if(t.length>2){let d=t[2].getFrame().clone();e.drawImage(n,d.x,d.y,d.width,d.height),Ct(e,d,r,"source-atop")}}},jt=oa;M(jt,"ImagePosition",{Left:"LEFT",right:"RIGHT"});jt.prototype.availableOptions=L(C({},xe.prototype.availableOptions),{leftImage:{type:"image",default:null},rightImage:{type:"image",default:null},imagePosition:{type:"string",default:jt.ImagePosition.Left,available:[jt.ImagePosition.Left,jt.ImagePosition.Right]}})});var Co,_t,bc=_(()=>{O();Rt();na();ra();Ri();ks();Co=class extends Me{_fontForRow(e,t){let i=this.getFontIdentifiers();return i[e%i.length]}_minimumNumberOfLines(e){return Math.max(Math.floor(super._minimumNumberOfLines(e)*.7),1)}_maximumNumberOfLines(e){return Math.max(Math.floor(e.countNumberOfCharacters()/5),1)}_randomLayoutRow(e,t,i,r){return this._createSingleRow(Co.RowType.Single,e,i,r)}_createSingleRow(e,t,i,r){let s=r.getFontIdentifier(),n=s==="imgly_font_amberlight"||s==="imgly_font_handycheera_regular"?new Ae().set(t.getLowerCase()):t;switch(e){case Co.RowType.Single:return new xe({words:n,width:i,attributes:r});case Co.RowType.SingleImage:return new jt({words:n,width:i,attributes:r});default:return I.warn(`TextDesignCelebrate#_createSingleRow: Invalid row type '${e}'`),null}}},_t=Co;M(_t,"defaultFontIdentifiers",["imgly_font_handycheera_regular","imgly_font_rasa_regular"]),M(_t,"defaultBanderoles",[pt.Celebrate1,pt.Celebrate2]),M(_t,"identifier","imgly_text_design_celebrate"),M(_t,"RowType",{Single:"SINGLE",SingleImage:"SINGLE_IMAGE"});_t.prototype.availableOptions=L(C({},Me.prototype.availableOptions),{relativeLineSpacing:{type:"number",default:.01875},fontIdentifiers:{type:"array",default:_t.defaultFontIdentifiers},banderoles:{type:"array",default:_t.defaultBanderoles}})});var Fe,aa=_(()=>{O();ws();Ri();Ti();Vt();Ts();ir();wo();Fe=class extends nt{constructor(...e){super(...e);this.setSize(new _e(this.getWidth(),this.getHeight()))}_getImageFrame(){let e=this._getTextFrame().clone(),t=this.getImage();if(this.getDrawingModeAspectFit()&&t){let i=Math.min(e.width/t.width,e.height/t.height),r=t.width*i,s=t.height*i;e.x+=(e.width-r)/2,e.y+=(e.height-s)/2,e.width=r,e.height=s}return e}_calculateLayoutElements(){return[new et({text:"",frame:this._getImageFrame(),font:new $e})]}render(e){let t=this.getImage(),i=this._getImageFrame(),s=this.getAttributes().getTextColor();si(e,t,i,s)}};M(Fe,"RowImages",{decorative1:"text-design/images/imgly_text_design_asset_decorative_01.png",decorative2:"text-design/images/imgly_text_design_asset_decorative_02.png",decorative3:"text-design/images/imgly_text_design_asset_decorative_05.png",decorative4:"text-design/images/imgly_text_design_asset_decorative_06.png",celebrate1:"text-design/images/imgly_text_design_asset_celebrate_03.png",celebrate2:"text-design/images/imgly_text_design_asset_celebrate_04.png",celebrate3:"text-design/images/imgly_text_design_asset_celebrate_05.png"});Fe.prototype.availableOptions=L(C({},nt.prototype.availableOptions),{words:{type:"object",default:new Ae},height:{type:"number",default:0},image:{type:"image",default:null},imagePath:{type:"string",default:Fe.RowImages.decorative1},drawingModeAspectFit:{type:"boolean",default:!1},attributes:{type:"configurable",default:new Tt}})});var or,Tg=_(()=>{O();mt();Rt();na();aa();ra();wt();Ri();ks();bc();or=class extends _t{constructor(...e){super(...e);M(this,"getImagePaths",()=>{let e=this.getBanderoles();return[...e&&e.map(t=>t.getImagePath())||[],...this._celebrateTypes]});M(this,"onImagesLoaded",()=>{let e=this.getBanderoles();e&&e.forEach(t=>{let i=ne.getImage(t.getImagePath());if(!i){I.warn(`TextDesignBlocks#onImagesLoaded: Image not found '${t.getImagePath()}'`);return}t.setImage(i)})});this._celebrateTypes=[Fe.RowImages.celebrate1,Fe.RowImages.celebrate2,Fe.RowImages.celebrate3],this._exclusiveFont=null,this._typeRandomizer=new Q(0),this._useMaskedRandomizer=new Q(0),this._seedPool.push(this._typeRandomizer),this._seedPool.push(this._useMaskedRandomizer)}_fontForRow(e,t){let i=this.getFontIdentifiers();return i[e%(i.length-1)]}_layoutRows(e,t){let i=this._typeRandomizer.pickNext(this._celebrateTypes),r=ne.getImage(i);r||I.warn(`TextDesignCelebrateSimple#_layoutRows: Image not fount '${i}'`);let s=new Fe({width:t,height:t*.5,drawingModeAspectFit:!0,image:r}).layout(),n=super._layoutRows(e,t);return[s,...n]}_randomLayoutRow(e,t,i,r){let s=e.countNumberOfCharacters(),n=13;s<4&&r.setFontIdentifier("imgly_font_rasa_regular");let l=this._useMaskedRandomizer.nextBool(2,1);return s<n&&l&&!this.getHasMaskedText()?this._layoutRow(e,i,r,!0):super._randomLayoutRow(e,t,i,r)}};M(or,"identifier","imgly_text_design_celebrate_simple"),M(or,"defaultFontIdentifiers",["imgly_font_amberlight","imgly_font_rasa_regular","imgly_font_rasa_500"]);or.prototype.availableOptions=L(C({},_t.prototype.availableOptions),{fontIdentifiers:{type:"array",default:or.defaultFontIdentifiers}})});var nr,vc=_(()=>{O();nr=class extends V{render(e,t,i,r,s){I.warn("TextDesignBackground#render: Abstract class")}};nr.prototype.availableOptions={}});var la,qt,Rg=_(()=>{O();wt();Ti();vc();({Rectangle:la}=B),qt=class extends nr{getImagePaths(){let{topImagePath:e,bottomImagePath:t,leftImagePath:i,rightImagePath:r}=this._options;return[e,t,i,r].filter(s=>s!=="")}render(e,t,i,r,s){let n=i.clone().scale(t.width),a=t.rectangle(0,0),l=ne.getImage(this.getTopImagePath()),h=ne.getImage(this.getLeftImagePath()),c=ne.getImage(this.getRightImagePath()),m=ne.getImage(this.getBottomImagePath());if(l){let d=l.width/l.height,u=n.top*this.getTopImageFillRate(),f=u*d,g=a.width/2-f/2,p=new la(g,0,f,u);si(e,l,p,r)}if(m){let d=m.width/m.height,u=n.bottom*this.getBottomImageFillRate(),f=u*d,g=a.width/2-f/2,p=new la(g,a.height-u,f,u);si(e,m,p,r)}if(h){let d=h.width/h.height,u=n.left*this.getLeftImageFillRate(),f=u/d,g=a.height/2-f/2,p=new la(0,g,u,f);si(e,h,p,r)}if(c){let d=c.width/c.height,u=n.right*this.getRightImageFillRate(),f=u/d,g=a.height/2-f/2,p=new la(a.width-u,g,u,f);si(e,c,p,r)}}};qt.prototype.availableOptions={topImagePath:{type:"string",default:""},leftImagePath:{type:"string",default:""},bottomImagePath:{type:"string",default:""},rightImagePath:{type:"string",default:""},topImageFillRate:{type:"number",default:1},leftImageFillRate:{type:"number",default:1},bottomImageFillRate:{type:"number",default:1},rightImageFillRate:{type:"number",default:1}};qt.Backgrounds=[new qt({topImagePath:"text-design/images/imgly_xib_image_text_design_equal_width_background1_1.png",leftImagePath:"text-design/images/imgly_xib_image_text_design_equal_width_background1_2.png",rightImagePath:"text-design/images/imgly_xib_image_text_design_equal_width_background1_2.png",bottomImagePath:"text-design/images/imgly_xib_image_text_design_equal_width_background1_3.png",topImageFillRate:.8,leftImageFillRate:.6,rightImageFillRate:.6,bottomImageFillRate:.8}),new qt({leftImagePath:"text-design/images/imgly_xib_image_text_design_equal_width_background2_1.png",rightImagePath:"text-design/images/imgly_xib_image_text_design_equal_width_background2_1.png",bottomImagePath:"text-design/images/imgly_xib_image_text_design_equal_width_background2_2.png",leftImageFillRate:.6,rightImageFillRate:.6,bottomImageFillRate:.6}),new qt({topImagePath:"text-design/images/imgly_xib_image_text_design_equal_width_background3_1.png",bottomImagePath:"text-design/images/imgly_xib_image_text_design_equal_width_background3_2.png",topImageFillRate:.6,bottomImageFillRate:.6}),new qt({topImagePath:"text-design/images/imgly_xib_image_text_design_equal_width_background4_1.png",leftImagePath:"text-design/images/imgly_xib_image_text_design_equal_width_background4_3.png",rightImagePath:"text-design/images/imgly_xib_image_text_design_equal_width_background4_3.png",bottomImagePath:"text-design/images/imgly_xib_image_text_design_equal_width_background4_2.png",topImageFillRate:.1,leftImageFillRate:.6,rightImageFillRate:.6,bottomImageFillRate:.6})]});var Xt,wc=_(()=>{O();Rg();mt();ft();Rt();Ri();Cs();Xt=class extends Oe{constructor(...e){super(...e);this._relativeInsets=new q(.1,.1,.1,.1),this._alreadyContainsARowWithScriptFont=!1,this._backgroundsRandomizer=new Q(0),this._seedPool.push(this._backgroundsRandomizer)}getImagePaths(){return k.Array.flatten(qt.Backgrounds.map(e=>e.getImagePaths()))}_getBackground(){return this._backgroundsRandomizer.pickNext(qt.Backgrounds)}generateLayoutData(e,t){return this._alreadyContainsARowWithScriptFont=!1,this._background=this._getBackground(),super.generateLayoutData(e,t)}_modifiedText(e){return super._modifiedText(e).toUpperCase()}_fontForRow(e,t){let i=super._fontForRow(e,t);return i==="imgly_font_petit_formal_script"&&(this._alreadyContainsARowWithScriptFont&&(i="imgly_font_bungee_inline"),this._alreadyContainsARowWithScriptFont=!0),i}_randomLayoutRow(e,t,i,r){let s=r.getFontIdentifier()==="imgly_font_petit_formal_script";return new xe({words:s?new Ae().set(e.getLowerCase()):e,width:i,attributes:r})}};M(Xt,"identifier","imgly_text_design_equal_width"),M(Xt,"defaultFontIdentifiers",["imgly_font_ultra","imgly_font_bungee_inline","imgly_font_petit_formal_script"]);Xt.prototype.availableOptions=L(C({},Oe.prototype.availableOptions),{fontIdentifiers:{type:"array",default:Xt.defaultFontIdentifiers},relativeLineSpacing:{type:"number",default:.025}})});var ar,Cg=_(()=>{O();ft();wc();ar=class extends Xt{constructor(...e){super(...e);this._relativeInsets=new q}_getBackground(){return null}};M(ar,"defaultFontIdentifiers",["imgly_font_ultra"]),M(ar,"identifier","imgly_text_design_equal_width_fat");ar.prototype.availableOptions=L(C({},Xt.prototype.availableOptions),{fontIdentifiers:{type:"array",default:ar.defaultFontIdentifiers}})});var H,Ss=_(()=>{O();ft();H=class extends V{insetsForWidth(e){return this.getRelativeInsets().clone().scale(e)}};H.prototype.availableOptions={imagePath:{type:"string",default:""},minimumHeightRatio:{type:"number",default:0},sizeToFitContent:{type:"boolean",default:!0},capInsets:{type:"object",default:new q},relativeInsets:{type:"object",default:new q}};H.Box=new H({imagePath:"text-design/images/imgly_text_design_asset_black_background.png",relativeInsets:new q(.1,.1,.1,.1)});H.Badge1=new H({imagePath:"text-design/images/imgly_text_design_asset_badge1.png",relativeInsets:new q(.3,.18,.2,.18)});H.Badge2=new H({imagePath:"text-design/images/imgly_text_design_asset_badge2.png",relativeInsets:new q(.3,.18,.2,.18)});H.Badge3=new H({imagePath:"text-design/images/imgly_text_design_asset_badge3.png",relativeInsets:new q(.3,.18,.2,.18)});H.Badge4=new H({imagePath:"text-design/images/imgly_text_design_asset_badge4.png",relativeInsets:new q(.3,.18,.2,.18)});H.SpeechBubble1=new H({imagePath:"text-design/images/imgly_text_design_asset_speech_bubble_small2.png",relativeInsets:new q(.04,.07,.12,.07),capInsets:new q(19*3,57*3,41*3,17*3)});H.SpeechBubble2=new H({imagePath:"text-design/images/imgly_text_design_asset_speech_bubble3.png",relativeInsets:new q(.04,.07,.12,.07),capInsets:new q(2*3,35*3,29*3,5*3)});H.SpeechBubble3=new H({imagePath:"text-design/images/imgly_text_design_asset_speech_bubble_small.png",relativeInsets:new q(.165664675,.2,.165664675,.2),minimumHeightRatio:.7});H.SpeechBubble4=new H({imagePath:"text-design/images/imgly_text_design_asset_speech_bubble4.png",relativeInsets:new q(.124800224,.2,.291200523,.2),minimumHeightRatio:.7});H.SpeechBubble5=new H({imagePath:"text-design/images/imgly_text_design_asset_speech_bubble5.png",relativeInsets:new q(.114892823,.27,.15984926,.27)});H.Watercolor1=new H({imagePath:"text-design/images/imgly_text_design_asset_watercolor_01.png",minimumHeightRatio:.7,relativeInsets:new q(.2,.25,.2,.25)});H.Watercolor2=new H({imagePath:"text-design/images/imgly_text_design_asset_watercolor_02.png",minimumHeightRatio:.7,relativeInsets:new q(.08,.25,.3,.25)});H.Watercolor3=new H({imagePath:"text-design/images/imgly_text_design_asset_watercolor_03.png",minimumHeightRatio:.7,relativeInsets:new q(.1,.2,.15,.2)})});var kg,Sg,ha,Tc=_(()=>{kg=require("split-graphemes"),Sg=class{constructor(e){this._context=e,this._lastFontStyle={}}getLines(){let e=[],t=[],i=this._lines.length;for(let r=0;r<i;r++){let s=this._lines[r],n=this._buildWords(s),a=n.length;for(let l=0;l<a;l++){let h=n[l],c=t.concat(h).join("").replace(/\s+$/i,"");if(this._getWidth(c)>this._maxWidth){t.length>0&&(e.push(t.join("")),t=[h]);let d=h.replace(/\s+$/i,"");if(this._getWidth(d)>this._maxWidth){let u=this._splitWord(h);e=e.concat(u.lines),u.rest&&(t=[u.rest])}}else t.push(h)}e.push(t.join("")),t=[]}return e.map(r=>this._trimLine(r,this._context.textAlign))}_trimLine(e,t){return e}_buildWords(e){let t=[],i="",r=e.length;for(let s=0;s<r;s++){let n=e[s];i+=n,(n===" "||n==="-"||s===r-1)&&(t.push(i),i="")}return t}_splitWord(e){let t={lines:[],rest:null},i=(0,kg.splitGraphemes)(e),r=i.length,s=[];for(let n=0;n<r;n++){let a=i[n];this._getWidth(s.concat(a).join(""))>this._maxWidth?(s.length>0&&t.lines.push(s.join("")),s=[a]):s.push(a),n===r-1&&s.length>0&&(t.rest=s.join(""))}return t}_fontStyleChanged(){return this._context.font!==this._lastFontStyle?(this._lastFontStyle=this._context.font,!0):!1}_getWidth(e){return this._context.measureText(e).width}setText(e){this._text=e,this._lines=e.split(`
`)}setMaxWidth(e){this._maxWidth=e}},ha=Sg});var Rc,Og,Fg,Cc=_(()=>{O();Tc();({Vector2:Rc}=B),Og=class{constructor(e,t){this._text=e,this._operation=t,this._textOptions={},this.rotation=0,this._createCanvas(),this._createTexture()}_createCanvas(){this._canvas=k.createCanvas(),this._context=this._canvas.getContext("2d"),this._textSplitter=new ha(this._context),this._finalCanvas=k.createCanvas(),this._finalContext=this._finalCanvas.getContext("2d")}_createTexture(){this._texture=R.Texture.fromCanvas(this._canvas),this._finalTexture=R.Texture.fromCanvas(this._finalCanvas)}_applyTextOptions(e,t){t.font=`${this._text.getFontStyle()} ${this._text.getFontWeight()} ${e.fontSize}px "${this._text.getFontFamily()}"`,this._text.getTextMetrics()?t.textBaseline="alphabetic":t.textBaseline="top",t.textAlign=this._text.getAlignment(),t.fillStyle=this._text.getColor().toRGBA(),t.strokeStyle=this._text.getOutlineColor().toRGBA();let i=this._text.getOutlineWidth();i>0&&(t.lineWidth=i)}_buildOutputLines(e){return this._textSplitter.setText(this._text.getText()),this._textSplitter.setMaxWidth(e),this._textSplitter.getLines().map(t=>t.replace(/\s+$/i,""))}_renderTextLine(e,t,i){let r=this._text.getAlignment(),s=new Rc(0,t);switch(r){case"left":s.x=i;break;case"center":s.x=this._canvas.width/2;break;case"right":s.x=this._canvas.width-i;break}this._context.save(),this._context.translate(s.x,s.y),this._context.fillText(e,0,0),this._context.restore(),this._text.getOutlineWidth()>0&&(this._context.miterLimit=2,this._context.strokeText(e,s.x,s.y))}update(e,t){let i=this.calculateFontStyles(e,t);if(i){let{dimensions:r,lines:s}=this._calculateText(e,i,t);this._renderText(e,r,s,i,t),this._updateFinalTexture()}}_updateFinalTexture(){let{width:e,height:t}=this._canvas,{rotation:i}=this,r=Math.cos(i),s=Math.sin(i),n=new Rc(Math.abs(e*r)+Math.abs(t*s),Math.abs(e*s)+Math.abs(t*r));this._finalCanvas.width=n.x,this._finalCanvas.height=n.y,this._finalContext.save(),this._finalContext.translate(this._finalCanvas.width/2,this._finalCanvas.height/2),this._finalContext.rotate(i),this._finalContext.drawImage(this._canvas,-e/2,-t/2),this._finalContext.restore()}_renderText(e,t,i,r,s){this._canvas.width=t.x,this._canvas.height=t.y,this._text.getMaxHeight()&&(this._canvas.height=Math.min(this._text.getMaxHeight()*s.y,this._canvas.height)),this._context=this._canvas.getContext("2d"),this._context.fillStyle=this._text.getBackgroundColor().toRGBA(),this._context.fillRect(0,0,t.x,t.y),this._applyTextOptions(r,this._context);let n=this._padding(s),a=this._text.getTextMetrics(),l=this._text.getFontSize()*s.y,h=1/a.unitsPerEm*l,c=a.ascender*h;for(let m=0;m<i.length;m++){let d=i[m];this._renderTextLine(d,r.topPadding+r.lineHeight*m+n+c,n)}}calculateFontStyles(e,t){let i=this._text.getFontFamily(),r=this._text.getFontSize()*t.y,s=this._text.getAbsoluteTextHeight(t),n=s*this._text.getLineHeight(),a=s*(this._text.getLineHeight()-1)/2,l={fontFamily:i,fontSize:r,lineHeight:n,topPadding:a};return(this._textOptions.fontFamily!==i||this._textOptions.fontSize!==r||this._textOptions.lineHeight!==n)&&(this._textOptions=l),l}_calculateText(e,t,i){let r=this._text.getMaxWidth()*i.x;this._applyTextOptions(t,this._context);let s=new Rc,n=this._text.getText().split(`
`);typeof r!="undefined"&&(s.x=r,n=this._buildOutputLines(r));for(let h=0;h<n.length;h++){let c=n[h];s.x=Math.max(s.x,this._context.measureText(c).width)}let{lineHeight:a}=t;s.y=n.length*a;let l=this._padding(i);return s.y+=l*2,s.x+=l*2,{dimensions:s,lines:n}}_padding(e){return this._text.getAbsoluteTextHeight(e)*.2}getTexture(){return this._texture}getFinalTexture(){return this._finalTexture}getDimensions(e,t){let i=this.calculateFontStyles(e,t),{dimensions:r}=this._calculateText(e,i,t);return r}dispose(){this._measurementElement&&document.body.removeChild(this._measurementElement),this._texture&&(this._texture.dispose(),this._texture=null),this._finalTexture&&(this._finalTexture.dispose(),this._finalTexture=null)}},Fg=Og});var Eg,ko,Ig=_(()=>{O();Tc();Vt();wt();({Vector2:Eg}=B),ko=class extends V{constructor(e){super(e);this._textOptions={},this._createCanvas()}_createCanvas(){this._canvas=k.createCanvas(),this._context=this._canvas.getContext("2d"),this._textSplitter=new ha(this._context),this._finalCanvas=k.createCanvas(),this._finalContext=this._finalCanvas.getContext("2d"),this.updateFontVariation()}setOption(e,t,i=!0,r=!1){super.setOption(e,t,i,r),e==="fontIdentifier"&&!r&&this.updateFontVariation()}updateFontVariation(){let e=ne.getVariation(this.getFontIdentifier());return e||I.warn(`TextDesignFont: Unable to find font '${this._fontIdentifier}'`),this.setFontVariation(e),e}_applyTextOptions(e={},t=this._context){let{fontSize:i,fontVariation:r,lineHeight:s,textColor:n,alignment:a}=C(C({},this._options),e),{fontStyle:l,fontWeight:h,fontFamily:c}=r.serializeOptions();t.font=`${l} ${h} ${i}px "${c}"`,t.fillStyle=n,t.textBaseline="top",t.textAlign=a||"left"}_buildOutputLines(e){return this._textSplitter.setText(this.getText()),this._textSplitter.setMaxWidth(e),this._textSplitter.getLines()}_renderTextLine(e,t){let i=this.getAlignment(),r=new Eg(0,t);switch(i){case"center":r.x=this._canvas.width/2;break;case"right":r.x=this._canvas.width;break}this._context.fillText(e,r.x,r.y)}update(){let e=this.calculateFontStyles();if(e){let{dimensions:t,lines:i}=this._calculateText(e);this._dimensions=t,this._renderText(t,i,e)}}draw(e,t=0,i=0){this.update(),e.drawImage(this._canvas,t,i,this._dimensions.x,this._dimensions.y)}_renderText(e,t,i){this._canvas.width=e.x,this._canvas.height=e.y,this._context=this._canvas.getContext("2d"),this._applyTextOptions(i,this._context);for(let r=0;r<t.length;r++){let s=t[r];this._renderTextLine(s,i.topPadding+i.lineHeight*r)}}getFontFamily(){return this.getFontVariation().getFontFamily()}calculateFontStyles(){let e=this.getFontFamily(),t=this.getFontSize(),i=this.getAbsoluteTextHeight(),r=i*this.getLineHeight(),s=i*(this.getLineHeight()-1)/2,n={fontFamily:e,fontSize:t,textHeight:i,lineHeight:r,topPadding:s};return this._textOptions=C({},n),n}getTextMetrics(){return this.getFontVariation().getTextMetrics()}getAbsoluteTextHeight(){let e=this.getFontSize(),t=this.getTextMetrics();if(t){let i=1/t.unitsPerEm*e,r=t.ascender*i,s=t.descender*i;return r+Math.abs(s)}return e*this.getLineHeight()*1.1}_calculateText(e){this._applyTextOptions(e,this._context);let t=new Eg,i=this.getText().split(`
`),r;if(typeof r!="undefined")t.x=r,i=this._buildOutputLines(r);else for(let n=0;n<i.length;n++){let a=i[n];t.x=Math.max(t.x,this._context.measureText(a).width)}let{lineHeight:s}=e;return t.y=i.length*s,{dimensions:t,lines:i}}getDimensions(){let e=this.calculateFontStyles(),{dimensions:t}=this._calculateText(e);return t}fitMaxHeight(){this.update();let e=this.getDimensions(),t=this.getText().split(`
`),i=this.getMaxHeight()/e.y}fitMaxWidth(){let e=this.getDimensions().x,t=this.getMaxWidth()/e;this.setFontSize(this.getFontSize()*t),this._textOptions.fontSize=this.getFontSize()}fitInFrame(e){this.setMaxWidth(e.width),this.setMaxHeight(e.height),this.fitMaxWidth(),this.fitMaxHeight()}getSize(){let e=this.getDimensions();return new _e(e.x,e.y)}};ko.prototype.availableOptions={text:{type:"string",default:""},fontIdentifier:{type:"string",default:"imgly_font_open_sans_bold"},fontVariation:{type:"object",default:null},lineHeight:{type:"number",default:1},fontSize:{type:"number",default:22},textColor:{type:"string",default:"black"},strokeStyle:{type:"string",default:"black"},outlineWidth:{type:"number",default:0},textBaseline:{type:"string",default:"alphabetic"},excludeAccents:{type:"boolean",default:!0},maxWidth:{type:"number",default:100},maxHeight:{type:"number",default:0},alignment:{type:"string",default:"left",available:["left","center","right"]}}});var ki,ca=_(()=>{O();Cc();ws();Ig();ir();ia();ki=class extends oi{_calculateLayoutElements(){let e=this.getWords(),t=this._getTextFrame(),r=this.getAttributes().getFontIdentifier(),s=this.getImageInsets(),n=new $e({text:e.getWord(0),fontIdentifier:r});n.fitWidth(t.width);let a=new et({text:e.getWord(0),frame:t,font:n});a.setFrame(this._getTextFrameForElement(a));let l=this.getSize();return(this.getSizeToFitContent()||l.height<=1)&&(l.height=s.top+a.getFrame().height+s.bottom),l.height=Math.max(l.height,this.getMinimumHeight()),[a]}_getTextFrameForElement(e){let i=this.getWords().getWord(0),r=this.getAttributes(),s=r.getFontIdentifier(),n=this.getImageInsets(),a=this.getImageInsets().applyToRectangle(this._getFrame()).scale(this.getTextScaleFactor()),l=new ko({text:i,fontIdentifier:s,alignment:r.getAlignment(),lineHeight:1});l.fitInFrame(a);let h=l.getSize();a.height=h.height;let c=h.height*this.getRowScaleFactor();this.getSizeToFitContent()&&(c+=n.top+n.bottom);let m=this._getFrame(),d=r.getAlignment();if(this.getCenteredVertically())a.y=m.height/2-c/2+n.top;else switch(d){case"left":a.y=m.height-c-n.bottom;break;case"center":a.y=m.height/2-c/2+c*this.getCenterOffset(),a.x=(m.width-a.width)/2;break;case"right":a.x=m.width-a.width-n.right;break;default:break}return a}render(e){e.save(),this._getLayoutElements().forEach(t=>{let{text:i,frame:r}=t.serializeOptions(),s=this.getAttributes(),n=s.getFontIdentifier(),a=new ko({text:i,fontIdentifier:n,alignment:s.getAlignment(),lineHeight:1,textColor:s.getTextColor().toRGBA()});r=this._getTextFrameForElement(t),a.fitInFrame(r),a.draw(e,r.x,r.y)}),e.restore()}};ki.prototype.availableOptions=L(C({},oi.prototype.availableOptions),{centerOffset:{type:"number",default:0},sizeToFitContent:{type:"boolean",default:!1},textScaleFactor:{type:"number",default:.95},rowScaleFactor:{type:"number",default:1},minimumHeight:{type:"number",default:0},centeredVertically:{type:"boolean",default:!1}})});var Os,we,lr=_(()=>{O();Ss();mt();ca();wt();Ri();Cs();Os=class extends Oe{constructor(...e){super(...e);this._rowType=H.Box,this._alignmentRandomizer=new Q(0),this._isMaskedRandomizer=new Q(0),this._seedPool.push(this._alignmentRandomizer),this._seedPool.push(this._isMaskedRandomizer)}getImagePaths(){return[H.Box.getImagePath()]}_modifiedText(e){return super._modifiedText(e).toLowerCase()}_modifiedLines(e){let t=new Ae;return t.set([e.reduce((i,r)=>`${i}${i===""?"":`
`}${r.joined(1)[0]}`,"")]),[t]}_layoutRows(e,t){let i=super._layoutRows(e,t),r=i[0];if(r&&this.getSquareLayout()){let s=r.getSize();s.height=s.width}return i}getAlignment(){return this._alignmentRandomizer.pickNext(this.constructor.ValidAlignments||Os.ValidAlignments)}_randomLayoutRow(e,t,i,r){let s=this.getAlignment(),n=this._rowType,a=ne.getImage(n.getImagePath());r.setAlignment(s);let l=new ki({words:e,width:i,attributes:r,image:a,imageInsets:n.insetsForWidth(i),capInsets:n.getCapInsets(),backgroundColor:S.WHITE,centerOffset:0,textScaleFactor:.7,isMasked:this._isMaskedRandomizer.nextBool()});this._rowType===H.Box&&(l.serverImageSmoothingFix=!0);let h=l.getSize();return this.getSquareLayout()?h.height=h.width:h.height=Math.max(h.height,h.width*n.getMinimumHeightRatio()),l}},we=Os;M(we,"defaultFontIdentifiers",["imgly_font_galano_grotesque_bold"]),M(we,"Alignment",{Left:"left",Center:"center",Right:"right"}),M(we,"ValidAlignments",[Os.Alignment.Left,Os.Alignment.Center,Os.Alignment.Right]),M(we,"identifier","imgly_text_design_masked");we.prototype.availableOptions=L(C({},Oe.prototype.availableOptions),{fontIdentifiers:{type:"array",default:we.defaultFontIdentifiers},squareLayout:{type:"boolean",default:!0}})});var Si,Mg=_(()=>{O();Ss();mt();lr();Si=class extends we{constructor(...e){super(...e);this._possibleRowTypes=[H.Badge1,H.Badge2,H.Badge3,H.Badge4],this._rowTypesRandomizer=new Q(0),this._isMaskedRandomizer=new Q(0),this._seedPool.push(this._rowTypesRandomizer),this._seedPool.push(this._isMaskedRandomizer)}getImagePaths(){return this._possibleRowTypes.map(e=>e.getImagePath())}_randomLayoutRow(e,t,i,r){this._rowType=this._rowTypesRandomizer.pickNext(this._possibleRowTypes),r.setLineSpacing(.9);let s=super._randomLayoutRow(e,t,i,r);return s.set({textScaleFactor:.9}),s}};M(Si,"defaultFontIdentifiers",["imgly_font_campton_bold"]),M(Si,"identifier","imgly_text_design_masked_badge"),M(Si,"ValidAlignments",[we.Alignment.Center]);Si.prototype.availableOptions=L(C({},we.prototype.availableOptions),{fontIdentifiers:{type:"array",default:Si.defaultFontIdentifiers}})});var gt,ua=_(()=>{O();Ss();mt();lr();gt=class extends we{constructor(...e){super(...e);this._possibleRowTypes=[H.SpeechBubble1,H.SpeechBubble3],this._rowTypesRandomizer=new Q(0),this._isMaskedRandomizer=new Q(0),this._seedPool.push(this._rowTypesRandomizer),this._seedPool.push(this._isMaskedRandomizer)}getImagePaths(){return this._possibleRowTypes.map(e=>e.getImagePath())}_rowTypes(e){return this._possibleRowTypes}_randomLayoutRow(e,t,i,r){this._rowType=this._rowTypesRandomizer.pickNext(this._rowTypes(e)),r.setLineSpacing(.9);let s=super._randomLayoutRow(e,t,i,r);return s.set({textScaleFactor:1,minimumHeight:i*this._rowType.getMinimumHeightRatio(),sizeToFitContent:this._rowType.getSizeToFitContent(),centeredVertically:!0}),s}};M(gt,"defaultFontIdentifiers",["imgly_font_roboto_black_italic","imgly_font_roboto_light_italic","imgly_font_roboto_black","imgly_font_roboto_light"]),M(gt,"identifier","imgly_text_design_masked_speech_bubble");gt.prototype.availableOptions=L(C({},we.prototype.availableOptions),{fontIdentifiers:{type:"array",default:gt.defaultFontIdentifiers},squareLayout:{type:"boolean",default:!1},alignment:{type:"string",default:"left",available:we.ValidAlignments}})});var hr,Bg=_(()=>{O();Ss();lr();ua();hr=class extends gt{constructor(...e){super(...e);this._possibleRowTypes=[H.SpeechBubble2,H.SpeechBubble4,H.SpeechBubble2,H.SpeechBubble4,H.SpeechBubble5],this._possibleRowTypesForMin15=this._possibleRowTypes.slice(0,2),this._possibleRowTypesForMax14=this._possibleRowTypes.slice(2)}_rowTypes(e){return e.countNumberOfCharacters()<15?this._possibleRowTypesForMax14:this._possibleRowTypesForMin15}};M(hr,"defaultFontIdentifiers",["imgly_font_permanent_marker"]),M(hr,"identifier","imgly_text_design_masked_speech_bubble_comic");hr.prototype.availableOptions=L(C({},gt.prototype.availableOptions),{fontIdentifiers:{type:"array",default:hr.defaultFontIdentifiers}})});var cr,Dg=_(()=>{O();ca();lr();cr=class extends we{_modifiedText(e){return super._modifiedText(e).toUpperCase()}_randomLayoutRow(e,t,i,r){let s=this._alignmentRandomizer.pickNext(we.ValidAlignments);return r.setAlignment(s),new ki({words:e,width:i,attributes:r,image:null,backgroundColor:S.WHITE,centerOffset:0,sizeToFitContent:!0,isMasked:!1,autoAdjustTextColor:!1})}};M(cr,"defaultFontIdentifiers",["imgly_font_abril_fatface_regular"]),M(cr,"identifier","imgly_text_design_multiline");cr.prototype.availableOptions=L(C({},we.prototype.availableOptions),{fontIdentifiers:{type:"array",default:cr.defaultFontIdentifiers}})});var B1,da,Pg=_(()=>{O();({Rectangle:B1}=B),da=class extends V{getContentFrame(){let e=this.getFrame().clone(),t=e.width*.1;return e.insetBy(t,t)}intersects(e){return this.getFrame().intersects(e.getFrame())}};da.prototype.availableOptions={frame:{type:"object",default:new B1}}});var Ag,Et,ma=_(()=>{O();wt();Ti();vc();Pg();({Rectangle:Ag}=B),Et=class extends nr{constructor(...e){super(...e);this._MAX_TRIES=1e3,this._PRECISION=1e3}render(e,t,i,r,s){let{imagePaths:n,relativeParticleSize:a}=this._options;if(n.length<=0)return;let l=t.width/t.height,h=new Ag(Math.round(i.left*this._PRECISION),Math.round(i.top*this._PRECISION*l),this._PRECISION,this._PRECISION);h.width-=h.x+Math.round(i.right*this._PRECISION),h.height-=h.y+Math.round(i.bottom*this._PRECISION*l);let c=[],m=0,d=0;for(;m<this.getParticleCount()&&d<this._MAX_TRIES;){let u=a/2,f=Math.round(u*this._PRECISION),y=Math.round(u*this._PRECISION*l),g=Math.floor(this._PRECISION)-f,p=Math.floor(this._PRECISION)-y,v=s.nextInRange(f,g),x=s.nextInRange(y,p),T=new Ag(v-f,x-y,2*f,2*y);!T.intersects(h)&&!this.hasCollision(c,T)&&(c.push(new da({frame:T})),m+=1),d+=1}for(let u=0;u<c.length;u++){let f=c[u],y=s.pickNext(n),g=ne.getImage(y),p=s.nextInRange(140,230)/255,v=t.width/this._PRECISION,x=t.height/this._PRECISION,T=f.getContentFrame();T.x*=v,T.y*=x,T.width*=v,T.height*=x;let D=r.clone();D.a=p,si(e,g,T,D,"source-atop")}}hasCollision(e,t){for(let i=0;i<e.length;i++)if(t.intersects(e[i].getFrame()))return!0;return!1}};Et.prototype.availableOptions=L(C({},nr.prototype.availableOptions),{particleCount:{type:"number",default:50},relativeParticleSize:{type:"number",default:.08},imagePaths:{type:"array",default:[]}})});var Fs,Lg=_(()=>{O();ma();Fs=class extends Et{};M(Fs,"Images",["text-design/images/imgly_text_design_particle_brush_01.png","text-design/images/imgly_text_design_particle_brush_02.png","text-design/images/imgly_text_design_particle_brush_03.png","text-design/images/imgly_text_design_particle_brush_04.png","text-design/images/imgly_text_design_particle_brush_05.png","text-design/images/imgly_text_design_particle_brush_06.png","text-design/images/imgly_text_design_particle_brush_07.png","text-design/images/imgly_text_design_particle_brush_08.png","text-design/images/imgly_text_design_particle_brush_09.png","text-design/images/imgly_text_design_particle_brush_10.png"]);Fs.prototype.availableOptions=L(C({},Et.prototype.availableOptions),{imagePaths:{type:"array",default:[...Fs.Images]},relativeParticleSize:{type:"number",default:.12}})});var Es,zg=_(()=>{O();ma();Es=class extends Et{};M(Es,"Images",["text-design/images/imgly_text_design_particle_circle_01.png","text-design/images/imgly_text_design_particle_circle_02.png","text-design/images/imgly_text_design_particle_circle_03.png","text-design/images/imgly_text_design_particle_circle_04.png","text-design/images/imgly_text_design_particle_circle_05.png","text-design/images/imgly_text_design_particle_circle_06.png","text-design/images/imgly_text_design_particle_circle_07.png","text-design/images/imgly_text_design_particle_circle_08.png","text-design/images/imgly_text_design_particle_circle_09.png","text-design/images/imgly_text_design_particle_circle_10.png"]);Es.prototype.availableOptions=L(C({},Et.prototype.availableOptions),{imagePaths:{type:"array",default:[...Es.Images]},relativeParticleSize:{type:"number",default:.12}})});var Is,Ng=_(()=>{O();ma();Is=class extends Et{};M(Is,"Images",["text-design/images/imgly_text_design_particle_triangle_01.png","text-design/images/imgly_text_design_particle_triangle_02.png","text-design/images/imgly_text_design_particle_triangle_03.png","text-design/images/imgly_text_design_particle_triangle_04.png","text-design/images/imgly_text_design_particle_triangle_05.png","text-design/images/imgly_text_design_particle_triangle_06.png","text-design/images/imgly_text_design_particle_triangle_07.png","text-design/images/imgly_text_design_particle_triangle_08.png","text-design/images/imgly_text_design_particle_triangle_09.png","text-design/images/imgly_text_design_particle_triangle_10.png"]);Is.prototype.availableOptions=L(C({},Et.prototype.availableOptions),{imagePaths:{type:"array",default:[...Is.Images]}})});var Oi,Le,fa=_(()=>{O();mt();ft();Rt();na();aa();wt();Ri();Cs();Oi=class extends Oe{constructor(...e){super(...e);this._relativeInsets=new q(0,0,0,0),this._INVALID_FONTS_IF_LESS_THEN_5_CHARS=["imgly_font_montserrat_light"],this._INVALID_FONTS_IF_LESS_THEN_4_CHARS=["imgly_font_montserrat_light","imgly_font_wolesbro"],this._lineCount=0,this._decorativeRowCreated=!1,this._useImageRowRandomizer=new Q(0),this._rowTypeRandomizer=new Q(0),this._lineDecorativeTypeRandomizer=new Q(0),this._seedPool.push(this._useImageRowRandomizer),this._seedPool.push(this._rowTypeRandomizer),this._seedPool.push(this._lineDecorativeTypeRandomizer)}getImagePaths(){return[...Oi.DecoratorImages,...Oi.RowImages]}_fontForRow(e,t){let i=t.countNumberOfCharacters(),r=this.getFontIdentifiers();return i<4?r=r.filter(s=>this._INVALID_FONTS_IF_LESS_THEN_4_CHARS.indexOf(s)<0):i<5&&(r=r.filter(s=>this._INVALID_FONTS_IF_LESS_THEN_5_CHARS.indexOf(s)<0)),r[e%r.length]}_modifiedText(e){return super._modifiedText(e).toUpperCase()}_modifiedLines(e){return this._lineCount=e.length,e}generateLayoutData(e,t){return this._decorativeRowCreated=!1,super.generateLayoutData(e,t)}_randomLayoutRow(e,t,i,r){let s=r.getFontIdentifier(),n=e;switch(s){case"imgly_font_wolesbro":n=new Ae().set(e.getLowerCase());break;case"imgly_font_permanent_marker":n=new Ae().set(e.getUpperCase());break;default:break}let a=this.getDecorativeRowsInTheMiddleOnly()&&(t===0||t===this._lineCount-1);if(this._useImageRowRandomizer.nextBool()||this._decorativeRowCreated||a)return new xe({words:n,width:i,attributes:r});this._decorativeRowCreated=!0;let[l,h]=this._randomDecoratorImages();return new jt({words:e,width:i,attributes:r,leftImage:l,rightImage:h})}_layoutRows(e,t){let i=super._layoutRows(e,t);if(!this.getDecorationsVisible())return i;let r=.0625*t,s=new Fe({width:t,height:r,image:ne.getImage(this._rowTypeRandomizer.pickNext(Oi.RowImages))}).layout(),n=new Fe({width:t,height:r,image:ne.getImage(this._rowTypeRandomizer.pickNext(Oi.RowImages))}).layout();return[s,...i,n]}_randomDecoratorImages(){return this._lineDecorativeTypeRandomizer.nextInRange(0,1)?Oi.DecoratorImages.slice(0,2).map(e=>ne.getImage(e)):Oi.DecoratorImages.slice(2).map(e=>ne.getImage(e))}},Le=Oi;M(Le,"defaultFontIdentifiers",["imgly_font_permanent_marker","imgly_font_wolesbro","imgly_font_wolesbro","imgly_font_montserrat_light"]),M(Le,"identifier","imgly_text_design_sunshine"),M(Le,"RowImages",[Fe.RowImages.decorative1,Fe.RowImages.decorative2,Fe.RowImages.decorative3,Fe.RowImages.decorative4]),M(Le,"DecoratorImages",["text-design/images/imgly_text_design_asset_decorative_03.png","text-design/images/imgly_text_design_asset_decorative_04.png","text-design/images/imgly_text_design_asset_decorative_07.png","text-design/images/imgly_text_design_asset_decorative_08.png"]);Le.prototype.availableOptions=L(C({},Oe.prototype.availableOptions),{fontIdentifiers:{type:"array",default:Le.defaultFontIdentifiers},relativeLineSpacing:{type:"number",default:.025/3*4},decorationsVisible:{type:"boolean",default:!0},decorativeRowsInTheMiddleOnly:{type:"boolean",default:!1}})});var Fi,ni,Ug=_(()=>{O();Lg();zg();Ng();mt();ft();wt();fa();Fi=class extends Le{constructor(...e){super(...e);this._relativeInsets=new q(.3,.3,.3,.3),this._backgroundRandomizer=new Q(0),this._decoTypeRandomizer=new Q(0),this._seedPool.push(this._backgroundRandomizer),this._seedPool.push(this._decoTypeRandomizer)}getImagePaths(){return[...Le.RowImages,...k.Array.flatten(Fi.Backgrounds.map(e=>e.getImagePaths())),...Fi.DecoratorImages]}_getBackground(){return this._backgroundRandomizer.pickNext(Fi.Backgrounds)}_randomDecoratorImages(){switch(this._decoTypeRandomizer.nextInRange(0,2)){case 0:return Fi.DecoratorImages.slice(0,2).map(e=>ne.getImage(e));case 1:case 2:return Fi.DecoratorImages.slice(2).map(e=>ne.getImage(e));default:return I.warn("TextDesignParticles#_randomDecoratorImages: Number generated not in valid range."),Fi.DecoratorImages.slice(2).map(e=>ne.getImage(e))}}},ni=Fi;M(ni,"defaultFontIdentifiers",["imgly_font_permanent_marker","imgly_font_wolesbro","imgly_font_wolesbro","imgly_font_montserrat_light"]),M(ni,"identifier","imgly_text_design_particles"),M(ni,"Backgrounds",[new Fs,new Es,new Is]),M(ni,"DecoratorImages",["text-design/images/imgly_text_design_particle_holder_01.png","text-design/images/imgly_text_design_particle_holder_02.png","text-design/images/imgly_text_design_particle_holder_03.png","text-design/images/imgly_text_design_particle_holder_04.png"]);ni.prototype.availableOptions=L(C({},Le.prototype.availableOptions),{fontIdentifiers:{type:"array",default:ni.defaultFontIdentifiers},decorationsVisible:{type:"boolean",default:!1},decorativeRowsInTheMiddleOnly:{type:"boolean",default:!0}})});var ur,Gg=_(()=>{O();mt();ft();yc();Cs();ur=class extends Oe{constructor(...e){super(...e);this._relativeInsets=new q(.1,0,0,0),this._rowTypeRandomizer=new Q(0),this._seedPool.push(this._rowTypeRandomizer)}_modifiedText(e){return super._modifiedText(e).toUpperCase()}_randomLayoutRow(e,t,i,r){let s=super._randomLayoutRow(e,t,i,r);return s.setShearingAngle(this.getShearingAngle()),s}_layoutRows(e,t){let i=super._layoutRows(e,t),r=k.values(at.FormType),s=30,n=new at({width:t,height:s,type:this._rowTypeRandomizer.pickNext(r),shearingAngle:this.getShearingAngle()}).layout(),a=new at({width:t,height:s,type:this._rowTypeRandomizer.pickNext(r),shearingAngle:this.getShearingAngle()}).layout();return[n,...i,a]}};M(ur,"defaultFontIdentifiers",["imgly_font_campton_bold"]),M(ur,"identifier","imgly_text_design_rotated");ur.prototype.availableOptions=L(C({},Oe.prototype.availableOptions),{fontIdentifiers:{type:"array",default:ur.defaultFontIdentifiers},relativeLineSpacing:{type:"number",default:.025/3},shearingAngle:{type:"number",default:-.1}})});var pa,Wg=_(()=>{ft();aa();wt();fa();pa=class extends Le{constructor(...e){super(...e);this._relativeInsets=new q(0,.3,0,.3)}_layoutRows(e,t){let i=super._layoutRows(e,t);if(!this.getDecorationsVisible())return i;let r=25,s=new Fe({width:t,height:r,image:ne.getImage(this._rowTypeRandomizer.pickNext(Le.RowImages))}).layout(),n=new Fe({width:t,height:r,image:ne.getImage(this._rowTypeRandomizer.pickNext(Le.RowImages))}).layout();return[s,...i,n]}};M(pa,"identifier","imgly_text_design_sunshine-v3_1_0")});var dr,Vg=_(()=>{O();Ss();lr();ua();dr=class extends gt{constructor(...e){super(...e);this._possibleRowTypes=[H.Watercolor1,H.Watercolor2,H.Watercolor3]}};M(dr,"defaultFontIdentifiers",["imgly_font_permanent_marker","imgly_font_wolesbro","imgly_font_wolesbro"]),M(dr,"identifier","imgly_text_design_watercolor");dr.prototype.availableOptions=L(C({},gt.prototype.availableOptions),{fontIdentifiers:{type:"array",default:dr.defaultFontIdentifiers},alignment:{type:"string",default:we.Alignment.Center,available:we.ValidAlignments}})});var D1,_a,kc,Hg=_(()=>{O();mt();ia();ca();Vt();Ti();({Rectangle:D1}=B),_a=1e3,kc=class{constructor(){this._layoutData=null,this._layout=null,this._text="",this._seed=0,this._debugMode=!1,this.randomizer=new Q}createLayout(e,t,i){this._layout=e,this._text=t,this._seed=i,e.seed(i),this._layoutData=e.generateLayoutData(t,_a)}calculateAspect(){return this._layoutData?this._layoutData.getSize().aspect():(I.warn("TextDesignRenderer#calculateAspect: No layout data"),1)}draw(e,t,i,r){let s=this._layoutData;if(this._layoutData){let n=new _e(_a,_a/t.aspect()),a=t.width/_a,l=s.getRelativeInsets().clone().scale(n.width),h=s.getRelativeLineSpacing()*n.width,c=l.top;e.save(),this.randomizer.seed(this._seed);let m=s.getBackground();m&&m.render(e,t,s.getRelativeInsets(),r?S.WHITE:i,this.randomizer),e.scale(a,a),s.getRows().forEach(d=>{e.save();let u=d.getAttributes();if(e.transform(1,d.getShearingAngle(),0,1,l.left,c),u.setTextColor(r?S.WHITE:i.clone()),u.setTintColor(r?S.WHITE:i.clone()),(d instanceof oi||d instanceof ki)&&(d.setBackgroundColor(r?S.WHITE:i.clone()),d.setIsUsedInInvertedLayout(r)),this._debugMode&&(d._debugMode=!0),d.willRender(e),d.render(e),d.didRender(e),this._debugMode){let f=d._getFrame(),y=d._getTextFrame();Rs(e,f,S.GREEN),Rs(e,y,S.BLUE),d._getLayoutElements().forEach(g=>{let p=g.getFrame(),v=d._getTextFrameForElement(g);Rs(e,p,new S(1,1,0)),Rs(e,v,new S(0,1,1))})}c+=d.getSize().height+h,e.restore()}),this._debugMode&&Rs(e,new D1(0,0,n.width,n.height),S.RED),e.restore()}}}});var Ei,Ms,ga,jg=_(()=>{O();vs();ks();vg();xc();wg();bc();Tg();wc();Cg();lr();Mg();ua();Bg();Dg();Ug();Gg();fa();Wg();Vg();mt();Vt();wt();Hg();({Vector2:Ei}=B),Ms=class extends Gt{constructor(e,t){super(e,t);this._isDisposed=!1,this._renderer=new kc,this._canvas=k.createCanvas(),this._context=this._canvas.getContext("2d"),this._texture=R.Texture.fromCanvas(this._canvas),this._sprite.setTexture(this._texture),this._aspect=1,this._isLayoutDirty=!0,this.getSeed()<0&&this.setSeed(Q.TimeSeed())}seed(e){this.setSeed(e||Q.TimeSeed()),this._isLayoutDirty=!0}_updateLayout(){let e=this.getLayout();return e?(this._renderer.createLayout(e,this.getText(),this.getSeed()),this._aspect=this._renderer.calculateAspect(),this._isLayoutDirty=!1,!0):null}applyTransform(e){super.applyTransform(e);let t={};this._options.dimensions&&(t.width=e.applyToRelativeSize(this.getWidth())),this.set(t,!1)}applyFlip(e){super.applyFlip(e);let{rotation:t}=this._options;switch(e){case"horizontal":t+=(Math.PI-t)*2,this.setRotation(t);break;case"vertical":t+=(Math.PI/2-t)*2,this.setRotation(t);break}}update(e,t){let i=this._isLayoutDirty;if(this._isDisposed||i&&!this._updateLayout())return;let r=this.getWidth()*t.min()/e.getTextureScale(),s=r/this._aspect,n=new Ei(r,s),a=new Ei(Math.round(r*2),Math.round(s*2)).clamp(new Ei(1,1),new Ei(1/0,1/0)),l=e.getRenderer(),h=l.getMaxDimensions()||1/0;a.x>h&&(a.x=h,a.y=Math.round(a.x/this._aspect)),a.y>h&&(a.y=h,a.x=Math.round(a.y*this._aspect));let c=k.ensureCanvasDimensions(this._canvas,a);(i||c)&&(this._context.clearRect(0,0,this._canvas.width,this._canvas.height),this._renderer.draw(this._context,new _e(a.x,a.y),this.getColor(),this.getInverted()),this.setDimensions(n),this._texture.getBaseTexture().update(),l.isOfType("webgl")&&l.updateTexture(this._texture.getBaseTexture())),super.update(e,t),this._applyFlip()}_applyFlip(){let e=this._sprite.getScale(),{flipHorizontally:t,flipVertically:i}=this._options;(t&&e.x>0||!t&&e.x<0)&&(e.x*=-1),(i&&e.y>0||!i&&e.y<0)&&(e.y*=-1),this._sprite.setScale(e)}_optionEquals(e,t){if(e==="layout"){let{layout:i}=this._options;return!(!i&&t||!t&&i||!t.constructor||!i.constructor||i.constructor.identifier!==t.constructor.identifier)}return super._optionEquals(e,t)}serializeOptions(e,t=!1){if(e&&this.getPadding()<0){let r=e.indexOf("padding");r>-1&&e.splice(r,1)}let i=super.serializeOptions(e,t);return e||(i.type="textdesign"),i}_getTexture(){return this._texture}canBeFlippedHorizontally(){return!1}canBeDuplicated(){return!0}canMaskCanvas(){return!0}canAdjustPadding(){return!0}dispose(){this._isDisposed=!0,this._texture.dispose(),this._sprite.dispose()}};Ms.Layouts={TextDesignBlocks:Me,TextDesignBlocksCondensed:rr,TextDesignBlocksLight:Ht,TextDesignCelebrate:_t,TextDesignCelebrateSimple:or,TextDesignEqualWidth:Xt,TextDesignEqualWidthFat:ar,TextDesignMasked:we,TextDesignMaskedBadge:Si,TextDesignMaskedSpeechBubble:gt,TextDesignMaskedSpeechBubbleComic:hr,TextDesignMultiline:cr,TextDesignWatercolor:dr,TextDesignSunshine:Le,TextDesignParticles:ni,TextDesignRotated:ur};Ms.LegacyLayouts={TextDesignBlocksLightV310:sr,TextDesignSunshineV310:pa};Ms.AssetManager=ne;Ms.prototype.availableOptions={id:{type:"string",default:()=>k.getUUID()},position:{type:"vector2",default:new Ei(.5,.5)},dimensions:{type:"vector2",default:Ei.NULL},anchor:{type:"vector2",default:new Ei(0,0)},pivot:{type:"vector2",default:new Ei(.5,.5)},rotation:{type:"number",default:0},flipHorizontally:{type:"boolean",default:!1},flipVertically:{type:"boolean",default:!1},layout:{type:"object",default:null,setter(o){return this._isLayoutDirty=!0,o}},text:{type:"string",default:"",setter(o){return this._isLayoutDirty=!0,o}},color:{type:"color",default:S.BLACK,setter(o){return this._isLayoutDirty=!0,o}},padding:{type:"number",default:.01,minValue:.01},width:{type:"number",default:.8},inverted:{type:"boolean",default:!1,setter(o){return this._isLayoutDirty=!0,o}},seed:{type:"number",default:-1}};ga=Ms});var Sc,ya,xa,qg=_(()=>{O();vs();Cc();({Vector2:Sc}=B),ya=class extends Gt{constructor(...e){super(...e);this._textRenderer=new Fg(this,this._operation),this._textRenderer.rotation=this.getRotation(),this._sprite.setTexture(this._textRenderer.getFinalTexture()),this._hitTestSprite.setTexture(this._textRenderer.getTexture())}serializeOptions(e,t=!1){let i=super.serializeOptions(e,t);return e||(i.type="text"),i}getDOMStyle(e,t){let i=this.getFontSize()*t.y;return{fontWeight:this._options.fontWeight,fontSize:`${i}px`,fontStyle:this._options.fontStyle,fontFamily:this._options.fontFamily,lineHeight:`${this.getAbsoluteTextHeight(t)*this.getLineHeight()}px`,color:this._options.color.toRGBA(),backgroundColor:this._options.backgroundColor.toRGBA(),textAlign:this._options.alignment}}getAbsoluteTextHeight(e){let t=this.getFontSize()*e.y,i=this.getTextMetrics();if(i){let r=1/i.unitsPerEm*t,s=i.ascender*r,n=i.descender*r;return s+Math.abs(n)}return t*this.getLineHeight()*1.1}getDimensions(e,t){return this._textRenderer.getDimensions(e,t)}applyFlip(e){super.applyFlip(e);let{rotation:t}=this._options;switch(e){case"horizontal":t+=(Math.PI-t)*2,this.setRotation(t);break;case"vertical":t+=(Math.PI/2-t)*2,this.setRotation(t);break}}applyTransform(e){super.applyTransform(e),this.set({fontSize:e.scaleSize(this.getFontSize(),"y"),maxWidth:e.scaleSize(this.getMaxWidth(),"x")},!1)}applyRotation(e){super.applyRotation(e);let t=(e+360)%360,i=this._operation.getInputDimensions();(t===90||t===270)&&(this.setMaxWidth(this.getMaxWidth()/i.x*i.y),this.setFontSize(this.getFontSize()/i.y*i.x))}setOption(e,t){let{flipHorizontally:i,flipVertically:r}=this._options;if(e==="rotation"){let s=t;i&&(s=Math.PI*2-s),r&&(s=Math.PI*2-s),this._options.rotation=s,this._textRenderer&&(this._textRenderer.rotation=s),this._rotation=s,this.emit("update");return}super.setOption(e,t)}getOption(e){return e==="rotation"?this._rotation:super.getOption(e)}getHitTestDisplayObject(){return this._hitTestSprite}update(e,t){if(this._sprite.setVisible(this._options.visible),!this._options.visible)return;this._textRenderer.update(e,t);let i=this._textRenderer.getFinalTexture();i.getBaseTexture().update();let s=e.getRenderer();s.isOfType("webgl")&&s.updateTexture(i.getBaseTexture()),super.update(e,t),this._sprite.setRotation(0),this._textRenderer.getTexture().getBaseTexture().update(),this._hitTestSprite.setRotation(this._rotation),this._hitTestSprite.updateTransform(),this._applyFlip()}_applyFlip(){let e=this._sprite.getScale(),{flipHorizontally:t,flipVertically:i}=this._options;(t&&e.x>0||!t&&e.x<0)&&(e.x*=-1,this.setRotation(this._rotation)),(i&&e.y>0||!i&&e.y<0)&&(e.y*=-1,this.setRotation(this._rotation)),this._sprite.setScale(e)}_getTexture(){return this._textRenderer.getFinalTexture()}dispose(){super.dispose(),this._textRenderer.dispose(),this._hitTestSprite.dispose(),this._sprite.dispose()}canBeFlippedHorizontally(){return!1}canAdjustPadding(){return!1}};ya.prototype.availableOptions={id:{type:"string",default:()=>k.getUUID()},fontSize:{type:"number",default:.1},characterSpacing:{type:"number",default:0},lineHeight:{type:"number",default:1.1},fontIdentifier:{type:"string"},fontFamily:{type:"string",default:"Times New Roman"},fontWeight:{type:"*",default:"normal"},fontStyle:{type:"string",default:"normal"},textMetrics:{type:"object",default:null},outlineWidth:{type:"number",default:0},outlineColor:{type:"color",default:S.BLACK},alignment:{type:"string",default:"left",available:["left","center","right"]},verticalAlignment:{type:"string",default:"top",available:["top","center","bottom"]},color:{type:"color",default:new S(1,0,0,1)},backgroundColor:{type:"color",default:S.TRANSPARENT},position:{type:"vector2",default:new Sc(.5,.5)},anchor:{type:"vector2",default:new Sc(0,0)},pivot:{type:"vector2",default:new Sc(.5,.5)},rotation:{type:"number",default:0},text:{type:"string",required:!0},maxWidth:{type:"number",default:.5},maxHeight:{type:"number",default:0},visible:{type:"boolean",default:!0},flipHorizontally:{type:"boolean",default:!1},flipVertically:{type:"boolean",default:!1}};ya.type="text";xa=ya});var Oc,ai,Xg,Yg=_(()=>{O();vs();fc();fg();jg();qg();({Vector2:Oc}=B),ai=class extends te{constructor(...e){super(...e);this.setSmoothDownscaling(this._sdk.getOptions().smoothDownscaling),this._onSpriteUpdate=this._onSpriteUpdate.bind(this),this._maskCanvas=k.createCanvas(),this._options.sprites.slice().forEach(i=>{this.removeSprite(i),this.addSprite(i)})}getSpritesOfType(e){return this._options.sprites.filter(t=>t instanceof e)}rotate(e){this._options.sprites.forEach(t=>{t.applyRotation(e)})}flip(e){this._options.sprites.forEach(t=>{t.applyFlip(e)})}_onSpriteUpdate(e,t){this.emit("update",this),this.setDirty(!0)}_applyRotation(e,t){this._options.sprites.forEach(i=>i.applyRotation(e,t))}transform(e){this._options.sprites.forEach(t=>t.applyTransform(e))}scale(e){this._options.sprites.forEach(t=>t.applyScale(e))}serializeOption(e,t=!1){return e==="sprites"?this._options.sprites.map(i=>i.serializeOptions(void 0,t)):super.serializeOption(e,t)}createSticker(e){return new ea(this,e)}createText(e){return new xa(this,e)}createBrush(e){return new er(this,e)}createTextDesign(e){return new ga(this,e)}addSprite(e){this._options.sprites.push(e);let t=this.getSmoothDownscaling();e.setSmoothDownscaling&&e.setSmoothDownscaling(t),this._container.addChild(e.getDisplayObject()),this.setDirty(!0),e.on("update",this._onSpriteUpdate),this.emit("update",this,this._options.sprites)}removeSprite(e){let{sprites:t}=this._options,i=t.indexOf(e);return i!==-1?(e.off("update",this._onSpriteUpdate),this._container.removeChild(e.getDisplayObject()),t.splice(i,1),this.setDirty(!0),!0):!1}_getOrientatedStageSize(){let e=this._sdk.getSprite().getTexture().getFrame(),t=this._sdk.getOperationsStack().getByIdentifier("orientation");if(t){let r=t?t.getRotation():0;return r===270||r===90?new Oc(e.height,e.width):new Oc(e.width,e.height)}let i=this._sdk.getOperationsStack().getByIdentifier("output");return i?i.getOutputResolution():new Oc(e.width,e.height)}_render(e){let t=this._container,{sprites:i}=this._options,r=e.getDimensions().clone().floor(),s=new R.Container;return s.addChild(this._sprite),Promise.all(i.map(n=>n.validateSettings())).then(()=>{i.forEach(n=>n.update(this._sdk,r))}).then(()=>{this._renderTexture.clear(),i.forEach(n=>{n.getInverted&&n.getInverted()?(this._renderTexture.render(s),this._renderTexture.render(this._renderMaskedSprite(n.getDisplayObject(),n.getColor?n.getColor():S.WHITE,n.getPadding?n.getPadding():-1)),s=new R.Container):s.addChild(n.getDisplayObject())}),this._renderTexture.render(s),t.addChild(this._sprite),i.forEach(n=>t.addChild(n.getDisplayObject()))})}_renderMaskedSprite(e,t,i){let r=this._maskCanvas,s=e.getWorldTransform(),n=this._getOrientatedStageSize();k.ensureCanvasDimensions(r,n);let a=r.getContext("2d");if(a.clearRect(0,0,r.width,r.height),a.save(),a.fillStyle=t.toRGBA(),i<0)a.fillRect(0,0,n.x,n.y);else{let c=Math.abs(e.getWidth()/e.getScale().x),m=Math.abs(e.getHeight()/e.getScale().y),d=c*i;a.transform(s.a,s.b,s.c,s.d,s.tx,s.ty),a.fillRect(-d,-d,c+d*2,m+d*2)}a.restore(),a.save(),a.globalCompositeOperation="destination-out",e._renderCanvas({getCurrentRenderTarget:()=>({getPixelRatio:()=>1}),beforeDraw:c=>{let m=e.getWidth(),d=e.getHeight(),u=e.getScale(),f=u.x<0,y=u.y<0;c.translate(m,d),c.scale(f?-1:1,y?-1:1),c.translate(-m,-d)},getContext:()=>a}),a.restore();let l=new R.Container,h=new R.Sprite(R.Texture.fromCanvas(r));return l.addChild(h),l}takeSpriteToFront(e){let{sprites:t}=this._options,i=t.indexOf(e);if(i===-1)return;k.moveArrayItem(t,i,t.length-1);let r=e.getDisplayObject();this._container.removeChild(r),this._container.addChild(r),this.setDirty(!0)}getSpritesAtPosition(e,t){let i=[];this._options.sprites.forEach(c=>c.update(this._sdk,t));let r=this._sdk.getSprite(),s=r.getWorldTransform().applyInverseToVector(e),{width:n,height:a}=r.getTexture().getFrame(),l=r.getAnchor().clone().multiply(-n,-a);s.subtract(l);let h=this._options.sprites.slice(0).reverse();for(let c=0,m=h.length;c<m;c++){let d=h[c];d.getHitTestDisplayObject().isAtPosition(s)&&i.push(d)}return i}setDirtyForRenderer(e,t,i){super.setDirtyForRenderer(e,t,i),this._options.sprites.forEach(r=>{r.setDirtyForRenderer(e,t,i)})}dispose(){super.dispose(),this._options.sprites.forEach(e=>{e.dispose()})}};ai.StickerSprite=ea;ai.TextSprite=xa;ai.BrushSprite=er;ai.TextDesignSprite=ga;ai.identifier="sprite";ai.prototype.availableOptions={sprites:{type:"array",default:[],setter(o,e){return o=o.map((t,i)=>{if(t instanceof Gt)return t;let r=C({},t);switch(delete r.type,t.type){case"text":return new xa(this,r);case"sticker":return new ea(this,r);case"brush":return new er(this,r);case"textdesign":return new ga(this,r);default:return I.error(this.constructor.name,`Invalid sprite type: ${t.type}`),null}}),e||(this._options.sprites&&this._options.sprites.slice().forEach(i=>{i.dispose(),this.removeSprite(i)}),o.forEach(t=>{this.addSprite(t)})),o}},smoothDownscaling:{type:"boolean",default:!1}};P.Operations.SpriteOperation=ai;Xg=ai});var Kg,Jg,Zg,Qg=_(()=>{O();({Vector2:Kg}=B),Jg=class{constructor(e,t){this._options=t,this._oldOptions={start:e.getStart().clone(),end:e.getEnd().clone(),rotation:e.getRotation(),textureScale:e.getTextureScale()},this._inputDimensions=e.getInputDimensions(!1),this._rotationDelta=t.rotation-e.getRotation(),this._deltaCos=Math.cos(this._rotationDelta),this._deltaSin=Math.sin(this._rotationDelta),this._oldAbsoluteSize=this._oldOptions.end.clone().subtract(this._oldOptions.start).multiply(this._inputDimensions),this._newAbsoluteSize=t.end.clone().subtract(t.start).multiply(this._inputDimensions),this._absoluteStartDiff=this._oldOptions.start.clone().subtract(t.start).multiply(this._inputDimensions),this._scaleRatio=e.calculateScale(t.rotation)/e.calculateScale(),this._sizeFactor=this._newAbsoluteSize.clone().divide(this._oldAbsoluteSize),this._textureScaleFactor=this._options.textureScale/e.getTextureScale()}applyToRelativePoint(e){let t=this._oldOptions.start,i=this._oldOptions.end,s=t.clone().add(i.clone().subtract(t).divide(2)).multiply(this._inputDimensions),n=e.clone().multiply(this._oldAbsoluteSize).subtract(this._oldAbsoluteSize.clone().divide(2)),l=s.clone().add(n).clone().subtract(this._inputDimensions.clone().divide(2)),h=new Kg(l.x*this._deltaCos-l.y*this._deltaSin,l.x*this._deltaSin+l.y*this._deltaCos),c=this._inputDimensions.clone().divide(2).add(h),m=this._options.start.clone().multiply(this._inputDimensions);return c.clone().subtract(m).divide(this._newAbsoluteSize)}applyToRelativeSize(e){return e*this._oldAbsoluteSize.min()/this._newAbsoluteSize.min()}applyToDimensions(e){return e=e.clone().multiply(this._scaleRatio),this._options.textureScale&&e.multiply(this._textureScaleFactor),e}scaleSize(e,t="y"){return e/this._sizeFactor[t]}applyToRotation(e){return(e+this._rotationDelta)%(Math.PI*2)}invert(){let e=this._options.start.clone(),t=this._options.end.clone(),i=this._inputDimensions,r=-this._rotationDelta,s=Math.cos(r),n=Math.sin(r),a=this._oldAbsoluteSize,l=this._newAbsoluteSize,h=e.clone().subtract(t).multiply(i),c=1/this._scaleRatio,m=new Kg(1/this._sizeFactor.x,1/this._sizeFactor.y),d=1/this._textureScaleFactor,u=this._oldOptions;return this._oldOptions=this._options,this._options=u,this._inputDimensions=i,this._rotationDelta=r,this._deltaCos=s,this._deltaSin=n,this._oldAbsoluteSize=l,this._newAbsoluteSize=a,this._absoluteStartDiff=h,this._scaleRatio=c,this._sizeFactor=m,this._textureScaleFactor=d,this}},Zg=Jg});var Fc,Bs,$g,ey=_(()=>{O();Qg();({Vector2:Fc}=B),Bs=class extends te{_render(e){this._sprite.setRotation(0);let t=e.getDimensions(),{start:i,end:r,rotation:s,textureScale:n}=this._options,l=r.clone().subtract(i).clone().divide(2),h=i.clone().add(l),m=this.calculateScale()*n,d=t.clone().multiply(m).multiply(l);return this._sprite.setAnchor(h),this._sprite.setRotation(s),this._sprite.setScale(m,m),this._sprite.setPosition(d),this._renderTexture.render(this._container),Promise.resolve()}calculateScale(e=this._options.rotation){let t=this.getInputDimensions(!1),i=new Fc(Math.abs(t.x*Math.cos(e))+Math.abs(t.y*Math.sin(e)),Math.abs(t.x*Math.sin(e))+Math.abs(t.y*Math.cos(e))),r=t.clone().subtract(i.clone()).divide(2).abs(),s=1;return r.y>r.x?s=r.y*2/t.y+1:s=r.x*2/t.x+1,s}getNewDimensions(e){let{start:t,end:i,textureScale:r}=this._options,s=this.calculateScale();return e.clone().multiply(r*s).multiply(i.clone().subtract(t)).round()}flip(e){let{start:t,end:i}=this._options,r=t.clone();e==="horizontal"?(t.set(1-i.x,t.y),i.set(1-r.x,i.y)):e==="vertical"&&(t.set(t.x,1-i.y),i.set(i.x,1-r.y))}rotate(e){let{start:t,end:i}=this._options,r=(e+360)%360,s=Math.floor(r/90);for(let n=0;n<s;n++){let a=t.clone();t.set(1-i.y,a.x),i.set(1-a.y,i.x)}}_onBeforeExport(){this._wasEnabledBeforeExport=this.getEnabled(),this.setEnabled(!0)}_onAfterExport(){this.setEnabled(this._wasEnabledBeforeExport,!0)}};Bs.identifier="transform";Bs.prototype.availableOptions={start:{type:"vector2",default:new Fc(0,0)},end:{type:"vector2",default:new Fc(1,1)},textureScale:{type:"number",default:1},rotation:{type:"number",default:0}};Bs.TransformChange=Zg;P.Operations.TransformOperation=Bs;$g=Bs});var So,ty,iy=_(()=>{fe();O();Ki();So=class extends te{constructor(...e){super(...e);this._watermarkImage=null;this._watermarkTexture=null;this._loadWatermarkImage=()=>{if(!this._watermarkImage){if(!(this._options.watermarkURI instanceof window.Image)){let e={value:this._options.crossOrigin,cors:!0};return Ue.loadImage(this._options.watermarkURI,e).then(t=>{this._watermarkImage=t})}this._watermarkImage=this._options.watermarkURI}return Promise.resolve()};this._setWatermarkalignment=(e,t)=>{let i=Math.min(t.x,t.y)*k.clamp(this._options.inset,0,1);switch(this._options.alignment){case"center":this._watermarkSprite.setPosition(new A(t.x-e.x,t.y-e.y).divide(2));break;case"top-left":this._watermarkSprite.setPosition(new A(i,i));break;case"top-right":this._watermarkSprite.setPosition(new A(t.x-e.x-i,i));break;case"bottom-left":this._watermarkSprite.setPosition(new A(i,t.y-e.y-i));break;case"bottom-right":this._watermarkSprite.setPosition(new A(t.x-e.x-i,t.y-e.y-i));break;default:this._watermarkSprite.setPosition(new A(0,0));break}};this._watermarkSprite=new R.Sprite,this._watermarkSprite.setAnchor(0,0),this._container.addChild(this._watermarkSprite)}_render(e){let{alpha:t,size:i}=this._options;return this._loadWatermarkImage().then(()=>{if(this._watermarkImage){this._watermarkTexture||(this._watermarkTexture=R.Texture.fromImage(this._watermarkImage),this._watermarkSprite.setTexture(this._watermarkTexture));let r=e.getDimensions(),{width:s,height:n}=this._watermarkImage,a=k.resizeVectorToFit(new A(s,n),r.clone().multiply(k.clamp(i,0,1)));this._setWatermarkalignment(a,r),this._watermarkSprite.setWidth(a.x),this._watermarkSprite.setHeight(a.y),this._watermarkSprite.setAlpha(t),this._renderTexture&&this._renderTexture.render(this._container)}return Promise.resolve()})}dispose(){super.dispose(),this._watermarkSprite.dispose()}};So.identifier="watermark";So.prototype.availableOptions={watermarkURI:{type:"string",required:!0},alignment:{type:"string",default:"top-right"},inset:{type:"number",default:"0.05"},size:{type:"number",default:"0.2"},alpha:{type:"number",default:1},crossOrigin:{type:"string",default:"anonymous"}};P.Operations.WatermarkOperation=So;ty=So});var P1,ry=_(()=>{O();Km();ef();v_();T_();C_();M_();L_();W_();H_();q_();K_();eg();mg();Yg();ey();iy();P1=[Ym,$m,b_,R_,I_,A_,G_,V_,Y_,$_,dg,Xg,$g,ty,j_,w_];P.AllOperations=P1});var yt=_(()=>{ry();ho();ho()});var sy,oy=_(()=>{sy=[{fontFamily:"Open Sans",variations:[{identifier:"imgly_font_open_sans_bold",fontWeight:"bold",provider:"file",filePath:"fonts/imgly_font_open_sans_bold.woff",default:!0,textMetrics:{unitsPerEm:2048,ascender:2189,descender:-600}}]},{fontFamily:"Aleo",variations:[{identifier:"imgly_font_aleo_bold",fontWeight:"bold",provider:"file",filePath:"fonts/imgly_font_aleo_bold.woff",textMetrics:{unitsPerEm:1e3,ascender:805,descender:-195}}]},{fontFamily:"Amatic SC",variations:[{identifier:"imgly_font_amaticsc",fontWeight:"normal",provider:"file",filePath:"fonts/imgly_font_amaticsc.woff",textMetrics:{unitsPerEm:1e3,ascender:1016,descender:-245}}]},{fontFamily:"Archivo",variations:[{identifier:"imgly_font_archivo_black",fontWeight:"normal",filePath:"fonts/imgly_font_archivo_black.woff",provider:"file",textMetrics:{unitsPerEm:1e3,ascender:878,descender:-210}}]},{fontFamily:"Bungee Inline",variations:[{identifier:"imgly_font_bungee_inline",fontWeight:"normal",fontStyle:"normal",filePath:"fonts/imgly_font_bungee_inline.woff",provider:"file",textMetrics:{unitsPerEm:1e3,ascender:860,descender:-140}}]},{fontFamily:"Campton Book",variations:[{identifier:"imgly_font_campton_bold",fontWeight:"bold",fontStyle:"normal",filePath:"fonts/imgly_font_campton_bold.woff",provider:"file",textMetrics:{unitsPerEm:1e3,ascender:770,descender:-294}}]},{fontFamily:"Carter",variations:[{identifier:"imgly_font_carter_one",fontWeight:"normal",fontStyle:"normal",filePath:"fonts/imgly_font_carter_one.woff",provider:"file",textMetrics:{unitsPerEm:2048,ascender:2264,descender:-890}}]},{fontFamily:"Codystar",variations:[{identifier:"imgly_font_codystar",fontWeight:"normal",fontStyle:"normal",filePath:"fonts/imgly_font_codystar.woff",provider:"file",textMetrics:{unitsPerEm:1024,ascender:953,descender:-255}}]},{fontFamily:"Fira Sans",variations:[{identifier:"imgly_font_fira_sans_regular",fontWeight:"normal",fontStyle:"normal",filePath:"fonts/imgly_font_fira_sans_regular.woff",provider:"file",textMetrics:{unitsPerEm:1e3,ascender:935,descender:-265}}]},{fontFamily:"Galano Grotesque",variations:[{identifier:"imgly_font_galano_grotesque_bold",fontWeight:"bold",fontStyle:"normal",filePath:"fonts/imgly_font_galano_grotesque_bold.woff",provider:"file",textMetrics:{unitsPerEm:1e3,ascender:800,descender:-200}}]},{fontFamily:"Krona One",variations:[{identifier:"imgly_font_krona_one",fontWeight:"normal",fontStyle:"normal",filePath:"fonts/imgly_font_krona_one.woff",provider:"file",textMetrics:{unitsPerEm:2048,ascender:2030,descender:-530}}]},{fontFamily:"Kumar One Outline",variations:[{identifier:"imgly_font_kumar_one_outline",fontWeight:"normal",fontStyle:"normal",filePath:"fonts/imgly_font_kumar_one_outline.woff",provider:"file",textMetrics:{unitsPerEm:1e3,ascender:1137,descender:-642}}]},{fontFamily:"Lobster",variations:[{identifier:"imgly_font_lobster",fontWeight:"normal",provider:"file",filePath:"fonts/imgly_font_lobster.woff",textMetrics:{unitsPerEm:1e3,ascender:1e3,descender:-250}}]},{fontFamily:"Molle",variations:[{identifier:"imgly_font_molle",fontWeight:"normal",fontStyle:"normal",filePath:"fonts/imgly_font_molle.woff",provider:"file",textMetrics:{unitsPerEm:2048,ascender:1852,descender:-701}}]},{fontFamily:"Monoton",variations:[{identifier:"imgly_font_monoton",fontWeight:"normal",fontStyle:"normal",filePath:"fonts/imgly_font_monoton.woff",provider:"file",textMetrics:{unitsPerEm:2048,ascender:2366,descender:-822}}]},{fontFamily:"Nixie One",variations:[{identifier:"imgly_font_nixie_one",fontWeight:"normal",fontStyle:"normal",filePath:"fonts/imgly_font_nixie_one.woff",provider:"file",textMetrics:{unitsPerEm:1e3,ascender:926,descender:-210}}]},{fontFamily:"Notable",variations:[{identifier:"imgly_font_notable",fontWeight:"normal",fontStyle:"normal",filePath:"fonts/imgly_font_notable.woff",provider:"file",textMetrics:{unitsPerEm:1e3,ascender:1143,descender:-157}}]},{fontFamily:"Ostrich",variations:[{identifier:"imgly_font_ostrich_sans_black",fontWeight:800,provider:"file",filePath:"fonts/imgly_font_ostrich_sans_black.woff",textMetrics:{unitsPerEm:1e3,ascender:950,descender:-250}},{identifier:"imgly_font_ostrich_sans_bold",fontWeight:"bold",provider:"file",filePath:"fonts/imgly_font_ostrich_sans_bold.woff",textMetrics:{unitsPerEm:1e3,ascender:950,descender:-250}}]},{fontFamily:"Oswald SemiBold",variations:[{identifier:"imgly_font_oswald_semi_bold",fontWeight:600,fontStyle:"normal",filePath:"fonts/imgly_font_oswald_semi_bold.woff",provider:"file",textMetrics:{unitsPerEm:1e3,ascender:1193,descender:-289}}]},{fontFamily:"Palanquin Dark SemiBold",variations:[{identifier:"imgly_font_palanquin_dark_semi_bold",fontWeight:"bold",fontStyle:"normal",filePath:"fonts/imgly_font_palanquin_dark_semi_bold.woff",provider:"file",textMetrics:{unitsPerEm:1e3,ascender:1320,descender:-491}}]},{fontFamily:"Poppins",variations:[{identifier:"imgly_font_poppins",fontWeight:"bold",fontStyle:"normal",filePath:"fonts/imgly_font_poppins.woff",provider:"file",textMetrics:{unitsPerEm:1e3,ascender:1050,descender:-350}}]},{fontFamily:"Permanent Marker",variations:[{identifier:"imgly_font_permanent_marker",fontWeight:"normal",fontStyle:"normal",filePath:"fonts/imgly_font_permanent_marker.woff",provider:"file",textMetrics:{unitsPerEm:1024,ascender:1136,descender:-325}}]},{fontFamily:"Roboto Black",variations:[{identifier:"imgly_font_roboto_black_italic",fontWeight:"normal",fontStyle:"italic",filePath:"fonts/imgly_font_roboto_black_italic.woff",provider:"file",textMetrics:{unitsPerEm:2048,ascender:1900,descender:-500}}]},{fontFamily:"Roboto Light",variations:[{identifier:"imgly_font_roboto_light_italic",fontWeight:"normal",fontStyle:"italic",filePath:"fonts/imgly_font_roboto_light_italic.woff",provider:"file",textMetrics:{unitsPerEm:2048,ascender:1900,descender:-500}}]},{fontFamily:"Sancreek",variations:[{identifier:"imgly_font_sancreek",fontWeight:"normal",fontStyle:"normal",filePath:"fonts/imgly_font_sancreek.woff",provider:"file",textMetrics:{unitsPerEm:2048,ascender:2104,descender:-738}}]},{fontFamily:"Stint Ultra Expanded",variations:[{identifier:"imgly_font_stint_ultra_expanded",fontWeight:"normal",fontStyle:"normal",filePath:"fonts/imgly_font_stint_ultra_expanded.woff",provider:"file",textMetrics:{unitsPerEm:2048,ascender:1853,descender:-483}}]},{fontFamily:"Trashhand",variations:[{identifier:"imgly_font_trash_hand",fontWeight:"normal",provider:"file",filePath:"fonts/imgly_font_trash_hand.woff",textMetrics:{unitsPerEm:1e3,ascender:759,descender:-304}}]},{fontFamily:"VT323",variations:[{identifier:"imgly_font_vt323",fontWeight:"normal",fontStyle:"normal",filePath:"fonts/imgly_font_vt323.woff",provider:"file",textMetrics:{unitsPerEm:1e3,ascender:800,descender:-200}}]},{fontFamily:"Yeseva One",variations:[{identifier:"imgly_font_yeseva_one",fontWeight:"normal",fontStyle:"normal",filePath:"fonts/imgly_font_yeseva_one.woff",provider:"file",textMetrics:{unitsPerEm:1e3,ascender:915,descender:-240}}]}]});var ny,ay=_(()=>{ny=[{fontFamily:"Open Sans",variations:[{identifier:"imgly_font_open_sans_bold",fontWeight:"bold",provider:"file",filePath:"fonts/imgly_font_open_sans_bold.woff",default:!0,textMetrics:{unitsPerEm:2048,ascender:2189,descender:-600}}]},{fontFamily:"Abril Fatface",variations:[{identifier:"imgly_font_abril_fatface_regular",fontWeight:"normal",fontStyle:"normal",provider:"file",filePath:"fonts/imgly_font_abril_fatface_regular.woff",textMetrics:{unitsPerEm:1e3,ascender:1058,descender:-291}}]},{fontFamily:"Amberlight",variations:[{identifier:"imgly_font_amberlight",fontWeight:"normal",fontStyle:"normal",provider:"file",filePath:"fonts/imgly_font_amberlight.woff",default:!0,textMetrics:{unitsPerEm:1e3,ascender:750,descender:-250}}]},{fontFamily:"Bungee Inline",variations:[{identifier:"imgly_font_bungee_inline",fontWeight:"normal",fontStyle:"normal",provider:"file",filePath:"fonts/imgly_font_bungee_inline.woff",default:!0,textMetrics:{unitsPerEm:1e3,ascender:860,descender:-140}}]},{fontFamily:"Campton Book",variations:[{identifier:"imgly_font_campton_bold",fontWeight:"bold",provider:"file",filePath:"fonts/imgly_font_campton_bold.woff",default:!0,textMetrics:{unitsPerEm:1e3,ascender:770,descender:-294}}]},{fontFamily:"Galano Grotesque",variations:[{identifier:"imgly_font_galano_grotesque_bold",fontWeight:"bold",fontStyle:"normal",provider:"file",filePath:"fonts/imgly_font_galano_grotesque_bold.woff",default:!0,textMetrics:{unitsPerEm:1e3,ascender:800,descender:-200}}]},{fontFamily:"Handycheera",variations:[{identifier:"imgly_font_handycheera_regular",fontWeight:"normal",fontStyle:"normal",provider:"file",filePath:"fonts/imgly_font_handycheera_regular.woff",default:!0,textMetrics:{unitsPerEm:2048,ascender:2199,descender:-808}}]},{fontFamily:"Montserrat Light",variations:[{identifier:"imgly_font_montserrat_light",fontWeight:"normal",fontStyle:"normal",provider:"file",filePath:"fonts/imgly_font_montserrat_light.woff",textMetrics:{unitsPerEm:1e3,ascender:968,descender:-251}}]},{fontFamily:"Ostrich",variations:[{identifier:"imgly_font_ostrich_sans_black",fontWeight:800,provider:"file",filePath:"fonts/imgly_font_ostrich_sans_black.woff",textMetrics:{unitsPerEm:1e3,ascender:950,descender:-250}},{identifier:"imgly_font_ostrich_sans_bold",fontWeight:"bold",provider:"file",filePath:"fonts/imgly_font_ostrich_sans_bold.woff",textMetrics:{unitsPerEm:1e3,ascender:950,descender:-250}},{identifier:"imgly_font_ostrich_sans_heavy",fontWeight:900,provider:"file",filePath:"fonts/imgly_font_ostrich_sans_heavy.woff",textMetrics:{unitsPerEm:1e3,ascender:674,descender:0}}]},{fontFamily:"Permanent Marker",variations:[{identifier:"imgly_font_permanent_marker",fontWeight:"normal",fontStyle:"normal",provider:"file",filePath:"fonts/imgly_font_permanent_marker.woff",textMetrics:{unitsPerEm:1024,ascender:1136,descender:-325}}]},{fontFamily:"Petit Formal Script",variations:[{identifier:"imgly_font_petit_formal_script",fontWeight:"normal",fontStyle:"normal",provider:"file",filePath:"fonts/imgly_font_petit_formal_script.woff",default:!0,textMetrics:{unitsPerEm:2048,ascender:2033,descender:-527}}]},{fontFamily:"Rasa",variations:[{identifier:"imgly_font_rasa_regular",fontWeight:"normal",fontStyle:"normal",provider:"file",filePath:"fonts/imgly_font_rasa_regular.woff",default:!0,textMetrics:{unitsPerEm:2750,ascender:2300,descender:-1050}},{identifier:"imgly_font_rasa_500",fontWeight:500,fontStyle:"normal",provider:"file",filePath:"fonts/imgly_font_rasa_500.woff",default:!0,textMetrics:{unitsPerEm:2750,ascender:2300,descender:-1050}}]},{fontFamily:"Roboto Black",variations:[{identifier:"imgly_font_roboto_black",fontWeight:"normal",fontStyle:"normal",filePath:"fonts/imgly_font_roboto_black.woff",provider:"file",textMetrics:{unitsPerEm:2048,ascender:1900,descender:-500}},{identifier:"imgly_font_roboto_black_italic",fontWeight:"normal",fontStyle:"italic",filePath:"fonts/imgly_font_roboto_black_italic.woff",provider:"file",textMetrics:{unitsPerEm:2048,ascender:1900,descender:-500}}]},{fontFamily:"Roboto Light",variations:[{identifier:"imgly_font_roboto_light",fontWeight:"normal",fontStyle:"normal",filePath:"fonts/imgly_font_roboto_light.woff",provider:"file",textMetrics:{unitsPerEm:2048,ascender:1900,descender:-500}},{identifier:"imgly_font_roboto_light_italic",fontWeight:"normal",fontStyle:"italic",filePath:"fonts/imgly_font_roboto_light_italic.woff",provider:"file",textMetrics:{unitsPerEm:2048,ascender:1900,descender:-500}}]},{fontFamily:"Sue Ellen Francisco",variations:[{identifier:"imgly_font_sue_ellen_francisco",fontWeight:"normal",fontStyle:"normal",filePath:"fonts/imgly_font_sue_ellen_francisco.woff",provider:"file",textMetrics:{unitsPerEm:1024,ascender:1362,descender:-634}}]},{fontFamily:"Ultra",variations:[{identifier:"imgly_font_ultra",fontWeight:"normal",fontStyle:"normal",provider:"file",filePath:"fonts/imgly_font_ultra.woff",default:!0,textMetrics:{unitsPerEm:2048,ascender:2066,descender:-561}}]},{fontFamily:"Wolesbro",variations:[{identifier:"imgly_font_wolesbro",fontWeight:"normal",fontStyle:"normal",provider:"file",filePath:"fonts/imgly_font_wolesbro.woff",textMetrics:{unitsPerEm:1e3,ascender:925,descender:-575}}]}]});var ly,hy=_(()=>{ly=[{identifier:"imgly_transforms_common",defaultName:"Common Ratios",ratios:[{identifier:"imgly_transform_common_custom",defaultName:"Custom",ratio:"*",selected:!0},{identifier:"imgly_transform_common_square",defaultName:"Square",ratio:1},{identifier:"imgly_transform_common_4-3",defaultName:"4:3",ratio:4/3},{identifier:"imgly_transform_common_16-9",defaultName:"16:9",ratio:16/9}]},{identifier:"imgly_transforms_facebook",defaultName:"Facebook",ratios:[{identifier:"imgly_transform_facebook_profile",defaultName:"Profile Pic",dimensions:{x:300,y:300},forceDimensions:!1,lockDimensions:!0},{identifier:"imgly_transform_facebook_ad",defaultName:"Ad",dimensions:{x:1200,y:627}},{identifier:"imgly_transform_facebook_post",defaultName:"Post",dimensions:{x:940,y:788}},{identifier:"imgly_transform_facebook_cover",defaultName:"Cover",dimensions:{x:851,y:315}}]}]});var cy,uy,dy=_(()=>{yt();oy();ay();hy();cy=[];typeof P.Operations.SpriteOperation!="undefined"&&cy.push(P.Operations.SpriteOperation.BrushSprite.Brushes.RadialBrush);uy={TRANSFORM_RATIO_CATEGORIES:ly,FONTS:sy,TEXT_DESIGN_FONTS:ny,BRUSHES:cy}});var A1,my,fy=_(()=>{as();A1=L(C({},ns),{LOAD:"load",SAVE:"save",EDITOR_RESIZE:"editor:resize",ZOOM:"editor:zoom",ZOOM_CHANGED:"editor:zoom_changed",HISTORY_REDO:"history:redo",HISTORY_BEFORE_REDO:"history:before-redo",TEXT_SCALED:"editor:text:scaled",TRANSFORM_RESIZE:"transform:resize",TRANSFORM_AFTER_EDIT:"transform:after-edit",ADDED_STICKER:"sticker:added-sticker",SPRITES_DESELECTED:"editor:sprite:deselected-all",CANVAS_FOCUS:"canvas:focus"}),my=A1});var Be,py=_(()=>{dy();fy();Be={EVENTS:my,DEFAULTS:uy}});function L1(){let{userAgent:o,appVersion:e}=navigator;return e.indexOf("MSIE")!==-1?e.match(/MSIE\s+?([0-9]+)/i)[1]:o.indexOf("Trident")!==-1?o.match(/rv:([0-9]+)/i)[1]:!1}var _y,gy=_(()=>{_y={getIEVersion:L1}});var z1,ba,N1,lt,yy=_(()=>{yt();Ni();ut();Kt();gy();z1=P.Utils,{Vector2:ba}=P.Math,N1={getInnerDimensionsForElement(o){let e=new ba(o.offsetWidth,o.offsetHeight),t=window.getComputedStyle(o,null);return e.x-=parseInt(t.getPropertyValue("padding-left"),10),e.x-=parseInt(t.getPropertyValue("padding-right"),10),e.y-=parseInt(t.getPropertyValue("padding-top"),10),e.y-=parseInt(t.getPropertyValue("padding-bottom"),10),e},getEventPosition(o){let e=o.clientX,t=o.clientY;if(o.type.indexOf("touch")!==-1){if(!o.touches.length)return;e=o.touches[0].clientX,t=o.touches[0].clientY}return new ba(e,t)},createTransparentPatternCanvas(){let o=document.createElement("canvas"),e=o.getContext("2d");return o.width=10,o.height=10,e.fillStyle="white",e.fillRect(0,0,o.width,o.height),e.fillStyle="#cccccc",e.fillRect(0,0,o.width/2,o.height/2),e.fillRect(o.width/2,o.height/2,o.width,o.height),o},supportsMSBlob(){let o=document.createElement("canvas"),e=typeof o.msToBlob!="undefined";return Ce(o),e},translate(o,e,t={}){let i=this.fetch(o,e);if(!i)return I.info("Utils#translate",`Unable to translate \`${e}\``),null;for(let r in t)i=i.replace(`\${${r}}`,t[r]);return i},fetch(o,e,t){e=e.replace(/\[(\w+)]/g,".$1"),e=e.replace(/^\./,"");let i=e.split(".");for(let r=0;r<i.length;r++){let s=i[r];if(o=o[s],!o)break}return typeof o=="undefined"?!1:o},isMobile(){let o=navigator.userAgent||navigator.vendor||window.opera;return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(o)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(o.substr(0,4))},select(o,e,t=null){t||(t=r=>r);let i=[];return e.forEach(r=>{o.forEach(s=>{t(s)===r&&i.push(s)})}),i},getJSONP(o){return new dt(o).load()},cloneCategories(o,e){return o.map(t=>(t=z1.clone(t),t[e]=t[e].slice(0),t))},mergeCategories(o,e,t){o=this.cloneCategories(o,t);let i=null;return e.forEach(r=>{o.forEach(s=>{r.identifier===s.identifier&&(i=s)}),i?i[t]=i[t].concat(r[t]):o.push(r)}),o},wrapFiltersInCategories(o,e){return o.map(t=>{let i=t;return e in i||(i={identifier:`imgly_filters_wrapped-${t.identifier}`,displayFlat:!0,[e]:[t]}),i})},getStyleObject(o){let e=window.getComputedStyle(o),t={};for(let i in e){let r=e.getPropertyValue(i),s=i.replace(/-([a-z])/g,(n,a)=>a.toUpperCase());r!==""&&(t[s]=r)}return t},styleElement(o,e){for(let t in e)o.style[t]=e[t]},debounce(o,e,t){let i;return function(...r){let s=()=>{i=null,t||o.apply(this,r)},n=t&&!i;clearTimeout(i),i=setTimeout(s,e),n&&o.apply(this,r)}},getScrollbarWidth(){let o=document.createElement("div");o.style.visibility="hidden",o.style.width="100px",o.style.msOverflowStyle="scrollbar",document.body.appendChild(o);let e=o.offsetWidth;o.style.overflow="scroll";let t=document.createElement("div");t.style.width="100%",o.appendChild(t);let i=t.offsetWidth;return o.parentNode.removeChild(o),e-i},findIntegerFraction(o,e=100){let t=Number.MAX_VALUE,i=0,r=0,s=1,n=1;for(let a=0;a<e;a++){let l=s/n-o;if(l<0)s++;else if(l>0)n++;else return new ba(s,n);let h=Math.abs(s/n-o);h<t&&(t=h,i=s,r=n)}return new ba(i,r)},toFixed(o,e=2){let t=o.toFixed(e);return parseFloat(t)},capitalize(o){return o.charAt(0).toUpperCase()+o.slice(1)},flipObject(o){let e={};for(let t in o)e[o[t]]=t;return e},Browser:_y},lt=N1});var va,le,c3,Ec,u3,d3,Ee,Ii,Ic,Z,m3,ee,f3,p3,_3,fe=_(()=>{yt();as();Li();ut();py();yy();({Base64:va}=P),{Color:le}=P,{ColorMatrix:c3}=P.Math,{EventEmitter:Ec}=P,{EXIF:u3}=P,{OptionType:d3}=P,Ee=P.Utils,{RenderType:Ii}=P,{ImageFormat:Ic}=P,Z=P,{UniformType:m3}=P,{Vector2:ee}=P.Math,{Rectangle:f3}=P.Math,{Range:p3}=P.Math,_3=typeof window!="undefined"&&window.performance&&window.performance.now?window.performance.now.bind(window.performance):ss()});var xy,wa,Mc=_(()=>{xy=class{constructor(){this._assetsByGroupId={}}addAsset(e,t,i=!1){this._assetsByGroupId[e]?i?this._assetsByGroupId[e].unshift(t):this._assetsByGroupId[e].push(t):this._assetsByGroupId[e]=[t]}setAssets(e,t){this._assetsByGroupId[e]=t}getAssets(e){return this._assetsByGroupId[e]=this._assetsByGroupId[e]||[],this._assetsByGroupId[e]}},wa=xy});var Fo,by=_(()=>{yt();Fo=class extends V{};Fo.prototype.availableOptions={fontFamily:{type:"string",required:!0},variations:{type:"array",required:!0}}});var U1,mr,Bc=_(()=>{yt();U1={100:"Extra Light",200:"Light",300:"Book",400:"Regular",500:"Medium",600:"Semibold",700:"Bold",800:"Black",900:"Extra Black",bold:"Bold",normal:"Regular"},mr=class extends V{getLabel(){let e=U1[this._options.fontWeight];switch(this._options.fontStyle){case"italic":e+=" Italic";break}return e}};mr.prototype.availableOptions={identifier:{type:"string",required:!0},fontFamily:{type:"string",required:!0},fontWeight:{type:"*",default:400},fontStyle:{type:"string",default:"normal"},textMetrics:{type:"object",default:null},provider:{type:"string",available:["google","file"]},filePath:{type:"string"},default:{type:"boolean",default:!1},font:{type:"object"}}});var Eo,Dc,vy=_(()=>{Eo={imgly_font_bernier_regular:"imgly_font_sancreek",imgly_font_cheque_regular:"imgly_font_kumar_one_outline",imgly_font_gagalin_regular:"imgly_font_permanent_marker",imgly_font_hagin_caps_thin:"imgly_font_nixie_one",imgly_font_intro_inline:"imgly_font_bungee_inline",imgly_font_nexa_script:"imgly_font_molle",imgly_font_panton_blackitalic_caps:"imgly_font_roboto_black_italic",imgly_font_panton_lightitalic_caps:"imgly_font_roboto_light_italic",imgly_font_perfograma:"imgly_font_codystar",imgly_font_panton_black_caps:"imgly_font_roboto_black",imgly_font_panton_light_caps:"imgly_font_roboto_light",imgly_font_summer_font_light:"imgly_font_sue_ellen_francisco"},Dc=(o,e=!1)=>Eo[o]?(e&&console.warn(`Font ${o} was deprecated. Please use ${Eo[o]} instead.`),Eo[o]):o});var ht,fr=_(()=>{fe();by();Bc();ut();vy();ht=class{constructor(e,t){this._ui=e,this._options=t,this._fonts=[],this._variationsByIdentifier={},this._fontsByFontFamily={},this._initFonts()}_initFonts(){let{fonts:e,replaceFonts:t,availableVariations:i,isTextDesign:r}=this._options,s=!0;e&&s&&e.forEach(({variations:l},h)=>{l&&l.forEach((c,m)=>{if(Eo[c.identifier]){let d=Dc(c.identifier,!0);e[h].variations[m].identifier=d;let{fontFamily:u}=Be.DEFAULTS.FONTS.find(f=>f.variations.some(y=>y.identifier===d));e[h].fontFamily=u}})});let n=r?Be.DEFAULTS.TEXT_DESIGN_FONTS:Be.DEFAULTS.FONTS;s&&(t?n=e:n=n.concat(e||[]));let a;n=n.map(l=>{let{fontFamily:h}=l,{variations:c}=l;if(s&&i&&(c=c.filter(d=>i.indexOf(d.identifier)!==-1)),c.length===0)return null;let m=new Fo({fontFamily:h});return c=c.map(d=>{let u=new mr(d);return u.setFontFamily(h),u.setFont(m),d.default&&!a&&(a=u),u.getTextMetrics()==null&&I.warn(`Missing font metrics for ${u.getIdentifier()}. The SDK will fall back to basic font rendering, which may lead to layout issues. Please provide font metrics for your custom fonts. See https://docs.photoeditorsdk.com/guides/html5/ for more details.`),this._variationsByIdentifier[u.getIdentifier()]=u,u}),m.setVariations(c),this._fontsByFontFamily[h]=m,m}).filter(l=>l),a||([a]=n[0].getVariations()),this._defaultVariation=a,this._fonts=n}getFonts(){return this._fonts}getFontByFontFamily(e){return this._fontsByFontFamily[e]}getVariationByIdentifier(e){return this._variationsByIdentifier[Dc(e)]}getVariationsByIdentifier(){return C({},this._variationsByIdentifier)}getDefaultVariation(){return this._defaultVariation}}});var W1,V1,Io,Ry=_(()=>{Bc();W1=30,V1="abcdefghijklmnopqrstuvwxzy",Io=class{constructor(e){this._fontVariation=e||new mr({fontFamily:"Times New Roman",fontWeight:"normal",fontStyle:"normal"}),this._createRuler()}_createRuler(){this._ruler=document.createElement("div"),this._ruler.innerText=V1,document.body.appendChild(this._ruler),this._setRulerStyle()}_setRulerStyle(){this._ruler.style.cssText=`
      position: absolute;
      top: -9999px;
      left: -9999px;
      opacity: 0;
      display: inline-block;
      font: ${this._fontVariation.getFontStyle()} ${this._fontVariation.getFontWeight()} ${W1}px ${this._fontVariation.getFontFamily()};
    `}setFontVariation(e){this._fontVariation=e,this._setRulerStyle()}getWidth(){return this._ruler?this._ruler.offsetWidth:-1}dispose(){this._ruler&&(this._ruler.parentNode.removeChild(this._ruler),this._ruler=null)}}});var Cy,H1,j1,Fa,ky=_(()=>{Ry();Cy=typeof window!="undefined"&&window.performance&&window.performance.now?window.performance.now.bind(window.performance):ss(),H1=50,j1=5e3,Fa=class{constructor(e){this._fontVariation=e,this._defaultFontRuler=new Io,this._customFontRuler=new Io(this._fontVariation)}observe(){let e=Cy();return new Promise((t,i)=>{let r=window.setInterval(()=>{if(this._defaultFontRuler.getWidth()!==this._customFontRuler.getWidth())return window.clearInterval(r),t();if(Cy()-e>=j1){let n=new Error(`Failed to load font ${this._fontVariation.getFontFamily()}.`);return n.font=this._fontVariation,i(n)}},H1)})}dispose(){this._defaultFontRuler.dispose(),this._customFontRuler.dispose()}}});var Ds,Lc=_(()=>{yt();ky();Ds=class{constructor(e){this._ui=e,this._fonts=[],this._observers=[]}add(e){this._fonts.push(e)}load(){return this._fonts.length===0?Promise.resolve():(this._observers=[],this._fonts.forEach(e=>{this._observers.push(new Fa(e))}),k.executePromises(this._observers.map(e=>e.observe())))}dispose(){this._observers.forEach(e=>e.dispose())}}});var Ea,Sy=_(()=>{Lc();Ea=class extends Ds{load(){return Promise.resolve()}}});var q1,Ia,Oy=_(()=>{Lc();q1={italic:"i"},Ia=class extends Ds{load(){return this._fonts.length&&this._addStylesheetTag(),super.load()}_addStylesheetTag(){let e=this._getFamiliesString(),t=document.createElement("link");t.rel="stylesheet",t.href=`https://fonts.googleapis.com/css?family=${e}`,document.getElementsByTagName("head")[0].appendChild(t)}_getFamiliesString(){let e={};this._fonts.forEach(i=>{let r=i.getFontFamily(),s=i.getFontStyle(),n=i.getFontWeight();e[r]=e[r]||[],typeof n!="undefined"?e[r].push(`${n}${q1[s]||""}`):e[r].push(400)});let t=[];for(let i in e){let r=e[i],s=r.length?`:${r.join(",")}`:"",n=i.replace(" ","+")+s;t.push(n)}return t.join("|")}}});var Ps,zc=_(()=>{Sy();Oy();Ps=class{constructor(e,t){this._ui=e,this._fonts=t,this._loadedFonts=[]}setFonts(e){this._fonts=e}needsToLoad(){for(let e=0;e<this._fonts.length;e++){let t;if(this._fonts[e].getVariations().forEach(i=>{t=t||i.getProvider()}),!!t)return!0}}fontLoaded(e){let t=e.getFontFamily();return this._loadedFonts.indexOf(t)!==-1}setFontLoaded(e){if(!this.fontLoaded(e)){let t=e.getFontFamily();this._loadedFonts.push(t)}}load(){let e=this._fonts,t={google:new Ia(this._ui),file:new Ea(this._ui)},i=()=>{for(let s in t)t[s].dispose()};e.filter(s=>!this.fontLoaded(s)).forEach(s=>{s.getVariations().forEach(n=>{let a=n.getProvider();if(!a)return;t[a].add(n)})});let r=[];for(let s in t)r.push(t[s].load());return Promise.all(r).then(()=>{i(),e.forEach(s=>{this.setFontLoaded(s)})}).catch(s=>{throw i(),s})}}});var Ma,Fy=_(()=>{fe();Ma=class{constructor(e,t){this._ui=e,this._options=t,this._brushes=[],this._brushesById={},this._addBrushes(Be.DEFAULTS.BRUSHES);let{brushes:i,replaceBrushes:r,availableBrushes:s}=this._options;this._options.brushes&&this._addBrushes(i,r),s&&(this._brushes=this._brushes.filter(n=>s.indexOf(n.identifier)!==-1))}_addBrushes(e,t){t&&(this._brushes=[],this._brushesById={}),e.forEach(i=>{this._brushes.push(i),this._brushesById[i.identifier]=i})}getBrushByIdentifier(e){return this._brushesById[e]}getBrushes(){return this._brushes}getFirstBrush(){return this._brushes[0]}}});var As,Mo,Ey=_(()=>{fe();As=class{constructor(e,t,i=!1){this._ui=e,this._options=t,this._categoriesById={},this._filtersByIdentifier={identity:Z.Operations.FilterOperation.Filters.IdentityFilter},this._categories=lt.wrapFiltersInCategories(Lt.DEFAULTS.FILTERS.slice(0),As.CATEGORY_ITEMS_PROPERTY),this._customAssetsAllowed=i||e.getEditor().getSDK()._l.areCustomAssetsAllowed(),this._customAssetsAllowed&&this._options.categories&&(this._options.categories=lt.wrapFiltersInCategories(this._options.categories,As.CATEGORY_ITEMS_PROPERTY)),this._initCategories()}instantiateFilterWithIdentifier(e){let t={value:this._ui._options.crossOrigin,cors:!0},i=this.getFilterByIdentifier(e);if(!i)return Promise.reject(new Error(`Unknown filter with identifier \`${e}\`!`));if(!(i.prototype instanceof Z.Operations.FilterOperation.Filter)){let{lutImage:r,resolution:s,horizontalTileCount:n,verticalTileCount:a}=i,{lightColor:l,darkColor:h}=i;if(l&&h)return l=le.fromHex(l),h=le.fromHex(h),Promise.resolve(new Z.Operations.FilterOperation.Filters.DuoToneFilter({lightColor:l,darkColor:h}));let c;this._ui.getPreloader&&(c=this._ui.getPreloader().getAsset(r));let m;return c?m=Promise.resolve(c):m=Ue.loadImage(this._ui.getAssetPath(r),t),m.then(()=>Ue.loadImage(this._ui.getAssetPath(r),t).then(d=>new Z.Operations.FilterOperation.Filters.ThreeDLUTFilter({image:d,resolution:s,horizontalTileCount:n,verticalTileCount:a})))}return Promise.resolve(new i)}_initCategories(){if(this._customAssetsAllowed&&this._options.categories&&(this._options.replaceCategories?this._categories=lt.wrapFiltersInCategories(this._options.categories,As.CATEGORY_ITEMS_PROPERTY):this._categories=lt.mergeCategories(this._categories,this._options.categories,As.CATEGORY_ITEMS_PROPERTY)),this._customAssetsAllowed&&this._options.availableFilters){let t=[];this._categories.forEach(i=>{let r=i.filters.filter(s=>this._options.availableFilters.indexOf(s.identifier)!==-1);r.length>0&&t.push({identifier:i.identifier,defaultName:i.defaultName,filters:r})}),this._categories=t}let e={identifier:"all",defaultName:"All",visible:!1,filters:this._categories.length<=0?[]:this._categories.map(t=>t.filters).reduce((t,i)=>t.concat(i))};this._categories.unshift(e),this._categoriesById.all=e,this._categories.forEach(t=>{this._categoriesById[t.identifier]=t}),e.filters.forEach(t=>{this._filtersByIdentifier[t.identifier]=t})}getFiltersForCategory(e){if(!this._categoriesById[e])throw new Error(`Unknown filter category '${e}'`);return this._categoriesById[e].filters}getItemsByCategory(e){return this.getFiltersForCategory(e)}getFilterByIdentifier(e){return this._filtersByIdentifier[e]}getCategories(){return this._categories}getCategoryByIdentifier(e){return this._categoriesById[e]}},Mo=As;M(Mo,"CATEGORY_ITEMS_PROPERTY","filters")});var Nc,Mi,Ba=_(()=>{fe();yt();Mc();as();Ni();Nc="imgly_sticker_custom",Mi=class{constructor(e,t,i){this._ui=e,this._options=t,this._dynamicAssetsLibrary=i||this._ui.getEditor().getDynamicAssetsLibrary()||new wa,this._categoriesById={},this._categories=[],this._stickersById={},this._customStickerCanvas=k.createCanvas(),this.reload()}reload(){this._categoriesById={},this._categories=[],this._stickersById={};let e=this._ui.getEditor().getSDK()._l.areCustomAssetsAllowed();this._addCategories(Lt.DEFAULTS.STICKER_CATEGORIES);let{categories:t,replaceCategories:i}=this._options;if(e&&this._options.categories?this._addCategories(t,i):(this._updateCategoriesMap(),this._updateAllCategory()),e){let r=this._dynamicAssetsLibrary.getAssets("sticker");if(r.length>0){let s=this._createCustomStickerCategory(r);this._addCategories([s],!1,!0)}}}loadExternal(e){return new dt(e).load().then(i=>{this._addCategories(i.categories,this._options.replaceCategories)})}_addCategories(e,t=!1,i=!1){t?this._categories=e.slice(0):i?this._categories=this._mergeCategories(e,this._categories):this._categories=this._mergeCategories(this._categories,e),this._updateCategoriesMap(),this._updateAllCategory()}_mergeCategories(e,t){e=lt.cloneCategories(e,"stickers");for(let i of t){let r=!1;for(let s of e)if(i.identifier===s.identifier){for(let n of i.stickers){let a=!1;for(let l of s.stickers)if(n.identifier===l.identifier){Object.assign(l,n),a=!0;break}a||s.stickers.push(n)}r=!0;break}r||e.push(i)}return e}_updateCategoriesMap(){this._categoriesById={},this._categories.forEach(e=>{this._categoriesById[e.identifier]=e}),this._categories.forEach(e=>{e.stickers.forEach(t=>{this._stickersById[t.identifier]=t})}),typeof this._options.availableStickers!="undefined"&&this._options.availableStickers!==null&&(this._categories.forEach(e=>{e.identifier!==Nc&&(e.stickers=e.stickers.filter(t=>this._options.availableStickers.indexOf(t.identifier)!==-1))}),this._categories=this._categories.filter(e=>e.stickers.length>0)),this._updateAllCategory()}_updateAllCategory(){this._allCategory={identifier:"all",defaultName:"All",stickers:this._categories.map(e=>e.stickers).reduce((e,t)=>e.concat(t),[])},this._categoriesById.all=this._allCategory}renderStickerThumbnailFromImage(e){let t=this._customStickerCanvas,i=t.getContext("2d");i.save();let r=62,s=r/e.width,n=s*e.height;t.width=r,t.height=r,i.clearRect(0,0,e.width,e.height),i.translate(0,.5*(t.height-n)),i.scale(s,s),i.drawImage(e,0,0);let a=t.toDataURL("image/png");return i.restore(),{data:a,width:r,height:n}}addCustomStickerFromImage(e,t,i="none"){let r=p=>{let x=this._ui.getEditor().getSDK().getRenderer(),T=new ee(p.width,p.height),D=this._ui.getEditor().getMaxMegapixels()*1e6,b=x.getMaxDimensions(),w=T.x*T.y>D,G=b!==null&&(T.x>b||T.y>b);if(w){let j=p.width/p.height,K=p.height/p.width;b=new ee(Math.sqrt(D*j),Math.sqrt(D*K)).floor().max()}let N=T.clone();return(w||G)&&(T.x/T.y>1?(N.x=b,N.y=b/T.x*T.y):(N.x=b/T.y*T.x,N.y=b)),N},s=(p,v)=>{let x=p.x/p.y;return x>1?new ee(v,v/x):new ee(v*x,v)},n=e.src.substring(0,14)==="data:image/svg";e=this._ui.getEditor().getSDK().correctExifOrientation(e);let l=s(new ee(e.width,e.height),2048),h=n?l:r(e),c=this._customStickerCanvas,m=c.getContext("2d");m.save();let d=this.renderStickerThumbnailFromImage(e);n?(e.width>e.height?(c.width=2048,c.height=2048/e.width*e.height):(c.height=2048,c.width=2048/e.height*e.width),e.width=c.width,e.height=c.height):(c.width=h.x,c.height=h.y,m.scale(h.x/e.width,h.y/e.height)),m.drawImage(e,0,0,e.width,e.height);let u=c.toDataURL();m.restore();let f={identifier:k.generateUUID(),defaultName:t||"",tintMode:i,images:{mediaThumb:{uris:[d.data],rawData:!0,width:d.width,height:d.height},mediaBase:{uris:n?[u,e.src]:[u],rawData:!0,isSVG:n,width:h.x,height:h.y}}},y=this._dynamicAssetsLibrary;y.addAsset("sticker",f,!0);let g=y.getAssets("sticker");if(g.length===1){let p=this._createCustomStickerCategory(g);this._addCategories([p],!1,!0)}else this.getCategory(Nc).stickers=g,this._updateAllCategory();this._updateCategoriesMap()}_createCustomStickerCategory(e){return{identifier:Nc,defaultName:"Custom",metaData:{backgroundImage:e[e.length-1].images.mediaBase.uris[0],rawData:!0},stickers:e}}getStickersForCategory(e){if(!this._categoriesById[e])throw new Error(`Unknown sticker category '${e}'`);return this._categoriesById[e].stickers}getStickerByIdentifier(e){return this._stickersById[e]}getCategories(e=!1){return e?[this._allCategory].concat(this._categories):this._categories}getCategory(e){return this._categoriesById[e]}static getURLForSticker(e,t="base"){let{images:i}=e,r=t==="base"&&i.mediaBase||i.mediaThumb,s=r.uris||[r.uri],n=s.filter(a=>!/\.svg$/i.test(a));return n.length?n[0]:s[0]}}});var Iy,Uc,_r,Gc=_(()=>{fe();zc();Fy();Ey();fr();Ba();Iy=Ws(require("p-map"));typeof Z.Operations.SpriteOperation!="undefined"&&(Uc=Z.Operations.SpriteOperation.BrushSprite);_r=class{constructor(e,t){this._editor=e,this._ui=this._editor.getUI(),this._data=t,this._filterManager=new Mo(this._ui,this._getOptions("filter")),this._stickerManager=new Mi(this._ui,this._getOptions("sticker")),this._brushManager=new Ma(this._ui,this._getOptions("brush")),this._fontManager=new ht(this._ui,this._getOptions("text"))}_getOptions(e){let{controls:t}=this._editor,i={};t&&t.get(e)&&(i=t.get(e).defaultOptions);let r=this._editor.getOptions();return Ee.deepDefaults({},r.editor.controlsOptions[e]||{},i)}deserialize(){return this._validateVersion().then(()=>this._deserializeInputImage()).then(()=>this._deserializeOperations())}_validateVersion(){return this._data.version!==this.constructor.version?Promise.reject(new Error(`Invalid version ${this._data.version}, expected ${this.constructor.version}`)):Promise.resolve()}_deserializeInputImage(){return new Promise((e,t)=>{let{data:i,type:r}=this._data.inputImage;if(i&&r){let s=new window.Image;s.addEventListener("load",()=>{this._editor.setImage(s),e()}),s.src=`data:${r};base64,${i}`}else e()})}_deserializeOperations(){return Gr(this,null,function*(){let{operations:e}=this._data;return(0,Iy.default)(e,t=>Gr(this,null,function*(){return this._deserializeOperation(t)}))})}_deserializeOperation(e){switch(e.type){case"crop":return this._deserializeCropOperation(e);case"orientation":return this._deserializeOrientationOperation(e);case"filter":return this._deserializeFilterOperation(e);case"adjustments":return this._deserializeAdjustmentsOperation(e);case"sprite":return this._deserializeSpriteOperation(e);case"focus":return this._deserializeFocusOperation(e)}}_deserializeCropOperation(e){let{options:t}=e,{rotation:i}=t,r=ee.fromObject(t.start),s=ee.fromObject(t.end);i>Math.PI&&(i-=Math.PI*2);let n={start:r,end:s};typeof i!="undefined"&&(n.rotation=i);let a=this._editor.operations.getOrCreate("transform");return this._editor.broadcastTransform(a,n),a.set(n),Promise.resolve(a)}_deserializeOrientationOperation(e){let{options:t}=e,i=this._editor.operations.getOrCreate("orientation");return i?(i.set(t),Promise.resolve(i)):Promise.resolve()}_deserializeFilterOperation(e){let{options:t}=e;return this._filterManager.getFilterByIdentifier(t.name)?this._filterManager.instantiateFilterWithIdentifier(t.name).then(i=>{let r=this._editor.operations.getOrCreate("filter");return r.set({identifier:t.name,filter:i,intensity:t.intensity}),r}):(I.warn("Deserializer",`Unknown filter \`${t.name}\``),Promise.resolve())}_deserializeAdjustmentsOperation(e){let{AdjustmentsOperation:t}=Z.Operations,{options:i}=e,r=["brightness","saturation","contrast","exposure","shadows","highlights","clarity"],s={};return r.forEach(n=>{if(typeof i[n]=="undefined")return;let{minValue:a,midValue:l,maxValue:h}=t.prototype.availableOptions[n],c=i[n];c=c<0?l+(l-a)*c:l+(h-l)*c,s[n]=c}),Promise.resolve(this._editor.operations.getOrCreate("adjustments",s))}_deserializeSpriteOperation(e){let{options:t}=e,i=this._editor.operations.getOrCreate("sprite");if(!i)return Promise.resolve();let r=t.sprites.map(s=>this._deserializeSprite(i,s)).filter(s=>s);return Promise.all(r).then(s=>(i.setSprites(s.filter(n=>n)),i))}_deserializeSprite(e,t){switch(t.type){case"sticker":return this._deserializeSticker(e,t);case"text":return this._deserializeText(e,t);case"brush":return this._deserializeBrush(e,t);case"textdesign":return this._deserializeTextDesign&&this._deserializeTextDesign(e,t)}}_deserializeSticker(e,t){let{SpriteOperation:i}=Z.Operations,{options:r}=t,s=this._stickerManager.getStickerByIdentifier(r.name),n=this._stickerManager.getURLForSticker(s);return s?new Promise((a,l)=>{let h=new window.Image;h.addEventListener("load",()=>{let c=i.StickerSprite.prototype.availableOptions.adjustments.structure,{rotation:m,flipHorizontally:d,flipVertically:u}=r,f={identifier:r.name,image:h,position:ee.fromObject(r.position),dimensions:ee.fromObject(r.dimensions),rotation:m,flipHorizontally:d,flipVertically:u,adjustments:{}};typeof r.adjustments!="undefined"&&["brightness","contrast","saturation"].forEach(y=>{typeof r.adjustments[y]!="undefined"&&(f.adjustments[y]=r.adjustments[y]+c[y].default)}),a(e.createSticker(f))}),h.crossOrigin=this._editor.getCrossOrigin(),h.src=this._editor.getUI().getAssetPath(n)}):(I.warn("Deserializer",`Unknown sticker '${r.name}'. Skipping sprite.`),Promise.resolve())}_deserializeText(e,t){let{options:i}=t,{fontSize:r,lineHeight:s,fontFamily:n,fontWeight:a,alignment:l,rotation:h,maxWidth:c,color:m,backgroundColor:d}=i,u=new Ps(this._ui),f=this._fontManager.getFontByFontFamily(n);return f||(f=this._fontManager.getDefaultFont()),u.setFonts([f]),u.load().then(()=>{let y=e.createText({fontSize:r,lineHeight:s,fontFamily:n,fontWeight:a,alignment:l,rotation:h,maxWidth:c,text:i.text,color:le.fromArray(m),backgroundColor:le.fromArray(d),position:ee.fromObject(i.position)});return y._edited=!0,y})}_deserializeBrush(e,t){let{options:i}=t,{paths:r}=i,s=e.createBrush();return r.forEach(n=>{this._deserializeBrushPath(s,n)}),Promise.resolve(s)}_deserializeBrushPath(e,t){let{points:i}=t,r=this._createBrushForPath(t),s=e.createPath(r);s.setClosed(!0),i.forEach(n=>{s.addControlPoint(ee.fromObject(n))})}_createBrushForPath(e){let{color:t,size:i}=e,s={color:le.fromArray(t),size:i},n=this._brushManager.getFirstBrush();if(n.prototype&&n.prototype instanceof Uc){let h=n;return new h(s)}let a=C({},n);delete a.image;class l extends Uc{}return l.identifier=n.identifier,new l(C(C({},a),s))}_deserializeFocusOperation(e){let{options:t}=e.options;switch(e.options.type){case"radial":{let{position:i,radius:r,gradientRadius:s,blurRadius:n}=t;return Promise.resolve(this._editor.operations.getOrCreate("radial-focus",{position:ee.fromObject(i),radius:r,gradientRadius:s,blurRadius:n}))}case"linear":{let{start:i,end:r,size:s,gradientSize:n,blurRadius:a}=t;return Promise.resolve(this._editor.operations.getOrCreate("mirrored-focus",{start:ee.fromObject(i),end:ee.fromObject(r),size:s,gradientSize:n,blurRadius:a}))}}}_getInputDimensionsForOperation(e){let t=!1,i=this._editor.getInputDimensions();return this._editor.operations.getStack().forEach(r=>{r===e&&(t=!0),!t&&(i=r.getNewDimensions(i))}),i}};_r.version="1.0.0"});var Ls,gr,Wc=_(()=>{fe();Ls=Math.PI*2,gr=class{constructor(e){this._editor=e,this._serializeOperations=this._serializeOperations.bind(this)}serialize(e={}){this._options=L(C({},e),{image:!0});let t={version:this.constructor.version};return this._serializeInputImage(t).then(this._serializeOperations)}_serializeInputImage(e){let t=this._editor.getImage(),{width:i,height:r}=t;if(!this._options.image)return e.inputImage={width:i,height:r},Promise.resolve(e);let s=Ee.createCanvas();s.width=t.width,s.height=t.height,s.getContext("2d").drawImage(t,0,0);let a=s.toDataURL(Ic.PNG);return e.inputImage={type:Ic.PNG,data:a.replace(/^data:image\/(.*?);base64,/,""),width:i,height:r},Promise.resolve(e)}_serializeOperations(e){let t=[];return this._editor.operations.getStack().forEach(r=>{let s=this._serializeOperation(r,t);s&&t.push(s)}),e.operations=t.filter(r=>r),Promise.resolve(e)}_serializeOperation(e,t){switch(e.constructor.identifier){case"transform":return this._serializeTransformOperation(e);case"orientation":return this._serializeOrientationOperation(e);case"filter":return this._serializeFilterOperation(e);case"adjustments":return this._serializeAdjustmentsOperation(e);case"sprite":return this._serializeSpriteOperation(e,t);case"radial-focus":return this._serializeRadialFocusOperation(e);case"mirrored-focus":return this._serializeLinearFocusOperation(e);default:I.warn(`Unable to serialize operation of type ${e.constructor.identifier}`)}}_serializeTransformOperation(e){let t=e.serializeOptions(["start","end","rotation"],!0);return t.rotation=(t.rotation+Ls)%Ls,{type:"crop",options:t}}_serializeOrientationOperation(e){return{type:"orientation",options:e.serializeOptions(["flipVertically","flipHorizontally","rotation"],!0)}}_serializeFilterOperation(e){return e.getIdentifier()==="identity"?null:{type:"filter",options:{intensity:e.getIntensity(),name:e.getIdentifier()}}}_serializeAdjustmentsOperation(e){let{availableOptions:t}=e,i=["brightness","saturation","contrast","exposure","shadows","highlights","clarity"],r={};return i.forEach(s=>{let n=t[s],a=e.getOption(s),{minValue:l,midValue:h,maxValue:c}=n;r[s]=a<=h?(a-l)/(h-l)-1:(a-h)/(c-h)}),{type:"adjustments",options:r}}_serializeSpriteOperation(e,t){let i=t.filter(n=>n.type==="sprite"),r,s=!0;if(i.length?(r=i.pop(),s=!1):r={type:"sprite",options:{sprites:[]}},e.getSprites().forEach(n=>{let a=null;n instanceof e.constructor.StickerSprite?a=this._serializeSticker(e,n):n instanceof e.constructor.TextSprite?a=this._serializeText(e,n):n instanceof e.constructor.BrushSprite?a=this._serializeBrush(e,n):n instanceof e.constructor.TextDesignSprite&&(a=this._serializeTextDesign&&this._serializeTextDesign(e,n)),a&&r.options.sprites.push(a)}),s)return r}_serializeSticker(e,t){let i=t.getAdjustments(),r=t.serializeOptions(["identifier","position","dimensions","flipVertically","flipHorizontally","rotation"],!0);r.name=r.identifier,delete r.identifier,r.rotation=(r.rotation+Ls)%Ls;let s=i.availableOptions;return r.adjustments={brightness:i.getBrightness()-s.brightness.default,saturation:i.getSaturation()-s.saturation.default,contrast:i.getContrast()-s.contrast.default},{type:"sticker",options:r}}_serializeText(e,t){let i=t.serializeOptions(["fontSize","lineHeight","fontFamily","fontWeight","alignment","color","backgroundColor","position","rotation","text","maxWidth"],!0);return i.rotation=(i.rotation+Ls)%Ls,{type:"text",options:i}}_serializeBrush(e,t){return{type:"brush",options:{paths:t.getPaths().map(i=>this._serializePath(i))}}}_serializePath(e){let t=e.getBrush().serializeOptions(["color","size"],!0);return t.points=e.getControlPoints().map(i=>i.getPosition().toObject()),t}_serializeRadialFocusOperation(e){return{type:"focus",options:{type:"radial",options:e.serializeOptions(["position","radius","gradientRadius","blurRadius"],!0)}}}_serializeLinearFocusOperation(e){return{type:"focus",options:{type:"linear",options:e.serializeOptions(["start","end","blurRadius","size","gradientSize"],!0)}}}_getInputDimensionsForOperation(e){let t=!1,i=this._editor.getInputDimensions();return this._editor.operations.getStack().forEach(r=>{r===e&&(t=!0),!t&&(i=r.getNewDimensions(i))}),i}};gr.version="1.0.0"});var My={};Te(My,{default:()=>Da});var Da,By=_(()=>{Gc();Wc();Da=class{constructor(e){this._editor=e}serialize(...e){return new gr(this._editor).serialize(...e)}deserialize(e){return new _r(this._editor,e).deserialize()}};Da.version="1.0.0"});var yr,Vc=_(()=>{fe();Gc();yr=class extends _r{_deserializeOperation(e){return e.type==="selective-blur"?this._deserializeSelectiveBlurOperation(e):super._deserializeOperation(e)}_deserializeCropOperation(e){let{options:t}=e,{rotation:i}=t,r=ee.fromObject(t.start),s=ee.fromObject(t.end),n=t.dimensions?ee.fromObject(t.dimensions):null;if(s.x-r.x<=0||s.y-r.y<=0)throw new Error(`A crop should not result in negative or zero dimensions - start: ${r} - end: ${s}`);i>Math.PI&&(i-=Math.PI*2);let a={start:r,end:s};typeof i!="undefined"&&(a.rotation=i);let l=this._editor.operations.getOrCreate("transform");if(!l)return Promise.resolve();if(this._editor.broadcastTransform(l,a),l.set(a),n){let h=s.clone().subtract(r),c=l.getInputDimensions(!1).multiply(h);l.setTextureScale(n.x/c.x)}return Promise.resolve(l)}};yr.version="1.0.1"});var Dy,xr,Hc=_(()=>{Wc();Dy=Math.PI*2,xr=class extends gr{_serializeTransformOperation(e){let t=e.serializeOptions(["start","end","rotation","textureScale"],!0);return t.rotation=(t.rotation+Dy)%Dy,t.textureScale!==1&&(t.dimensions=e.getNewDimensions(e.getInputDimensions(!1))),delete t.textureScale,{type:"crop",options:t}}};xr.version="1.0.1"});var Py={};Te(Py,{default:()=>Pa});var Pa,Ay=_(()=>{Vc();Hc();Pa=class{constructor(e){this._editor=e}serialize(...e){return new xr(this._editor).serialize(...e)}deserialize(e){return new yr(this._editor,e).deserialize()}};Pa.version="1.0.1"});var zs,Bo,Ly=_(()=>{Li();fe();({OptionType:zs}=Z),Bo=class extends Z.Configurable{constructor(e,t={}){super(t);this._loaded=!1,this._loading=!1,this._ui=e,this._frame=Z.Utils.deepClone(this._options)}load(){if(this._loaded)return Promise.resolve();if(this._loading)return Promise.reject(new Error("Called Frame#load while it's already loading"));this._loading=!0;let{imageGroups:e}=this._frame,t=[];return["top","left","right","bottom"].forEach(i=>{if(!(i in e))return;let r=e[i];["start","mid","end"].forEach(s=>{s in r&&t.push(this._loadPart(i,s))})}),Promise.all(t).then(()=>{this._loaded=!0,this._loading=!1}).catch(i=>{this._loaded=!1,this._loading=!1})}_loadPart(e,t){let{imageGroups:i}=this._frame,r=i[e][t],s=r;return typeof r!="string"&&"image"in r&&(s=r.image),Ue.load(this._ui.getAssetPath(s)).then(n=>(typeof r!="string"?this._frame.imageGroups[e][t].image=n:this._frame.imageGroups[e][t]=n,n))}getFrame(){return this._frame}};Bo.prototype.availableOptions={identifier:{type:zs.STRING,required:!0},defaultName:{type:zs.STRING},thumbnail:{type:zs.STRING},tintable:{type:zs.BOOLEAN,default:!1},layoutMode:{type:zs.STRING,default:"horizontal-inside",available:["horizontal-inside","vertical-inside"]},imageGroups:{type:zs.OBJECT,required:!0}}});var Aa,zy=_(()=>{fe();Aa=class{constructor(e,t){this._ui=e,this._options=t,this._categoriesById={},this._categories=[],this._framesById={},this._addCategories(Lt.DEFAULTS.FRAME_CATEGORIES),this._customAssetsAllowed=e.getEditor().getSDK()._l.areCustomAssetsAllowed();let{categories:i,replaceCategories:r}=this._options;this._customAssetsAllowed&&this._options.categories?this._addCategories(i,r):this._updateAllCategory()}_addCategories(e,t=!1){t?this._categories=e.slice(0):this._categories=lt.mergeCategories(this._categories,e,"frames"),this._categoriesById={},this._categories.forEach(r=>{this._categoriesById[r.identifier]=r});let{availableFrames:i}=this._options;this._customAssetsAllowed&&i&&this._categories.forEach(r=>{r.frames=r.frames.filter(s=>i.indexOf(s.identifier)!==-1)}),this._categories.forEach(r=>{r.frames.forEach(s=>{this._framesById[s.identifier]=s})}),this._updateAllCategory()}_updateAllCategory(){this._allCategory={identifier:"all",defaultName:"All",frames:this._categories.map(e=>e.frames).reduce((e,t)=>e.concat(t),[])},this._categoriesById.all=this._allCategory}getFramesForCategory(e){if(!this._categoriesById[e])throw new Error(`Unknown frame category '${e}'`);return this._categoriesById[e].frames}getFrameByIdentifier(e){return this._framesById[e]}getCategories(){return this._categories}getCategory(e){return this._categoriesById[e]}}});var La,Ny=_(()=>{fe();La=class{constructor(e,t){this._ui=e,this._options=t,this._overlays=Lt.DEFAULTS.OVERLAYS.slice(0),this._overlaysByIdentifier={};let i=e.getEditor().getSDK()._l.areCustomAssetsAllowed();i&&t.overlays&&(t.replaceOverlays?this._overlays=t.overlays:this._overlays=this._overlays.concat(t.overlays)),i&&t.availableOverlays&&(this._overlays=this._overlays.filter(r=>t.availableOverlays.indexOf(r.identifier)!==-1)),this._overlays.forEach(r=>{this._overlaysByIdentifier[r.identifier]=r})}getOverlays(){return this._overlays}getOverlayByIdentifier(e){return this._overlaysByIdentifier[e]}}});var li,Ns,za=_(()=>{fe();({OverlayFilter:li}=Z.Engine.Filters),Ns={[li.BLEND_MODES.NORMAL]:"normal",[li.BLEND_MODES.OVERLAY]:"overlay",[li.BLEND_MODES.HARD_LIGHT]:"hard light",[li.BLEND_MODES.SOFT_LIGHT]:"soft light",[li.BLEND_MODES.MULTIPLY]:"multiply",[li.BLEND_MODES.DARKEN]:"darken",[li.BLEND_MODES.LIGHTEN]:"lighten",[li.BLEND_MODES.SCREEN]:"screen",[li.BLEND_MODES.COLOR_BURN]:"color burn"}});var X1,br,jc=_(()=>{fe();zc();Ly();Li();zy();Ny();Ba();Vc();za();X1=Ee.flipObject(Ns),br=class extends yr{constructor(...e){super(...e);this._frameManager=new Aa(this._ui,this._getOptions("frame"));let t=this._getOptions("overlay");t&&(this._overlayManager=new La(this._ui,t))}_deserializeSprite(e,t){return t.type==="frame"?this._deserializeFrame(e,t):t.type==="overlay"?this._deserializeOverlay(e,t):super._deserializeSprite(e,t)}_deserializeOperation(e){return e.type==="transform"?this._deserializeTransformOperation(e):super._deserializeOperation(e)}_deserializeOrientationOperation(e){if(this._data.meta&&this._data.meta.platform!=="html5")return super._deserializeOrientationOperation(e);let{rotation:t,flipHorizontally:i,flipVertically:r}=e.options,s=t===90&&!i&&!r;return s|=t===90&&i&&r,s|=t===270&&!i&&!r,s|=t===270&&i&&r,s&&(e.options.flipHorizontally=!e.options.flipHorizontally,e.options.flipVertically=!e.options.flipVertically),super._deserializeOrientationOperation(e)}_deserializeTransformOperation(e){return super._deserializeCropOperation(e).then(t=>{if(!t)return;let i=Ee.Array.find(this._data.operations,r=>r.type==="orientation");if(i){let{options:r}=i,{rotation:s,flipHorizontally:n,flipVertically:a}=r;(s===90||s===270)&&(!n&&a||n&&!a)&&(n=!n,a=!a),t.rotate(r.rotation),n&&(t.flip("horizontal"),t.setRotation(t.getRotation()*-1)),a&&(t.flip("vertical"),t.setRotation(t.getRotation()*-1))}return t})}_deserializeFrame(e,t){let{identifier:i}=t.options,r=this._frameManager.getFrameByIdentifier(i);if(!r)return I.warn("Deserializer",`Unknown frame \`${i}\`. Skipping frame.`),Promise.resolve();let s=new Bo(this._ui,r);return s.load().then(()=>{this._editor.operations.getOrCreate("frame",{frame:s.getFrame()})})}_deserializeOverlay(e,t){let{blendMode:i,intensity:r,identifier:s}=t.options,n=this._overlayManager.getOverlayByIdentifier(s);if(!n)return I.warn("Deserializer",`Unknown overlay \`${s}\`. Skipping overlay.`),Promise.resolve();let a=this._editor.getUI().getAssetPath(n.image);return Ue.load(a).then(l=>{this._editor.operations.getOrCreate("overlay",{alpha:r,identifier:s,blendMode:parseInt(X1[i||n.blendMode],10),image:l})})}_createBrushForPath(e){let t=super._createBrushForPath(e);return typeof e.hardness!="undefined"&&t.hasOption("hardness")&&t.setHardness(e.hardness),t}_deserializeSticker(e,t){let{SpriteOperation:i}=Z.Operations,{options:r}=t,s=this._stickerManager.getStickerByIdentifier(r.identifier),n=Mi.getURLForSticker(s,"base");if(!s)return I.warn("Deserializer",`Unknown sticker \`${r.identifier}\`. Skipping sprite.`),Promise.resolve();let a=e.getInputDimensions(!1);return new Promise((l,h)=>{let c=new window.Image;c.addEventListener("load",()=>{let m=i.StickerSprite.prototype.availableOptions.adjustments.structure,{rotation:d,flipHorizontally:u,flipVertically:f}=r,y={identifier:r.identifier,image:c,position:ee.fromObject(r.position),dimensions:ee.fromObject(r.dimensions).multiply(a.min()),rotation:d,flipHorizontally:u,flipVertically:f,adjustments:{}};typeof r.adjustments!="undefined"&&["brightness","contrast","saturation"].forEach(g=>{typeof r.adjustments[g]!="undefined"&&(y.adjustments[g]=r.adjustments[g]+m[g].default)}),typeof r.tintColor!="undefined"&&typeof s.tintMode!="undefined"&&(y.tintColor=le.fromArray(r.tintColor),y.tintMode=s.tintMode),l(e.createSticker(y))}),c.crossOrigin=this._editor.getCrossOrigin(),c.src=this._editor.getUI().getAssetPath(n)})}_deserializeFilterOperation(e){let{options:t}=e;return this._filterManager.getFilterByIdentifier(t.identifier)?this._filterManager.instantiateFilterWithIdentifier(t.identifier).then(i=>{let r=this._editor.operations.getOrCreate("filter");if(!!r)return r.set({identifier:t.identifier,filter:i,intensity:t.intensity}),r}):(I.warn("Deserializer",`Unknown filter \`${t.identifier}\``),Promise.resolve())}_deserializeFocusOperation(e){let{options:t,type:i}=e.options;if(i!=="radial")return super._deserializeFocusOperation(e);let r=this._editor.getImage(),s=r.width/r.height,{start:n,end:a,gradientRadius:l,blurRadius:h}=t,c=ee.fromObject(a).subtract(ee.fromObject(n)).multiply(s,1).len();return Promise.resolve(this._editor.operations.getOrCreate("radial-focus",{position:ee.fromObject(n),radius:c,gradientRadius:l,blurRadius:h}))}_deserializeText(e,t){let{options:i}=t,{fontSize:r,lineHeight:s,fontIdentifier:n,alignment:a,rotation:l,maxWidth:h,color:c,backgroundColor:m}=i,d=new Ps(this._ui),u=this._fontManager.getVariationByIdentifier(n);return u?d.setFonts([u.getFont()]):u=this._fontManager.getDefaultFont(),d.load().then(()=>{let f=e.getInputDimensions(!1),y=h*f.min()/f.x,g=e.createText({fontSize:r,lineHeight:s,fontFamily:u.getFontFamily(),fontWeight:u.getFontWeight(),fontIdentifier:u.getIdentifier(),alignment:a,rotation:l,maxWidth:y,text:i.text,color:le.fromArray(c),backgroundColor:le.fromArray(m),position:ee.fromObject(i.position)});return g._edited=!0,g})}};br.version="2.0.0"});var vr,qc=_(()=>{Hc();za();vr=class extends xr{_serializeSticker(e,t){let i=e.getInputDimensions(!1),r=super._serializeSticker(e,t);return t.getTintMode()!=="none"&&(r.options.tintColor=t.serializeOption("tintColor",!0)),r.options.dimensions=t.getDimensions().clone().divide(i.min()).toObject(),r.options.identifier=r.options.name,delete r.options.name,r}_serializePath(e){let t=super._serializePath(e),i=e.getBrush();return i.hasOption("hardness")&&(t.hardness=i.getOption("hardness")),t}_serializeOperation(e,t){return e.constructor.identifier==="frame"?(this._serializeFrameOperation(e,t),null):e.constructor.identifier==="overlay"?(this._serializeOverlayOperation(e,t),null):super._serializeOperation(e,t)}_serializeFrameOperation(e,t){let i=t.filter(s=>s.type==="sprite"),r;i.length?r=i.pop():(r={type:"sprite",options:{sprites:[]}},t.push(r)),r.options.sprites.push({type:"frame",options:this._getFrameOptions(e)})}_serializeOverlayOperation(e,t){if(!e.getIdentifier())return;let i=t.filter(s=>s.type==="sprite"),r;i.length?r=i.pop():(r={type:"sprite",options:{sprites:[]}},t.push(r)),r.options.sprites.push({type:"overlay",options:{identifier:e.getIdentifier(),intensity:e.getAlpha(),blendMode:Ns[e.getBlendMode()]}})}_getFrameOptions(e){return{identifier:e.getFrame().identifier}}_serializeOrientationOperation(e){let t=super._serializeOrientationOperation(e);return(t.options.rotation===90||t.options.rotation===270)&&(t.options.flipHorizontally=!t.options.flipHorizontally,t.options.flipVertically=!t.options.flipVertically),t}_serializeTransformOperation(e){let{operations:t}=this._editor;if(t.exists("orientation")){e=e.clone();let r=t.get("orientation");e.rotate(-r.getRotation()),r.getFlipVertically()&&(e.flip("vertical"),e.setRotation(e.getRotation()*-1)),r.getFlipHorizontally()&&(e.flip("horizontal"),e.setRotation(e.getRotation()*-1))}let i=super._serializeTransformOperation(e);return i.type="transform",i}_serializeText(e,t){let i=super._serializeText(e,t),r=e.getInputDimensions(!1);return i.options.fontIdentifier=t.getFontIdentifier(),i.options.maxWidth=i.options.maxWidth*r.x/r.min(),delete i.options.fontFamily,i}_serializeFilterOperation(e){let t=super._serializeFilterOperation(e);return t?(t.options.identifier=t.options.name,delete t.options.name,t):null}_serializeRadialFocusOperation(e){let t=super._serializeRadialFocusOperation(e),i=t.options.options;return i.start=i.position,delete i.position,i.end={x:i.start.x+i.radius,y:i.start.y},delete i.radius,t}};vr.version="2.0.0"});var Uy={};Te(Uy,{default:()=>Na});var Na,Gy=_(()=>{jc();qc();Na=class{constructor(e){this._editor=e}serialize(...e){return new vr(this._editor).serialize(...e)}deserialize(e){return new br(this._editor,e).deserialize()}};Na.version="2.0.0"});var Yt,Do=_(()=>{fe();Yt=class{constructor(e,t={}){this._ui=e,this._options=t,this._defaultLayouts=Z.Operations.SpriteOperation.TextDesignSprite.Layouts,this._legacyLayouts=Z.Operations.SpriteOperation.TextDesignSprite.LegacyLayouts,this._layouts=[],this._init()}_init(){let{availableLayouts:e}=this._options,t=C(C({},this._defaultLayouts),this._legacyLayouts);this._layouts=Object.keys(t).map(i=>({identifier:t[i].identifier,layout:t[i]})),e&&(e.push(...Object.values(this._legacyLayouts).map(i=>i.identifier)),this._layouts=this._layouts.filter(i=>e.indexOf(i.identifier)>=0))}getLayoutByIdentifier(e){let t=Ee.Array.find(this._layouts,i=>i.identifier===e);return t&&t.layout}getLayouts(){return[...this._layouts]}getDefaultLayout(){return this.getLayouts()[0]}}});var Xc,wr,Yc=_(()=>{fe();Li();fr();Ba();Do();jc();typeof Z.Operations.SpriteOperation!="undefined"&&(Xc=Z.Operations.SpriteOperation.BrushSprite.Brush);wr=class extends br{_deserializeSticker(e,t){let{SpriteOperation:i}=Z.Operations,{options:r}=t,s=this._stickerManager.getStickerByIdentifier(r.identifier);if(!s)return I.warn("Deserializer",`Unknown sticker \`${r.identifier}\`. Skipping sprite.`),Promise.resolve();let{mediaBase:n}=s.images,a=Mi.getURLForSticker(s,"base"),l=n.rawData?n.uris[0]:this._editor.getUI().getAssetPath(a),h=e.getInputDimensions(!1);return Ue.load(l).then(c=>{let m=i.StickerSprite.prototype.availableOptions.adjustments.structure,{rotation:d,flipHorizontally:u,flipVertically:f}=r,y={identifier:r.identifier,image:c,position:ee.fromObject(r.position),dimensions:ee.fromObject(r.dimensions).multiply(h.min()),rotation:d||0,flipHorizontally:u,flipVertically:f,resizeMode:s.resizeMode||"keepAspect",adjustments:{}};return typeof r.adjustments!="undefined"&&["brightness","contrast","saturation"].forEach(g=>{typeof r.adjustments[g]!="undefined"&&(y.adjustments[g]=r.adjustments[g]+m[g].default)}),typeof r.tintMode!="undefined"&&typeof r.tintColor!="undefined"?(y.tintColor=le.fromArray(r.tintColor.rgba),y.tintMode=r.tintMode):typeof r.tintColor!="undefined"&&typeof s.tintMode!="undefined"&&(y.tintColor=le.fromArray(r.tintColor.rgba),y.tintMode=s.tintMode),typeof r.alpha!="undefined"&&(y.alpha=r.alpha),e.createSticker(y)})}_deserializeTransformOperation(e){return super._deserializeTransformOperation(e).then(t=>{if(!!t)return t._ratio=null,t})}_deserializeInputImage(){let{data:e,type:t,uri:i}=this._data.image;return e&&t&&(i=`data:${t};base64,${e}`),i?Ue.load(i).then(r=>{this._editor.setImage(r)}):Promise.resolve()}_deserializeAdjustmentsOperation(e){let{AdjustmentsOperation:t}=Z.Operations;return super._deserializeAdjustmentsOperation(e).then(i=>{if(!i)return null;let{options:r}=e,s=["gamma","whites","blacks","temperature"],n={};return s.forEach(a=>{if(typeof r[a]=="undefined")return;let{minValue:l,midValue:h,maxValue:c}=t.prototype.availableOptions[a],m=r[a];m=m<0?h+(h-l)*m:h+(c-h)*m,n[a]=m}),i.set(n),i})}_deserializeFocusOperation(e){let{options:t}=e.options;switch(e.options.type){case"radial":return super._deserializeFocusOperation(e);case"linear":{let{start:i,end:r,blurRadius:s}=t;return Promise.resolve(this._editor.operations.getOrCreate("linear-focus",{controlPoint1:ee.fromObject(i),controlPoint2:ee.fromObject(r),blurRadius:s}))}case"mirrored":{let{start:i,end:r,size:s,gradientSize:n,blurRadius:a}=t;return Promise.resolve(this._editor.operations.getOrCreate("mirrored-focus",{start:ee.fromObject(i),end:ee.fromObject(r),size:s,gradientSize:n,blurRadius:a}))}case"gaussian":{let{blurRadius:i}=t;return Promise.resolve(this._editor.operations.getOrCreate("blur",{blurRadius:i}))}}}_deserializeText(e,t){let{options:i}=t,{fontSize:r,lineHeight:s,fontIdentifier:n,alignment:a,rotation:l,maxWidth:h,color:c,backgroundColor:m}=i,d=this._ui.getFontLoader(),u=this._fontManager.getVariationByIdentifier(n);return u?d.setFonts([u.getFont()]):u=this._fontManager.getDefaultVariation(),d.load().then(()=>{let f=e.getInputDimensions(!1),y=h*f.min()/f.x,g=e.createText({fontSize:r,lineHeight:s,fontFamily:u.getFontFamily(),fontWeight:u.getFontWeight(),fontIdentifier:u.getIdentifier(),textMetrics:u.getTextMetrics(),alignment:a,rotation:l,maxWidth:y,text:i.text,color:le.fromArray(c.rgba),backgroundColor:le.fromArray(m.rgba),position:ee.fromObject(i.position)});return g._edited=!0,g})}_createBrushForPath(e){let{identifier:t,color:i,size:r,hardness:s}=e.brush,a={color:le.fromArray(i.rgba),size:r};typeof s!="undefined"&&(a.hardness=s);let l=this._brushManager.getBrushByIdentifier(t);if(l||(l=this._brushManager.getFirstBrush()),l.prototype&&l.prototype instanceof Xc){let m=l;return new m(a)}let h=C({},l);delete h.image;class c extends Xc{}return c.identifier=l.identifier,new c(C(C({},h),a))}_deserializeFrame(e,t){return super._deserializeFrame(e,t).then(()=>{let i=this._editor.operations.get("frame"),{size:r,alpha:s,tintColor:n}=t.options,a={};typeof r!="undefined"&&(a.scale=r),typeof s!="undefined"&&(a.alpha=s),typeof n!="undefined"&&(a.tintColor=le.fromArray(n.rgba)),i.set(a)})}_deserializeTextDesign(e,t){let{options:i}=t,{position:r,rotation:s,flipHorizontally:n,flipVertically:a,text:l,color:h,width:c,seed:m,inverted:d}=i,{identifier:u}=i;u===Z.Operations.SpriteOperation.TextDesignSprite.Layouts.TextDesignBlocksLight.identifier?u=Z.Operations.SpriteOperation.TextDesignSprite.LegacyLayouts.TextDesignBlocksLightV310.identifier:u===Z.Operations.SpriteOperation.TextDesignSprite.Layouts.TextDesignSunshine.identifier&&(u=Z.Operations.SpriteOperation.TextDesignSprite.LegacyLayouts.TextDesignSunshineV310.identifier);let f=new Yt(this._ui,this._getOptions("textdesign")),y=new ht(this._ui,{fonts:Be.DEFAULTS.TEXT_DESIGN_FONTS,replaceFonts:!0}),{AssetManager:g}=e.constructor.TextDesignSprite,p=this._ui.getFontLoader(),v=f.getLayoutByIdentifier(u),x=new v;return p.setFonts(y.getFonts()),g.setFonts(C(C({},g.getFonts()),y.getVariationsByIdentifier())),p.load().then(()=>{let T=x.getImagePaths().map(D=>({path:D,fullPath:this._ui.getAssetPath(D),image:null}));return g.loadImages(T).then(()=>(x.onImagesLoaded(),e.createTextDesign({position:r,rotation:s,flipHorizontally:n,flipVertically:a,text:l,color:le.fromArray(h.rgba),width:c,seed:m,inverted:d,layout:x})))})}};wr.version="3.0.0"});var Tr,Kc=_(()=>{yt();Tr=class extends V{};Tr.prototype.availableOptions={identifier:{type:"string",required:!0},defaultName:{type:"string",required:!0},ratio:{type:"*",required:!1,default:null},selected:{type:"boolean",required:!1},dimensions:{type:"vector2",required:!1},lockDimensions:{type:"boolean",required:!1,default:null},forceDimensions:{type:"boolean",required:!1,default:null}}});var Rr,Jc=_(()=>{fe();Kc();qc();Rr=class extends vr{serialize(e={}){return super.serialize(e).then(t=>(t.meta={platform:"html5",version:this._editor.getSDK().version,createdAt:Ee.ISODateString(new Date)},t.image=t.inputImage,delete t.inputImage,t))}_serializeSticker(e,t){let i=super._serializeSticker(e,t);return i.options.alpha=t.getAlpha(),i.options.tintColor&&(i.options.tintColor={rgba:i.options.tintColor}),i}_serializeText(e,t){let i=super._serializeText(e,t);return i.options.color={rgba:i.options.color},i.options.backgroundColor={rgba:i.options.backgroundColor},i.options.flipHorizontally=!1,i.options.flipVertically=!1,delete i.options.fontWeight,i}_serializePath(e){let t=super._serializePath(e);delete t.hardness,delete t.size,delete t.color;let i=e.getBrush();t.brush=i.serializeOptions(["identifier","size","color"],!0),typeof t.brush.identifier=="undefined"&&delete t.brush.identifier,t.brush.color={rgba:t.brush.color};let r=i.getOption("hardness");return r!=="undefined"&&(t.brush.hardness=r),t}_serializeFrameOperation(e,t){super._serializeFrameOperation(e,t);let i=t.filter(s=>s.type==="sprite"),r;if(i.length){r=i.pop();let s=r.options.sprites.filter(l=>l.type==="frame")[0];e.getTintColor().equals(new le(1,1,1,0))||(s.options.tintColor={rgba:e.serializeOption("tintColor",!0)});let a=e.serializeOptions(["scale","alpha"],!0);s.options=C(C({},s.options),a),s.options.size=s.options.scale,delete s.options.scale}}_serializeTransformOperation(e){let t=super._serializeTransformOperation(e);if(e._ratio){let i;e._ratio instanceof Tr?i=e._ratio.getIdentifier():i=e._ratio.identifier,t.options.meta={identifier:i}}return delete t.options.scale,t}_serializeAdjustmentsOperation(e){let t=super._serializeAdjustmentsOperation(e),i=["gamma","whites","blacks","temperature"],{availableOptions:r}=e,s={};return i.forEach(n=>{let a=r[n],l=e.getOption(n),{minValue:h,midValue:c,maxValue:m}=a;s[n]=l<=c?(l-h)/(c-h)-1:(l-c)/(m-c)}),t.options=C(C({},t.options),s),t}_serializeOperation(e,t){switch(e.constructor.identifier){case"mirrored-focus":return this._serializeMirroredFocusOperation(e);case"linear-focus":return this._serializeLinearFocusOperation(e);case"blur":return this._serializeBlurOperation(e);default:return super._serializeOperation(e,t)}}_serializeMirroredFocusOperation(e){return{type:"focus",options:{type:"mirrored",options:e.serializeOptions(["start","end","blurRadius","size","gradientSize"],!0)}}}_serializeLinearFocusOperation(e){let t=e.serializeOptions(["controlPoint1","controlPoint2","blurRadius"],!0);return t.start=t.controlPoint1,delete t.controlPoint1,t.end=t.controlPoint2,delete t.controlPoint2,{type:"focus",options:{type:"linear",options:t}}}_serializeBlurOperation(e){return{type:"focus",options:{type:"gaussian",options:e.serializeOptions(["blurRadius"],!0)}}}};Rr.version="3.0.0"});var Wy={};Te(Wy,{default:()=>Ua});var Ua,Vy=_(()=>{Yc();Jc();Ua=class{constructor(e){this._editor=e}serialize(...e){return new Rr(this._editor).serialize(...e)}deserialize(e){return new wr(this._editor,e).deserialize()}};Ua.version="3.0.0"});var Cr,Zc=_(()=>{fe();fr();Do();Yc();Cr=class extends wr{_deserializeTextDesign(e,t){let{options:i}=t,{position:r,rotation:s,flipHorizontally:n,flipVertically:a,text:l,color:h,width:c,seed:m,inverted:d}=i,{identifier:u}=i;u===Z.Operations.SpriteOperation.TextDesignSprite.Layouts.TextDesignBlocksLight.identifier?u=Z.Operations.SpriteOperation.TextDesignSprite.LegacyLayouts.TextDesignBlocksLightV310.identifier:u===Z.Operations.SpriteOperation.TextDesignSprite.Layouts.TextDesignSunshine.identifier&&(u=Z.Operations.SpriteOperation.TextDesignSprite.LegacyLayouts.TextDesignSunshineV310.identifier);let f=new Yt(this._ui,this._getOptions("textdesign")),y=new ht(this._ui,{fonts:Be.DEFAULTS.TEXT_DESIGN_FONTS,replaceFonts:!0}),{AssetManager:g}=e.constructor.TextDesignSprite,p=this._ui.getFontLoader(),v=f.getLayoutByIdentifier(u),x=new v;return p.setFonts(y.getFonts()),g.setFonts(C(C({},g.getFonts()),y.getVariationsByIdentifier())),p.load().then(()=>{let T=x.getImagePaths().map(D=>({path:D,fullPath:this._ui.getAssetPath(D),image:null}));return g.loadImages(T).then(()=>(x.onImagesLoaded(),e.createTextDesign({position:r,rotation:s,flipHorizontally:n,flipVertically:a,text:l,color:le.fromArray(h.rgba),width:c,seed:m,inverted:d,layout:x})))})}};Cr.version="3.1.0"});var kr,Qc=_(()=>{fe();Jc();kr=class extends Rr{_serializeTextDesign(e,t){let i=t.serializeOptions(["position","rotation","flipHorizontally","flipVertically","text","color","width","seed","inverted"],!0);i.color={rgba:i.color};let r=t.getLayout();return r&&(i.identifier=r.constructor.identifier),{type:"textdesign",options:i}}};kr.version="3.1.0"});var Hy={};Te(Hy,{default:()=>Ga});var Ga,jy=_(()=>{Zc();Qc();Ga=class{constructor(e){this._editor=e}serialize(...e){return new kr(this._editor).serialize(...e)}deserialize(e){return new Cr(this._editor,e).deserialize()}};Ga.version="3.1.0"});var Sr,$c=_(()=>{fe();fr();Do();Zc();Sr=class extends Cr{_deserializeTextDesign(e,t){let{options:i}=t,{position:r,rotation:s,flipHorizontally:n,flipVertically:a,text:l,color:h,width:c,seed:m,inverted:d}=i,{identifier:u}=i;u===Z.Operations.SpriteOperation.TextDesignSprite.Layouts.TextDesignBlocksLight.identifier?u=Z.Operations.SpriteOperation.TextDesignSprite.LegacyLayouts.TextDesignBlocksLightV310.identifier:u===Z.Operations.SpriteOperation.TextDesignSprite.Layouts.TextDesignSunshine.identifier&&(u=Z.Operations.SpriteOperation.TextDesignSprite.LegacyLayouts.TextDesignSunshineV310.identifier);let f="padding"in i?i.padding/c:-1,y=new Yt(this._ui,this._getOptions("textdesign")),g=new ht(this._ui,{fonts:Be.DEFAULTS.TEXT_DESIGN_FONTS,replaceFonts:!0}),{AssetManager:p}=e.constructor.TextDesignSprite,v=this._ui.getFontLoader(),x=y.getLayoutByIdentifier(u),T=new x;return v.setFonts(g.getFonts()),p.setFonts(C(C({},p.getFonts()),g.getVariationsByIdentifier())),v.load().then(()=>{let D=T.getImagePaths().map(b=>({path:b,fullPath:this._ui.getAssetPath(b),image:null}));return p.loadImages(D).then(()=>(T.onImagesLoaded(),e.createTextDesign({position:r,rotation:s,flipHorizontally:n,flipVertically:a,text:l,color:le.fromArray(h.rgba),width:c,seed:m,inverted:d,layout:T,padding:f})))})}};Sr.version="3.2.0"});var Or,eu=_(()=>{Qc();Or=class extends kr{_serializeTextDesign(e,t){let i=t.serializeOptions(["position","rotation","flipHorizontally","flipVertically","text","color","width","seed","inverted","padding"],!0);i.color={rgba:i.color};let r=t.getLayout();return r&&(i.identifier=r.constructor.identifier),i.padding*=i.width,{type:"textdesign",options:i}}};Or.version="3.2.0"});var qy={};Te(qy,{default:()=>Wa});var Wa,Xy=_(()=>{$c();eu();Wa=class{constructor(e){this._editor=e}serialize(...e){return new Or(this._editor).serialize(...e)}deserialize(e){return new Sr(this._editor,e).deserialize()}};Wa.version="3.2.0"});var Fr,tu=_(()=>{$c();Fr=class extends Sr{_deserializeOperation(e){return super._deserializeOperation(e)}_deserializeOrientationOperation(e){let{options:t}=e,i=this._editor.operations.getOrCreate("orientation");return i?(i.set(t),Promise.resolve(i)):Promise.resolve()}};Fr.version="3.4.0"});var Er,iu=_(()=>{za();eu();Er=class extends Or{_serializeOperation(e,t){switch(e.constructor.identifier){case"artfilter":return this._serializeStyle(e);default:return super._serializeOperation(e,t)}}_serializeOrientationOperation(e){return{type:"orientation",options:e.serializeOptions(["flipVertically","flipHorizontally","rotation"],!0)}}_serializeStyle(e){let{identifier:t,intensity:i,blendMode:r}=e.getOptions(),{tileEdgeLength:s,overlappingFactor:n}=e.getStyleTransferModel().getOptions();return{type:"artFilter",options:{identifier:t,intensity:i,blendMode:Ns[r],tileEdgeLength:s,overlappingFactor:n}}}};Er.version="3.4.0"});var Yy={};Te(Yy,{default:()=>Va});var Va,Ky=_(()=>{tu();iu();Va=class{constructor(e){this._editor=e}serialize(...e){return new Er(this._editor).serialize(...e)}deserialize(e){return new Fr(this._editor,e).deserialize()}};Va.version="3.4.0"});var Ir,ru=_(()=>{fe();fr();Do();tu();Ir=class extends Fr{_deserializeTextDesign(e,t){let{options:i}=t,{position:r,rotation:s,flipHorizontally:n,flipVertically:a,text:l,color:h,width:c,seed:m,inverted:d,identifier:u}=i,f="padding"in i?i.padding/c:-1,y=new Yt(this._ui,this._getOptions("textdesign")),g=new ht(this._ui,{fonts:Be.DEFAULTS.TEXT_DESIGN_FONTS,replaceFonts:!0}),{AssetManager:p}=e.constructor.TextDesignSprite,v=this._ui.getFontLoader(),x=y.getLayoutByIdentifier(u),T=new x;return v.setFonts(g.getFonts()),p.setFonts(C(C({},p.getFonts()),g.getVariationsByIdentifier())),v.load().then(()=>{let D=T.getImagePaths().map(b=>({path:b,fullPath:this._ui.getAssetPath(b),image:null}));return p.loadImages(D).then(()=>(T.onImagesLoaded(),e.createTextDesign({position:r,rotation:s,flipHorizontally:n,flipVertically:a,text:l,color:le.fromArray(h.rgba),width:c,seed:m,inverted:d,layout:T,padding:f})))})}};Ir.version="3.5.0"});var Mr,su=_(()=>{iu();Mr=class extends Er{};Mr.version="3.5.0"});var Jy={};Te(Jy,{default:()=>Ha});var Ha,Zy=_(()=>{ru();su();Ha=class{constructor(e){this._editor=e}serialize(...e){return new Mr(this._editor).serialize(...e)}deserialize(e){return new Ir(this._editor,e).deserialize()}};Ha.version="3.5.0"});var Br,ou=_(()=>{fe();ru();Br=class extends Ir{_deserializeAdjustmentsOperation(e){let{AdjustmentsOperation:t}=Z.Operations;return super._deserializeAdjustmentsOperation(e).then(i=>{if(!i)return null;let{options:r}=e,s="sharpness",n={};if(typeof r[s]=="undefined")return;let{minValue:a,midValue:l,maxValue:h}=t.prototype.availableOptions[s],c=r[s];return c=c<0?l+(l-a)*c:l+(h-l)*c,n[s]=c,i.set(n),i})}};Br.version="3.6.0"});var Dr,nu=_(()=>{su();Dr=class extends Mr{_serializeAdjustmentsOperation(e){let t=super._serializeAdjustmentsOperation(e),i="sharpness",{availableOptions:r}=e,s={},n=r[i],a=e.getOption(i),{minValue:l,midValue:h,maxValue:c}=n;return s[i]=a<=h?(a-l)/(h-l)-1:(a-h)/(c-h),t.options=C(C({},t.options),s),t}};Dr.version="3.6.0"});var Qy={};Te(Qy,{default:()=>ja});var ja,$y=_(()=>{ou();nu();ja=class{constructor(e){this._editor=e}serialize(...e){return new Dr(this._editor).serialize(...e)}deserialize(e){return new Br(this._editor,e).deserialize()}};ja.version="3.6.0"});var Pr,au=_(()=>{yt();ou();Pr=class extends Br{deserialize(){return this._validateVersion().then(()=>this._deserializeAssetLibrary()).then(()=>this._deserializeInputImage()).then(()=>this._deserializeOperations())}_deserializeAssetLibrary(){return new Promise((e,t)=>{let i=this._data;if(!i.assetLibrary){e();return}let{assets:r}=i.assetLibrary,s=[];for(let n in r)s.push(this._deserializeCustomAssets(n,r[n]));return Promise.all(s).then(()=>{e()}).catch(n=>{console.error(n),t(n)})})}_deserializeCustomAssets(e,t){switch(e){case"stickers":return this._deserializeCustomStickerAssets(t);default:return Promise.reject(new Error(`Unknown asset type: ${e}`))}}_deserializeCustomStickerAssets(e){let t="none",i=this._editor.getOptions().editor;i&&i.controlsOptions&&i.controlsOptions.sticker&&(t=i.controlsOptions.sticker.customStickerTintMode||"none");let r=e.map(s=>new Promise((n,a)=>{let{identifier:l,raster:h}=s,c=s.svg!==void 0,m=`data:${h.type};base64,${h.data}`,d=new Ge;d.onload=()=>{d=this._editor.getSDK().correctExifOrientation(d),d.toDataURL&&(m=d.toDataURL());let f={data:"",width:1,height:1},y={identifier:l,defaultName:s.name||"",tintMode:t,images:{mediaBase:{uris:[m],rawData:!0,isSVG:c,width:d.width,height:d.height},mediaThumb:{uris:[f.data],rawData:!0,width:f.width,height:f.height}}};if(c){let g=`data:image/svg+xml;base64,${s.svg.data}`;y.images.mediaBase.uris.push(g)}n(y)},d.onerror=()=>{a(new Error(`Invalid base64 data: ${m}`))},d.src=m}));return Promise.all(r).then(s=>{this._editor.getDynamicAssetsLibrary().setAssets("sticker",s),this._stickerManager.reload()})}};Pr.version="3.7.0"});var Ar,lu=_(()=>{nu();Ar=class extends Dr{serialize(e={}){return super.serialize(e).then(t=>this._serializeAssetLibrary(t).then(i=>i))}_serializeAssetLibrary(e){if(!this._editor.getDynamicAssetsLibrary)return Promise.resolve(e);let t=this._editor.getDynamicAssetsLibrary(),i=this._serializeCustomStickerAssets(e,t);return i.length===0||(e.assetLibrary={assets:{stickers:i}}),Promise.resolve(e)}_serializeCustomStickerAssets(e,t){let i=t.getAssets("sticker");if(i.length===0)return[];let r=e.operations.filter(a=>a.type==="sprite").flatMap(a=>a.options.sprites).filter(a=>a.type==="sticker").map(a=>a.options.identifier),s={};return r.forEach(a=>{s[a]=!0}),i.filter(a=>s[a.identifier]).map(a=>{let{identifier:l,defaultName:h,images:c}=a,m=c.mediaBase.uris[0],{isSVG:d}=c.mediaBase,f=/^data:(image\/(jpeg|png));base64,(.*)$/g.exec(m),y=f[1],g=f[3],p={identifier:l,name:h,raster:{type:y,data:g}};return h&&(p.name=h),d&&(p.svg={data:c.mediaBase.uris[1].replace(/^data:image\/svg\+xml;base64,/g,"")}),p})}};Ar.version="3.7.0"});var e0={};Te(e0,{default:()=>qa});var qa,t0=_(()=>{au();lu();qa=class{constructor(e){this._editor=e}serialize(...e){return new Ar(this._editor).serialize(...e)}deserialize(e){return new Pr(this._editor,e).deserialize()}};qa.version="3.7.0"});var Lr,hu=_(()=>{au();Lr=class extends Pr{};Lr.version="3.8.0"});var zr,cu=_(()=>{lu();zr=class extends Ar{_serializeSticker(e,t){let i=super._serializeSticker(e,t);return i.options.tintMode=t.getTintMode(),i}};zr.version="3.8.0"});var i0={};Te(i0,{default:()=>Xa});var Xa,r0=_(()=>{hu();cu();Xa=class{constructor(e){this._editor=e}serialize(...e){return new zr(this._editor).serialize(...e)}deserialize(e){return new Lr(this._editor,e).deserialize()}};Xa.version="3.8.0"});var Nr,uu=_(()=>{fe();hu();Nr=class extends Lr{_deserializeTransformOperation(e){return super._deserializeCropOperation(e).then(t=>{if(!t)return;let i=Ee.Array.find(this._data.operations,r=>r.type==="orientation");if(i){let{options:r}=i;t.rotate(r.rotation),r.flipHorizontally&&(t.flip("horizontal"),t.setRotation(t.getRotation()*-1)),r.flipVertically&&(t.flip("vertical"),t.setRotation(t.getRotation()*-1))}return t._ratio=null,t})}_deserializeText(e,t){let{options:i}=t,{fontSize:r,lineHeight:s,fontIdentifier:n,alignment:a,rotation:l,maxWidth:h,color:c,backgroundColor:m}=i,d=this._ui.getFontLoader(),u=this._fontManager.getVariationByIdentifier(n);return u?d.setFonts([u.getFont()]):u=this._fontManager.getDefaultVariation(),d.load().then(()=>{let f=e.getInputDimensions(!1),y=f.min(),g=f.x,p=f.y,v=h*y/g,x=r*y/p,T=e.createText({fontSize:x,lineHeight:s,fontFamily:u.getFontFamily(),fontWeight:u.getFontWeight(),fontIdentifier:u.getIdentifier(),textMetrics:u.getTextMetrics(),alignment:a,rotation:l,maxWidth:v,text:i.text,color:le.fromArray(c.rgba),backgroundColor:le.fromArray(m.rgba),position:ee.fromObject(i.position)});return T._edited=!0,T})}};Nr.version="3.9.0"});var s0,Ur,du=_(()=>{Kc();cu();s0=Math.PI*2,Ur=class extends zr{_serializeTransformOperation(e){let{operations:t}=this._editor;if(t.exists("orientation")){e=e.clone();let s=t.get("orientation");s.getFlipVertically()&&(e.flip("vertical"),e.setRotation(e.getRotation()*-1)),s.getFlipHorizontally()&&(e.flip("horizontal"),e.setRotation(e.getRotation()*-1)),e.rotate(-s.getRotation())}let i=e.serializeOptions(["start","end","rotation","textureScale"],!0);i.rotation=(i.rotation+s0)%s0,i.textureScale!==1&&(i.dimensions=e.getNewDimensions(e.getInputDimensions(!1))),delete i.textureScale;let r={type:"transform",options:i};if(e._ratio){let s;e._ratio instanceof Tr?s=e._ratio.getIdentifier():s=e._ratio.identifier,r.options.meta={identifier:s}}return delete r.options.scale,r}_serializeText(e,t){let i=e.getInputDimensions(!1),r=super._serializeText(e,t);return r.options.fontSize=r.options.fontSize*i.y/i.min(),r}};Ur.version="3.9.0"});var o0={};Te(o0,{default:()=>Ya});var Ya,n0=_(()=>{uu();du();Ya=class{constructor(e){this._editor=e}serialize(...e){return new Ur(this._editor).serialize(...e)}deserialize(e){return new Nr(this._editor,e).deserialize()}};Ya.version="3.9.0"});var Po,a0=_(()=>{uu();Po=class extends Nr{};Po.version="3.12.0"});var Ao,l0=_(()=>{du();Ao=class extends Ur{_serializeCustomStickerAssets(e,t){let i=t.getAssets("sticker");if(i.length===0)return[];let r=e.operations.filter(a=>a.type==="sprite").flatMap(a=>a.options.sprites).filter(a=>a.type==="sticker").map(a=>a.options.identifier),s={};return r.forEach(a=>{s[a]=!0}),i.filter(a=>s[a.identifier]).map(a=>{let{identifier:l,defaultName:h,images:c}=a,m=c.mediaBase.uris[0],{isSVG:d}=c.mediaBase,f=/^data:(image\/(jpeg|png|gif));base64,(.*)$/g.exec(m),y=f[1],g=f[3],p={identifier:l,name:h,raster:{type:y,data:g}};return h&&(p.name=h),d&&(p.svg={data:c.mediaBase.uris[1].replace(/^data:image\/svg\+xml;base64,/g,"")}),p})}};Ao.version="3.12.0"});var h0={};Te(h0,{default:()=>Ka});var Ka,c0=_(()=>{a0();l0();Ka=class{constructor(e){this._editor=e}serialize(...e){return new Ao(this._editor).serialize(...e)}deserialize(e){return new Po(this._editor,e).deserialize()}};Ka.version="3.12.0"});var K1={};Te(K1,{default:()=>Y1});fe();Ni();Mc();fe();fe();var Oo=class{static downloadDataURL(e,t="photoeditorsdk-export"){let i=this.createBlobURLFromDataURL(e),r=this.getExtensionFromDataURL(e),s=document.createElement("a");s.download=`${t}.${r}`,s.href=i,document.body.appendChild(s),s.click(),document.body.removeChild(s)}static downloadMSBlob(e,t="photoeditorsdk-export"){navigator.msSaveBlob&&navigator.msSaveBlob(e,`${t}.png`)}static getExtensionFromDataURL(e){return e.split(",")[0].split(":")[1].split(";")[0].split("/").pop()}static createBlobURLFromDataURL(e){if(!window.Blob||!window.URL||!ArrayBuffer||!Uint8Array)return e;let t=va.decode(e.split(",")[1]),i=e.split(",")[0].split(":")[1].split(";")[0],r=new ArrayBuffer(t.length),s=new Uint8Array(r);for(let a=0;a<t.length;a++)s[a]=t[a];let n=new window.Blob([r],{type:i});return window.URL.createObjectURL(n)}};var Ta=class{constructor(e,t,i){this._sdk=e,this._options=t,this._download=i}export(){let e=this._getRenderType();return this._sdk.export(e,this._options.format,this._options.quality).then(t=>(this._download&&this._downloadData(e,t),t))}_downloadData(e,t){switch(e){case Ii.DATAURL:Oo.downloadDataURL(t,this._options.fileBasename);break;case Ii.MSBLOB:Oo.downloadMSBlob(t,this._options.fileBasename);break}}_getRenderType(){let e=this._options;return e.type!==Ii.IMAGE||!this._download?e.type:lt.supportsMSBlob()?Ii.MSBLOB:Ii.DATAURL}};fr();Kt();yt();as();Li();ut();yt();var G1=[{identifier:"imgly_font_open_sans_bold",fontFamily:"Open Sans",fontWeight:"bold",fontURI:"./fonts/imgly_font_open_sans_bold.woff",format:"woff",textMetrics:{unitsPerEm:2048,ascender:2189,descender:-600}},{identifier:"imgly_font_aleo_bold",fontFamily:"Aleo",fontWeight:"bold",fontURI:"./fonts/imgly_font_aleo_bold.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:805,descender:-195}},{identifier:"imgly_font_amaticsc",fontFamily:"Amatic SC",fontWeight:"normal",fontURI:"./fonts/imgly_font_amaticsc.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:1016,descender:-245}},{identifier:"imgly_font_archivo_black",fontFamily:"Archivo",fontWeight:"normal",fontURI:"./fonts/imgly_font_archivo_black.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:878,descender:-210}},{identifier:"imgly_font_bungee_inline",fontFamily:"Bungee Inline",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_bungee_inline.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:860,descender:-140}},{identifier:"imgly_font_fira_sans_regular",fontFamily:"Fira Sans",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_fira_sans_regular.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:935,descender:-265}},{identifier:"imgly_font_campton_bold",fontFamily:"Campton Book",fontWeight:"bold",fontStyle:"normal",fontURI:"./fonts/imgly_font_campton_bold.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:770,descender:-294}},{identifier:"imgly_font_carter_one",fontFamily:"Carter One",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_carter_one.woff",format:"woff",textMetrics:{unitsPerEm:2048,ascender:2264,descender:-890}},{identifier:"imgly_font_codystar",fontFamily:"Codystar",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_codystar.woff",format:"woff",textMetrics:{unitsPerEm:1024,ascender:953,descender:-255}},{identifier:"imgly_font_galano_grotesque_bold",fontFamily:"Galano Grotesque",fontWeight:"bold",fontStyle:"normal",fontURI:"./fonts/imgly_font_galano_grotesque_bold.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:800,descender:-200}},{identifier:"imgly_font_krona_one",fontFamily:"Krona One",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_krona_one.woff",format:"woff",textMetrics:{unitsPerEm:2048,ascender:2030,descender:-530}},{identifier:"imgly_font_kumar_one_outline",fontFamily:"Kumar One Outline",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_kumar_one_outline.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:1137,descender:-642}},{identifier:"imgly_font_lobster",fontFamily:"Lobster",fontWeight:"normal",fontURI:"./fonts/imgly_font_lobster.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:1e3,descender:-250}},{identifier:"imgly_font_molle",fontFamily:"Molle",fontWeight:"normal",fontStyle:"italic",fontURI:"./fonts/imgly_font_molle.woff",format:"woff",textMetrics:{unitsPerEm:2048,ascender:1852,descender:-701}},{identifier:"imgly_font_monoton",fontFamily:"Monoton",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_monoton.woff",format:"woff",textMetrics:{unitsPerEm:2048,ascender:2366,descender:-822}},{identifier:"imgly_font_nixie_one",fontFamily:"Nixie One",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_nixie_one.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:926,descender:-210}},{identifier:"imgly_font_notable",fontFamily:"Notable",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_notable.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:1143,descender:-157}},{identifier:"imgly_font_ostrich_sans_black",fontFamily:"Ostrich",fontWeight:800,fontStyle:"normal",fontURI:"./fonts/imgly_font_ostrich_sans_black.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:950,descender:-250}},{identifier:"imgly_font_ostrich_sans_bold",fontFamily:"Ostrich",fontWeight:"bold",fontStyle:"normal",fontURI:"./fonts/imgly_font_ostrich_sans_bold.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:950,descender:-250}},{identifier:"imgly_font_oswald_semi_bold",fontFamily:"Oswald SemiBold",googleFamily:"Oswald",fontWeight:600,fontStyle:"normal",fontURI:"./fonts/imgly_font_oswald_semi_bold.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:1193,descender:-289}},{identifier:"imgly_font_palanquin_dark_semi_bold",fontFamily:"Palanquin Dark SemiBold",googleFamily:"Palanquin Dark",fontWeight:"bold",fontStyle:"normal",fontURI:"./fonts/imgly_font_palanquin_dark_semi_bold.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:1320,descender:-491}},{identifier:"imgly_font_poppins",fontFamily:"Poppins",fontWeight:"bold",fontStyle:"normal",fontURI:"./fonts/imgly_font_poppins.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:1050,descender:-350}},{identifier:"imgly_font_permanent_marker",fontFamily:"Permanent Marker",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_permanent_marker.woff",format:"woff",textMetrics:{unitsPerEm:1024,ascender:1136,descender:-325}},{identifier:"imgly_font_roboto_black_italic",fontFamily:"Roboto Black",fontWeight:"bold",fontStyle:"italic",googleFamily:"Roboto",fontURI:"./fonts/imgly_font_roboto_black_italic.woff",format:"woff",textMetrics:{unitsPerEm:2048,ascender:1900,descender:-500}},{identifier:"imgly_font_roboto_light_italic",fontFamily:"Roboto Light",googleFamily:"Roboto",fontWeight:300,fontStyle:"italic",fontURI:"./fonts/imgly_font_roboto_light_italic.woff",format:"woff",textMetrics:{unitsPerEm:2048,ascender:1900,descender:-500}},{identifier:"imgly_font_sancreek",fontFamily:"Sancreek",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_sancreek.woff",format:"woff",textMetrics:{unitsPerEm:2048,ascender:2104,descender:-738}},{identifier:"imgly_font_stint_ultra_expanded",fontFamily:"Stint Ultra Expanded",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_stint_ultra_expanded.woff",format:"woff",textMetrics:{unitsPerEm:2048,ascender:1853,descender:-483}},{identifier:"imgly_font_trash_hand",fontFamily:"Trash Hand",fontWeight:"normal",fontURI:"./fonts/imgly_font_trash_hand.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:759,descender:-304}},{identifier:"imgly_font_vt323",fontFamily:"VT323",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_vt323.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:800,descender:-200}},{identifier:"imgly_font_yeseva_one",fontFamily:"Yeseva One",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_yeseva_one.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:915,descender:-240}},{identifier:"imgly_font_abril_fatface_regular",fontFamily:"Abril Fatface",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_abril_fatface_regular.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:1058,descender:-291}},{identifier:"imgly_font_amberlight",fontFamily:"Amberlight",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_amberlight.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:750,descender:-250}},{identifier:"imgly_font_montserrat_light",fontFamily:"Montserrat Light",googleFamily:"Montserrat",fontWeight:300,fontStyle:"normal",fontURI:"./fonts/imgly_font_montserrat_light.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:968,descender:-251}},{identifier:"imgly_font_handycheera_regular",fontFamily:"Handycheera",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_handycheera_regular.woff",format:"woff",textMetrics:{unitsPerEm:2048,ascender:2199,descender:-808}},{identifier:"imgly_font_ostrich_sans_heavy",fontFamily:"Ostrich",fontWeight:900,fontStyle:"normal",fontURI:"./fonts/imgly_font_ostrich_sans_heavy.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:674,descender:0}},{identifier:"imgly_font_petit_formal_script",fontFamily:"Petit Formal Script",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_petit_formal_script.woff",format:"woff",textMetrics:{unitsPerEm:2048,ascender:2033,descender:-527}},{identifier:"imgly_font_rasa_500",fontFamily:"Rasa",fontWeight:500,fontStyle:"normal",fontURI:"./fonts/imgly_font_rasa_500.woff",format:"woff",textMetrics:{unitsPerEm:2750,ascender:2300,descender:-1050}},{identifier:"imgly_font_rasa_regular",fontFamily:"Rasa",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_rasa_regular.woff",format:"woff",textMetrics:{unitsPerEm:2750,ascender:2300,descender:-1050}},{identifier:"imgly_font_roboto_black",fontFamily:"Roboto Black",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_roboto_black.woff",format:"woff",textMetrics:{unitsPerEm:2048,ascender:1900,descender:-500}},{identifier:"imgly_font_roboto_light",fontFamily:"Roboto Light",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_roboto_light.woff",format:"woff",textMetrics:{unitsPerEm:2048,ascender:1900,descender:-500}},{identifier:"imgly_font_sue_ellen_francisco",fontFamily:"Sue Ellen Francisco",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_sue_ellen_francisco.woff",format:"woff",textMetrics:{unitsPerEm:1024,ascender:1362,descender:-634}},{identifier:"imgly_font_ultra",fontFamily:"Ultra",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_ultra.woff",format:"woff",textMetrics:{unitsPerEm:2048,ascender:2066,descender:-561}},{identifier:"imgly_font_wolesbro",fontFamily:"Wolesbro",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_wolesbro.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:925,descender:-575}}],Pc=G1;var wy=[];typeof P.Operations.SpriteOperation!="undefined"&&wy.push(P.Operations.SpriteOperation.BrushSprite.Brushes.RadialBrush);var pr={EVENTS:{EXPORT:"export",OPERATION_CREATED:"operation:created",OPERATION_UPDATED:"operation:updated",OPERATION_REMOVED:"operation:removed"},DEFAULTS:{TRANSFORM_RATIO_CATEGORIES:[{identifier:"imgly_transforms_common",defaultName:"Common Ratios",ratios:[{identifier:"imgly_transform_common_custom",defaultName:"Custom",ratio:"*",selected:!0},{identifier:"imgly_transform_common_square",defaultName:"Square",ratio:1},{identifier:"imgly_transform_common_4-3",defaultName:"4:3",ratio:4/3},{identifier:"imgly_transform_common_16-9",defaultName:"16:9",ratio:16/9}]},{identifier:"imgly_transforms_facebook",defaultName:"Facebook",ratios:[{identifier:"imgly_transform_facebook_profile",defaultName:"Profile Pic",ratio:1/1},{identifier:"imgly_transform_facebook_ad",defaultName:"Ad",dimensions:new P.Math.Vector2(1200,627)},{identifier:"imgly_transform_facebook_post",defaultName:"Post",dimensions:new P.Math.Vector2(940,788)},{identifier:"imgly_transform_facebook_cover",defaultName:"Cover",dimensions:new P.Math.Vector2(851,315)}]}],FONTS:Pc,BRUSHES:wy,TEXT_DESIGN_FONTS:Pc}};yt();Ni();ut();Kt();var{Utils:V3}=P,{Vector2:H3}=P.Math;var{Base64:$3}=P,{Color:Ra}=P,{ColorMatrix:e4}=P.Math,{EventEmitter:Ty}=P,{EXIF:t4}=P,{OptionType:i4}=P,{Promise:r4}=P,Ca=P.Utils,{RenderType:s4}=P,{ImageFormat:o4}=P,Ac=P,{UniformType:n4}=P,{Vector2:ka}=P.Math,{Rectangle:a4}=P.Math,{Range:l4}=P.Math,h4=typeof window!="undefined"&&window.performance&&window.performance.now?window.performance.now.bind(window.performance):ss();var Sa=class{constructor(e,t,i){this._editor=e,this._sdk=t,this._mediator=i,this._available=this._sdk.getOperations(),this._map={},this._stack=this._sdk.getOperationsStack(),this._preferredOrder=this._editor.getOptions().editor.operationsOrder,this._fixStack()}exists(e){return!!this._map[e]}add(e){let{identifier:t}=e.constructor;e.on("update",()=>{this._mediator.emit(pr.EVENTS.OPERATION_UPDATED,e)});let i=this._preferredOrder.indexOf(t);if(i===-1)throw new Error(`EditorOperations#add: \`${t}\` does not appear in \`operationsOrder\``);this._stack.set(i,e),this._map[t]=e,this._mediator.emit(pr.EVENTS.OPERATION_CREATED,e)}remove(e,t=!0){let i=typeof e=="object"?e.constructor.identifier:e,r=this._stack.getStack();e=this.get(i),delete this._map[i];let s=r.map(n=>n.constructor.identifier).indexOf(i);if(s!==-1){this._stack.removeAt(s);for(let n=s+1;n<r.length;n++){let a=r[n];!a||a.setDirty(!0)}t&&this._mediator.emit(pr.EVENTS.OPERATION_REMOVED,e)}}get(e){return this._map[e]}getOrCreate(e,t={}){if(this._map[e]){let s=this._map[e];return s.set(t,!1),s}let i=this._available[e],r=new i(this._sdk,t);return this.add(r),r}getStack(){return this._stack}reset(){for(let e in this._map)this._map[e].dispose();this._map={}}_fixStack(){let e=this._stack.getStack().slice();this._stack.clear(),e.forEach(t=>{this.add(t)})}};var Oa=class{constructor(e,t,i){this._image=e,this._maxPixels=t,this._maxDimensions=i}needsResize(){let e=new ka(this._image.width,this._image.height),t=e.x*e.y,i=this._maxPixels!==null&&t>this._maxPixels,r=this._maxDimensions!==null&&(e.x>this._maxDimensions||e.y>this._maxDimensions);return i||r}resize(){let e=null,t=null,i=this._maxDimensions;return new Promise((r,s)=>{setTimeout(()=>{let a=new ka(this._image.width,this._image.height).clone();if(this._maxPixels!==null&&a.x*a.y>this._maxPixels&&(a.copy(this._getDimensionsByMaxPixels()),e="maxMegaPixels"),i!==null&&(a.x>i||a.y>i)){let l=Math.min(i/a.x,i/a.y);a.multiply(l),e="maxDimensions"}a.floor(),t=this._createResizedImageCanvas(a),r({canvas:t,dimensions:a,reason:e})},1e3)})}_createResizedImageCanvas(e,t=e){let i=this._image,r=Ca.createCanvas();r.width=e.x,r.height=e.y;let s=e.clone().subtract(t).divide(2);return r.getContext("2d").drawImage(i,0,0,i.width,i.height,s.x,s.y,t.x,t.y),r}_getDimensionsByMaxPixels(){let e=this._image,t=this._maxPixels,i=e.width/e.height,r=e.height/e.width;return new ka(Math.sqrt(t*i),Math.sqrt(t*r)).floor()}};var u0=class extends Ty{constructor(e,t,i,r=!1){super();this._ui=e,this._options=t,this._mediator=i,this._shallow=r,this._initFonts(),r||(this._initSDK(),this.operations=new Sa(this,this._sdk,this._mediator),this._initSerializers()),this._dynamicAssetsLibrary=new wa}_initFonts(){let e=L(C({},this._options.editor.controlsOptions.text),{additionalFonts:[],replaceFonts:!1,availableVariations:null});this._fontManager=new ht(this._ui,e);let t=this._fontManager.getFonts(),i=this._ui.getFontLoader();i.setFonts(t),i.load()}setImage(e=this._options.editor.image,t=!0){t&&this.reset();let i=null;i=this._sdk.parseExif(e),this._setImage(e,i)}_initSDK(){let{logLevel:e,displayWelcomeMessage:t,debug:i,license:r,crossOrigin:s}=this._options,{smoothDownscaling:n,smoothUpscaling:a,preferredRenderer:l,pixelRatio:h,transparent:c,clearColor:m,watermark:d}=this._options.editor,u;Array.isArray(m)?u=Ra.fromArray(m):typeof m=="string"?u=Ra.fromHex(m):m instanceof Ra&&(u=m.clone());let f={logLevel:e,debug:i,displayWelcomeMessage:t,pixelRatio:h,smoothDownscaling:n,smoothUpscaling:a,transparent:c,crossOrigin:s,clearColor:u,license:r,watermark:d};this._sdk=new Ac(l,f)}getMaxMegapixels(){let{maxMegaPixels:e}=this._options.editor;return e}getCrossOrigin(){return Ca.getCrossOriginValue(this._options.crossOrigin||"anonymous")}getOutputDimensions(e=!1){return this._sdk.getOutputDimensions(e)}getOutputTextureDimensions(e=!1){return this._sdk.getOutputTextureDimensions(e)}getFinalDimensions(e=!1){return this._sdk.getFinalDimensions(e)}_setImage(e=this._options.editor.image,t=null){this._sdk.setAllOperationsToDirty(),this._options.editor.image=e,this._sdk.setImage(e,t)}_ensureImageIsResized(){let e=this._sdk.getImage(),t=this._sdk.getRenderer(),i=this.getMaxMegapixels(),r=i?i*1e6:null,s=t.getMaxDimensions(),n=new Oa(e,r,s);return!this._resizedImage&&n.needsResize()?n.resize().then(({canvas:a,dimensions:l,reason:h})=>(this._resizedImage=a,this._sdk.setImage(a),a)):Promise.resolve(e)}export(e=!1,t={}){return this._watermarkOperation&&this._watermarkOperation.setEnabled(!1),this._sdk.setAllOperationsToDirty(),this._ensureImageIsResized().then(i=>{let r=C(C({},this._options.editor.export),t);return new Ta(this._sdk,r,!1).export().then(n=>(this.emit("export",n),this._mediator.emit(pr.EVENTS.EXPORT,n,this),this._watermarkOperation&&(this._watermarkOperation.setEnabled(!0),this._sdk.render()),this._sdk.setAllOperationsToDirty(),n))})}broadcastTransform(e,t){let i=new Ac.Operations.TransformOperation.TransformChange(e,t);["sprite","selective-blur","radial-focus","mirrored-focus","linear-focus","blur"].forEach(s=>{let n=this.operations.get(s);!n||n.transform(i)})}broadcastFlip(e){["mirrored-focus","radial-focus","linear-focus","sprite","selective-blur"].forEach(i=>{let r=this.operations.get(i);!r||r.flip(e)})}broadcastRotate(e){["transform","mirrored-focus","linear-focus","radial-focus","sprite","selective-blur"].forEach(i=>{let r=this.operations.get(i);!r||r.rotate(e)})}_initSerializers(){this._serializers={"1.0.0":(By(),je(My)).default,"1.0.1":(Ay(),je(Py)).default,"2.0.0":(Gy(),je(Uy)).default,"3.0.0":(Vy(),je(Wy)).default,"3.1.0":(jy(),je(Hy)).default,"3.2.0":(Xy(),je(qy)).default,"3.4.0":(Ky(),je(Yy)).default,"3.5.0":(Zy(),je(Jy)).default,"3.6.0":($y(),je(Qy)).default,"3.7.0":(t0(),je(e0)).default,"3.8.0":(r0(),je(i0)).default,"3.9.0":(n0(),je(o0)).default,"3.12.0":(c0(),je(h0)).default}}serialize(e={},t="3.12.0"){let i=this._serializers[t];return i?new i(this).serialize(e):Promise.reject(new Error(`No serializer for version ${t} found.`))}deserialize(e){let t=this._serializers[e.version];return t?new t(this).deserialize(e):Promise.reject(new Error(`No serializer for version ${e.version} found.`))}reset(){this._sdk.reset(),this.operations.reset()}dispose(){this.stop(),this._resizedImage&&Ce(this._resizedImage),this._sdk.dispose()}getRenderer(){return this._sdk.getRenderer()}getSDK(){return this._sdk}getInputDimensions(){return this._sdk.getInputDimensions()}getImage(){return this._options.editor.image}getOptions(){return this._options}getUI(){return this._ui}getMediator(){return this._mediator}getDynamicAssetsLibrary(){return this._dynamicAssetsLibrary}},d0=u0;fe();var m0=require("canvas");var Ja=class{constructor(e){this._ui=e,this._fonts=[]}add(e){this._fonts.push(e)}load(){return Promise.resolve()}dispose(){}};var Za=class extends Ja{load(){return this._fonts.forEach(e=>{let t=this._ui.getAssetPath(e.getFilePath(),!1,!0);(0,m0.registerFont)(t,{family:e.getFont().getFontFamily(),weight:e.getFontWeight(),style:e.getFontStyle()})}),super.load()}};var Qa=class{constructor(e,t){this._ui=e,this._fonts=t,this._loadedFonts=[]}setFonts(e){this._fonts=e}needsToLoad(){for(let e=0;e<this._fonts.length;e++){let t;if(this._fonts[e].getVariations().forEach(i=>{t=t||i.getProvider()}),!!t)return!0}}fontLoaded(e){let t=e.getFontFamily();return this._loadedFonts.indexOf(t)!==-1}setFontLoaded(e){if(!this.fontLoaded(e)){let t=e.getFontFamily();this._loadedFonts.push(t)}}load(){let e=this._fonts,t={file:new Za(this._ui)},i=()=>{for(let s in t)t[s].dispose()};e.filter(s=>!this.fontLoaded(s)).forEach(s=>{s.getVariations().forEach(n=>{let a=n.getProvider();if(!a)return;let l=t[a];if(!l)return I.warn(`No font loader for provider \`${a}\` found.`);l.add(n)})});let r=[];for(let s in t)r.push(t[s].load());return Promise.all(r).then(()=>{i(),e.forEach(s=>{this.setFontLoaded(s)})}).catch(s=>{throw i(),s})}};var Us=o=>Ee.byteArrayToString(va.decode(o)),Bi=class extends Ec{constructor(e={}){super();this._mediator=new Ec,this._fontLoader=new Qa(this),this._options=e,this._initOptions(),this._initEvents(),this._disposed=!1,this._editor=new d0(this,this._options,this._mediator),this._options.editor.image&&this._editor.setImage(this._options.editor.image),I.setLevel(this._options.logLevel),this._v()}export(...e){return this._editor.export(...e)}serialize(...e){return this._editor.serialize(...e)}deserialize(e){return this._editor.deserialize(e)}getEditor(){return this._editor}_initOptions(){this._options=Ee.defaults(this._options,{logLevel:"warn",crossOrigin:"Anonymous",editor:{},assets:{},responsive:!1,preloader:!0}),this._options.editor=Ee.defaults(this._options.editor||{},{preferredRenderer:"webgl",displayResizeMessage:!0,controlsOptions:{},operationsOrder:["exif-orientation","orientation","transform","filter","adjustments","radial-focus","mirrored-focus","linear-focus","blur","selective-blur","overlay","sprite","frame"],maxMegaPixels:null}),this._options.editor.export=Ee.defaults(this._options.editor.export||{},{format:"image/png",type:Ii.IMAGE,download:!0,fileBasename:"photoeditorsdk-export",quality:.8}),this._options.assets=Ee.defaults(this._options.assets||{},{baseUrl:process.cwd(),resolver:null})}_v(){return this[Us("X29wdGlvbnM=")][Us("bGljZW5zZQ==")]?!0:(I.error(Us("TGljZW5zaW5n"),Us("Tm8gYGxpY2Vuc2VgIG9wdGlvbiBnaXZlbg==")),I.error(Us("TGljZW5zaW5n"),Us("SW4gY2FzZSB5b3UgZG9uJ3QgaGF2ZSBhIGxpY2Vuc2UgeWV0LCBwbGVhc2UgY29udGFjdCBvdXIgc2FsZXMgc3RhZmYgYXQgc2FsZXNAaW1nLmx5IHRvIG9idGFpbiBhIGxpY2Vuc2Ugb3IgbG9nIGluIHRvIHlvdXIgY3VzdG9tZXIgZGFzaGJvYXJkLg==")),!1)}_initEvents(){this._mediator.pipeEvents(this)}_disposeEvents(){this._mediator.unpipeEvents(this)}setImage(e){this._editor.setImage(e)}getAssetPath(e,t=!1,i=!1){let{baseUrl:r,resolver:s}=this._options.assets,n=`${r}/${e}`;if(e.match(/(ftp|http|https):\/\//)&&(n=e),t){if(!i&&Math.max(typeof window!="undefined"&&window.devicePixelRatio||1,1)>1){let l=/\.[\w?=]+$/;e=e.replace(l,h=>`@2x${h}`)}n=`${r}/ui/desktop/${e}`}return typeof s!="undefined"&&s!==null&&(n=s(n)),n}getFontLoader(){return this._fontLoader}dispose(){if(this._disposed)throw new Error("This instance of PhotoEditorSDK is already disposed.");this._disposed=!0,this._disposeEvents()}render(e){return this.deserialize(e).then(()=>this.export())}};Bi.prototype.identifier="node";Bi.Constants=Be;Bi.Events=Be.EVENTS;Bi.Utils=lt;Bi.JSONLoader=dt;Bi.SDK=Z;var Y1=Bi;module.exports=je(K1);0&&(module.exports={});
/*
 * Based on https://github.com/exif-js/exif-js by Jacob Seidelin
 * Licensed under MIT
 * @license
 */
/*
 * Extracted from MinifyJpeg (Copyright (c) 2014 Hiroaki Matoba, MIT License):
 * https://github.com/hMatoba/MinifyJpeg
 * @license
 */
/*
 * http://paulirish.com/2011/requestanimationframe-for-smart-animating/
 * http://my.opera.com/emoller/blog/2011/12/20/requestanimationframe-for-smart-er-animating
 * requestAnimationFrame polyfill by Erik Möller. fixes from Paul Irish and Tino Zijdel
 * MIT license
 * @license
 */
/*!
 *  Secure Hash Algorithm (SHA256)
 *  http://www.webtoolkit.info/
 *
 *  Original code by Angel Marin, Paul Johnston.
 */
/*!
 * Copyright (c) 2003-2005  Tom Wu
 * All Rights Reserved.
 *
 * Permission is hereby granted, free of charge, to any person obtaining
 * a copy of this software and associated documentation files (the
 * "Software"), to deal in the Software without restriction, including
 * without limitation the rights to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to
 * the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS-IS" AND WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS, IMPLIED OR OTHERWISE, INCLUDING WITHOUT LIMITATION, ANY
 * WARRANTY OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.
 *
 * IN NO EVENT SHALL TOM WU BE LIABLE FOR ANY SPECIAL, INCIDENTAL,
 * INDIRECT OR CONSEQUENTIAL DAMAGES OF ANY KIND, OR ANY DAMAGES WHATSOEVER
 * RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER OR NOT ADVISED OF
 * THE POSSIBILITY OF DAMAGE, AND ON ANY THEORY OF LIABILITY, ARISING OUT
 * OF OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * In addition, the following condition applies:
 *
 * All redistributions must retain an intact copy of this copyright notice
 * and disclaimer.
 */
/*!
StackBlur - a fast almost Gaussian Blur For Canvas

Version:  0.5
Author:   Mario Klingemann
Contact:  mario@quasimondo.com
Website:  http://www.quasimondo.com/StackBlurForCanvas
Twitter:  @quasimondo

In case you find this class useful - especially in commercial projects -
I am not totally unhappy for a small donation to my PayPal account
mario@quasimondo.de

Or support me on flattr:
https://flattr.com/thing/72791/StackBlur-a-fast-almost-Gaussian-Blur-Effect-for-CanvasJavascript

Copyright (c) 2010 Mario Klingemann

Permission is hereby granted, free of charge, to any person
obtaining a copy of this software and associated documentation
files (the "Software"), to deal in the Software without
restriction, including without limitation the rights to use,
copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the
Software is furnished to do so, subject to the following
conditions:

The above copyright notice and this permission notice shall be
included in all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
OTHER DEALINGS IN THE SOFTWARE.
@license
*/
